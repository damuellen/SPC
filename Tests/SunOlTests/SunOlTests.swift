import Utilities
import XCTest
import xlsxwriter

@testable import SunOl

class SunOlTests: XCTestCase {
  override func setUp() {
    let path = "input2.txt"
    guard let csv = CSVReader(atPath: path) else {
      print("No input")
      return
    }
    TunOl.Q_Sol_MW_thLoop = [0] + csv["csp"]
    TunOl.Reference_PV_plant_power_at_inverter_inlet_DC = [0] + csv["pv"]
    TunOl.Reference_PV_MV_power_at_transformer_outlet = [0] + csv["out"]
  }

  func testsCalculation() {
    guard let csv_ref = CSVReader(atPath: "calc.csv", separator: "\t"),
      let csv_ref2 = CSVReader(atPath: "daily1.csv", separator: "\t"),
      let csv_ref3 = CSVReader(atPath: "daily2.csv", separator: "\t")
    else {
      print("No input")
      return
    }

    var calc = [String]()

    func compare(_ array: [Double], letter: String, start index: Int) {
      let index = index
      let ref = csv_ref[letter]
      var correct = true
      var counter = 1
      for i in 1..<8700 {
        if counter > 5 { break }
        // if !array[index + i].isZero && array[index + i] < 1E-13 { continue }
        if abs(ref[i - 1] - array[index + i]) / ref[i - 1] > 0.01 {
          counter += 1
          correct = false
           XCTFail("Calculation \(letter) \(i + 4)   \(ref[i - 1]) != \(array[index + i])  [\(index + i)]")
        }
      }
      ()
      if correct {calc.append(letter) }
    }
    var day1 = [String]()
    func compareDay(_ array: [Double], letter: String, start index: Int) {
      let index = index
      let ref = csv_ref2[letter]
      var correct = true
      var counter = 1
      for i in 0..<364 {
        if counter > 5 { break }
        if abs(ref[i] - array[index + i]) > 0.1 {
          counter += 1
          correct = false  
           XCTFail("Daily1 \(letter) \(i + 3)   \(ref[i]) != \(array[index + i])  [\(index + i)]")
        }
      }
      if correct {day1.append(letter) }
    }

    var day2 = [String]()
    func compare2Day(_ array: [Double], letter: String, start index: Int) {
      let index = index
      let ref = csv_ref3[letter]
      var correct = true
      var counter = 1
      for i in 0..<364 {
        // if counter > 5 { break }
        if abs(ref[i] - array[index + i]) > 0.1 {
          counter += 1
          correct = false  
          XCTFail("Daily2 \(letter) \(i + 3)   \(ref[i]) != \(array[index + i])  [\(index + i)]")
        }
      }
      if correct {day2.append(letter) }
    }

    guard let model = TunOl([120.00,8867.00,190.00,950.00,1350.00,500.00,100.00,300.00,40.00,30000.00,46.00,30000.00,30.00,120.00,1200.00,50.00,0.00,])

    else {
      print("Invalid config")
      return
    }

    let hour0 = model.hour0(
      TunOl.Q_Sol_MW_thLoop, TunOl.Reference_PV_plant_power_at_inverter_inlet_DC,
      TunOl.Reference_PV_MV_power_at_transformer_outlet)

    compare(hour0, letter: "H", start: 8760)
    compare(hour0, letter: "I", start: 17520)
    compare(hour0, letter: "J", start: 26280)
    compare(hour0, letter: "K", start: 35040)
    compare(hour0, letter: "L", start: 43800)
    compare(hour0, letter: "M", start: 52560)
    compare(hour0, letter: "O", start: 61320)
    compare(hour0, letter: "P", start: 70080)
    compare(hour0, letter: "Q", start: 78840)
    compare(hour0, letter: "R", start: 87600)
    compare(hour0, letter: "S", start: 96360)
    compare(hour0, letter: "T", start: 105120)
    compare(hour0, letter: "U", start: 113880)

    compare(hour0, letter: "V", start: 122640)
    compare(hour0, letter: "W", start: 131400)
    compare(hour0, letter: "X", start: 140160)
    compare(hour0, letter: "Y", start: 148920)
    compare(hour0, letter: "Z", start: 157680)
    compare(hour0, letter: "AA", start: 166440)
    compare(hour0, letter: "AB", start: 175200)
    compare(hour0, letter: "AC", start: 183960)

    compare(hour0, letter: "AD", start: 192720)
    compare(hour0, letter: "AE", start: 201480)
    compare(hour0, letter: "AF", start: 210240)
    compare(hour0, letter: "AG", start: 219000)
    compare(hour0, letter: "AH", start: 227760)
    compare(hour0, letter: "AI", start: 236520)
    compare(hour0, letter: "AJ", start: 245280)
    compare(hour0, letter: "AK", start: 254040)

    compare(hour0, letter: "AL", start: 262800)
    compare(hour0, letter: "AM", start: 271560)
    compare(hour0, letter: "AN", start: 280320)
    compare(hour0, letter: "AO", start: 289080)
    compare(hour0, letter: "AP", start: 297840)
    compare(hour0, letter: "AQ", start: 306600)
    compare(hour0, letter: "AR", start: 315360)
    compare(hour0, letter: "AS", start: 324120)
    compare(hour0, letter: "AT", start: 332880)

    // print("Calculation")
    // Array(hour0[..<61320]).head(6, steps: 8760)
    // print("Calculation")
    // Array(hour0[61320..<113880]).head(14, steps: 8760)
    // print("Calculation")

    let hour1 = model.hour1(hour0: hour0)

    compare(hour1, letter: "AV", start: 0)
    compare(hour1, letter: "AW", start: 8760)
    compare(hour1, letter: "AX", start: 17520)
    compare(hour1, letter: "AY", start: 26280)
    compare(hour1, letter: "AZ", start: 35040)
    compare(hour1, letter: "BA", start: 43800)
    compare(hour1, letter: "BB", start: 52560)
    compare(hour1, letter: "BC", start: 61320)
    compare(hour1, letter: "BD", start: 70080)
    compare(hour1, letter: "BE", start: 78840)
    compare(hour1, letter: "BF", start: 87600)
    compare(hour1, letter: "BG", start: 96360)
    compare(hour1, letter: "BH", start: 105120)
    compare(hour1, letter: "BI", start: 113880)
    compare(hour1, letter: "BJ", start: 122640)
    compare(hour1, letter: "BK", start: 131400)
    compare(hour1, letter: "BL", start: 140160)
    compare(hour1, letter: "BM", start: 148920)
    compare(hour1, letter: "BN", start: 157680)
    compare(hour1, letter: "BO", start: 166440)
    compare(hour1, letter: "BP", start: 175200)
    compare(hour1, letter: "BQ", start: 183960)
    print("Calculation")
    // hour1.head(47, steps: 8760)

    let d22 = model.d22(hour0: hour0)
    print("Daily 2")
    compare2Day(d22, letter: "DM", start: 13140)
    compare2Day(d22, letter: "DN", start: 13505)
    compare2Day(d22, letter: "DO", start: 13870)
    compare2Day(d22, letter: "DR", start: 0)
    compare2Day(d22, letter: "DS", start: 365)
    compare2Day(d22, letter: "DT", start: 730)
    compare2Day(d22, letter: "DU", start: 1095)
    compare2Day(d22, letter: "DV", start: 1460)
    compare2Day(d22, letter: "DW", start: 1825)
    compare2Day(d22, letter: "DX", start: 2190)
    compare2Day(d22, letter: "DY", start: 2555)
    compare2Day(d22, letter: "DZ", start: 2920)
    compare2Day(d22, letter: "EA", start: 3285)
    compare2Day(d22, letter: "EB", start: 3650)
    compare2Day(d22, letter: "EC", start: 4015)
    compare2Day(d22, letter: "ED", start: 4380)
    compare2Day(d22, letter: "EE", start: 4745)
    compare2Day(d22, letter: "EF", start: 5110)
    compare2Day(d22, letter: "EG", start: 5475)
    compare2Day(d22, letter: "EH", start: 5840)
    compare2Day(d22, letter: "EI", start: 6205)
    compare2Day(d22, letter: "EJ", start: 6570)
    compare2Day(d22, letter: "EK", start: 6935)
    compare2Day(d22, letter: "EL", start: 7300)
    compare2Day(d22, letter: "EM", start: 7665)
    compare2Day(d22, letter: "EN", start: 8030)
    compare2Day(d22, letter: "EO", start: 8395)
    compare2Day(d22, letter: "EP", start: 8760)
    compare2Day(d22, letter: "EQ", start: 9125)
    compare2Day(d22, letter: "ER", start: 9490)
    compare2Day(d22, letter: "ES", start: 9855)
    compare2Day(d22, letter: "ET", start: 10220)
    compare2Day(d22, letter: "EU", start: 10585)
    compare2Day(d22, letter: "EV", start: 10950)
    compare2Day(d22, letter: "EW", start: 11315)
    compare2Day(d22, letter: "EX", start: 11680)
    compare2Day(d22, letter: "EY", start: 12045)
    compare2Day(d22, letter: "EZ", start: 12410)
    compare2Day(d22, letter: "FA", start: 12775)

    // Array(d6[0..<5840]).head(121, steps: 365)
    // print("Daily 2")
    // Array(d6[5840...]).head(137, steps: 365)

    var hour2 = [Double](repeating: .zero, count: 183_960)
    var hour3 = [Double](repeating: .zero, count: 297_840)
    var hour4 = [Double](repeating: .zero, count: 516_840)
    var d10 = [Double](repeating: .zero, count: 13_140)
    var d11 = [Double](repeating: .zero, count: 17_155)
    var d12 = [Double](repeating: .zero, count: 17_155)
    var d13 = [Double](repeating: .zero, count: 47_085) 
    var d23 = [Double](repeating: .zero, count: 48_545)
    var d21 = [Double](repeating: .zero, count: 9_855)

    for j in 0..<4 {
      model.hour2(&hour2, j: j, hour0: hour0, hour1: hour1)
      if j == 0 {
        compare(hour2, letter: "BT", start: 175200)
        compare(hour2, letter: "BU", start: 0)
        compare(hour2, letter: "BV", start: 8760)
        compare(hour2, letter: "BW", start: 17520)
        compare(hour2, letter: "BX", start: 26280)
        compare(hour2, letter: "BY", start: 35040)
        compare(hour2, letter: "BZ", start: 43800)
        compare(hour2, letter: "CA", start: 52560)
        compare(hour2, letter: "CB", start: 61320)
        compare(hour2, letter: "CC", start: 70080)
        compare(hour2, letter: "CD", start: 78840)
        compare(hour2, letter: "CE", start: 87600)
        compare(hour2, letter: "CF", start: 96360)
        compare(hour2, letter: "CG", start: 105120)
        compare(hour2, letter: "CH", start: 113880)
        compare(hour2, letter: "CI", start: 122640)
        compare(hour2, letter: "CJ", start: 131400)
        compare(hour2, letter: "CK", start: 140160)
        compare(hour2, letter: "CL", start: 148920)
        compare(hour2, letter: "CM", start: 157680)
        print("Hour Case", j)  // hour2.head(72, steps: 8760)
      }
      if j == 1 {
        print("Hour Case", j)  // hour2.head(184, steps: 8760)
      }
      if j == 2 {
        compare(hour2, letter: "KK", start: 0)
        compare(hour2, letter: "KL", start: 8760)
        compare(hour2, letter: "KM", start: 17520)
        compare(hour2, letter: "KN", start: 26280)
        compare(hour2, letter: "KO", start: 35040)
        compare(hour2, letter: "KP", start: 43800)
        compare(hour2, letter: "KQ", start: 52560)
        compare(hour2, letter: "KR", start: 61320)
        compare(hour2, letter: "KS", start: 70080)
        compare(hour2, letter: "KT", start: 78840)
        compare(hour2, letter: "KU", start: 87600)
        compare(hour2, letter: "KV", start: 96360)
        compare(hour2, letter: "KW", start: 105120)
        compare(hour2, letter: "KX", start: 113880)
        compare(hour2, letter: "KY", start: 122640)
        compare(hour2, letter: "KZ", start: 131400)
        compare(hour2, letter: "LA", start: 140160)
        compare(hour2, letter: "LB", start: 148920)
        compare(hour2, letter: "LC", start: 157680)
        compare(hour2, letter: "LD", start: 166440)
        print("Hour Case", j)  // hour2.head(296, steps: 8760)
      }

      model.hour3(&hour3, j: j, hour0: hour0, hour1: hour1, hour2: hour2)
      print("Hour Case", j)
      // hour3.head(93, steps: 8760)
      if j == 0 {
        compare(hour3, letter: "CP", start: 0)
        compare(hour3, letter: "CQ", start: 8760)
        compare(hour3, letter: "CR", start: 17520)
        compare(hour3, letter: "CN", start: 289080)
        compare(hour3, letter: "CS", start: 26280)
        compare(hour3, letter: "CT", start: 35040)
        compare(hour3, letter: "CU", start: 43800)
        compare(hour3, letter: "CV", start: 52560)
        compare(hour3, letter: "CW", start: 61320)
        compare(hour3, letter: "CX", start: 70080)
        compare(hour3, letter: "CY", start: 78840)
        compare(hour3, letter: "CZ", start: 87600)
        compare(hour3, letter: "DG", start: 148920)
        compare(hour3, letter: "DH", start: 157680)
        compare(hour3, letter: "DI", start: 166440)
        compare(hour3, letter: "DJ", start: 175200)
        compare(hour3, letter: "DK", start: 183960)
        compare(hour3, letter: "DL", start: 192720)
        compare(hour3, letter: "DM", start: 201480)
        compare(hour3, letter: "DN", start: 210240)
        compare(hour3, letter: "DO", start: 219000)
        compare(hour3, letter: "DP", start: 227760)
        compare(hour3, letter: "DQ", start: 236520)
        compare(hour3, letter: "DR", start: 245280)
        compare(hour3, letter: "DS", start: 254040)
        compare(hour3, letter: "DT", start: 262800)
        compare(hour3, letter: "DU", start: 280320)


      }
      model.d10(&d10, case: j, hour2: hour2, hour3: hour3)
      if j == 0 {
        compareDay(d10, letter: "D", start: 365)
        compareDay(d10, letter: "E", start: 730)
        compareDay(d10, letter: "F", start: 1095)
        // compareDay(d10, letter: "G", start: 1460)
        compareDay(d10, letter: "H", start: 1825)
        // compareDay(d10, letter: "I", start: 2190)
        compareDay(d10, letter: "J", start: 2555)
        // compareDay(d10, letter: "K", start: 2920)
        compareDay(d10, letter: "L", start: 3285)
      }
      if j == 2 {
        compareDay(d10, letter: "CB", start: 365)
        compareDay(d10, letter: "CC", start: 730)
        compareDay(d10, letter: "CH", start: 2555)
        // compareDay(d10, letter: "CI", start: 2920)
        compareDay(d10, letter: "CJ", start: 3285)
        compareDay(d10, letter: "CK", start: 3650)
        compareDay(d10, letter: "CL", start: 4015)
        compareDay(d10, letter: "CM", start: 4380)
        compareDay(d10, letter: "CN", start: 4745)
        compareDay(d10, letter: "CO", start: 5110)
        compareDay(d10, letter: "CP", start: 5475)
      }
      model.hour4(&hour4, j: j, d1: d10, hour0: hour0, hour1: hour1, hour2: hour2, hour3: hour3)
      if j == 0 {
        compare(hour4, letter: "DV", start: 0)
        compare(hour4, letter: "DW", start: 8760)
        compare(hour4, letter: "DX", start: 17520)
        compare(hour4, letter: "DY", start: 26280)
        compare(hour4, letter: "DZ", start: 35040)
        compare(hour4, letter: "EA", start: 43800)
        compare(hour4, letter: "EB", start: 52560)
        compare(hour4, letter: "EC", start: 61320)
        compare(hour4, letter: "ED", start: 70080)
        compare(hour4, letter: "EE", start: 78840)
        compare(hour4, letter: "EF", start: 87600)
        compare(hour4, letter: "EG", start: 96360)
        compare(hour4, letter: "EH", start: 105120)
        compare(hour4, letter: "EI", start: 113880)
        compare(hour4, letter: "EJ", start: 122640)
        compare(hour4, letter: "EK", start: 131400)
        compare(hour4, letter: "EL", start: 140160)
        compare(hour4, letter: "EM", start: 148920)
        compare(hour4, letter: "EN", start: 157680)
        compare(hour4, letter: "EO", start: 166440)
        compare(hour4, letter: "EP", start: 175200)
        compare(hour4, letter: "EQ", start: 183960)
        compare(hour4, letter: "ER", start: 192720)
        compare(hour4, letter: "ES", start: 201480)
        compare(hour4, letter: "ET", start: 210240)
        compare(hour4, letter: "EU", start: 219000)
        compare(hour4, letter: "EW", start: 227760)
        compare(hour4, letter: "EX", start: 236520)
        compare(hour4, letter: "EY", start: 245280)
        compare(hour4, letter: "EZ", start: 254040)
        compare(hour4, letter: "FA", start: 262800)
        compare(hour4, letter: "FB", start: 271560)
        compare(hour4, letter: "FC", start: 280320)
        compare(hour4, letter: "FD", start: 289080)
        compare(hour4, letter: "FE", start: 297840)
        compare(hour4, letter: "FF", start: 306600)
        compare(hour4, letter: "FG", start: 315360)
        compare(hour4, letter: "FH", start: 324120)
        compare(hour4, letter: "FI", start: 332880)
        compare(hour4, letter: "FJ", start: 341640)
        compare(hour4, letter: "FK", start: 350400)
        compare(hour4, letter: "FL", start: 359160)
        compare(hour4, letter: "FM", start: 367920)
        compare(hour4, letter: "FN", start: 376680)
        compare(hour4, letter: "FO", start: 385440)
        compare(hour4, letter: "FP", start: 394200)
        compare(hour4, letter: "FQ", start: 402960)
        compare(hour4, letter: "FR", start: 411720)
        compare(hour4, letter: "FS", start: 420480)
        compare(hour4, letter: "FT", start: 429240)
        compare(hour4, letter: "FU", start: 438000)
        compare(hour4, letter: "FV", start: 446760)
        compare(hour4, letter: "FW", start: 455520)
        compare(hour4, letter: "FX", start: 464280)
        compare(hour4, letter: "FY", start: 473040)
        compare(hour4, letter: "FZ", start: 481800)
        compare(hour4, letter: "GA", start: 490560)
      }
      if j == 2 {
        compare(hour4, letter: "MM", start: 8760)
        compare(hour4, letter: "MN", start: 17520)
        compare(hour4, letter: "MO", start: 26280)
        compare(hour4, letter: "MP", start: 35040)
        compare(hour4, letter: "MQ", start: 43800)
        compare(hour4, letter: "MR", start: 52560)
        compare(hour4, letter: "MS", start: 61320)
        compare(hour4, letter: "MT", start: 70080)
        compare(hour4, letter: "MU", start: 78840)
        compare(hour4, letter: "MV", start: 87600)
        compare(hour4, letter: "MW", start: 96360)
        compare(hour4, letter: "MX", start: 105120)
        compare(hour4, letter: "MY", start: 113880)
        compare(hour4, letter: "MZ", start: 122640)
        compare(hour4, letter: "NA", start: 131400)
        compare(hour4, letter: "NB", start: 140160)
        compare(hour4, letter: "NC", start: 148920)
        compare(hour4, letter: "ND", start: 157680)
        compare(hour4, letter: "NE", start: 166440)
        compare(hour4, letter: "NF", start: 175200)
        compare(hour4, letter: "NG", start: 183960)
        compare(hour4, letter: "NH", start: 192720)
        compare(hour4, letter: "NI", start: 201480)
        compare(hour4, letter: "NJ", start: 210240)
        compare(hour4, letter: "NK", start: 219000)
      }
      print("Hour Case", j)
      // Array(hour4[0..<227760]).head(125, steps: 8760)
      // Array(hour4[227760...]).head(152, steps: 8760)

      model.night(case: j, d10: &d10, hour3: hour3, hour4: hour4)
      print("Daily Case", j)
      // if j == 2 { Array(d1[8760..<9490]).head(26, steps: 365) }
      // print("Daily Case", j)
      // Array(d1[5840...]).head(19, steps: 365)
      if j == 0 {
        compareDay(d10, letter: "L", start: 3285)
        compareDay(d10, letter: "M", start: 3650)
        compareDay(d10, letter: "N", start: 4015)
        compareDay(d10, letter: "O", start: 4380)
        compareDay(d10, letter: "P", start: 4745)
        compareDay(d10, letter: "T", start: 5840)
        compareDay(d10, letter: "W", start: 6935)
        compareDay(d10, letter: "Z", start: 8030)
        compareDay(d10, letter: "AA", start: 8395)
        compareDay(d10, letter: "AB", start: 8760)
        compareDay(d10, letter: "AC", start: 9125)

        compareDay(d10, letter: "AJ", start: 11680)
        compareDay(d10, letter: "AK", start: 12045)
        compareDay(d10, letter: "AL", start: 12410)

        compareDay(d10, letter: "AM", start: 12775)

        compareDay(d10, letter: "AM", start: 12775)
      }

      if j == 2 {
        compareDay(d10, letter: "CX", start: 8030)
        compareDay(d10, letter: "CY", start: 8395)
        compareDay(d10, letter: "CZ", start: 8760)
        compareDay(d10, letter: "DA", start: 9125)
        compareDay(d10, letter: "DK", start: 12775)
      }

      model.d11(case: j, &d11, hour0: hour0, hour2: hour2, hour3: hour3)
      if j == 0 {
        compareDay(d11, letter: "EY", start: 0)
        compareDay(d11, letter: "EZ", start: 365)
        compareDay(d11, letter: "FA", start: 730)
        compareDay(d11, letter: "FC", start: 1460)
        compareDay(d11, letter: "FD", start: 1825)
        compareDay(d11, letter: "FE", start: 2190)
        compareDay(d11, letter: "FK", start: 4380)
        compareDay(d11, letter: "FV", start: 8395)
        compareDay(d11, letter: "FW", start: 8760)
        compareDay(d11, letter: "GA", start: 10220)
        compareDay(d11, letter: "GB", start: 10585)
        compareDay(d11, letter: "GC", start: 10950)
        compareDay(d11, letter: "GE", start: 11680)
        compareDay(d11, letter: "GG", start: 12410)

        compareDay(d11, letter: "FR", start: 6935)
        compareDay(d11, letter: "FS", start: 7300)
        print("Daily Case", j)  // Array(d15[0..<9125]).head(154, steps: 365)
        // print("Daily Case", j)
        // Array(d15[9125...]).head(179, steps: 365)
      }
      if j == 1 {
        print("Daily Case", j)  // Array(d15[0..<9125]).head(376, steps: 365)
        // print("Daily Case", j)
        // Array(d15[9125...]).head(401, steps: 365)
      }
      if j == 2 {
        compareDay(d11, letter: "WO", start: 0)
        compareDay(d11, letter: "WP", start: 365)
        compareDay(d11, letter: "WQ", start: 730)
        // compareDay(d11, letter: "WR", start: 1095)
        compareDay(d11, letter: "WS", start: 1460)
        compareDay(d11, letter: "WT", start: 1825)
        compareDay(d11, letter: "WU", start: 2190)
        // compareDay(d11, letter: "WV", start: 2555)
        // compareDay(d11, letter: "WW", start: 2920)
        // compareDay(d11, letter: "WX", start: 3285)
        // compareDay(d11, letter: "WY", start: 3650)
        // compareDay(d11, letter: "WZ", start: 4015)
        compareDay(d11, letter: "XA", start: 4380)
        // compareDay(d11, letter: "XB", start: 4745)
        // compareDay(d11, letter: "XC", start: 5110)
        // compareDay(d11, letter: "XD", start: 5475)
        // compareDay(d11, letter: "XE", start: 5840)
        // compareDay(d11, letter: "XF", start: 6205)
        // compareDay(d11, letter: "XG", start: 6570)
        // compareDay(d11, letter: "XH", start: 6935)
        compareDay(d11, letter: "XI", start: 7300)
        compareDay(d11, letter: "XJ", start: 7665)
        compareDay(d11, letter: "XK", start: 8030)
        compareDay(d11, letter: "XL", start: 8395)
        compareDay(d11, letter: "XM", start: 8760)
        compareDay(d11, letter: "XN", start: 9125)
        compareDay(d11, letter: "XO", start: 9490)
        compareDay(d11, letter: "XP", start: 9855)
        compareDay(d11, letter: "XQ", start: 10220)
        compareDay(d11, letter: "XR", start: 10585)
        compareDay(d11, letter: "XS", start: 10950)
        compareDay(d11, letter: "XT", start: 11315)
        compareDay(d11, letter: "XU", start: 11680)
        compareDay(d11, letter: "XV", start: 12045)
        compareDay(d11, letter: "XW", start: 12410)
        compareDay(d11, letter: "XX", start: 12775)
        compareDay(d11, letter: "XY", start: 13140)
        // compareDay(d11, letter: "XZ", start: 13505)
        compareDay(d11, letter: "YA", start: 13870)
        compareDay(d11, letter: "YB", start: 14235)
        // compareDay(d11, letter: "YC", start: 14600)
        compareDay(d11, letter: "YD", start: 14965)
        compareDay(d11, letter: "YE", start: 15330)
        // compareDay(d11, letter: "YF", start: 15695)
        compareDay(d11, letter: "YG", start: 16060)
        compareDay(d11, letter: "YH", start: 16425)
        // compareDay(d11, letter: "YI", start: 16790)

      }
      model.d12(case: j, &d12, hour0: hour0, hour4: hour4)
      print("Daily 1 Case", j)
      // Array(d16[..<9125]).head(202, steps: 365)
      // print("Daily 1 Case", j)
      // Array(d16[9125...]).head(227, steps: 365)

      if j == 0 {
        compareDay(d12, letter: "HO", start: 7300)
        compareDay(d12, letter: "HR", start: 8395)
      }

      if j == 2 {
        compareDay(d12, letter: "YK", start: 0)
        compareDay(d12, letter: "YL", start: 365)
        compareDay(d12, letter: "YM", start: 730)
        // compareDay(d12, letter: "YN", start: 1095)
        compareDay(d12, letter: "YO", start: 1460)
        compareDay(d12, letter: "YP", start: 1825)
        compareDay(d12, letter: "YQ", start: 2190)
        // compareDay(d12, letter: "YR", start: 2555)
        // compareDay(d12, letter: "YS", start: 2920)
        // compareDay(d12, letter: "YT", start: 3285)
        // compareDay(d12, letter: "YU", start: 3650)
        // compareDay(d12, letter: "YV", start: 4015)
        compareDay(d12, letter: "YW", start: 4380)
        // compareDay(d12, letter: "YX", start: 4745)
        // compareDay(d12, letter: "YY", start: 5110)
        // compareDay(d12, letter: "YZ", start: 5475)
        // compareDay(d12, letter: "ZA", start: 5840)
        // compareDay(d12, letter: "ZB", start: 6205)
        // compareDay(d12, letter: "ZC", start: 6570)
        // compareDay(d12, letter: "ZD", start: 6935)
        compareDay(d12, letter: "ZE", start: 7300)
        compareDay(d12, letter: "ZF", start: 7665)
        compareDay(d12, letter: "ZG", start: 8030)
        compareDay(d12, letter: "ZH", start: 8395)
        compareDay(d12, letter: "ZI", start: 8760)
        compareDay(d12, letter: "ZJ", start: 9125)
        compareDay(d12, letter: "ZK", start: 9490)
        compareDay(d12, letter: "ZL", start: 9855)
        compareDay(d12, letter: "ZM", start: 10220)
        compareDay(d12, letter: "ZN", start: 10585)
        compareDay(d12, letter: "ZO", start: 10950)
        compareDay(d12, letter: "ZP", start: 11315)
        compareDay(d12, letter: "ZQ", start: 11680)
        compareDay(d12, letter: "ZR", start: 12045)
        compareDay(d12, letter: "ZS", start: 12410)
        compareDay(d12, letter: "ZT", start: 12775)
        compareDay(d12, letter: "ZU", start: 13140)
        // compareDay(d12, letter: "ZV", start: 13505)
        compareDay(d12, letter: "ZW", start: 13870)
        compareDay(d12, letter: "ZX", start: 14235)
        // compareDay(d12, letter: "ZY", start: 14600)
        compareDay(d12, letter: "ZZ", start: 14965)
        compareDay(d12, letter: "AAA", start: 15330)
        // compareDay(d12, letter: "AAB", start: 15695)
        compareDay(d12, letter: "AAC", start: 16060)
        compareDay(d12, letter: "AAD", start: 16425)
        // compareDay(d12, letter: "AAE", start: 16790)
      }

      model.d13(&d13, case: j, d10: d10, d11: d11, d12: d12)
      model.d14(&d13, case: j, d10: d10, d11: d11, d12: d12)
      if j == 0 {
        compareDay(d13, letter: "IQ", start: 0)
        compareDay(d13, letter: "IR", start: 365)
        compareDay(d13, letter: "IS", start: 730)
        compareDay(d13, letter: "JP", start: 8760)
        compareDay(d13, letter: "JQ", start: 9125)
        compareDay(d13, letter: "JR", start: 9490)
        compareDay(d13, letter: "KG", start: 14965)
        compareDay(d13, letter: "KI", start: 15330)
        compareDay(d13, letter: "KJ", start: 15695)
        compareDay(d13, letter: "KK", start: 16060)
        compareDay(d13, letter: "KZ", start: 21535)
        compareDay(d13, letter: "MK", start: 34310)
        compareDay(d13, letter: "NA", start: 40150)
        compareDay(d13, letter: "NO", start: 45260)
        compareDay(d13, letter: "NP", start: 45625)
        compareDay(d13, letter: "NL", start: 44165)
        print("Daily 1 Case", j)  // Array(d17[..<7665]).head(250, steps: 365)
        // print("Daily 1 Case", j)
        // Array(d17[7665..<13505]).head(272, steps: 365)
        // print("Daily 1 Case", j)
        // Array(d17[13505..<19345]).head(289, steps: 365)
        // print("Daily 1 Case", j)
        // Array(d17[19345..<31755]).head(306, steps: 365)
        // print("Daily 1 Case", j)
        // Array(d17[31755...]).head(341, steps: 365)
      }

      if j == 0 {

      }

      if j == 1 {

      }
      if j == 2 {
        compareDay(d13, letter: "AAG", start: 0)
        compareDay(d13, letter: "AAH", start: 365)
        compareDay(d13, letter: "AAI", start: 730)
        compareDay(d13, letter: "AAJ", start: 1095)
        compareDay(d13, letter: "AAK", start: 1460)
        compareDay(d13, letter: "AAL", start: 1825)
        compareDay(d13, letter: "AAM", start: 2190)
        compareDay(d13, letter: "AAN", start: 2555)
        compareDay(d13, letter: "AAO", start: 2920)
        compareDay(d13, letter: "AAP", start: 3285)
        compareDay(d13, letter: "AAQ", start: 3650)
        compareDay(d13, letter: "AAR", start: 4015)
        compareDay(d13, letter: "AAS", start: 4380)
        compareDay(d13, letter: "AAT", start: 4745)
        compareDay(d13, letter: "AAU", start: 5110)
        compareDay(d13, letter: "AAV", start: 5475)
        compareDay(d13, letter: "AAW", start: 5840)
        compareDay(d13, letter: "AAX", start: 6205)
        compareDay(d13, letter: "AAY", start: 6570)
        compareDay(d13, letter: "AAZ", start: 6935)
        compareDay(d13, letter: "ABA", start: 7300)
        compareDay(d13, letter: "ABB", start: 7665)
        compareDay(d13, letter: "ABC", start: 8030)
        compareDay(d13, letter: "ABD", start: 8395)

        compareDay(d13, letter: "ABF", start: 8760)
        compareDay(d13, letter: "ABG", start: 9125)
        compareDay(d13, letter: "ABH", start: 9490)
        compareDay(d13, letter: "ABI", start: 9855)
        compareDay(d13, letter: "ABJ", start: 10220)
        compareDay(d13, letter: "ABK", start: 10585)
        compareDay(d13, letter: "ABL", start: 10950)
        compareDay(d13, letter: "ABM", start: 11315)
        compareDay(d13, letter: "ABN", start: 11680)
        compareDay(d13, letter: "ABO", start: 12045)
        compareDay(d13, letter: "ABP", start: 12410)
        compareDay(d13, letter: "ABQ", start: 12775)
        compareDay(d13, letter: "ABR", start: 13140)
        compareDay(d13, letter: "ABS", start: 13505)
        compareDay(d13, letter: "ABT", start: 13870)
        compareDay(d13, letter: "ABU", start: 14235)
        compareDay(d13, letter: "ABV", start: 14600)
        compareDay(d13, letter: "ABW", start: 14965)

        compareDay(d13, letter: "ABY", start: 15330)
        compareDay(d13, letter: "ABZ", start: 15695)
        compareDay(d13, letter: "ACA", start: 16060)
        compareDay(d13, letter: "ACB", start: 16425)
        compareDay(d13, letter: "ACC", start: 16790)
        compareDay(d13, letter: "ACD", start: 17155)
        compareDay(d13, letter: "ACE", start: 17520)
        compareDay(d13, letter: "ACF", start: 17885)
        compareDay(d13, letter: "ACG", start: 18250)
        compareDay(d13, letter: "ACH", start: 18615)
        compareDay(d13, letter: "ACI", start: 18980)
        compareDay(d13, letter: "ACJ", start: 19345)
        compareDay(d13, letter: "ACK", start: 19710)
        compareDay(d13, letter: "ACL", start: 20075)
        compareDay(d13, letter: "ACM", start: 20440)
        compareDay(d13, letter: "ACN", start: 20805)
        compareDay(d13, letter: "ACO", start: 21170)
        compareDay(d13, letter: "ACP", start: 21535)
      }

      let d0 = model.day0(hour0: hour0)

      model.d21(&d21, case: j, day0: d0)
      if j == 0 {
        compare2Day(d0, letter: "B", start: 365)
        compare2Day(d0, letter: "C", start: 730)
        compare2Day(d21, letter: "E", start: 0)
        compare2Day(d21, letter: "F", start: 365)
        compare2Day(d21, letter: "G", start: 730)
        compare2Day(d21, letter: "H", start: 1095)
        compare2Day(d21, letter: "I", start: 1460)
        compare2Day(d21, letter: "J", start: 1825)
        compare2Day(d21, letter: "K", start: 2190)
        compare2Day(d21, letter: "L", start: 2555)
        compare2Day(d21, letter: "M", start: 2920)
        compare2Day(d21, letter: "N", start: 3285)
        compare2Day(d21, letter: "O", start: 3650)
        compare2Day(d21, letter: "P", start: 4015)
        compare2Day(d21, letter: "Q", start: 4380)
        compare2Day(d21, letter: "R", start: 4745)
        compare2Day(d21, letter: "S", start: 5110)
        compare2Day(d21, letter: "T", start: 5475)
        compare2Day(d21, letter: "U", start: 5840)
        compare2Day(d21, letter: "V", start: 6205)
        compare2Day(d21, letter: "W", start: 6570)
        compare2Day(d21, letter: "X", start: 6935)
        compare2Day(d21, letter: "Y", start: 7300)
        compare2Day(d21, letter: "Z", start: 7665)
        compare2Day(d21, letter: "AA", start: 8030)
        compare2Day(d21, letter: "AB", start: 8395)
        compare2Day(d21, letter: "AC", start: 8760)
        compare2Day(d21, letter: "AD", start: 9125)
        compare2Day(d21, letter: "AE", start: 9490)
      }
      if j == 1 {
        compare2Day(d21, letter: "AG", start: 0)
        compare2Day(d21, letter: "AH", start: 365)
        compare2Day(d21, letter: "AI", start: 730)
        compare2Day(d21, letter: "AJ", start: 1095)
        compare2Day(d21, letter: "AK", start: 1460)
        compare2Day(d21, letter: "AL", start: 1825)
        compare2Day(d21, letter: "AM", start: 2190)
        compare2Day(d21, letter: "AN", start: 2555)
        compare2Day(d21, letter: "AO", start: 2920)
        compare2Day(d21, letter: "AP", start: 3285)
        compare2Day(d21, letter: "AQ", start: 3650)
        compare2Day(d21, letter: "AR", start: 4015)
        compare2Day(d21, letter: "AS", start: 4380)
        compare2Day(d21, letter: "AT", start: 4745)
        compare2Day(d21, letter: "AU", start: 5110)
        compare2Day(d21, letter: "AV", start: 5475)
        compare2Day(d21, letter: "AW", start: 5840)
        compare2Day(d21, letter: "AX", start: 6205)
        compare2Day(d21, letter: "AY", start: 6570)
        compare2Day(d21, letter: "AZ", start: 6935)
        compare2Day(d21, letter: "BA", start: 7300)
        compare2Day(d21, letter: "BB", start: 7665)
        compare2Day(d21, letter: "BC", start: 8030)
        compare2Day(d21, letter: "BD", start: 8395)
        compare2Day(d21, letter: "BE", start: 8760)
        compare2Day(d21, letter: "BF", start: 9125)
        compare2Day(d21, letter: "BG", start: 9490)
      }
      if j == 2 {
        compare2Day(d21, letter: "BI", start: 0)
        compare2Day(d21, letter: "BJ", start: 365)
        compare2Day(d21, letter: "BK", start: 730)
        compare2Day(d21, letter: "BL", start: 1095)
        compare2Day(d21, letter: "BM", start: 1460)
        compare2Day(d21, letter: "BN", start: 1825)
        compare2Day(d21, letter: "BO", start: 2190)
        compare2Day(d21, letter: "BP", start: 2555)
        compare2Day(d21, letter: "BQ", start: 2920)
        compare2Day(d21, letter: "BR", start: 3285)
        compare2Day(d21, letter: "BS", start: 3650)
        compare2Day(d21, letter: "BT", start: 4015)
        compare2Day(d21, letter: "BU", start: 4380)
        compare2Day(d21, letter: "BV", start: 4745)
        compare2Day(d21, letter: "BW", start: 5110)
        compare2Day(d21, letter: "BX", start: 5475)
        compare2Day(d21, letter: "BY", start: 5840)
        compare2Day(d21, letter: "BZ", start: 6205)
        compare2Day(d21, letter: "CA", start: 6570)
        compare2Day(d21, letter: "CB", start: 6935)
        compare2Day(d21, letter: "CC", start: 7300)
        compare2Day(d21, letter: "CD", start: 7665)
        compare2Day(d21, letter: "CE", start: 8030)
        compare2Day(d21, letter: "CF", start: 8395)
        compare2Day(d21, letter: "CG", start: 8760)
        compare2Day(d21, letter: "CH", start: 9125)
        compare2Day(d21, letter: "CI", start: 9490)
      }
      print("Daily 2 Case", j)
      // Array(d21[0..<6935]).head(0, steps: 365)
      // print("Daily 2 Case", j)
      // Array(d21[6935...]).head(19, steps: 365)

      model.d23(&d23, case: j, day0: d0, d21: d21, d22: d22)
      if j == 0 {
        compare2Day(d23, letter: "FC", start: 0)
        compare2Day(d23, letter: "FD", start: 365)
        compare2Day(d23, letter: "FE", start: 730)
        compare2Day(d23, letter: "FF", start: 1095)
        compare2Day(d23, letter: "FG", start: 1460)
        compare2Day(d23, letter: "FH", start: 1825)
        compare2Day(d23, letter: "FI", start: 2190)
        compare2Day(d23, letter: "FJ", start: 2555)
        compare2Day(d23, letter: "FK", start: 2920)
        compare2Day(d23, letter: "FL", start: 3285)
        compare2Day(d23, letter: "FM", start: 3650)
        compare2Day(d23, letter: "FN", start: 4015)
        compare2Day(d23, letter: "FO", start: 4380)
        compare2Day(d23, letter: "FP", start: 4745)
        compare2Day(d23, letter: "FQ", start: 5110)
        compare2Day(d23, letter: "FR", start: 5475)
        compare2Day(d23, letter: "FS", start: 5840)
        compare2Day(d23, letter: "FT", start: 6205)
        compare2Day(d23, letter: "FU", start: 6570)
        compare2Day(d23, letter: "FV", start: 6935)
        compare2Day(d23, letter: "FW", start: 7300)
        compare2Day(d23, letter: "FX", start: 7665)
        compare2Day(d23, letter: "FY", start: 8030)
        compare2Day(d23, letter: "FZ", start: 8395)
        compare2Day(d23, letter: "GA", start: 8760)
        compare2Day(d23, letter: "GB", start: 9125)
        compare2Day(d23, letter: "GC", start: 9490)

        compare2Day(d23, letter: "GE", start: 9855)
        compare2Day(d23, letter: "GF", start: 10220)
        compare2Day(d23, letter: "GG", start: 10585)
        compare2Day(d23, letter: "GH", start: 10950)
        compare2Day(d23, letter: "GI", start: 11315)
        compare2Day(d23, letter: "GJ", start: 11680)
        compare2Day(d23, letter: "GK", start: 12045)
        compare2Day(d23, letter: "GL", start: 12410)
        compare2Day(d23, letter: "GM", start: 12775)
        compare2Day(d23, letter: "GN", start: 13140)
        compare2Day(d23, letter: "GO", start: 13505)
        compare2Day(d23, letter: "GP", start: 13870)
        compare2Day(d23, letter: "GQ", start: 14235)
        compare2Day(d23, letter: "GR", start: 14600)
        compare2Day(d23, letter: "GS", start: 14965)
        compare2Day(d23, letter: "GT", start: 15330)
        compare2Day(d23, letter: "GU", start: 15695)
        compare2Day(d23, letter: "GV", start: 16060)
        compare2Day(d23, letter: "GW", start: 16425)
        compare2Day(d23, letter: "GX", start: 16790)

        compare2Day(d23, letter: "GZ", start: 17155)
        compare2Day(d23, letter: "HA", start: 17520)
        compare2Day(d23, letter: "HB", start: 17885)
        compare2Day(d23, letter: "HC", start: 18250)
        compare2Day(d23, letter: "HD", start: 18615)
        compare2Day(d23, letter: "HE", start: 18980)
        compare2Day(d23, letter: "HF", start: 19345)
        compare2Day(d23, letter: "HG", start: 19710)
        compare2Day(d23, letter: "HH", start: 20075)
        compare2Day(d23, letter: "HI", start: 20440)
        compare2Day(d23, letter: "HJ", start: 20805)
        compare2Day(d23, letter: "HK", start: 21170)
        compare2Day(d23, letter: "HL", start: 21535)
        compare2Day(d23, letter: "HM", start: 21900)
        compare2Day(d23, letter: "HN", start: 22265)
        compare2Day(d23, letter: "HO", start: 22630)
        compare2Day(d23, letter: "HP", start: 22995)
        compare2Day(d23, letter: "HQ", start: 23360)
        compare2Day(d23, letter: "HR", start: 23725)
        compare2Day(d23, letter: "HS", start: 24090)

        compare2Day(d23, letter: "HU", start: 24455)
        compare2Day(d23, letter: "HV", start: 24820)
        compare2Day(d23, letter: "HW", start: 25185)
        // compare2Day(d23, letter: "HX", start: 25550)
        compare2Day(d23, letter: "HY", start: 25915)
        compare2Day(d23, letter: "HZ", start: 26280)
        compare2Day(d23, letter: "IA", start: 26645)
        compare2Day(d23, letter: "IB", start: 27010)
        compare2Day(d23, letter: "IC", start: 27375)
        // compare2Day(d23, letter: "ID", start: 27740)
        compare2Day(d23, letter: "IE", start: 28105)
        compare2Day(d23, letter: "IF", start: 28470)
        // compare2Day(d23, letter: "IG", start: 28835)
        compare2Day(d23, letter: "IH", start: 29200)
        compare2Day(d23, letter: "II", start: 29565)
        compare2Day(d23, letter: "IJ", start: 29930)
        compare2Day(d23, letter: "IK", start: 30295)
        compare2Day(d23, letter: "IL", start: 30660)
        compare2Day(d23, letter: "IM", start: 31025)
        compare2Day(d23, letter: "IN", start: 31390)
        compare2Day(d23, letter: "IO", start: 31755)
        compare2Day(d23, letter: "IP", start: 32120)
        compare2Day(d23, letter: "IQ", start: 32485)
        compare2Day(d23, letter: "IR", start: 32850)
        compare2Day(d23, letter: "IS", start: 33215)
        compare2Day(d23, letter: "IT", start: 33580)
        compare2Day(d23, letter: "IU", start: 33945)
        compare2Day(d23, letter: "IV", start: 34310)
        compare2Day(d23, letter: "IW", start: 34675)
        compare2Day(d23, letter: "IX", start: 35040)

        compare2Day(d23, letter: "IZ", start: 35405)
        compare2Day(d23, letter: "JA", start: 35770)
        compare2Day(d23, letter: "JB", start: 36135)
        // compare2Day(d23, letter: "JC", start: 36500)
        compare2Day(d23, letter: "JD", start: 36865)
        compare2Day(d23, letter: "JE", start: 37230)
        compare2Day(d23, letter: "JF", start: 37595)
        compare2Day(d23, letter: "JG", start: 37960)
        compare2Day(d23, letter: "JH", start: 38325)
        // compare2Day(d23, letter: "JI", start: 38690)
        compare2Day(d23, letter: "JJ", start: 39055)
        compare2Day(d23, letter: "JK", start: 39420)
        // compare2Day(d23, letter: "JL", start: 39785)
        compare2Day(d23, letter: "JM", start: 40150)

        compare2Day(d23, letter: "JN", start: 40515)
        compare2Day(d23, letter: "JO", start: 40880)
        compare2Day(d23, letter: "JP", start: 41245)
        // compare2Day(d23, letter: "JQ", start: 41610)


        compare2Day(d23, letter: "JR", start: 47815)
        compare2Day(d23, letter: "JS", start: 42340)
        compare2Day(d23, letter: "JT", start: 42705)
        compare2Day(d23, letter: "JU", start: 43070)
        compare2Day(d23, letter: "JV", start: 43435)
        // compare2Day(d23, letter: "JW", start: 43800)
        compare2Day(d23, letter: "JX", start: 44165)
        compare2Day(d23, letter: "JY", start: 44530)
        compare2Day(d23, letter: "JZ", start: 44895)
        compare2Day(d23, letter: "KA", start: 45260)
        compare2Day(d23, letter: "KB", start: 45625)  // compare2Day(d23, letter: "KC", start: 45990)

      }

      print("Daily 2 Case", j)
      if j == 1 {
        compare2Day(d23, letter: "KE", start: 0)
        compare2Day(d23, letter: "KF", start: 365)
        compare2Day(d23, letter: "KG", start: 730)
        compare2Day(d23, letter: "KH", start: 1095)
        compare2Day(d23, letter: "KI", start: 1460)
        compare2Day(d23, letter: "KJ", start: 1825)
        compare2Day(d23, letter: "KK", start: 2190)
        compare2Day(d23, letter: "KL", start: 2555)
        compare2Day(d23, letter: "KM", start: 2920)
        compare2Day(d23, letter: "KN", start: 3285)
        compare2Day(d23, letter: "KO", start: 3650)
        compare2Day(d23, letter: "KP", start: 4015)
        compare2Day(d23, letter: "KQ", start: 4380)
        compare2Day(d23, letter: "KR", start: 4745)
        compare2Day(d23, letter: "KS", start: 5110)
        compare2Day(d23, letter: "KT", start: 5475)
        compare2Day(d23, letter: "KU", start: 5840)
        compare2Day(d23, letter: "KV", start: 6205)
        compare2Day(d23, letter: "KW", start: 6570)
        compare2Day(d23, letter: "KX", start: 6935)
        compare2Day(d23, letter: "KY", start: 7300)
        compare2Day(d23, letter: "KZ", start: 7665)
        compare2Day(d23, letter: "LA", start: 8030)
        compare2Day(d23, letter: "LB", start: 8395)
        compare2Day(d23, letter: "LC", start: 8760)
        compare2Day(d23, letter: "LD", start: 9125)
        compare2Day(d23, letter: "LE", start: 9490)

        compare2Day(d23, letter: "LG", start: 9855)
        compare2Day(d23, letter: "LH", start: 10220)
        compare2Day(d23, letter: "LI", start: 10585)
        compare2Day(d23, letter: "LJ", start: 10950)
        compare2Day(d23, letter: "LK", start: 11315)
        compare2Day(d23, letter: "LL", start: 11680)
        compare2Day(d23, letter: "LM", start: 12045)
        compare2Day(d23, letter: "LN", start: 12410)
        compare2Day(d23, letter: "LO", start: 12775)
        compare2Day(d23, letter: "LP", start: 13140)
        compare2Day(d23, letter: "LQ", start: 13505)
        compare2Day(d23, letter: "LR", start: 13870)
        compare2Day(d23, letter: "LS", start: 14235)
        compare2Day(d23, letter: "LT", start: 14600)
        compare2Day(d23, letter: "LU", start: 14965)
        compare2Day(d23, letter: "LV", start: 15330)
        compare2Day(d23, letter: "LW", start: 15695)
        compare2Day(d23, letter: "LX", start: 16060)
        compare2Day(d23, letter: "LY", start: 16425)
        compare2Day(d23, letter: "LZ", start: 16790)

        compare2Day(d23, letter: "MB", start: 17155)
        compare2Day(d23, letter: "MC", start: 17520)
        compare2Day(d23, letter: "MD", start: 17885)
        compare2Day(d23, letter: "ME", start: 18250)
        compare2Day(d23, letter: "MF", start: 18615)
        compare2Day(d23, letter: "MG", start: 18980)
        compare2Day(d23, letter: "MH", start: 19345)
        compare2Day(d23, letter: "MI", start: 19710)
        compare2Day(d23, letter: "MJ", start: 20075)
        compare2Day(d23, letter: "MK", start: 20440)
        compare2Day(d23, letter: "ML", start: 20805)
        compare2Day(d23, letter: "MM", start: 21170)
        compare2Day(d23, letter: "MN", start: 21535)
        compare2Day(d23, letter: "MO", start: 21900)
        compare2Day(d23, letter: "MP", start: 22265)
        compare2Day(d23, letter: "MQ", start: 22630)
        compare2Day(d23, letter: "MR", start: 22995)
        compare2Day(d23, letter: "MS", start: 23360)
        compare2Day(d23, letter: "MT", start: 23725)
        compare2Day(d23, letter: "MU", start: 24090)

        compare2Day(d23, letter: "MW", start: 24455)
        compare2Day(d23, letter: "MX", start: 24820)
        compare2Day(d23, letter: "MY", start: 25185)
        // compare2Day(d23, letter: "MZ", start: 25550)
        compare2Day(d23, letter: "NA", start: 25915)
        compare2Day(d23, letter: "NB", start: 26280)
        compare2Day(d23, letter: "NC", start: 26645)
        compare2Day(d23, letter: "ND", start: 27010)
        compare2Day(d23, letter: "NE", start: 27375)
        // compare2Day(d23, letter: "NF", start: 27740)
        compare2Day(d23, letter: "NG", start: 28105)
        compare2Day(d23, letter: "NH", start: 28470)
        // compare2Day(d23, letter: "NI", start: 28835)
        compare2Day(d23, letter: "NJ", start: 29200)
        compare2Day(d23, letter: "NK", start: 29565)
        compare2Day(d23, letter: "NL", start: 29930)
        compare2Day(d23, letter: "NM", start: 30295)
        compare2Day(d23, letter: "NN", start: 30660)
        compare2Day(d23, letter: "NO", start: 31025)
        compare2Day(d23, letter: "NP", start: 31390)
        compare2Day(d23, letter: "NQ", start: 31755)
        compare2Day(d23, letter: "NR", start: 32120)
        compare2Day(d23, letter: "NS", start: 32485)
        // compare2Day(d23, letter: "NT", start: 32850)
        compare2Day(d23, letter: "NU", start: 33215)
        compare2Day(d23, letter: "NV", start: 33580)
        compare2Day(d23, letter: "NW", start: 33945)
        compare2Day(d23, letter: "NX", start: 34310)
        compare2Day(d23, letter: "NY", start: 34675)
        compare2Day(d23, letter: "NZ", start: 35040)

        compare2Day(d23, letter: "OB", start: 35405)
        compare2Day(d23, letter: "OC", start: 35770)
        compare2Day(d23, letter: "OD", start: 36135)
        // compare2Day(d23, letter: "OE", start: 36500)
        compare2Day(d23, letter: "OF", start: 36865)
        compare2Day(d23, letter: "OG", start: 37230)
        compare2Day(d23, letter: "OH", start: 37595)
        compare2Day(d23, letter: "OI", start: 37960)
        compare2Day(d23, letter: "OJ", start: 38325)
        // compare2Day(d23, letter: "OK", start: 38690)
        compare2Day(d23, letter: "OL", start: 39055)
        compare2Day(d23, letter: "OM", start: 39420)
        // compare2Day(d23, letter: "ON", start: 39785)
        compare2Day(d23, letter: "OO", start: 40150)
        compare2Day(d23, letter: "OP", start: 40515)
        compare2Day(d23, letter: "OQ", start: 40880)
        compare2Day(d23, letter: "OR", start: 41245)
        // compare2Day(d23, letter: "OS", start: 41610)

        compare2Day(d23, letter: "OT", start: 47815)


        compare2Day(d23, letter: "OU", start: 42340)
        compare2Day(d23, letter: "OV", start: 42705)
        compare2Day(d23, letter: "OW", start: 43070)
        compare2Day(d23, letter: "OX", start: 43435)
        // compare2Day(d23, letter: "OY", start: 43800)
        compare2Day(d23, letter: "OZ", start: 44165)
        compare2Day(d23, letter: "PA", start: 44530)
        compare2Day(d23, letter: "PB", start: 44895)
        compare2Day(d23, letter: "PC", start: 45260)
        compare2Day(d23, letter: "PD", start: 45625)  // compare2Day(d23, letter: "PE", start: 45990)
      }

      if j == 2 {
        compare2Day(d23, letter: "PG", start: 0)
        compare2Day(d23, letter: "PH", start: 365)
        compare2Day(d23, letter: "PI", start: 730)
        compare2Day(d23, letter: "PJ", start: 1095)
        compare2Day(d23, letter: "PK", start: 1460)
        compare2Day(d23, letter: "PL", start: 1825)
        compare2Day(d23, letter: "PM", start: 2190)
        compare2Day(d23, letter: "PN", start: 2555)
        compare2Day(d23, letter: "PO", start: 2920)
        compare2Day(d23, letter: "PP", start: 3285)
        compare2Day(d23, letter: "PQ", start: 3650)
        compare2Day(d23, letter: "PR", start: 4015)
        compare2Day(d23, letter: "PS", start: 4380)
        compare2Day(d23, letter: "PT", start: 4745)
        compare2Day(d23, letter: "PU", start: 5110)
        compare2Day(d23, letter: "PV", start: 5475)
        compare2Day(d23, letter: "PW", start: 5840)
        compare2Day(d23, letter: "PX", start: 6205)
        compare2Day(d23, letter: "PY", start: 6570)
        compare2Day(d23, letter: "PZ", start: 6935)
        compare2Day(d23, letter: "QA", start: 7300)
        compare2Day(d23, letter: "QB", start: 7665)
        compare2Day(d23, letter: "QC", start: 8030)
        compare2Day(d23, letter: "QD", start: 8395)
        compare2Day(d23, letter: "QE", start: 8760)
        compare2Day(d23, letter: "QF", start: 9125)
        compare2Day(d23, letter: "QG", start: 9490)

        compare2Day(d23, letter: "QI", start: 9855)
        compare2Day(d23, letter: "QJ", start: 10220)
        compare2Day(d23, letter: "QK", start: 10585)
        compare2Day(d23, letter: "QL", start: 10950)
        compare2Day(d23, letter: "QM", start: 11315)
        compare2Day(d23, letter: "QN", start: 11680)
        compare2Day(d23, letter: "QO", start: 12045)
        compare2Day(d23, letter: "QP", start: 12410)
        compare2Day(d23, letter: "QQ", start: 12775)
        compare2Day(d23, letter: "QR", start: 13140)
        compare2Day(d23, letter: "QS", start: 13505)
        compare2Day(d23, letter: "QT", start: 13870)
        compare2Day(d23, letter: "QU", start: 14235)
        compare2Day(d23, letter: "QV", start: 14600)
        compare2Day(d23, letter: "QW", start: 14965)
        compare2Day(d23, letter: "QX", start: 15330)
        compare2Day(d23, letter: "QY", start: 15695)
        compare2Day(d23, letter: "QZ", start: 16060)
        compare2Day(d23, letter: "RA", start: 16425)
        compare2Day(d23, letter: "RB", start: 16790)

        compare2Day(d23, letter: "RD", start: 17155)
        compare2Day(d23, letter: "RE", start: 17520)
        compare2Day(d23, letter: "RF", start: 17885)
        compare2Day(d23, letter: "RG", start: 18250)
        compare2Day(d23, letter: "RH", start: 18615)
        compare2Day(d23, letter: "RI", start: 18980)
        compare2Day(d23, letter: "RJ", start: 19345)
        compare2Day(d23, letter: "RK", start: 19710)
        compare2Day(d23, letter: "RL", start: 20075)
        compare2Day(d23, letter: "RM", start: 20440)
        compare2Day(d23, letter: "RN", start: 20805)
        compare2Day(d23, letter: "RO", start: 21170)
        compare2Day(d23, letter: "RP", start: 21535)
        compare2Day(d23, letter: "RQ", start: 21900)
        compare2Day(d23, letter: "RR", start: 22265)
        compare2Day(d23, letter: "RS", start: 22630)
        compare2Day(d23, letter: "RT", start: 22995)
        compare2Day(d23, letter: "RU", start: 23360)
        compare2Day(d23, letter: "RV", start: 23725)
        compare2Day(d23, letter: "RW", start: 24090)

        compare2Day(d23, letter: "RY", start: 24455)
        compare2Day(d23, letter: "RZ", start: 24820)
        compare2Day(d23, letter: "SA", start: 25185)
        // compare2Day(d23, letter: "SB", start: 25550)
        compare2Day(d23, letter: "SC", start: 25915)
        compare2Day(d23, letter: "SD", start: 26280)
        compare2Day(d23, letter: "SE", start: 26645)
        compare2Day(d23, letter: "SF", start: 27010)
        compare2Day(d23, letter: "SG", start: 27375)
        // compare2Day(d23, letter: "SH", start: 27740)
        compare2Day(d23, letter: "SI", start: 28105)
        compare2Day(d23, letter: "SJ", start: 28470)
        // compare2Day(d23, letter: "SK", start: 28835)
        compare2Day(d23, letter: "SL", start: 29200)
        compare2Day(d23, letter: "SM", start: 29565)
        compare2Day(d23, letter: "SN", start: 29930)
        compare2Day(d23, letter: "SO", start: 30295)
        compare2Day(d23, letter: "SP", start: 30660)
        compare2Day(d23, letter: "SQ", start: 31025)
        compare2Day(d23, letter: "SR", start: 31390)
        compare2Day(d23, letter: "SS", start: 31755)
        compare2Day(d23, letter: "ST", start: 32120)
        compare2Day(d23, letter: "SU", start: 32485)
        compare2Day(d23, letter: "SV", start: 32850)
        compare2Day(d23, letter: "SW", start: 33215)
        compare2Day(d23, letter: "SX", start: 33580)
        compare2Day(d23, letter: "SY", start: 33945)
        compare2Day(d23, letter: "SZ", start: 34310)
        compare2Day(d23, letter: "TA", start: 34675)
        compare2Day(d23, letter: "TB", start: 35040)

        compare2Day(d23, letter: "TD", start: 35405)
        compare2Day(d23, letter: "TE", start: 35770)
        compare2Day(d23, letter: "TF", start: 36135)
        // compare2Day(d23, letter: "TG", start: 36500)
        compare2Day(d23, letter: "TH", start: 36865)
        compare2Day(d23, letter: "TI", start: 37230)
        compare2Day(d23, letter: "TJ", start: 37595)
        compare2Day(d23, letter: "TK", start: 37960)
        compare2Day(d23, letter: "TL", start: 38325)
        // compare2Day(d23, letter: "TM", start: 38690)
        compare2Day(d23, letter: "TN", start: 39055)
        compare2Day(d23, letter: "TO", start: 39420)
        // compare2Day(d23, letter: "TP", start: 39785)
        compare2Day(d23, letter: "TQ", start: 40150)
        compare2Day(d23, letter: "TR", start: 40515)
        compare2Day(d23, letter: "TS", start: 40880)
        compare2Day(d23, letter: "TT", start: 41245)
        // compare2Day(d23, letter: "TU", start: 41610)
        // compare2Day(d23, letter: "TV", start: 41975)
        compare2Day(d23, letter: "TV", start: 47815)

        compare2Day(d23, letter: "TW", start: 42340)
        compare2Day(d23, letter: "TX", start: 42705)
        compare2Day(d23, letter: "TY", start: 43070)
        compare2Day(d23, letter: "TZ", start: 43435)
        // compare2Day(d23, letter: "UA", start: 43800)
        compare2Day(d23, letter: "UB", start: 44165)
        compare2Day(d23, letter: "UC", start: 44530)
        compare2Day(d23, letter: "UD", start: 44895)
        compare2Day(d23, letter: "UE", start: 45260)
        compare2Day(d23, letter: "UF", start: 45625)  // compare2Day(d23, letter:"UG", start:45990)
      }  // Array(d27[..<9855]).head(121, steps: 365)
      // print("Daily 2 Case", j)
      // Array(d27[9855..<17155]).head(148, steps: 365)
      // print("Daily 2 Case", j)
      // Array(d27[17155..<24090]).head(168, steps: 365)
      // print("Daily 2 Case", j)
      // Array(d27[24090..<31755]).head(188, steps: 365)
      // print("Daily 2 Case", j)
      // Array(d27[31755..<38690]).head(206, steps: 365)
      // print("Daily 2 Case", j)
      // Array(d27[38690...]).head(242, steps: 365)
    }
    print("Calc", calc.joined(separator: " "))
    print("Daily1", day1.joined(separator: " "))
    // print("Daily2", day2.joined(separator: " "))
  }

  func testsCalculation2() {
    guard
      let model = TunOl([93.45593212,0.0000,0.0000,943.1577,1380.0000,600.0000,75.7355,0.00,43.13,3.6215,46.61,279.4058,30.6744,109.5815,1021.4523,0.00,0.0000,])

    else {
      print("Invalid config")
      return
    }

    let costs = Costs(model)

    let hour0 = model.hour0(
      TunOl.Q_Sol_MW_thLoop, TunOl.Reference_PV_plant_power_at_inverter_inlet_DC,
      TunOl.Reference_PV_MV_power_at_transformer_outlet)

    let hour1 = model.hour1(hour0: hour0)
    let day0 = model.day0(hour0: hour0)
    let d22 = model.d22(hour0: hour0)
    var day = [[Double]]()

    var hour2 = [Double](repeating: .zero, count: 183_960)
    var hour3 = [Double](repeating: .zero, count: 297_840)
    var hour4 = [Double](repeating: .zero, count: 516_840)
    var d10 = [Double](repeating: .zero, count: 13_140)
    var d11 = [Double](repeating: .zero, count: 17_155)
    var d12 = [Double](repeating: .zero, count: 17_155)
    var d13 = [Double](repeating: .zero, count: 47_085) 
    var d23 = [Double](repeating: .zero, count: 48_545)
    var d21 = [Double](repeating: .zero, count: 9_855)
    
    for j in 0..<4 {
      model.hour2(&hour2, j: j, hour0: hour0, hour1: hour1)
      model.hour3(&hour3, j: j, hour0: hour0, hour1: hour1, hour2: hour2)
      model.d10(&d10, case: j, hour2: hour2, hour3: hour3)
      model.hour4(&hour4, j: j, d1: d10, hour0: hour0, hour1: hour1, hour2: hour2, hour3: hour3)
      model.night(case: j, d10: &d10, hour3: hour3, hour4: hour4)
      model.d11(case: j, &d11, hour0: hour0, hour2: hour2, hour3: hour3)
      model.d12(case: j, &d12, hour0: hour0, hour4: hour4)
      model.d13(&d13, case: j, d10: d10, d11: d11, d12: d12)
      model.d14(&d13, case: j, d10: d10, d11: d11, d12: d12)
      day.append(Array(d13[31755..<32850]))
      day.append(Array(d13[44165..<45625]))

      model.d21(&d21, case: j, day0: day0)
      model.d23(&d23, case: j, day0: day0, d21: d21, d22: d22)

      day.append(Array(d23[33945..<35040]))
      day.append(Array(d23[44895..<45990]))
    }

    var meth_produced_MTPH_sum = Double.zero
    var elec_from_grid_sum = Double.zero
    var elec_to_grid_MTPH_sum = Double.zero

    let _ = [
      "1a day prio", "1a night prio", "2a day prio", "2a night prio", "1b day prio", "1b night prio", "2b day prio",
      "2b night prio", "1c day prio", "1c night prio", "2c day prio", "2c night prio", "1d day prio", "1d night prio",
      "2d day prio", "2d night prio",
    ]

    for d in 0..<365 {
      if d == 333 { print() }
      let cases = day.indices.map { i in
        costs.LCOM(
          meth_produced_MTPH: day[i][d] * 365.0, elec_from_grid: day[i][d + 365 + 365] * 365.0,
          elec_to_grid: day[i][d + 365] * 365.0)
      }
      let ranked = cases.indices.filter { cases[$0].isFinite }.filter { cases[$0] > 0 }
        .sorted { cases[$0] < cases[$1] }
      if let best = ranked.first {
        meth_produced_MTPH_sum += day[best][d]
        elec_from_grid_sum += day[best][d + 365 + 365]
        elec_to_grid_MTPH_sum += day[best][d + 365]
      }
    }

    let LCOM = costs.LCOM(
      meth_produced_MTPH: meth_produced_MTPH_sum, elec_from_grid: elec_from_grid_sum,
      elec_to_grid: elec_to_grid_MTPH_sum)
    XCTAssertEqual(LCOM, 1193, accuracy: 1, "LCOM")
    XCTAssertEqual(meth_produced_MTPH_sum, 128806, accuracy: 1, "meth_produced_MTPH_sum")
    XCTAssertEqual(elec_from_grid_sum, 0, accuracy: 1, "elec_from_grid_sum")
    XCTAssertEqual(elec_to_grid_MTPH_sum, 0, accuracy: 1, "elec_to_grid_MTPH_sum")
  }

  func testsCosts() {
    let model = TunOl([
      100.00, 10.00, 50.00, 600.00, 1000.00, 600.00, 5.00, 5.00, 80.00, 3.00, 90.00, 5.00, 60.00, 110.00, 200.00, 0.00,
      0.00,
    ])!
    let costs = Costs(model)
    var fixtures = [
      19113593.96, 151300856.2, 465123723.2, 36221243.55, 5753063.152, 2496904, 84_370_000, 504_000_000,
      2966339.549, 43922259.87, 15901.02011, 86731590.14, 32406.66362, 131_815_026, 69130701.25, 10070885.31,
      0,
    ]
    .makeIterator()
    for child in Mirror(reflecting: costs).children.filter({ $0.label?.contains("cost") ?? false }) {
      XCTAssertEqual(child.value as! Double, fixtures.next()!, accuracy: 1, child.label!)
    }
  }
}
