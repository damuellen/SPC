import Utilities
import XCTest
import xlsxwriter

@testable import SunOl

class SunOlTests: XCTestCase {
  func testsCalculation() {
    let path = "/workspaces/SPC/input2.txt"
    guard let csv = CSV(atPath: path) else {
      print("No input.")
      return
    }
    TunOl.Q_Sol_MW_thLoop = [0] + csv["csp"]
    TunOl.Reference_PV_plant_power_at_inverter_inlet_DC = [0] + csv["pv"]
    TunOl.Reference_PV_MV_power_at_transformer_outlet = [0] + csv["out"]
    let model = TunOl([])
    let hour0 = model.hour0(TunOl.Q_Sol_MW_thLoop, TunOl.Reference_PV_plant_power_at_inverter_inlet_DC, TunOl.Reference_PV_MV_power_at_transformer_outlet)
    print("Calculation")
    Array(hour0[..<61320]).head(6, steps: 8760)
    print("Calculation")
    Array(hour0[61320..<113880]).head(14, steps: 8760)
    print("Calculation")

    let hour1 = model.hour1(hour0: hour0)
    print("Calculation")
    hour1.head(47, steps: 8760)

    let day6 = model.day(hour0: hour0)
    print("Daily 2")
    Array(day6[0..<5840]).head(121, steps: 365)
    print("Daily 2")
    Array(day6[5840...]).head(137, steps: 365)

    var day = [[Double]]()

    var hour2 = [Double](repeating: Double.zero, count: 166440+8760)
    var hour3 = [Double](repeating: Double.zero, count: 271_560)
    var hour4 = [Double](repeating: Double.zero, count: 490560+8760)
    var day1 = [Double](repeating: Double.zero, count: 13_140)
    var day15 = [Double](repeating: Double.zero, count: 17_155)
    var day16 = [Double](repeating: Double.zero, count: 17_155)
    var day17 = [Double](repeating: Double.zero, count: 46_720)
    var day27 = [Double](repeating: Double.zero, count: 45990+365)
    var day21 = [Double](repeating: Double.zero, count: 9_855)

    for j in 0..<4 {

      model.hour2(&hour2, j: j, hour0: hour0, hour1: hour1)
      if j == 0 { print("Hour Case", j); hour2.head(72, steps: 8760) }
      if j == 1 { print("Hour Case", j); hour2.head(184, steps: 8760) }
      if j == 2 { print("Hour Case", j); hour2.head(296, steps: 8760) }

      model.hour3(&hour3, j: j, hour0: hour0, hour1: hour1, hour2: hour2)
            print("Hour Case", j)
        hour3.head(93, steps: 8760)

      model.day1(&day1, case: j, hour2: hour2, hour3: hour3)

      model.hour4(&hour4, j: j, day1: day1, hour0: hour0, hour1: hour1, hour2: hour2)
      print("Hour Case", j)
      Array(hour4[0..<227760]).head(125, steps: 8760)
      Array(hour4[227760...]).head(152, steps: 8760)

      model.night(case: j, day1: &day1, hour3: hour3, hour4: hour4)
      print("Daily Case", j)
      Array(day1[0..<5840]).head(2, steps: 365)
      print("Daily Case", j)
      Array(day1[5840...]).head(19, steps: 365)

      model.day15(&day15, hour0: hour0, hour2: hour2, hour3: hour3, day11: day1)
      if j == 0 {
        print("Daily Case", j)
        Array(day15[0..<9125]).head(154, steps: 365)
        print("Daily Case", j)
        Array(day15[9125...]).head(179, steps: 365)
      }
      if j == 1 {
        print("Daily Case", j)
        Array(day15[0..<9125]).head(376, steps: 365)
        print("Daily Case", j)
        Array(day15[9125...]).head(401, steps: 365)
      }

      model.day16(&day16, hour0: hour0, hour4: hour4, day11: day1, day15: day15)
      print("Daily 1 Case", j)
      Array(day16[..<9125]).head(202, steps: 365)
      print("Daily 1 Case", j)
      Array(day16[9125...]).head(227, steps: 365)

      model.day17(&day17, case: j, day1: day1, day5: day15, day6: day16)
      if j == 0 {
        print("Daily 1 Case", j)
        Array(day17[..<7665]).head(250, steps: 365)
        print("Daily 1 Case", j)
        Array(day17[7665..<13505]).head(272, steps: 365)
        print("Daily 1 Case", j)
        Array(day17[13505..<19345]).head(289, steps: 365)
        print("Daily 1 Case", j)
        Array(day17[19345..<31755]).head(306, steps: 365)
        print("Daily 1 Case", j)
        Array(day17[31755...]).head(341, steps: 365)
      }

      if j == 0 {
      XCTAssertEqual(day17[0], -8.78, accuracy: 0.1, "$IQ$3")
      XCTAssertEqual(day17[365], -599.38, accuracy: 0.1, "$IR$3")
      XCTAssertEqual(day17[730], -1044.41, accuracy: 0.1, "$IS$3")
      XCTAssertEqual(day17[1095], -8.69, accuracy: 0.1, "$IT$3")
      XCTAssertEqual(day17[1460], -593.38, accuracy: 0.1, "$IU$3")
      XCTAssertEqual(day17[1825], -497.36, accuracy: 0.1, "$IV$3")
      XCTAssertEqual(day17[2190], -49.73, accuracy: 0.1, "$IW$3")
      XCTAssertEqual(day17[2555], -187.59, accuracy: 0.1, "$IX$3")
      XCTAssertEqual(day17[2920], -381.65, accuracy: 0.1, "$IY$3")
      XCTAssertEqual(day17[3285], 115.46, accuracy: 0.1, "$IZ$3")
      XCTAssertEqual(day17[3650], 115.46, accuracy: 0.1, "$JA$3")
      XCTAssertEqual(day17[4015], 115.46, accuracy: 0.1, "$JB$3")
      XCTAssertEqual(day17[4380], -8.78, accuracy: 0.1, "$JC$3")
      XCTAssertEqual(day17[4745], -599.38, accuracy: 0.1, "$JD$3")
      XCTAssertEqual(day17[5110], -1044.41, accuracy: 0.1, "$JE$3")
      XCTAssertEqual(day17[5475], 74.96, accuracy: 0.1, "$JF$3")
      XCTAssertEqual(day17[5840], 9.36, accuracy: 0.1, "$JG$3")
      XCTAssertEqual(day17[6205], -35.39, accuracy: 0.1, "$JH$3")
      XCTAssertEqual(day17[6570], -104.69, accuracy: 0.1, "$JI$3")
      XCTAssertEqual(day17[6935], -162.36, accuracy: 0.1, "$JJ$3")
      XCTAssertEqual(day17[7300], -201.70, accuracy: 0.1, "$JK$3")
      XCTAssertEqual(day17[7665], 28.29, accuracy: 0.1, "$JL$3")
      XCTAssertEqual(day17[8030], 20.36, accuracy: 0.1, "$JM$3")
      XCTAssertEqual(day17[8395], 14.95, accuracy: 0.1, "$JN$3")
      XCTAssertEqual(day17[1], 1734.58, accuracy: 0.1, "$IQ$4")
      XCTAssertEqual(day17[366], 1143.98, accuracy: 0.1, "$IR$4")
      XCTAssertEqual(day17[731], 585.50, accuracy: 0.1, "$IS$4")
      XCTAssertEqual(day17[1096], 1717.23, accuracy: 0.1, "$IT$4")
      XCTAssertEqual(day17[1461], 1132.54, accuracy: 0.1, "$IU$4")
      XCTAssertEqual(day17[1826], 579.64, accuracy: 0.1, "$IV$4")
      XCTAssertEqual(day17[2191], 449.66, accuracy: 0.1, "$IW$4")
      XCTAssertEqual(day17[2556], 311.80, accuracy: 0.1, "$IX$4")
      XCTAssertEqual(day17[2921], 102.84, accuracy: 0.1, "$IY$4")
      XCTAssertEqual(day17[3286], 115.46, accuracy: 0.1, "$IZ$4")
      XCTAssertEqual(day17[3651], 115.46, accuracy: 0.1, "$JA$4")
      XCTAssertEqual(day17[4016], 115.46, accuracy: 0.1, "$JB$4")
      XCTAssertEqual(day17[4381], 450.00, accuracy: 0.1, "$JC$4")
      XCTAssertEqual(day17[4746], 450.00, accuracy: 0.1, "$JD$4")
      XCTAssertEqual(day17[5111], 375.58, accuracy: 0.1, "$JE$4")
      XCTAssertEqual(day17[5476], 74.96, accuracy: 0.1, "$JF$4")
      XCTAssertEqual(day17[5841], 9.36, accuracy: 0.1, "$JG$4")
      XCTAssertEqual(day17[6206], -40.35, accuracy: 0.1, "$JH$4")
      XCTAssertEqual(day17[6571], -104.69, accuracy: 0.1, "$JI$4")
      XCTAssertEqual(day17[6936], -162.36, accuracy: 0.1, "$JJ$4")
      XCTAssertEqual(day17[7301], -206.06, accuracy: 0.1, "$JK$4")
      XCTAssertEqual(day17[7666], 28.29, accuracy: 0.1, "$JL$4")
      XCTAssertEqual(day17[8031], 20.36, accuracy: 0.1, "$JM$4")
      XCTAssertEqual(day17[8396], 14.35, accuracy: 0.1, "$JN$4")
      XCTAssertEqual(day17[2], 1367.02, accuracy: 0.1, "$IQ$5")
      XCTAssertEqual(day17[367], 775.99, accuracy: 0.1, "$IR$5")
      XCTAssertEqual(day17[732], 217.94, accuracy: 0.1, "$IS$5")
      XCTAssertEqual(day17[1097], 1353.35, accuracy: 0.1, "$IT$5")
      XCTAssertEqual(day17[1462], 768.23, accuracy: 0.1, "$IU$5")
      XCTAssertEqual(day17[1827], 215.76, accuracy: 0.1, "$IV$5")
      XCTAssertEqual(day17[2192], 218.62, accuracy: 0.1, "$IW$5")
      XCTAssertEqual(day17[2557], 80.58, accuracy: 0.1, "$IX$5")
      XCTAssertEqual(day17[2922], -128.20, accuracy: 0.1, "$IY$5")
      XCTAssertEqual(day17[3287], 185.71, accuracy: 0.1, "$IZ$5")
      XCTAssertEqual(day17[3652], 185.71, accuracy: 0.1, "$JA$5")
      XCTAssertEqual(day17[4017], 185.71, accuracy: 0.1, "$JB$5")
      XCTAssertEqual(day17[4382], 450.00, accuracy: 0.1, "$JC$5")
      XCTAssertEqual(day17[4747], 450.00, accuracy: 0.1, "$JD$5")
      XCTAssertEqual(day17[5112], 217.94, accuracy: 0.1, "$JE$5")
      XCTAssertEqual(day17[5477], 74.96, accuracy: 0.1, "$JF$5")
      XCTAssertEqual(day17[5842], 9.36, accuracy: 0.1, "$JG$5")
      XCTAssertEqual(day17[6207], -40.35, accuracy: 0.1, "$JH$5")
      XCTAssertEqual(day17[6572], -104.69, accuracy: 0.1, "$JI$5")
      XCTAssertEqual(day17[6937], -162.36, accuracy: 0.1, "$JJ$5")
      XCTAssertEqual(day17[7302], -206.06, accuracy: 0.1, "$JK$5")
      XCTAssertEqual(day17[7667], 28.29, accuracy: 0.1, "$JL$5")
      XCTAssertEqual(day17[8032], 20.36, accuracy: 0.1, "$JM$5")
      XCTAssertEqual(day17[8397], 14.35, accuracy: 0.1, "$JN$5")
      }
      if j == 1 {
      XCTAssertEqual(day17[0], -57.66, accuracy: 0.1, "$RL$3")
      XCTAssertEqual(day17[365], -2216.55, accuracy: 0.1, "$RM$3")
      XCTAssertEqual(day17[730], -1093.29, accuracy: 0.1, "$RN$3")
      XCTAssertEqual(day17[1095], -57.08, accuracy: 0.1, "$RO$3")
      XCTAssertEqual(day17[1460], -1137.62, accuracy: 0.1, "$RP$3")
      XCTAssertEqual(day17[1825], -585.18, accuracy: 0.1, "$RQ$3")
      XCTAssertEqual(day17[2190], -138.43, accuracy: 0.1, "$RR$3")
      XCTAssertEqual(day17[2555], -696.46, accuracy: 0.1, "$RS$3")
      XCTAssertEqual(day17[2920], -470.36, accuracy: 0.1, "$RT$3")
      XCTAssertEqual(day17[3285], 115.46, accuracy: 0.1, "$RU$3")
      XCTAssertEqual(day17[3650], 115.46, accuracy: 0.1, "$RV$3")
      XCTAssertEqual(day17[4015], 115.46, accuracy: 0.1, "$RW$3")
      XCTAssertEqual(day17[4380], -57.66, accuracy: 0.1, "$RX$3")
      XCTAssertEqual(day17[4745], -2216.55, accuracy: 0.1, "$RY$3")
      XCTAssertEqual(day17[5110], -1093.29, accuracy: 0.1, "$RZ$3")
      XCTAssertEqual(day17[5475], 309.36, accuracy: 0.1, "$SA$3")
      XCTAssertEqual(day17[5840], 309.36, accuracy: 0.1, "$SB$3")
      XCTAssertEqual(day17[6205], 199.01, accuracy: 0.1, "$SC$3")
      XCTAssertEqual(day17[6570], -104.69, accuracy: 0.1, "$SD$3")
      XCTAssertEqual(day17[6935], -310.75, accuracy: 0.1, "$SE$3")
      XCTAssertEqual(day17[7300], -201.70, accuracy: 0.1, "$SF$3")
      XCTAssertEqual(day17[7665], 28.29, accuracy: 0.1, "$SG$3")
      XCTAssertEqual(day17[8030], -0.05, accuracy: 0.1, "$SH$3")
      XCTAssertEqual(day17[8395], 14.95, accuracy: 0.1, "$SI$3")
      XCTAssertEqual(day17[1], 1685.70, accuracy: 0.1, "$RL$4")
      XCTAssertEqual(day17[366], -473.20, accuracy: 0.1, "$RM$4")
      XCTAssertEqual(day17[731], 536.62, accuracy: 0.1, "$RN$4")
      XCTAssertEqual(day17[1096], 1668.84, accuracy: 0.1, "$RO$4")
      XCTAssertEqual(day17[1461], -468.46, accuracy: 0.1, "$RP$4")
      XCTAssertEqual(day17[1826], 531.25, accuracy: 0.1, "$RQ$4")
      XCTAssertEqual(day17[2191], 360.96, accuracy: 0.1, "$RR$4")
      XCTAssertEqual(day17[2556], -197.07, accuracy: 0.1, "$RS$4")
      XCTAssertEqual(day17[2921], 14.14, accuracy: 0.1, "$RT$4")
      XCTAssertEqual(day17[3286], 115.46, accuracy: 0.1, "$RU$4")
      XCTAssertEqual(day17[3651], 115.46, accuracy: 0.1, "$RV$4")
      XCTAssertEqual(day17[4016], 115.46, accuracy: 0.1, "$RW$4")
      XCTAssertEqual(day17[4381], 450.00, accuracy: 0.1, "$RX$4")
      XCTAssertEqual(day17[4746], -473.20, accuracy: 0.1, "$RY$4")
      XCTAssertEqual(day17[5111], 375.58, accuracy: 0.1, "$RZ$4")
      XCTAssertEqual(day17[5476], 309.36, accuracy: 0.1, "$SA$4")
      XCTAssertEqual(day17[5841], 309.36, accuracy: 0.1, "$SB$4")
      XCTAssertEqual(day17[6206], 194.05, accuracy: 0.1, "$SC$4")
      XCTAssertEqual(day17[6571], -104.69, accuracy: 0.1, "$SD$4")
      XCTAssertEqual(day17[6936], -310.75, accuracy: 0.1, "$SE$4")
      XCTAssertEqual(day17[7301], -206.06, accuracy: 0.1, "$SF$4")
      XCTAssertEqual(day17[7666], 28.29, accuracy: 0.1, "$SG$4")
      XCTAssertEqual(day17[8031], -0.05, accuracy: 0.1, "$SH$4")
      XCTAssertEqual(day17[8396], 14.35, accuracy: 0.1, "$SI$4")
      XCTAssertEqual(day17[2], 1452.40, accuracy: 0.1, "$RL$5")
      XCTAssertEqual(day17[367], -771.63, accuracy: 0.1, "$RM$5")
      XCTAssertEqual(day17[732], 303.32, accuracy: 0.1, "$RN$5")
      XCTAssertEqual(day17[1097], 1437.88, accuracy: 0.1, "$RO$5")
      XCTAssertEqual(day17[1462], -763.91, accuracy: 0.1, "$RP$5")
      XCTAssertEqual(day17[1827], 300.29, accuracy: 0.1, "$RQ$5")
      XCTAssertEqual(day17[2192], 186.35, accuracy: 0.1, "$RR$5")
      XCTAssertEqual(day17[2557], -399.05, accuracy: 0.1, "$RS$5")
      XCTAssertEqual(day17[2922], -160.47, accuracy: 0.1, "$RT$5")
      XCTAssertEqual(day17[3287], 185.71, accuracy: 0.1, "$RU$5")
      XCTAssertEqual(day17[3652], 185.71, accuracy: 0.1, "$RV$5")
      XCTAssertEqual(day17[4017], 185.71, accuracy: 0.1, "$RW$5")
      XCTAssertEqual(day17[4382], 450.00, accuracy: 0.1, "$RX$5")
      XCTAssertEqual(day17[4747], -771.63, accuracy: 0.1, "$RY$5")
      XCTAssertEqual(day17[5112], 303.32, accuracy: 0.1, "$RZ$5")
      XCTAssertEqual(day17[5477], 309.36, accuracy: 0.1, "$SA$5")
      XCTAssertEqual(day17[5842], 309.36, accuracy: 0.1, "$SB$5")
      XCTAssertEqual(day17[6207], 194.05, accuracy: 0.1, "$SC$5")
      XCTAssertEqual(day17[6572], -104.69, accuracy: 0.1, "$SD$5")
      XCTAssertEqual(day17[6937], -310.75, accuracy: 0.1, "$SE$5")
      XCTAssertEqual(day17[7302], -206.06, accuracy: 0.1, "$SF$5")
      XCTAssertEqual(day17[7667], 28.29, accuracy: 0.1, "$SG$5")
      XCTAssertEqual(day17[8032], -0.05, accuracy: 0.1, "$SH$5")
      XCTAssertEqual(day17[8397], 14.35, accuracy: 0.1, "$SI$5")
      }
      if j == 2 {
      XCTAssertEqual(day17[0], 189.77, accuracy: 0.1, "$AAG$3")
      XCTAssertEqual(day17[365], -1394.25, accuracy: 0.1, "$AAH$3")
      XCTAssertEqual(day17[730], -845.86, accuracy: 0.1, "$AAI$3")
      XCTAssertEqual(day17[1095], 187.87, accuracy: 0.1, "$AAJ$3")
      XCTAssertEqual(day17[1460], -652.89, accuracy: 0.1, "$AAK$3")
      XCTAssertEqual(day17[1825], -368.89, accuracy: 0.1, "$AAL$3")
      XCTAssertEqual(day17[2190], 80.04, accuracy: 0.1, "$AAM$3")
      XCTAssertEqual(day17[2555], -206.83, accuracy: 0.1, "$AAN$3")
      XCTAssertEqual(day17[2920], -251.89, accuracy: 0.1, "$AAO$3")
      XCTAssertEqual(day17[3285], 115.46, accuracy: 0.1, "$AAP$3")
      XCTAssertEqual(day17[3650], 115.46, accuracy: 0.1, "$AAQ$3")
      XCTAssertEqual(day17[4015], 115.46, accuracy: 0.1, "$AAR$3")
      XCTAssertEqual(day17[4380], 189.77, accuracy: 0.1, "$AAS$3")
      XCTAssertEqual(day17[4745], -1394.25, accuracy: 0.1, "$AAT$3")
      XCTAssertEqual(day17[5110], -845.86, accuracy: 0.1, "$AAU$3")
      XCTAssertEqual(day17[5475], 309.36, accuracy: 0.1, "$AAV$3")
      XCTAssertEqual(day17[5840], 309.36, accuracy: 0.1, "$AAW$3")
      XCTAssertEqual(day17[6205], 199.01, accuracy: 0.1, "$AAX$3")
      XCTAssertEqual(day17[6570], 101.37, accuracy: 0.1, "$AAY$3")
      XCTAssertEqual(day17[6935], 101.37, accuracy: 0.1, "$AAZ$3")
      XCTAssertEqual(day17[7300], 4.35, accuracy: 0.1, "$ABA$3")
      XCTAssertEqual(day17[7665], 28.29, accuracy: 0.1, "$ABB$3")
      XCTAssertEqual(day17[8030], 5.05, accuracy: 0.1, "$ABC$3")
      XCTAssertEqual(day17[8395], 14.95, accuracy: 0.1, "$ABD$3")
      XCTAssertEqual(day17[8760], 0.63, accuracy: 0.1, "$ABF$3")
      XCTAssertEqual(day17[9490], -1584.02, accuracy: 0.1, "$ABH$3")
      XCTAssertEqual(day17[10220], -652.89, accuracy: 0.1, "$ABJ$3")
      XCTAssertEqual(day17[10585], 19.21, accuracy: 0.1, "$ABK$3")
      XCTAssertEqual(day17[10950], -267.65, accuracy: 0.1, "$ABL$3")
      XCTAssertEqual(day17[11315], 115.46, accuracy: 0.1, "$ABM$3")
      XCTAssertEqual(day17[11680], 115.46, accuracy: 0.1, "$ABN$3")
      XCTAssertEqual(day17[12410], -1584.02, accuracy: 0.1, "$ABP$3")
      XCTAssertEqual(day17[12775], 289.14, accuracy: 0.1, "$ABQ$3")
      XCTAssertEqual(day17[13140], 289.14, accuracy: 0.1, "$ABR$3")
      XCTAssertEqual(day17[13505], 83.59, accuracy: 0.1, "$ABS$3")
      XCTAssertEqual(day17[13870], 83.59, accuracy: 0.1, "$ABT$3")
      XCTAssertEqual(day17[14235], 25.85, accuracy: 0.1, "$ABU$3")
      XCTAssertEqual(day17[14600], 2.61, accuracy: 0.1, "$ABV$3")
      XCTAssertEqual(day17[14965], 0.55, accuracy: 0.1, "$ABW$3")
      XCTAssertEqual(day17[15330], 0.60, accuracy: 0.1, "$ABY$3")
      XCTAssertEqual(day17[16060], -1035.63, accuracy: 0.1, "$ACA$3")
      XCTAssertEqual(day17[16790], -402.91, accuracy: 0.1, "$ACC$3")
      XCTAssertEqual(day17[17155], 45.67, accuracy: 0.1, "$ACD$3")
      XCTAssertEqual(day17[17520], -286.26, accuracy: 0.1, "$ACE$3")
      XCTAssertEqual(day17[17885], 115.46, accuracy: 0.1, "$ACF$3")
      XCTAssertEqual(day17[18250], 115.46, accuracy: 0.1, "$ACG$3")
      XCTAssertEqual(day17[18980], -1035.63, accuracy: 0.1, "$ACI$3")
      XCTAssertEqual(day17[19345], 309.36, accuracy: 0.1, "$ACJ$3")
      XCTAssertEqual(day17[19710], 199.01, accuracy: 0.1, "$ACK$3")
      XCTAssertEqual(day17[20075], 101.37, accuracy: 0.1, "$ACL$3")
      XCTAssertEqual(day17[20440], 4.35, accuracy: 0.1, "$ACM$3")
      XCTAssertEqual(day17[20805], 25.51, accuracy: 0.1, "$ACN$3")
      XCTAssertEqual(day17[21170], 12.16, accuracy: 0.1, "$ACO$3")
      XCTAssertEqual(day17[21535], 0.55, accuracy: 0.1, "$ACP$3")
      XCTAssertEqual(day17[21900], 1189.37, accuracy: 0.1, "$ACR$3")
      XCTAssertEqual(day17[22265], 1604.64, accuracy: 0.1, "$ACS$3")
      XCTAssertEqual(day17[22630], 20.53, accuracy: 0.1, "$ACT$3")
      XCTAssertEqual(day17[22995], 70.26, accuracy: 0.1, "$ACU$3")
      XCTAssertEqual(day17[23360], 508.17, accuracy: 0.1, "$ACV$3")
      XCTAssertEqual(day17[23725], 372.62, accuracy: 0.1, "$ACW$3")
      XCTAssertEqual(day17[24090], 3303.83, accuracy: 0.1, "$ACX$3")
      XCTAssertEqual(day17[24455], 47.53, accuracy: 0.1, "$ACY$3")
      XCTAssertEqual(day17[24820], 414.21, accuracy: 0.1, "$ACZ$3")
      XCTAssertEqual(day17[25550], 503.09, accuracy: 0.1, "$ADB$3")
      XCTAssertEqual(day17[25915], 368.89, accuracy: 0.1, "$ADC$3")
      XCTAssertEqual(day17[26280], 503.09, accuracy: 0.1, "$ADD$3")
      XCTAssertEqual(day17[26645], 368.89, accuracy: 0.1, "$ADE$3")
      XCTAssertEqual(day17[28105], 49.18, accuracy: 0.1, "$ADI$3")
      XCTAssertEqual(day17[28835], 49.18, accuracy: 0.1, "$ADK$3")
      XCTAssertEqual(day17[31755], 103.52, accuracy: 0.1, "$ADS$3")
      XCTAssertEqual(day17[32485], 414.21, accuracy: 0.1, "$ADU$3")
      XCTAssertEqual(day17[32850], 15.00, accuracy: 0.1, "$ADV$3")
      XCTAssertEqual(day17[33215], 9.00, accuracy: 0.1, "$ADW$3")
      XCTAssertEqual(day17[34310], 1048.67, accuracy: 0.1, "$AEA$3")
      XCTAssertEqual(day17[34675], 1760.04, accuracy: 0.1, "$AEB$3")
      XCTAssertEqual(day17[35040], 20.53, accuracy: 0.1, "$AEC$3")
      XCTAssertEqual(day17[35405], 70.26, accuracy: 0.1, "$AED$3")
      XCTAssertEqual(day17[35770], 447.35, accuracy: 0.1, "$AEE$3")
      XCTAssertEqual(day17[36135], 406.98, accuracy: 0.1, "$AEF$3")
      XCTAssertEqual(day17[36500], 3303.83, accuracy: 0.1, "$AEG$3")
      XCTAssertEqual(day17[36865], 21.38, accuracy: 0.1, "$AEH$3")
      XCTAssertEqual(day17[37230], 428.62, accuracy: 0.1, "$AEI$3")
      XCTAssertEqual(day17[37960], 442.87, accuracy: 0.1, "$AEK$3")
      XCTAssertEqual(day17[38325], 402.91, accuracy: 0.1, "$AEL$3")
      XCTAssertEqual(day17[38690], 442.87, accuracy: 0.1, "$AEM$3")
      XCTAssertEqual(day17[39055], 402.91, accuracy: 0.1, "$AEN$3")
      XCTAssertEqual(day17[40515], 49.18, accuracy: 0.1, "$AER$3")
      XCTAssertEqual(day17[41245], 49.18, accuracy: 0.1, "$AET$3")
      XCTAssertEqual(day17[44165], 90.00, accuracy: 0.1, "$AFB$3")
      XCTAssertEqual(day17[44895], 428.62, accuracy: 0.1, "$AFD$3")
      XCTAssertEqual(day17[45260], 15.00, accuracy: 0.1, "$AFE$3")
      XCTAssertEqual(day17[45625], 9.00, accuracy: 0.1, "$AFF$3")
      XCTAssertEqual(day17[1], 1933.13, accuracy: 0.1, "$AAG$4")
      XCTAssertEqual(day17[366], 349.11, accuracy: 0.1, "$AAH$4")
      XCTAssertEqual(day17[731], 784.05, accuracy: 0.1, "$AAI$4")
      XCTAssertEqual(day17[1096], 1913.80, accuracy: 0.1, "$AAJ$4")
      XCTAssertEqual(day17[1461], 345.62, accuracy: 0.1, "$AAK$4")
      XCTAssertEqual(day17[1826], 776.21, accuracy: 0.1, "$AAL$4")
      XCTAssertEqual(day17[2191], 579.43, accuracy: 0.1, "$AAM$4")
      XCTAssertEqual(day17[2556], 292.56, accuracy: 0.1, "$AAN$4")
      XCTAssertEqual(day17[2921], 232.61, accuracy: 0.1, "$AAO$4")
      XCTAssertEqual(day17[3286], 115.46, accuracy: 0.1, "$AAP$4")
      XCTAssertEqual(day17[3651], 115.46, accuracy: 0.1, "$AAQ$4")
      XCTAssertEqual(day17[4016], 115.46, accuracy: 0.1, "$AAR$4")
      XCTAssertEqual(day17[4381], 450.00, accuracy: 0.1, "$AAS$4")
      XCTAssertEqual(day17[4746], 349.11, accuracy: 0.1, "$AAT$4")
      XCTAssertEqual(day17[5111], 375.58, accuracy: 0.1, "$AAU$4")
      XCTAssertEqual(day17[5476], 309.36, accuracy: 0.1, "$AAV$4")
      XCTAssertEqual(day17[5841], 309.36, accuracy: 0.1, "$AAW$4")
      XCTAssertEqual(day17[6206], 194.05, accuracy: 0.1, "$AAX$4")
      XCTAssertEqual(day17[6571], 101.37, accuracy: 0.1, "$AAY$4")
      XCTAssertEqual(day17[6936], 101.37, accuracy: 0.1, "$AAZ$4")
      XCTAssertEqual(day17[7666], 28.29, accuracy: 0.1, "$ABB$4")
      XCTAssertEqual(day17[8031], 5.05, accuracy: 0.1, "$ABC$4")
      XCTAssertEqual(day17[8396], 14.35, accuracy: 0.1, "$ABD$4")
      XCTAssertEqual(day17[8761], 1.00, accuracy: 0.1, "$ABF$4")
      XCTAssertEqual(day17[9126], 784.05, accuracy: 0.1, "$ABG$4")
      XCTAssertEqual(day17[9491], -799.97, accuracy: 0.1, "$ABH$4")
      XCTAssertEqual(day17[9856], 776.21, accuracy: 0.1, "$ABI$4")
      XCTAssertEqual(day17[10221], -461.36, accuracy: 0.1, "$ABJ$4")
      XCTAssertEqual(day17[10586], 232.61, accuracy: 0.1, "$ABK$4")
      XCTAssertEqual(day17[10951], -54.25, accuracy: 0.1, "$ABL$4")
      XCTAssertEqual(day17[11316], 115.46, accuracy: 0.1, "$ABM$4")
      XCTAssertEqual(day17[11681], 115.46, accuracy: 0.1, "$ABN$4")
      XCTAssertEqual(day17[12046], 375.58, accuracy: 0.1, "$ABO$4")
      XCTAssertEqual(day17[12411], -799.97, accuracy: 0.1, "$ABP$4")
      XCTAssertEqual(day17[12776], 194.05, accuracy: 0.1, "$ABQ$4")
      XCTAssertEqual(day17[13141], 194.05, accuracy: 0.1, "$ABR$4")
      XCTAssertEqual(day17[14236], 14.35, accuracy: 0.1, "$ABU$4")
      XCTAssertEqual(day17[14601], -8.89, accuracy: 0.1, "$ABV$4")
      XCTAssertEqual(day17[14966], 0.69, accuracy: 0.1, "$ABW$4")
      XCTAssertEqual(day17[15331], 1.00, accuracy: 0.1, "$ABY$4")
      XCTAssertEqual(day17[15696], 349.11, accuracy: 0.1, "$ABZ$4")
      XCTAssertEqual(day17[16061], -799.97, accuracy: 0.1, "$ACA$4")
      XCTAssertEqual(day17[16426], 345.62, accuracy: 0.1, "$ACB$4")
      XCTAssertEqual(day17[16791], -461.36, accuracy: 0.1, "$ACC$4")
      XCTAssertEqual(day17[17156], 292.56, accuracy: 0.1, "$ACD$4")
      XCTAssertEqual(day17[17521], -54.25, accuracy: 0.1, "$ACE$4")
      XCTAssertEqual(day17[17886], 115.46, accuracy: 0.1, "$ACF$4")
      XCTAssertEqual(day17[18251], 115.46, accuracy: 0.1, "$ACG$4")
      XCTAssertEqual(day17[18616], 349.11, accuracy: 0.1, "$ACH$4")
      XCTAssertEqual(day17[18981], -799.97, accuracy: 0.1, "$ACI$4")
      XCTAssertEqual(day17[19346], 309.36, accuracy: 0.1, "$ACJ$4")
      XCTAssertEqual(day17[19711], 194.05, accuracy: 0.1, "$ACK$4")
      XCTAssertEqual(day17[20076], 101.37, accuracy: 0.1, "$ACL$4")
      XCTAssertEqual(day17[20806], 5.05, accuracy: 0.1, "$ACN$4")
      XCTAssertEqual(day17[21171], -8.89, accuracy: 0.1, "$ACO$4")
      XCTAssertEqual(day17[21536], 0.69, accuracy: 0.1, "$ACP$4")
      XCTAssertEqual(day17[21901], 1850.93, accuracy: 0.1, "$ACR$4")
      XCTAssertEqual(day17[22266], 2019.07, accuracy: 0.1, "$ACS$4")
      XCTAssertEqual(day17[22631], 23.67, accuracy: 0.1, "$ACT$4")
      XCTAssertEqual(day17[22996], 70.26, accuracy: 0.1, "$ACU$4")
      XCTAssertEqual(day17[23361], 488.23, accuracy: 0.1, "$ACV$4")
      XCTAssertEqual(day17[23726], 270.81, accuracy: 0.1, "$ACW$4")
      XCTAssertEqual(day17[24091], 4550.94, accuracy: 0.1, "$ACX$4")
      XCTAssertEqual(day17[24456], 74.42, accuracy: 0.1, "$ACY$4")
      XCTAssertEqual(day17[24821], 97.62, accuracy: 0.1, "$ACZ$4")
      XCTAssertEqual(day17[25551], 786.22, accuracy: 0.1, "$ADB$4")
      XCTAssertEqual(day17[25916], 459.63, accuracy: 0.1, "$ADC$4")
      XCTAssertEqual(day17[26281], 483.35, accuracy: 0.1, "$ADD$4")
      XCTAssertEqual(day17[26646], 268.10, accuracy: 0.1, "$ADE$4")
      XCTAssertEqual(day17[27011], 494.40, accuracy: 0.1, "$ADF$4")
      XCTAssertEqual(day17[28106], 49.18, accuracy: 0.1, "$ADI$4")
      XCTAssertEqual(day17[28836], 49.18, accuracy: 0.1, "$ADK$4")
      XCTAssertEqual(day17[31756], 163.79, accuracy: 0.1, "$ADS$4")
      XCTAssertEqual(day17[32486], 97.62, accuracy: 0.1, "$ADU$4")
      XCTAssertEqual(day17[32851], 15.00, accuracy: 0.1, "$ADV$4")
      XCTAssertEqual(day17[33216], 9.00, accuracy: 0.1, "$ADW$4")
      XCTAssertEqual(day17[34311], 1292.41, accuracy: 0.1, "$AEA$4")
      XCTAssertEqual(day17[34676], 2901.79, accuracy: 0.1, "$AEB$4")
      XCTAssertEqual(day17[35041], 23.67, accuracy: 0.1, "$AEC$4")
      XCTAssertEqual(day17[35406], 70.26, accuracy: 0.1, "$AED$4")
      XCTAssertEqual(day17[35771], 327.27, accuracy: 0.1, "$AEE$4")
      XCTAssertEqual(day17[36136], 385.54, accuracy: 0.1, "$AEF$4")
      XCTAssertEqual(day17[36501], 4550.94, accuracy: 0.1, "$AEG$4")
      XCTAssertEqual(day17[36866], 22.61, accuracy: 0.1, "$AEH$4")
      XCTAssertEqual(day17[37231], 427.39, accuracy: 0.1, "$AEI$4")
      XCTAssertEqual(day17[37961], 547.19, accuracy: 0.1, "$AEK$4")
      XCTAssertEqual(day17[38326], 652.89, accuracy: 0.1, "$AEL$4")
      XCTAssertEqual(day17[38691], 323.99, accuracy: 0.1, "$AEM$4")
      XCTAssertEqual(day17[39056], 381.68, accuracy: 0.1, "$AEN$4")
      XCTAssertEqual(day17[39421], 494.40, accuracy: 0.1, "$AEO$4")
      XCTAssertEqual(day17[40516], 49.18, accuracy: 0.1, "$AER$4")
      XCTAssertEqual(day17[41246], 49.18, accuracy: 0.1, "$AET$4")
      XCTAssertEqual(day17[44166], 112.42, accuracy: 0.1, "$AFB$4")
      XCTAssertEqual(day17[44896], 427.39, accuracy: 0.1, "$AFD$4")
      XCTAssertEqual(day17[45261], 15.00, accuracy: 0.1, "$AFE$4")
      XCTAssertEqual(day17[45626], 9.00, accuracy: 0.1, "$AFF$4")
      XCTAssertEqual(day17[2], 1470.69, accuracy: 0.1, "$AAG$5")
      XCTAssertEqual(day17[367], -228.95, accuracy: 0.1, "$AAH$5")
      XCTAssertEqual(day17[732], 321.61, accuracy: 0.1, "$AAI$5")
      XCTAssertEqual(day17[1097], 1455.98, accuracy: 0.1, "$AAJ$5")
      XCTAssertEqual(day17[1462], -226.66, accuracy: 0.1, "$AAK$5")
      XCTAssertEqual(day17[1827], 318.39, accuracy: 0.1, "$AAL$5")
      XCTAssertEqual(day17[2192], 308.50, accuracy: 0.1, "$AAM$5")
      XCTAssertEqual(day17[2557], -26.96, accuracy: 0.1, "$AAN$5")
      XCTAssertEqual(day17[2922], -38.32, accuracy: 0.1, "$AAO$5")
      XCTAssertEqual(day17[3287], 185.71, accuracy: 0.1, "$AAP$5")
      XCTAssertEqual(day17[3652], 185.71, accuracy: 0.1, "$AAQ$5")
      XCTAssertEqual(day17[4017], 185.71, accuracy: 0.1, "$AAR$5")
      XCTAssertEqual(day17[4382], 450.00, accuracy: 0.1, "$AAS$5")
      XCTAssertEqual(day17[4747], -228.95, accuracy: 0.1, "$AAT$5")
      XCTAssertEqual(day17[5112], 321.61, accuracy: 0.1, "$AAU$5")
      XCTAssertEqual(day17[5477], 309.36, accuracy: 0.1, "$AAV$5")
      XCTAssertEqual(day17[5842], 309.36, accuracy: 0.1, "$AAW$5")
      XCTAssertEqual(day17[6207], 194.05, accuracy: 0.1, "$AAX$5")
      XCTAssertEqual(day17[6572], 101.37, accuracy: 0.1, "$AAY$5")
      XCTAssertEqual(day17[6937], 101.37, accuracy: 0.1, "$AAZ$5")
      XCTAssertEqual(day17[7667], 28.29, accuracy: 0.1, "$ABB$5")
      XCTAssertEqual(day17[8032], 5.05, accuracy: 0.1, "$ABC$5")
      XCTAssertEqual(day17[8397], 14.35, accuracy: 0.1, "$ABD$5")
      XCTAssertEqual(day17[8762], 0.95, accuracy: 0.1, "$ABF$5")
      XCTAssertEqual(day17[9127], 448.55, accuracy: 0.1, "$ABG$5")
      XCTAssertEqual(day17[9492], -1251.08, accuracy: 0.1, "$ABH$5")
      XCTAssertEqual(day17[9857], 444.07, accuracy: 0.1, "$ABI$5")
      XCTAssertEqual(day17[10222], -648.53, accuracy: 0.1, "$ABJ$5")
      XCTAssertEqual(day17[10952], -335.46, accuracy: 0.1, "$ABL$5")
      XCTAssertEqual(day17[11317], 185.71, accuracy: 0.1, "$ABM$5")
      XCTAssertEqual(day17[11682], 185.71, accuracy: 0.1, "$ABN$5")
      XCTAssertEqual(day17[12047], 448.55, accuracy: 0.1, "$ABO$5")
      XCTAssertEqual(day17[12412], -1251.08, accuracy: 0.1, "$ABP$5")
      XCTAssertEqual(day17[12777], 206.79, accuracy: 0.1, "$ABQ$5")
      XCTAssertEqual(day17[13142], 206.79, accuracy: 0.1, "$ABR$5")
      XCTAssertEqual(day17[13507], 11.20, accuracy: 0.1, "$ABS$5")
      XCTAssertEqual(day17[13872], 11.20, accuracy: 0.1, "$ABT$5")
      XCTAssertEqual(day17[14237], 15.89, accuracy: 0.1, "$ABU$5")
      XCTAssertEqual(day17[14602], -7.35, accuracy: 0.1, "$ABV$5")
      XCTAssertEqual(day17[14967], 0.55, accuracy: 0.1, "$ABW$5")
      XCTAssertEqual(day17[15332], 0.85, accuracy: 0.1, "$ABY$5")
      XCTAssertEqual(day17[15697], 344.19, accuracy: 0.1, "$ABZ$5")
      XCTAssertEqual(day17[16062], -804.90, accuracy: 0.1, "$ACA$5")
      XCTAssertEqual(day17[16427], 340.74, accuracy: 0.1, "$ACB$5")
      XCTAssertEqual(day17[16792], -548.69, accuracy: 0.1, "$ACC$5")
      XCTAssertEqual(day17[17157], 86.16, accuracy: 0.1, "$ACD$5")
      XCTAssertEqual(day17[17522], -260.66, accuracy: 0.1, "$ACE$5")
      XCTAssertEqual(day17[17887], 185.71, accuracy: 0.1, "$ACF$5")
      XCTAssertEqual(day17[18252], 185.71, accuracy: 0.1, "$ACG$5")
      XCTAssertEqual(day17[18617], 344.19, accuracy: 0.1, "$ACH$5")
      XCTAssertEqual(day17[18982], -804.90, accuracy: 0.1, "$ACI$5")
      XCTAssertEqual(day17[19347], 309.36, accuracy: 0.1, "$ACJ$5")
      XCTAssertEqual(day17[19712], 194.05, accuracy: 0.1, "$ACK$5")
      XCTAssertEqual(day17[20077], 101.37, accuracy: 0.1, "$ACL$5")
      XCTAssertEqual(day17[20807], 12.89, accuracy: 0.1, "$ACN$5")
      XCTAssertEqual(day17[21172], -1.05, accuracy: 0.1, "$ACO$5")
      XCTAssertEqual(day17[21537], 0.66, accuracy: 0.1, "$ACP$5")
      XCTAssertEqual(day17[21902], 1762.30, accuracy: 0.1, "$ACR$5")
      XCTAssertEqual(day17[22267], 1604.64, accuracy: 0.1, "$ACS$5")
      XCTAssertEqual(day17[22632], 44.20, accuracy: 0.1, "$ACT$5")
      XCTAssertEqual(day17[23362], 558.62, accuracy: 0.1, "$ACV$5")
      XCTAssertEqual(day17[23727], 341.38, accuracy: 0.1, "$ACW$5")
      XCTAssertEqual(day17[24092], 4309.69, accuracy: 0.1, "$ACX$5")
      XCTAssertEqual(day17[24822], 1.45, accuracy: 0.1, "$ACZ$5")
      XCTAssertEqual(day17[25552], 748.29, accuracy: 0.1, "$ADB$5")
      XCTAssertEqual(day17[25917], 368.89, accuracy: 0.1, "$ADC$5")
      XCTAssertEqual(day17[26282], 553.03, accuracy: 0.1, "$ADD$5")
      XCTAssertEqual(day17[26647], 337.97, accuracy: 0.1, "$ADE$5")
      XCTAssertEqual(day17[27012], 226.18, accuracy: 0.1, "$ADF$5")
      XCTAssertEqual(day17[27742], 168.15, accuracy: 0.1, "$ADH$5")
      XCTAssertEqual(day17[28107], 33.66, accuracy: 0.1, "$ADI$5")
      XCTAssertEqual(day17[28472], 104.47, accuracy: 0.1, "$ADJ$5")
      XCTAssertEqual(day17[29202], 307.47, accuracy: 0.1, "$ADL$5")
      XCTAssertEqual(day17[29932], 1.19, accuracy: 0.1, "$ADN$5")
      XCTAssertEqual(day17[30297], 394.23, accuracy: 0.1, "$ADO$5")
      XCTAssertEqual(day17[30662], 103.43, accuracy: 0.1, "$ADP$5")
      XCTAssertEqual(day17[31027], 290.81, accuracy: 0.1, "$ADQ$5")
      XCTAssertEqual(day17[31757], 305.64, accuracy: 0.1, "$ADS$5")
      XCTAssertEqual(day17[32122], 1.19, accuracy: 0.1, "$ADT$5")
      XCTAssertEqual(day17[32487], 1.45, accuracy: 0.1, "$ADU$5")
      XCTAssertEqual(day17[32852], 15.00, accuracy: 0.1, "$ADV$5")
      XCTAssertEqual(day17[33217], 9.00, accuracy: 0.1, "$ADW$5")
      XCTAssertEqual(day17[33582], 15.00, accuracy: 0.1, "$ADX$5")
      XCTAssertEqual(day17[34312], 1247.98, accuracy: 0.1, "$AEA$5")
      XCTAssertEqual(day17[34677], 2464.38, accuracy: 0.1, "$AEB$5")
      XCTAssertEqual(day17[35042], 44.94, accuracy: 0.1, "$AEC$5")
      XCTAssertEqual(day17[35772], 379.33, accuracy: 0.1, "$AEE$5")
      XCTAssertEqual(day17[36137], 520.67, accuracy: 0.1, "$AEF$5")
      XCTAssertEqual(day17[36502], 4266.01, accuracy: 0.1, "$AEG$5")
      XCTAssertEqual(day17[37232], 391.29, accuracy: 0.1, "$AEI$5")
      XCTAssertEqual(day17[37962], 528.17, accuracy: 0.1, "$AEK$5")
      XCTAssertEqual(day17[38327], 557.12, accuracy: 0.1, "$AEL$5")
      XCTAssertEqual(day17[38692], 375.54, accuracy: 0.1, "$AEM$5")
      XCTAssertEqual(day17[39057], 515.46, accuracy: 0.1, "$AEN$5")
      XCTAssertEqual(day17[39422], 194.29, accuracy: 0.1, "$AEO$5")
      XCTAssertEqual(day17[40152], 156.89, accuracy: 0.1, "$AEQ$5")
      XCTAssertEqual(day17[40517], 34.39, accuracy: 0.1, "$AER$5")
      XCTAssertEqual(day17[40882], 35.23, accuracy: 0.1, "$AES$5")
      XCTAssertEqual(day17[41612], 307.32, accuracy: 0.1, "$AEU$5")
      XCTAssertEqual(day17[42342], 80.81, accuracy: 0.1, "$AEW$5")
      XCTAssertEqual(day17[42707], 312.95, accuracy: 0.1, "$AEX$5")
      XCTAssertEqual(day17[43072], 34.88, accuracy: 0.1, "$AEY$5")
      XCTAssertEqual(day17[43437], 365.82, accuracy: 0.1, "$AEZ$5")
      XCTAssertEqual(day17[43802], 87.75, accuracy: 0.1, "$AFA$5")
      XCTAssertEqual(day17[44167], 339.84, accuracy: 0.1, "$AFB$5")
      XCTAssertEqual(day17[44532], 80.81, accuracy: 0.1, "$AFC$5")
      XCTAssertEqual(day17[44897], 391.29, accuracy: 0.1, "$AFD$5")
      XCTAssertEqual(day17[45262], 15.00, accuracy: 0.1, "$AFE$5")
      XCTAssertEqual(day17[45627], 9.00, accuracy: 0.1, "$AFF$5")
      XCTAssertEqual(day17[45992], 15.00, accuracy: 0.1, "$AFG$5")
      }
      if j == 3 {
      XCTAssertEqual(day17[0], 2167.02, accuracy: 0.1, "$AJB$3")
      XCTAssertEqual(day17[365], 2167.02, accuracy: 0.1, "$AJC$3")
      XCTAssertEqual(day17[730], 1131.39, accuracy: 0.1, "$AJD$3")
      XCTAssertEqual(day17[1095], 2145.35, accuracy: 0.1, "$AJE$3")
      XCTAssertEqual(day17[1460], 2145.35, accuracy: 0.1, "$AJF$3")
      XCTAssertEqual(day17[1825], 1120.08, accuracy: 0.1, "$AJG$3")
      XCTAssertEqual(day17[2190], 452.65, accuracy: 0.1, "$AJH$3")
      XCTAssertEqual(day17[2555], 452.65, accuracy: 0.1, "$AJI$3")
      XCTAssertEqual(day17[2920], 120.73, accuracy: 0.1, "$AJJ$3")
      XCTAssertEqual(day17[3285], 115.46, accuracy: 0.1, "$AJK$3")
      XCTAssertEqual(day17[3650], 115.46, accuracy: 0.1, "$AJL$3")
      XCTAssertEqual(day17[4015], 115.46, accuracy: 0.1, "$AJM$3")
      XCTAssertEqual(day17[4380], 428.62, accuracy: 0.1, "$AJN$3")
      XCTAssertEqual(day17[4745], 428.62, accuracy: 0.1, "$AJO$3")
      XCTAssertEqual(day17[5110], 350.00, accuracy: 0.1, "$AJP$3")
      XCTAssertEqual(day17[5475], 309.36, accuracy: 0.1, "$AJQ$3")
      XCTAssertEqual(day17[5840], 309.36, accuracy: 0.1, "$AJR$3")
      XCTAssertEqual(day17[6205], 199.01, accuracy: 0.1, "$AJS$3")
      XCTAssertEqual(day17[6570], 101.37, accuracy: 0.1, "$AJT$3")
      XCTAssertEqual(day17[6935], 101.37, accuracy: 0.1, "$AJU$3")
      XCTAssertEqual(day17[7300], 4.35, accuracy: 0.1, "$AJV$3")
      XCTAssertEqual(day17[7665], 56.63, accuracy: 0.1, "$AJW$3")
      XCTAssertEqual(day17[8030], 56.63, accuracy: 0.1, "$AJX$3")
      XCTAssertEqual(day17[8395], 43.29, accuracy: 0.1, "$AJY$3")
      XCTAssertEqual(day17[8760], 1.00, accuracy: 0.1, "$AKA$3")
      XCTAssertEqual(day17[9125], 1131.39, accuracy: 0.1, "$AKB$3")
      XCTAssertEqual(day17[9490], 1131.39, accuracy: 0.1, "$AKC$3")
      XCTAssertEqual(day17[9855], 1120.08, accuracy: 0.1, "$AKD$3")
      XCTAssertEqual(day17[10220], 1120.08, accuracy: 0.1, "$AKE$3")
      XCTAssertEqual(day17[10585], 120.73, accuracy: 0.1, "$AKF$3")
      XCTAssertEqual(day17[10950], 120.73, accuracy: 0.1, "$AKG$3")
      XCTAssertEqual(day17[11315], 115.46, accuracy: 0.1, "$AKH$3")
      XCTAssertEqual(day17[11680], 115.46, accuracy: 0.1, "$AKI$3")
      XCTAssertEqual(day17[12045], 350.00, accuracy: 0.1, "$AKJ$3")
      XCTAssertEqual(day17[12410], 350.00, accuracy: 0.1, "$AKK$3")
      XCTAssertEqual(day17[12775], 199.01, accuracy: 0.1, "$AKL$3")
      XCTAssertEqual(day17[13140], 199.01, accuracy: 0.1, "$AKM$3")
      XCTAssertEqual(day17[13505], 4.35, accuracy: 0.1, "$AKN$3")
      XCTAssertEqual(day17[13870], 4.35, accuracy: 0.1, "$AKO$3")
      XCTAssertEqual(day17[14235], 43.29, accuracy: 0.1, "$AKP$3")
      XCTAssertEqual(day17[14600], 43.29, accuracy: 0.1, "$AKQ$3")
      XCTAssertEqual(day17[14965], 1.00, accuracy: 0.1, "$AKR$3")
      XCTAssertEqual(day17[15330], 1.00, accuracy: 0.1, "$AKT$3")
      XCTAssertEqual(day17[15695], 2167.02, accuracy: 0.1, "$AKU$3")
      XCTAssertEqual(day17[16060], 1131.39, accuracy: 0.1, "$AKV$3")
      XCTAssertEqual(day17[16425], 2145.35, accuracy: 0.1, "$AKW$3")
      XCTAssertEqual(day17[16790], 1120.08, accuracy: 0.1, "$AKX$3")
      XCTAssertEqual(day17[17155], 452.65, accuracy: 0.1, "$AKY$3")
      XCTAssertEqual(day17[17520], 120.73, accuracy: 0.1, "$AKZ$3")
      XCTAssertEqual(day17[17885], 115.46, accuracy: 0.1, "$ALA$3")
      XCTAssertEqual(day17[18250], 115.46, accuracy: 0.1, "$ALB$3")
      XCTAssertEqual(day17[18615], 428.62, accuracy: 0.1, "$ALC$3")
      XCTAssertEqual(day17[18980], 350.00, accuracy: 0.1, "$ALD$3")
      XCTAssertEqual(day17[19345], 309.36, accuracy: 0.1, "$ALE$3")
      XCTAssertEqual(day17[19710], 199.01, accuracy: 0.1, "$ALF$3")
      XCTAssertEqual(day17[20075], 101.37, accuracy: 0.1, "$ALG$3")
      XCTAssertEqual(day17[20440], 4.35, accuracy: 0.1, "$ALH$3")
      XCTAssertEqual(day17[20805], 56.63, accuracy: 0.1, "$ALI$3")
      XCTAssertEqual(day17[21170], 43.29, accuracy: 0.1, "$ALJ$3")
      XCTAssertEqual(day17[21535], 1.00, accuracy: 0.1, "$ALK$3")
      XCTAssertEqual(day17[21900], 1816.48, accuracy: 0.1, "$ALM$3")
      XCTAssertEqual(day17[22265], 0.00, accuracy: 0.1, "$ALN$3")
      XCTAssertEqual(day17[22630], 20.53, accuracy: 0.1, "$ALO$3")
      XCTAssertEqual(day17[22995], 70.26, accuracy: 0.1, "$ALP$3")
      XCTAssertEqual(day17[23360], 779.27, accuracy: 0.1, "$ALQ$3")
      XCTAssertEqual(day17[23725], 0.00, accuracy: 0.1, "$ALR$3")
      XCTAssertEqual(day17[24090], 3303.83, accuracy: 0.1, "$ALS$3")
      XCTAssertEqual(day17[24455], 164.10, accuracy: 0.1, "$ALT$3")
      XCTAssertEqual(day17[24820], 0.00, accuracy: 0.1, "$ALU$3")
      XCTAssertEqual(day17[25185], 781.39, accuracy: 0.1, "$ALV$3")
      XCTAssertEqual(day17[25550], 771.48, accuracy: 0.1, "$ALW$3")
      XCTAssertEqual(day17[25915], 0.00, accuracy: 0.1, "$ALX$3")
      XCTAssertEqual(day17[26280], 771.48, accuracy: 0.1, "$ALY$3")
      XCTAssertEqual(day17[26645], 0.00, accuracy: 0.1, "$ALZ$3")
      XCTAssertEqual(day17[27010], 0.00, accuracy: 0.1, "$AMA$3")
      XCTAssertEqual(day17[27375], 0.00, accuracy: 0.1, "$AMB$3")
      XCTAssertEqual(day17[27740], 0.00, accuracy: 0.1, "$AMC$3")
      XCTAssertEqual(day17[28105], 49.18, accuracy: 0.1, "$AMD$3")
      XCTAssertEqual(day17[28470], 0.00, accuracy: 0.1, "$AME$3")
      XCTAssertEqual(day17[28835], 49.18, accuracy: 0.1, "$AMF$3")
      XCTAssertEqual(day17[29200], 0.00, accuracy: 0.1, "$AMG$3")
      XCTAssertEqual(day17[29565], 0.00, accuracy: 0.1, "$AMH$3")
      XCTAssertEqual(day17[29930], 0.00, accuracy: 0.1, "$AMI$3")
      XCTAssertEqual(day17[30295], 0.00, accuracy: 0.1, "$AMJ$3")
      XCTAssertEqual(day17[30660], 0.00, accuracy: 0.1, "$AMK$3")
      XCTAssertEqual(day17[31025], 0.00, accuracy: 0.1, "$AML$3")
      XCTAssertEqual(day17[31390], 0.00, accuracy: 0.1, "$AMM$3")
      XCTAssertEqual(day17[31755], 163.79, accuracy: 0.1, "$AMN$3")
      XCTAssertEqual(day17[32120], 350.00, accuracy: 0.1, "$AMO$3")
      XCTAssertEqual(day17[32485], 0.00, accuracy: 0.1, "$AMP$3")
      XCTAssertEqual(day17[32850], 15.00, accuracy: 0.1, "$AMQ$3")
      XCTAssertEqual(day17[33215], 9.00, accuracy: 0.1, "$AMR$3")
      XCTAssertEqual(day17[33580], 0.00, accuracy: 0.1, "$AMS$3")
      XCTAssertEqual(day17[33945], 0.00, accuracy: 0.1, "$AMT$3")
      XCTAssertEqual(day17[34310], 1816.48, accuracy: 0.1, "$AMV$3")
      XCTAssertEqual(day17[34675], 0.00, accuracy: 0.1, "$AMW$3")
      XCTAssertEqual(day17[35040], 20.53, accuracy: 0.1, "$AMX$3")
      XCTAssertEqual(day17[35405], 70.26, accuracy: 0.1, "$AMY$3")
      XCTAssertEqual(day17[35770], 779.27, accuracy: 0.1, "$AMZ$3")
      XCTAssertEqual(day17[36135], 0.00, accuracy: 0.1, "$ANA$3")
      XCTAssertEqual(day17[36500], 3303.83, accuracy: 0.1, "$ANB$3")
      XCTAssertEqual(day17[36865], 164.10, accuracy: 0.1, "$ANC$3")
      XCTAssertEqual(day17[37230], 0.00, accuracy: 0.1, "$AND$3")
      XCTAssertEqual(day17[37595], 781.39, accuracy: 0.1, "$ANE$3")
      XCTAssertEqual(day17[37960], 771.48, accuracy: 0.1, "$ANF$3")
      XCTAssertEqual(day17[38325], 0.00, accuracy: 0.1, "$ANG$3")
      XCTAssertEqual(day17[38690], 771.48, accuracy: 0.1, "$ANH$3")
      XCTAssertEqual(day17[39055], 0.00, accuracy: 0.1, "$ANI$3")
      XCTAssertEqual(day17[39420], 0.00, accuracy: 0.1, "$ANJ$3")
      XCTAssertEqual(day17[39785], 0.00, accuracy: 0.1, "$ANK$3")
      XCTAssertEqual(day17[40150], 0.00, accuracy: 0.1, "$ANL$3")
      XCTAssertEqual(day17[40515], 49.18, accuracy: 0.1, "$ANM$3")
      XCTAssertEqual(day17[40880], 0.00, accuracy: 0.1, "$ANN$3")
      XCTAssertEqual(day17[41245], 49.18, accuracy: 0.1, "$ANO$3")
      XCTAssertEqual(day17[41610], 0.00, accuracy: 0.1, "$ANP$3")
      XCTAssertEqual(day17[41975], 0.00, accuracy: 0.1, "$ANQ$3")
      XCTAssertEqual(day17[42340], 0.00, accuracy: 0.1, "$ANR$3")
      XCTAssertEqual(day17[42705], 0.00, accuracy: 0.1, "$ANS$3")
      XCTAssertEqual(day17[43070], 0.00, accuracy: 0.1, "$ANT$3")
      XCTAssertEqual(day17[43435], 0.00, accuracy: 0.1, "$ANU$3")
      XCTAssertEqual(day17[43800], 0.00, accuracy: 0.1, "$ANV$3")
      XCTAssertEqual(day17[44165], 163.79, accuracy: 0.1, "$ANW$3")
      XCTAssertEqual(day17[44530], 350.00, accuracy: 0.1, "$ANX$3")
      XCTAssertEqual(day17[44895], 0.00, accuracy: 0.1, "$ANY$3")
      XCTAssertEqual(day17[45260], 15.00, accuracy: 0.1, "$ANZ$3")
      XCTAssertEqual(day17[45625], 9.00, accuracy: 0.1, "$AOA$3")
      XCTAssertEqual(day17[45990], 0.00, accuracy: 0.1, "$AOB$3")
      XCTAssertEqual(day17[46355], 0.00, accuracy: 0.1, "$AOC$3")

      XCTAssertEqual(day17[1], 3601.32, accuracy: 0.1, "$AJB$4")
      XCTAssertEqual(day17[366], 3601.32, accuracy: 0.1, "$AJC$4")
      XCTAssertEqual(day17[731], 2567.84, accuracy: 0.1, "$AJD$4")
      XCTAssertEqual(day17[1096], 3871.28, accuracy: 0.1, "$AJE$4")
      XCTAssertEqual(day17[1461], 3871.28, accuracy: 0.1, "$AJF$4")
      XCTAssertEqual(day17[1826], 2733.69, accuracy: 0.1, "$AJG$4")
      XCTAssertEqual(day17[2191], 642.98, accuracy: 0.1, "$AJH$4")
      XCTAssertEqual(day17[2556], 642.98, accuracy: 0.1, "$AJI$4")
      XCTAssertEqual(day17[2921], 411.77, accuracy: 0.1, "$AJJ$4")
      XCTAssertEqual(day17[3286], 115.46, accuracy: 0.1, "$AJK$4")
      XCTAssertEqual(day17[3651], 115.46, accuracy: 0.1, "$AJL$4")
      XCTAssertEqual(day17[4016], 115.46, accuracy: 0.1, "$AJM$4")
      XCTAssertEqual(day17[4381], 450.00, accuracy: 0.1, "$AJN$4")
      XCTAssertEqual(day17[4746], 450.00, accuracy: 0.1, "$AJO$4")
      XCTAssertEqual(day17[5111], 375.58, accuracy: 0.1, "$AJP$4")
      XCTAssertEqual(day17[5476], 309.36, accuracy: 0.1, "$AJQ$4")
      XCTAssertEqual(day17[5841], 309.36, accuracy: 0.1, "$AJR$4")
      XCTAssertEqual(day17[6206], 194.05, accuracy: 0.1, "$AJS$4")
      XCTAssertEqual(day17[6571], 101.37, accuracy: 0.1, "$AJT$4")
      XCTAssertEqual(day17[6936], 101.37, accuracy: 0.1, "$AJU$4")
      XCTAssertEqual(day17[7301], 0.00, accuracy: 0.1, "$AJV$4")
      XCTAssertEqual(day17[7666], 56.63, accuracy: 0.1, "$AJW$4")
      XCTAssertEqual(day17[8031], 56.63, accuracy: 0.1, "$AJX$4")
      XCTAssertEqual(day17[8396], 42.69, accuracy: 0.1, "$AJY$4")
      XCTAssertEqual(day17[8761], 1.00, accuracy: 0.1, "$AKA$4")
      XCTAssertEqual(day17[9126], 2567.84, accuracy: 0.1, "$AKB$4")
      XCTAssertEqual(day17[9491], 2567.84, accuracy: 0.1, "$AKC$4")
      XCTAssertEqual(day17[9856], 2733.69, accuracy: 0.1, "$AKD$4")
      XCTAssertEqual(day17[10221], 2733.69, accuracy: 0.1, "$AKE$4")
      XCTAssertEqual(day17[10586], 411.77, accuracy: 0.1, "$AKF$4")
      XCTAssertEqual(day17[10951], 411.77, accuracy: 0.1, "$AKG$4")
      XCTAssertEqual(day17[11316], 115.46, accuracy: 0.1, "$AKH$4")
      XCTAssertEqual(day17[11681], 115.46, accuracy: 0.1, "$AKI$4")
      XCTAssertEqual(day17[12046], 375.58, accuracy: 0.1, "$AKJ$4")
      XCTAssertEqual(day17[12411], 375.58, accuracy: 0.1, "$AKK$4")
      XCTAssertEqual(day17[12776], 194.05, accuracy: 0.1, "$AKL$4")
      XCTAssertEqual(day17[13141], 194.05, accuracy: 0.1, "$AKM$4")
      XCTAssertEqual(day17[13506], 0.00, accuracy: 0.1, "$AKN$4")
      XCTAssertEqual(day17[13871], 0.00, accuracy: 0.1, "$AKO$4")
      XCTAssertEqual(day17[14236], 42.69, accuracy: 0.1, "$AKP$4")
      XCTAssertEqual(day17[14601], 42.69, accuracy: 0.1, "$AKQ$4")
      XCTAssertEqual(day17[14966], 1.00, accuracy: 0.1, "$AKR$4")
      XCTAssertEqual(day17[15331], 1.00, accuracy: 0.1, "$AKT$4")
      XCTAssertEqual(day17[15696], 3601.32, accuracy: 0.1, "$AKU$4")
      XCTAssertEqual(day17[16061], 2567.84, accuracy: 0.1, "$AKV$4")
      XCTAssertEqual(day17[16426], 3871.28, accuracy: 0.1, "$AKW$4")
      XCTAssertEqual(day17[16791], 2733.69, accuracy: 0.1, "$AKX$4")
      XCTAssertEqual(day17[17156], 642.98, accuracy: 0.1, "$AKY$4")
      XCTAssertEqual(day17[17521], 411.77, accuracy: 0.1, "$AKZ$4")
      XCTAssertEqual(day17[17886], 115.46, accuracy: 0.1, "$ALA$4")
      XCTAssertEqual(day17[18251], 115.46, accuracy: 0.1, "$ALB$4")
      XCTAssertEqual(day17[18616], 450.00, accuracy: 0.1, "$ALC$4")
      XCTAssertEqual(day17[18981], 375.58, accuracy: 0.1, "$ALD$4")
      XCTAssertEqual(day17[19346], 309.36, accuracy: 0.1, "$ALE$4")
      XCTAssertEqual(day17[19711], 194.05, accuracy: 0.1, "$ALF$4")
      XCTAssertEqual(day17[20076], 101.37, accuracy: 0.1, "$ALG$4")
      XCTAssertEqual(day17[20441], 0.00, accuracy: 0.1, "$ALH$4")
      XCTAssertEqual(day17[20806], 56.63, accuracy: 0.1, "$ALI$4")
      XCTAssertEqual(day17[21171], 42.69, accuracy: 0.1, "$ALJ$4")
      XCTAssertEqual(day17[21536], 1.00, accuracy: 0.1, "$ALK$4")
      XCTAssertEqual(day17[21901], 1850.93, accuracy: 0.1, "$ALM$4")
      XCTAssertEqual(day17[22266], 0.00, accuracy: 0.1, "$ALN$4")
      XCTAssertEqual(day17[22631], 23.67, accuracy: 0.1, "$ALO$4")
      XCTAssertEqual(day17[22996], 70.26, accuracy: 0.1, "$ALP$4")
      XCTAssertEqual(day17[23361], 488.23, accuracy: 0.1, "$ALQ$4")
      XCTAssertEqual(day17[23726], 0.00, accuracy: 0.1, "$ALR$4")
      XCTAssertEqual(day17[24091], 4550.94, accuracy: 0.1, "$ALS$4")
      XCTAssertEqual(day17[24456], 74.42, accuracy: 0.1, "$ALT$4")
      XCTAssertEqual(day17[24821], 0.00, accuracy: 0.1, "$ALU$4")
      XCTAssertEqual(day17[25186], 2192.26, accuracy: 0.1, "$ALV$4")
      XCTAssertEqual(day17[25551], 786.22, accuracy: 0.1, "$ALW$4")
      XCTAssertEqual(day17[25916], 0.00, accuracy: 0.1, "$ALX$4")
      XCTAssertEqual(day17[26281], 483.35, accuracy: 0.1, "$ALY$4")
      XCTAssertEqual(day17[26646], 0.00, accuracy: 0.1, "$ALZ$4")
      XCTAssertEqual(day17[27011], 494.40, accuracy: 0.1, "$AMA$4")
      XCTAssertEqual(day17[27376], 191.53, accuracy: 0.1, "$AMB$4")
      XCTAssertEqual(day17[27741], 0.00, accuracy: 0.1, "$AMC$4")
      XCTAssertEqual(day17[28106], 49.18, accuracy: 0.1, "$AMD$4")
      XCTAssertEqual(day17[28471], 0.00, accuracy: 0.1, "$AME$4")
      XCTAssertEqual(day17[28836], 49.18, accuracy: 0.1, "$AMF$4")
      XCTAssertEqual(day17[29201], 0.00, accuracy: 0.1, "$AMG$4")
      XCTAssertEqual(day17[29566], 0.00, accuracy: 0.1, "$AMH$4")
      XCTAssertEqual(day17[29931], 0.00, accuracy: 0.1, "$AMI$4")
      XCTAssertEqual(day17[30296], 0.00, accuracy: 0.1, "$AMJ$4")
      XCTAssertEqual(day17[30661], 0.00, accuracy: 0.1, "$AMK$4")
      XCTAssertEqual(day17[31026], 0.00, accuracy: 0.1, "$AML$4")
      XCTAssertEqual(day17[31391], 0.00, accuracy: 0.1, "$AMM$4")
      XCTAssertEqual(day17[31756], 163.79, accuracy: 0.1, "$AMN$4")
      XCTAssertEqual(day17[32121], 350.00, accuracy: 0.1, "$AMO$4")
      XCTAssertEqual(day17[32486], 0.00, accuracy: 0.1, "$AMP$4")
      XCTAssertEqual(day17[32851], 15.00, accuracy: 0.1, "$AMQ$4")
      XCTAssertEqual(day17[33216], 9.00, accuracy: 0.1, "$AMR$4")
      XCTAssertEqual(day17[33581], 0.00, accuracy: 0.1, "$AMS$4")
      XCTAssertEqual(day17[33946], 0.00, accuracy: 0.1, "$AMT$4")
      XCTAssertEqual(day17[34311], 1850.93, accuracy: 0.1, "$AMV$4")
      XCTAssertEqual(day17[34676], 0.00, accuracy: 0.1, "$AMW$4")
      XCTAssertEqual(day17[35041], 23.67, accuracy: 0.1, "$AMX$4")
      XCTAssertEqual(day17[35406], 70.26, accuracy: 0.1, "$AMY$4")
      XCTAssertEqual(day17[35771], 488.23, accuracy: 0.1, "$AMZ$4")
      XCTAssertEqual(day17[36136], 0.00, accuracy: 0.1, "$ANA$4")
      XCTAssertEqual(day17[36501], 4550.94, accuracy: 0.1, "$ANB$4")
      XCTAssertEqual(day17[36866], 74.42, accuracy: 0.1, "$ANC$4")
      XCTAssertEqual(day17[37231], 0.00, accuracy: 0.1, "$AND$4")
      XCTAssertEqual(day17[37596], 2192.26, accuracy: 0.1, "$ANE$4")
      XCTAssertEqual(day17[37961], 786.22, accuracy: 0.1, "$ANF$4")
      XCTAssertEqual(day17[38326], 0.00, accuracy: 0.1, "$ANG$4")
      XCTAssertEqual(day17[38691], 483.35, accuracy: 0.1, "$ANH$4")
      XCTAssertEqual(day17[39056], 0.00, accuracy: 0.1, "$ANI$4")
      XCTAssertEqual(day17[39421], 494.40, accuracy: 0.1, "$ANJ$4")
      XCTAssertEqual(day17[39786], 191.53, accuracy: 0.1, "$ANK$4")
      XCTAssertEqual(day17[40151], 0.00, accuracy: 0.1, "$ANL$4")
      XCTAssertEqual(day17[40516], 49.18, accuracy: 0.1, "$ANM$4")
      XCTAssertEqual(day17[40881], 0.00, accuracy: 0.1, "$ANN$4")
      XCTAssertEqual(day17[41246], 49.18, accuracy: 0.1, "$ANO$4")
      XCTAssertEqual(day17[41611], 0.00, accuracy: 0.1, "$ANP$4")
      XCTAssertEqual(day17[41976], 0.00, accuracy: 0.1, "$ANQ$4")
      XCTAssertEqual(day17[42341], 0.00, accuracy: 0.1, "$ANR$4")
      XCTAssertEqual(day17[42706], 0.00, accuracy: 0.1, "$ANS$4")
      XCTAssertEqual(day17[43071], 0.00, accuracy: 0.1, "$ANT$4")
      XCTAssertEqual(day17[43436], 0.00, accuracy: 0.1, "$ANU$4")
      XCTAssertEqual(day17[43801], 0.00, accuracy: 0.1, "$ANV$4")
      XCTAssertEqual(day17[44166], 163.79, accuracy: 0.1, "$ANW$4")
      XCTAssertEqual(day17[44531], 350.00, accuracy: 0.1, "$ANX$4")
      XCTAssertEqual(day17[44896], 0.00, accuracy: 0.1, "$ANY$4")
      XCTAssertEqual(day17[45261], 15.00, accuracy: 0.1, "$ANZ$4")
      XCTAssertEqual(day17[45626], 9.00, accuracy: 0.1, "$AOA$4")
      XCTAssertEqual(day17[45991], 0.00, accuracy: 0.1, "$AOB$4")
      XCTAssertEqual(day17[46356], 0.00, accuracy: 0.1, "$AOC$4")

      XCTAssertEqual(day17[2], 4420.29, accuracy: 0.1, "$AJB$5")
      XCTAssertEqual(day17[367], 4420.29, accuracy: 0.1, "$AJC$5")
      XCTAssertEqual(day17[732], 3492.00, accuracy: 0.1, "$AJD$5")
      XCTAssertEqual(day17[1097], 4878.83, accuracy: 0.1, "$AJE$5")
      XCTAssertEqual(day17[1462], 4878.83, accuracy: 0.1, "$AJF$5")
      XCTAssertEqual(day17[1827], 3741.24, accuracy: 0.1, "$AJG$5")
      XCTAssertEqual(day17[2192], 823.62, accuracy: 0.1, "$AJH$5")
      XCTAssertEqual(day17[2557], 823.62, accuracy: 0.1, "$AJI$5")
      XCTAssertEqual(day17[2922], 697.58, accuracy: 0.1, "$AJJ$5")
      XCTAssertEqual(day17[3287], 115.46, accuracy: 0.1, "$AJK$5")
      XCTAssertEqual(day17[3652], 115.46, accuracy: 0.1, "$AJL$5")
      XCTAssertEqual(day17[4017], 115.46, accuracy: 0.1, "$AJM$5")
      XCTAssertEqual(day17[4382], 450.00, accuracy: 0.1, "$AJN$5")
      XCTAssertEqual(day17[4747], 450.00, accuracy: 0.1, "$AJO$5")
      XCTAssertEqual(day17[5112], 450.00, accuracy: 0.1, "$AJP$5")
      XCTAssertEqual(day17[5477], 309.36, accuracy: 0.1, "$AJQ$5")
      XCTAssertEqual(day17[5842], 309.36, accuracy: 0.1, "$AJR$5")
      XCTAssertEqual(day17[6207], 194.05, accuracy: 0.1, "$AJS$5")
      XCTAssertEqual(day17[6572], 101.37, accuracy: 0.1, "$AJT$5")
      XCTAssertEqual(day17[6937], 101.37, accuracy: 0.1, "$AJU$5")
      XCTAssertEqual(day17[7302], 0.00, accuracy: 0.1, "$AJV$5")
      XCTAssertEqual(day17[7667], 56.63, accuracy: 0.1, "$AJW$5")
      XCTAssertEqual(day17[8032], 56.63, accuracy: 0.1, "$AJX$5")
      XCTAssertEqual(day17[8397], 42.69, accuracy: 0.1, "$AJY$5")
      XCTAssertEqual(day17[8762], 1.00, accuracy: 0.1, "$AKA$5")
      XCTAssertEqual(day17[9127], 3492.00, accuracy: 0.1, "$AKB$5")
      XCTAssertEqual(day17[9492], 3492.00, accuracy: 0.1, "$AKC$5")
      XCTAssertEqual(day17[9857], 3741.24, accuracy: 0.1, "$AKD$5")
      XCTAssertEqual(day17[10222], 3741.24, accuracy: 0.1, "$AKE$5")
      XCTAssertEqual(day17[10587], 697.58, accuracy: 0.1, "$AKF$5")
      XCTAssertEqual(day17[10952], 697.58, accuracy: 0.1, "$AKG$5")
      XCTAssertEqual(day17[11317], 115.46, accuracy: 0.1, "$AKH$5")
      XCTAssertEqual(day17[11682], 115.46, accuracy: 0.1, "$AKI$5")
      XCTAssertEqual(day17[12047], 450.00, accuracy: 0.1, "$AKJ$5")
      XCTAssertEqual(day17[12412], 450.00, accuracy: 0.1, "$AKK$5")
      XCTAssertEqual(day17[12777], 194.05, accuracy: 0.1, "$AKL$5")
      XCTAssertEqual(day17[13142], 194.05, accuracy: 0.1, "$AKM$5")
      XCTAssertEqual(day17[13507], 0.00, accuracy: 0.1, "$AKN$5")
      XCTAssertEqual(day17[13872], 0.00, accuracy: 0.1, "$AKO$5")
      XCTAssertEqual(day17[14237], 42.69, accuracy: 0.1, "$AKP$5")
      XCTAssertEqual(day17[14602], 42.69, accuracy: 0.1, "$AKQ$5")
      XCTAssertEqual(day17[14967], 1.00, accuracy: 0.1, "$AKR$5")
      XCTAssertEqual(day17[15332], 1.00, accuracy: 0.1, "$AKT$5")
      XCTAssertEqual(day17[15697], 4420.29, accuracy: 0.1, "$AKU$5")
      XCTAssertEqual(day17[16062], 3492.00, accuracy: 0.1, "$AKV$5")
      XCTAssertEqual(day17[16427], 4878.83, accuracy: 0.1, "$AKW$5")
      XCTAssertEqual(day17[16792], 3741.24, accuracy: 0.1, "$AKX$5")
      XCTAssertEqual(day17[17157], 823.62, accuracy: 0.1, "$AKY$5")
      XCTAssertEqual(day17[17522], 697.58, accuracy: 0.1, "$AKZ$5")
      XCTAssertEqual(day17[17887], 115.46, accuracy: 0.1, "$ALA$5")
      XCTAssertEqual(day17[18252], 115.46, accuracy: 0.1, "$ALB$5")
      XCTAssertEqual(day17[18617], 450.00, accuracy: 0.1, "$ALC$5")
      XCTAssertEqual(day17[18982], 450.00, accuracy: 0.1, "$ALD$5")
      XCTAssertEqual(day17[19347], 309.36, accuracy: 0.1, "$ALE$5")
      XCTAssertEqual(day17[19712], 194.05, accuracy: 0.1, "$ALF$5")
      XCTAssertEqual(day17[20077], 101.37, accuracy: 0.1, "$ALG$5")
      XCTAssertEqual(day17[20442], 0.00, accuracy: 0.1, "$ALH$5")
      XCTAssertEqual(day17[20807], 56.63, accuracy: 0.1, "$ALI$5")
      XCTAssertEqual(day17[21172], 42.69, accuracy: 0.1, "$ALJ$5")
      XCTAssertEqual(day17[21537], 1.00, accuracy: 0.1, "$ALK$5")
      XCTAssertEqual(day17[21902], 1850.93, accuracy: 0.1, "$ALM$5")
      XCTAssertEqual(day17[22267], 0.00, accuracy: 0.1, "$ALN$5")
      XCTAssertEqual(day17[22632], 25.99, accuracy: 0.1, "$ALO$5")
      XCTAssertEqual(day17[22997], 70.26, accuracy: 0.1, "$ALP$5")
      XCTAssertEqual(day17[23362], 202.42, accuracy: 0.1, "$ALQ$5")
      XCTAssertEqual(day17[23727], 0.00, accuracy: 0.1, "$ALR$5")
      XCTAssertEqual(day17[24092], 5191.59, accuracy: 0.1, "$ALS$5")
      XCTAssertEqual(day17[24457], 0.00, accuracy: 0.1, "$ALT$5")
      XCTAssertEqual(day17[24822], 0.00, accuracy: 0.1, "$ALU$5")
      XCTAssertEqual(day17[25187], 3042.00, accuracy: 0.1, "$ALV$5")
      XCTAssertEqual(day17[25552], 786.22, accuracy: 0.1, "$ALW$5")
      XCTAssertEqual(day17[25917], 0.00, accuracy: 0.1, "$ALX$5")
      XCTAssertEqual(day17[26282], 200.39, accuracy: 0.1, "$ALY$5")
      XCTAssertEqual(day17[26647], 0.00, accuracy: 0.1, "$ALZ$5")
      XCTAssertEqual(day17[27012], 870.00, accuracy: 0.1, "$AMA$5")
      XCTAssertEqual(day17[27377], 284.17, accuracy: 0.1, "$AMB$5")
      XCTAssertEqual(day17[27742], 0.00, accuracy: 0.1, "$AMC$5")
      XCTAssertEqual(day17[28107], 49.18, accuracy: 0.1, "$AMD$5")
      XCTAssertEqual(day17[28472], 0.00, accuracy: 0.1, "$AME$5")
      XCTAssertEqual(day17[28837], 49.18, accuracy: 0.1, "$AMF$5")
      XCTAssertEqual(day17[29202], 0.00, accuracy: 0.1, "$AMG$5")
      XCTAssertEqual(day17[29567], 0.00, accuracy: 0.1, "$AMH$5")
      XCTAssertEqual(day17[29932], 0.00, accuracy: 0.1, "$AMI$5")
      XCTAssertEqual(day17[30297], 0.00, accuracy: 0.1, "$AMJ$5")
      XCTAssertEqual(day17[30662], 0.00, accuracy: 0.1, "$AMK$5")
      XCTAssertEqual(day17[31027], 0.00, accuracy: 0.1, "$AML$5")
      XCTAssertEqual(day17[31392], 0.00, accuracy: 0.1, "$AMM$5")
      XCTAssertEqual(day17[31757], 163.79, accuracy: 0.1, "$AMN$5")
      XCTAssertEqual(day17[32122], 431.10, accuracy: 0.1, "$AMO$5")
      XCTAssertEqual(day17[32487], 0.00, accuracy: 0.1, "$AMP$5")
      XCTAssertEqual(day17[32852], 15.00, accuracy: 0.1, "$AMQ$5")
      XCTAssertEqual(day17[33217], 9.00, accuracy: 0.1, "$AMR$5")
      XCTAssertEqual(day17[33582], 0.00, accuracy: 0.1, "$AMS$5")
      XCTAssertEqual(day17[33947], 0.00, accuracy: 0.1, "$AMT$5")
      XCTAssertEqual(day17[34312], 1850.93, accuracy: 0.1, "$AMV$5")
      XCTAssertEqual(day17[34677], 0.00, accuracy: 0.1, "$AMW$5")
      XCTAssertEqual(day17[35042], 25.99, accuracy: 0.1, "$AMX$5")
      XCTAssertEqual(day17[35407], 70.26, accuracy: 0.1, "$AMY$5")
      XCTAssertEqual(day17[35772], 202.42, accuracy: 0.1, "$AMZ$5")
      XCTAssertEqual(day17[36137], 0.00, accuracy: 0.1, "$ANA$5")
      XCTAssertEqual(day17[36502], 5191.59, accuracy: 0.1, "$ANB$5")
      XCTAssertEqual(day17[36867], 0.00, accuracy: 0.1, "$ANC$5")
      XCTAssertEqual(day17[37232], 0.00, accuracy: 0.1, "$AND$5")
      XCTAssertEqual(day17[37597], 3042.00, accuracy: 0.1, "$ANE$5")
      XCTAssertEqual(day17[37962], 786.22, accuracy: 0.1, "$ANF$5")
      XCTAssertEqual(day17[38327], 0.00, accuracy: 0.1, "$ANG$5")
      XCTAssertEqual(day17[38692], 200.39, accuracy: 0.1, "$ANH$5")
      XCTAssertEqual(day17[39057], 0.00, accuracy: 0.1, "$ANI$5")
      XCTAssertEqual(day17[39422], 870.00, accuracy: 0.1, "$ANJ$5")
      XCTAssertEqual(day17[39787], 284.17, accuracy: 0.1, "$ANK$5")
      XCTAssertEqual(day17[40152], 0.00, accuracy: 0.1, "$ANL$5")
      XCTAssertEqual(day17[40517], 49.18, accuracy: 0.1, "$ANM$5")
      XCTAssertEqual(day17[40882], 0.00, accuracy: 0.1, "$ANN$5")
      XCTAssertEqual(day17[41247], 49.18, accuracy: 0.1, "$ANO$5")
      XCTAssertEqual(day17[41612], 0.00, accuracy: 0.1, "$ANP$5")
      XCTAssertEqual(day17[41977], 0.00, accuracy: 0.1, "$ANQ$5")
      XCTAssertEqual(day17[42342], 0.00, accuracy: 0.1, "$ANR$5")
      XCTAssertEqual(day17[42707], 0.00, accuracy: 0.1, "$ANS$5")
      XCTAssertEqual(day17[43072], 0.00, accuracy: 0.1, "$ANT$5")
      XCTAssertEqual(day17[43437], 0.00, accuracy: 0.1, "$ANU$5")
      XCTAssertEqual(day17[43802], 0.00, accuracy: 0.1, "$ANV$5")
      XCTAssertEqual(day17[44167], 163.79, accuracy: 0.1, "$ANW$5")
      XCTAssertEqual(day17[44532], 431.10, accuracy: 0.1, "$ANX$5")
      XCTAssertEqual(day17[44897], 0.00, accuracy: 0.1, "$ANY$5")
      XCTAssertEqual(day17[45262], 15.00, accuracy: 0.1, "$ANZ$5")
      XCTAssertEqual(day17[45627], 9.00, accuracy: 0.1, "$AOA$5")
      XCTAssertEqual(day17[45992], 0.00, accuracy: 0.1, "$AOB$5")
      XCTAssertEqual(day17[46357], 0.00, accuracy: 0.1, "$AOC$5")
      }

      day.append(Array(day17[31755..<33215]))
      day.append(Array(day17[44165..<45625]))

      let day0 = model.day0(hour0: hour0)
      model.day21(&day21, case: j, day0: day0)
      print("Daily 2 Case", j)
      Array(day21[0..<6935]).head(0, steps: 365)
      print("Daily 2 Case", j)
      Array(day21[6935...]).head(19, steps: 365)

      model.day27(&day27, case: j, day0: day0, day1: day21, day6: day6)
      print("Daily 2 Case", j)
      Array(day27[..<9855]).head(121, steps: 365)
      print("Daily 2 Case", j)
      Array(day27[9855..<17155]).head(148, steps: 365)
      print("Daily 2 Case", j)
      Array(day27[17155..<24090]).head(168, steps: 365)
      print("Daily 2 Case", j)
      Array(day27[24090..<31755]).head(188, steps: 365)
      print("Daily 2 Case", j)
      Array(day27[31755..<38690]).head(206, steps: 365)
      print("Daily 2 Case", j)
      Array(day27[38690...]).head(242, steps: 365)

      day.append(Array(day27[33945..<35040]))
      day.append(Array(day27[44895..<45990]))
    }

    let costs = Costs(model)
    var meth_produced_MTPH_sum = Double.zero
    var elec_from_grid_sum = Double.zero
    var elec_to_grid_MTPH_sum = Double.zero

    for d in 0..<365 {
      let cases = day.indices.map { i in
        costs.LCOM(meth_produced_MTPH: day[i][d], elec_from_grid: day[i][d+365], elec_to_grid: day[i][d+365+365])
        
      }
      print(cases)
      let best = cases.indices.filter{cases[$0].isFinite}.filter{cases[$0]>0}.sorted().first
      if let best = best { 
        meth_produced_MTPH_sum += day[best][d]
        elec_from_grid_sum += day[best][d+365]
        elec_to_grid_MTPH_sum += day[best][d+365+365]
      } 
    }
    let LCOM = costs.LCOM(meth_produced_MTPH: meth_produced_MTPH_sum, elec_from_grid: elec_from_grid_sum, elec_to_grid: elec_to_grid_MTPH_sum)
    print(LCOM)
  }
}
