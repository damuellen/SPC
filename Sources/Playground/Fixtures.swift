import Foundation
// import Regex

let formulasCalculation: [String: String] = [
"D" : "=IF(C6=0,D5+1,D5)",    "H" : "=MAX(0,G6/MAX($G$5:$G$8763))", "I" : "=IFERROR(IF(G6<MAX($G$5:$G$8763),MAX(G6,0)/F6,0),0)", "J" : "=E6*CSP_loop_nr_ud", "K" : "=F6*PV_DC_cap_ud/PV_Ref_DC_cap", "L" : "=MIN(PV_AC_cap_ud,IF(K6/PV_DC_cap_ud>Inv_eff_Ref_approx_handover,K6*POLY(K6/PV_DC_cap_ud,HL_Coeff),IF(K6/PV_DC_cap_ud>0,K6*POLY(K6/PV_DC_cap_ud,LL_Coeff),0)))", "M" : "=MAX(0,-G6/PV_Ref_AC_cap*PV_AC_cap_ud)",  "O" : "=IF($J6>0,$J6*CSP_var_aux_nom_perc,CSP_nonsolar_aux_cons)+M6+PB_stby_aux_cons", "P" : "=MAX(0,$L6-O6)", "Q" : "=MAX(0,O6-P6)", "R" : "=IF(MIN(Overall_harmonious_var_max_cons+Overall_fix_cons,$P6+Grid_import_max_ud*Grid_import_yes_no_BESS_strategy,MIN($J6+El_boiler_cap_ud*El_boiler_eff,($P6+Grid_import_max_ud*Grid_import_yes_no_BESS_strategy)/(Overall_harmonious_var_max_cons+Overall_fix_cons+MAX(0,(Overall_harmonious_var_heat_max_cons+Overall_heat_fix_cons-$J6))/El_boiler_eff)*(Overall_harmonious_var_heat_max_cons+Overall_heat_fix_cons))/(Overall_harmonious_var_heat_max_cons+Overall_heat_fix_cons)*(Overall_harmonious_var_max_cons+Overall_fix_cons))<Overall_harmonious_var_min_cons+Overall_fix_cons,0,Overall_harmonious_var_min_cons+Overall_fix_cons)", "S" : "=IF(AND(R6>0,R5=0,OR(R6=0,R7=0)),0,R6)", "T" : "=S6/(Overall_harmonious_var_max_cons+Overall_fix_cons)*(Overall_harmonious_var_heat_max_cons+Overall_heat_fix_cons)", "U" : "=IF(AND(S5<=0,S6>0),U5+1,U5)", "V" : "=MAX(0,$P6-$Q6-$S6-MAX(0,($T6-$J6)/El_boiler_eff))", "W" : "=MAX(0,$J6-T6)", "X" : "=MAX(0,-($P6-$Q6-$S6-MAX(0,(T6-$J6)/El_boiler_eff)))", "Y" : "=Grid_import_max_ud-X6", "Z" : "=MAX(0,(T6-$J6)/El_boiler_eff)", "AA" : "=MAX(0,El_boiler_cap_ud-Z6)", "AB" : "=MAX(0,1-S6/(Overall_harmonious_var_max_cons+Overall_fix_cons)*MethSynt_harmonious_max_perc)*MethSynt_RawMeth_nom_prod_ud", "AC" : "=MAX(0,1-S6/(Overall_harmonious_var_max_cons+Overall_fix_cons)*CCU_harmonious_max_perc)*CCU_CO2_nom_prod_ud", "AD" : "=MAX(0,1-S6/(Overall_harmonious_var_max_cons+Overall_fix_cons)*EY_harmonious_max_perc)*EY_Hydrogen_nom_prod", "AE" : "=MIN(BESS_chrg_max_cons,V6)", "AF" : "=MIN(Grid_export_max_ud,V6)", "AG" : "=IF(MIN(Overall_harmonious_var_max_cons+Overall_fix_cons,$P6+Grid_import_max_ud*Grid_import_yes_no_BESS_strategy,MIN($J6+El_boiler_cap_ud*El_boiler_eff,($P6+Grid_import_max_ud*Grid_import_yes_no_BESS_strategy)/(Overall_harmonious_var_max_cons+Overall_fix_cons+MAX(0,(Overall_harmonious_var_heat_max_cons+Overall_heat_fix_cons-$J6))/El_boiler_eff)*(Overall_harmonious_var_heat_max_cons+Overall_heat_fix_cons))/(Overall_harmonious_var_heat_max_cons+Overall_heat_fix_cons)*(Overall_harmonious_var_max_cons+Overall_fix_cons))<Overall_harmonious_var_min_cons+Overall_fix_cons,0,MIN(Overall_harmonious_var_max_cons+Overall_fix_cons,$P6+Grid_import_max_ud*Grid_import_yes_no_BESS_strategy,MIN($J6+El_boiler_cap_ud*El_boiler_eff,($P6+Grid_import_max_ud*Grid_import_yes_no_BESS_strategy)/(Overall_harmonious_var_max_cons+Overall_fix_cons+MAX(0,(Overall_harmonious_var_heat_max_cons+Overall_heat_fix_cons-$J6))/El_boiler_eff)*(Overall_harmonious_var_heat_max_cons+Overall_heat_fix_cons))/(Overall_harmonious_var_heat_max_cons+Overall_heat_fix_cons)*(Overall_harmonious_var_max_cons+Overall_fix_cons)))", "AH" : "=IF(AND(AG6>0,AG5=0,OR(AG6=0,AG7=0)),0,AG6)", "AI" : "=AH6/(Overall_harmonious_var_max_cons+Overall_fix_cons)*(Overall_harmonious_var_heat_max_cons+Overall_heat_fix_cons)", "AJ" : "=MAX(0,$P6-$Q6-AH6-MAX(0,(AI6-$J6)/El_boiler_eff))", "AK" : "=MAX(0,$J6-AI6)", "AL" : "=MAX(0,-($P6-$Q6-AH6-MAX(0,(AI6-$J6)/El_boiler_eff)))", "AM" : "=Grid_import_max_ud-AL6", "AN" : "=MAX(0,(AI6-$J6)/El_boiler_eff)", "AO" : "=MAX(0,El_boiler_cap_ud-AN6)", "AP" : "=MAX(0,1-AH6/(Overall_harmonious_var_max_cons+Overall_fix_cons)*MethSynt_harmonious_max_perc)*MethSynt_RawMeth_nom_prod_ud", "AQ" : "=MAX(0,1-AH6/(Overall_harmonious_var_max_cons+Overall_fix_cons)*CCU_harmonious_max_perc)*CCU_CO2_nom_prod_ud", "AR" : "=MAX(0,1-AH6/(Overall_harmonious_var_max_cons+Overall_fix_cons)*EY_harmonious_max_perc)*EY_Hydrogen_nom_prod", "AS" : "=MIN(BESS_chrg_max_cons,AJ6)", "AT" : "=MIN(Grid_export_max_ud,AJ6)",  "AV" : "=IF($J6>0,$J6*CSP_var_aux_nom_perc,CSP_nonsolar_aux_cons)+$M6", "AW" : "=MAX(0,$L6-AV6)", "AX" : "=MAX(0,AV6-AW6)", "AY" : "=MAX(0,MIN(AW6*(1-Heater_eff*(1+1/Ratio_CSP_vs_Heater)*TES_aux_cons_perc),Heater_cap_ud,$J6*Ratio_CSP_vs_Heater/Heater_eff))", "AZ" : "=MIN(TES_thermal_cap,SUMIF($D$5:$D$8763,\"=\"&$D6,AY$5:AY$8763)*Heater_eff*(1+1/Ratio_CSP_vs_Heater))", "BA" : "=MAX(0,SUMIF($D$5:$D$8763,\"=\"&$D6,AY$5:AY$8763)*Heater_eff*(1+1/Ratio_CSP_vs_Heater)-TES_thermal_cap)", "BB" : "=IF(OR(AND(BA6>0,AY6>0,AY5=0),AND(BA6>0,AY7=0,AY6>0)),AY6,0)", "BC" : "=MAX(0,BA6-SUMIF($D$5:$D$8763,\"=\"&$D6,BB$5:BB$8763)*Heater_eff*(1+1/Ratio_CSP_vs_Heater))", "BD" : "=IF(AZ6=0,0,$AY6-IF(BA6=0,0,(BA6-BC6)/(SUMIF($D$5:$D$8763,\"=\"&$D6,BB$5:BB$8763)*Heater_eff*(1+1/Ratio_CSP_vs_Heater))*BB6))", "BE" : "=IF(OR($BD6=0,BC6=0),0,MAX(($AW6-$BD6)/(BC6/(1+1/Ratio_CSP_vs_Heater)/Heater_eff/COUNTIFS($D$5:$D$8763,\"=\"&$D6,$BD$4:$BD$8762,\">0\")),($J6-$BD6*Heater_eff/Ratio_CSP_vs_Heater)/(BC6/(1+Ratio_CSP_vs_Heater)/COUNTIFS($D$5:$D$8763,\"=\"&$D6,$BD$5:$BD$8763,\">0\")))/SUMIF($D$5:$D$8763,\"=\"&$D6,$BD$5:$BD$8763)*$BD6)", "BF" : "=IF(AZ6=0,0,BD6-IF(BC6=0,0,BC6/(1+1/Ratio_CSP_vs_Heater)/Heater_eff/SUMIF($D$5:$D$8763,\"=\"&$D6,BE$5:BE$8763)*BE6))", "BG" : "=MIN($J6,BF6*Heater_eff/Ratio_CSP_vs_Heater)", "BH" : "=AX6+(BF6*Heater_eff+BG6)*TES_aux_cons_perc", "BI" : "=MAX(0,AW6-BF6-BH6)", "BJ" : "=$J6-BG6", "BK" : "=MAX(0,-(AW6-BF6-BH6))", "BL" : "=IF(MIN(Overall_harmonious_var_max_cons+Overall_fix_cons,BI6+Grid_import_max_ud*Grid_import_yes_no_PB_strategy-PB_stby_aux_cons,MIN(BJ6+El_boiler_cap_ud*El_boiler_eff,(BI6+Grid_import_max_ud*Grid_import_yes_no_PB_strategy-PB_stby_aux_cons)/(Overall_harmonious_var_max_cons+Overall_fix_cons+PB_stby_aux_cons+MAX(0,(Overall_harmonious_var_heat_max_cons+Overall_heat_fix_cons-BJ6))/El_boiler_eff)*(Overall_harmonious_var_heat_max_cons+Overall_heat_fix_cons))/(Overall_harmonious_var_heat_max_cons+Overall_heat_fix_cons)*(Overall_harmonious_var_max_cons+Overall_fix_cons))<Overall_harmonious_var_min_cons+Overall_fix_cons,0,Overall_harmonious_var_min_cons+Overall_fix_cons)", "BM" : "=IF(AND(BL6>0,BL5=0,OR(BL6=0,BL7=0)),0,BL6)", "BN" : "=BM6/(Overall_harmonious_var_max_cons+Overall_fix_cons)*(Overall_harmonious_var_heat_max_cons+Overall_heat_fix_cons)", "BO" : "=IF(AND(BM5<=0,BM6>0),BO5+1,IF(AND(BI5<=0,BI6>0,COUNTIF(BM6:BM15,\"=0\")=10,COUNTIF(BI6:BI15,\">0\")>5),BO5+1,BO5))", "BP" : "=MAX(0,BI6-BK6-BM6-MAX(0,(BN6-BJ6)/El_boiler_eff))", "BQ" : "=MAX(0,BJ6-BN6)", "BR" : "=MAX(0,-(BI6-BK6-BM6-MAX(0,(BN6-BJ6)/El_boiler_eff)))", "BS" : "=Grid_import_max_ud-BR6",  "BU" : "=IF($BM6>0,0,IF(A_overall_var_min_cons+A_overall_fix_stby_cons+$BK6+IF($BM7=0,0,A_overall_stup_cons)+MAX(0,A_overall_var_heat_min_cons+A_overall_heat_fix_stby_cons+IF($BM7=0,0,A_overall_heat_stup_cons)-$BQ6)/El_boiler_eff<$BP6-PB_stby_aux_cons,0,A_overall_var_min_cons+A_overall_fix_stby_cons+IF($BM7=0,0,A_overall_stup_cons)))", "BV" : "=IF(AND(BU7>0,BU6=0,BU5>0),BU5,BU6)", "BW" : "=IF(BV6=0,0,$BK6+((MIN(PB_nom_net_cap,MAX(PB_net_min_cap,(1+TES_aux_cons_perc)*(BV6+$BK6-$BP6)))+PB_nom_net_cap*PB_nom_var_aux_cons_perc_net*POLY(MIN(PB_nom_net_cap,MAX(PB_net_min_cap,(1+TES_aux_cons_perc)*(BV6+$BK6-$BP6)))/PB_nom_net_cap,PB_n2g_var_aux_el_Coeff)+PB_fix_aux_el)/(PB_gross_min_eff+(PB_nom_gross_eff-PB_gross_min_eff)/(PB_nom_net_cap-PB_net_min_cap)*(MIN(PB_nom_net_cap,MAX(0,BV6+$BK6-$BP6))-PB_net_min_cap))+MAX(0,A_overall_var_heat_min_cons+A_overall_heat_fix_stby_cons-$BQ6)*PB_Ratio_Heat_input_vs_output)*TES_aux_cons_perc+IF(AND(BV6=0,BV7>0),MAX(0,IF(COUNTIF(BV$1:BV6,\"0\")=PB_warm_start_duration,PB_warm_start_heat_req,PB_hot_start_heat_req)-$BQ6)*TES_aux_cons_perc,0))", "BX" : "=IF(BV6=0,0,MAX(PB_net_min_cap,MIN(PB_nom_net_cap,BV6+BW6-$BP6)))", "BY" : "=IF(BX6=0,0,BX6+PB_nom_net_cap*PB_nom_var_aux_cons_perc_net*POLY(BX6/PB_nom_net_cap,PB_n2g_var_aux_el_Coeff)+PB_fix_aux_el)", "BZ" : "=IF(AND(BY6=0,BY7>0),IF(COUNTIF(BY1:BY6,\"0\")=PB_warm_start_duration,PB_warm_start_heat_req,PB_hot_start_heat_req),0)", "CA" : "=IF(BY6=0,0,BY6/PB_nom_gross_eff/POLY(BY6/PB_nom_gross_cap_ud,el_Coeff))", "CB" : "=IF(CA6=0,0,MAX(0,PB_Ratio_Heat_input_vs_output*(MIN(A_overall_var_heat_min_cons+A_overall_heat_fix_stby_cons+IF($BM7=0,0,A_overall_heat_stup_cons),(BX6-BW6+$BP6)/(A_overall_var_min_cons+A_overall_fix_stby_cons+IF($BM7=0,0,A_overall_stup_cons))*(A_overall_var_heat_min_cons+A_overall_heat_fix_stby_cons+IF($BM7=0,0,A_overall_heat_stup_cons)))-$BQ6-MAX(0,BX6-BV6-BW6)*El_boiler_eff)))", "CC" : "=IF(MIN(SUMIF($BO$5:$BO$8763,\"=\"&$BO6,$AY$5:$AY$8763)*Heater_eff*(1+1/Ratio_CSP_vs_Heater),TES_thermal_cap)<SUMIF($BO$5:$BO$8763,\"=\"&$BO6,BZ$5:BZ$8763)+SUMIF($BO$5:$BO$8763,\"=\"&$BO6,CA$5:CA$8763)+SUMIF($BO$5:$BO$8763,\"=\"&$BO6,CB$5:CB$8763),0,SUMIF($BO$5:$BO$8763,\"=\"&$BO6,BZ$5:BZ$8763)+SUMIF($BO$5:$BO$8763,\"=\"&$BO6,CA$5:CA$8763)+SUMIF($BO$5:$BO$8763,\"=\"&$BO6,CB$5:CB$8763))", "CD" : "=IF(CC6=0,0,MAX(0,SUMIF($BO$5:$BO$8763,\"=\"&$BO6,$AY$5:$AY$8763)*Heater_eff*(1+1/Ratio_CSP_vs_Heater)-CC6))", "CE" : "=IF(OR(AND(CD6>0,$AY6>0,$AY5=0),AND(CD6>0,$AY7=0,$AY6>0)),$AY6,0)", "CF" : "=MAX(0,CD6-SUMIF($BO$5:$BO$8763,\"=\"&$BO6,CE$5:CE$8763)*Heater_eff*(1+1/Ratio_CSP_vs_Heater))", "CG" : "=IF(CD6=0,0,$AY6-(CD6-CF6)/(SUMIF($BO$5:$BO$8763,\"=\"&$BO6,CE$5:CE$8763)*Heater_eff*(1+1/Ratio_CSP_vs_Heater))*CE6)", "CH" : "=IF(OR(CG6=0,CF6=0),0,MAX(($AW6-CG6)/(CF6/(1+1/Ratio_CSP_vs_Heater)/Heater_eff/COUNTIFS($BO$5:$BO$8763,\"=\"&$BO6,CG$5:CG$8763,\">0\")),($J6-CG6*Heater_eff/Ratio_CSP_vs_Heater)/(CF6/(1+Ratio_CSP_vs_Heater)/COUNTIFS($BO$5:$BO$8763,\"=\"&$BO6,CG$5:CG$8763,\">0\")))/SUMIF($BO$5:$BO$8763,\"=\"&$BO6,CG$5:CG$8763)*CG6)", "CI" : "=IF(CC6=0,0,CG6-IF(CF6=0,0,CF6/(1+1/Ratio_CSP_vs_Heater)/Heater_eff/SUMIF($BO$5:$BO$8763,\"=\"&$BO6,CH$5:CH$8763)*CH6))", "CJ" : "=MIN($J6,CI6*Heater_eff/Ratio_CSP_vs_Heater)", "CK" : "=MAX(0,$L6-CI6)", "CL" : "=MAX(0,$J6-CJ6)", "CM" : "=IF($J6>0,$J6*CSP_var_aux_nom_perc,CSP_nonsolar_aux_cons)+$M6+(CI6*Heater_eff+CJ6)*TES_aux_cons_perc+IF(OR(BY6=0,AND(BY6>0,CC6=0)),PB_stby_aux_cons+BZ6*TES_aux_cons_perc,(BZ6+CA6+CB6)*TES_aux_cons_perc)", "CN" : "=MAX(0,-($L6+IF(CC6>0,BX6,0)-CI6-CM6))",  "CP" : "=IF(MIN(Overall_harmonious_var_max_cons+Overall_fix_cons,CK6+Grid_import_max_ud*Grid_import_yes_no_PB_strategy-(CM6-CN6),MIN(CL6+El_boiler_cap_ud*El_boiler_eff,(CK6+Grid_import_max_ud*Grid_import_yes_no_PB_strategy-(CM6-CN6))/(Overall_harmonious_var_max_cons+Overall_fix_cons+(CM6-CN6)+MAX(0,(Overall_harmonious_var_heat_max_cons+Overall_heat_fix_cons-CL6))/El_boiler_eff)*(Overall_harmonious_var_heat_max_cons+Overall_heat_fix_cons))/(Overall_harmonious_var_heat_max_cons+Overall_heat_fix_cons)*(Overall_harmonious_var_max_cons+Overall_fix_cons))<Overall_harmonious_var_min_cons+Overall_fix_cons,0,Overall_harmonious_var_min_cons+Overall_fix_cons)", "CQ" : "=IF(AND(CP6>0,CP5=0,OR(CP6=0,CP7=0)),0,CP6)", "CR" : "=CQ6/(Overall_harmonious_var_max_cons+Overall_fix_cons)*(Overall_harmonious_var_heat_max_cons+Overall_heat_fix_cons)", "CS" : "=IF(AND(CQ5<=0,CQ6>0),CS5+1,IF(AND(CK6>0,$BO6<>$BO5,SUM(CQ6:CQ8)=0),CS5+1,CS5))", "CT" : "=IF(OR(CQ6>0,CC6=0),0,MIN((BX6+CK6+(CL6+CB6/PB_Ratio_Heat_input_vs_output)/El_boiler_eff-(CM6-CN6))/(A_overall_var_min_cons+A_overall_fix_stby_cons+IF(CQ7=0,0,A_overall_stup_cons)+(A_overall_var_heat_min_cons+A_overall_heat_fix_stby_cons+IF(CR7=0,0,A_overall_heat_stup_cons))/El_boiler_eff)*(A_overall_var_min_cons+A_overall_fix_stby_cons+IF(CQ7=0,0,A_overall_stup_cons)),A_overall_var_min_cons+A_overall_fix_stby_cons+IF(CQ7=0,0,A_overall_stup_cons)))", "CU" : "=IF(CT6=0,0,MIN((BX6+CK6+(CL6+CB6/PB_Ratio_Heat_input_vs_output)/El_boiler_eff-(CM6-CN6))/(A_overall_var_min_cons+A_overall_fix_stby_cons+IF(CQ7=0,0,A_overall_stup_cons)+(A_overall_var_heat_min_cons+A_overall_heat_fix_stby_cons+IF(CR7=0,0,A_overall_heat_stup_cons))/El_boiler_eff)*(A_overall_var_heat_min_cons+A_overall_heat_fix_stby_cons+IF(CR7=0,0,A_overall_heat_stup_cons)),A_overall_var_heat_min_cons+A_overall_heat_fix_stby_cons+IF(CR7=0,0,A_overall_heat_stup_cons)))", "CV" : "=MAX(0,IF(CC6>0,BX6,0)+CK6-(CM6-CN6)-CQ6-CT6-MAX(0,(CR6+CU6-IF(CC6>0,CB6/PB_Ratio_Heat_input_vs_output,0)-CL6)/El_boiler_eff))", "CW" : "=MAX(0,CL6+IF(CC6=0,0,CB6/PB_Ratio_Heat_input_vs_output)-CR6-CU6)", "CX" : "=MAX(0,-(IF(CC6>0,BX6,0)+CK6-(CM6-CN6)-CQ6-CT6-MAX(0,(CR6+CU6-IF(CC6>0,CB6/PB_Ratio_Heat_input_vs_output,0)-CL6)/El_boiler_eff)))", "CY" : "=Grid_import_max_ud-CX6", "CZ" : "=MIN(El_boiler_cap_ud,MAX(0,(CR6+CU6-CL6-IF(CC6>0,CB6/PB_Ratio_Heat_input_vs_output,0))/El_boiler_eff))", "DA" : "=MAX(0,El_boiler_cap_ud-CZ6)", "DB" : "=MAX(0,1-((MAX(0,CQ6-Overall_fix_cons)-Overall_harmonious_var_min_cons)/(Overall_harmonious_var_max_cons-Overall_harmonious_var_min_cons)*(MethSynt_harmonious_max_perc-MethSynt_harmonious_min_perc)+MethSynt_harmonious_min_perc))*MethSynt_RawMeth_nom_prod_ud", "DC" : "=MAX(0,1-((MAX(0,CQ6-Overall_fix_cons)-Overall_harmonious_var_min_cons)/(Overall_harmonious_var_max_cons-Overall_harmonious_var_min_cons)*(CCU_harmonious_max_perc-CCU_harmonious_min_perc)+CCU_harmonious_min_perc))*CCU_CO2_nom_prod_ud", "DD" : "=MAX(0,1-((MAX(0,CQ6-Overall_fix_cons)-Overall_harmonious_var_min_cons)/(Overall_harmonious_var_max_cons-Overall_harmonious_var_min_cons)*(EY_harmonious_max_perc-EY_harmonious_min_perc)+EY_harmonious_min_perc))*EY_Hydrogen_nom_prod", "DE" : "=MIN(BESS_chrg_max_cons,CV6)", "DF" : "=MIN(Grid_export_max_ud,CV6)", "DG" : "=IF(MIN(Overall_harmonious_var_max_cons+Overall_fix_cons,CK6+Grid_import_max_ud*Grid_import_yes_no_PB_strategy-(CM6-CN6),MIN(CL6+El_boiler_cap_ud*El_boiler_eff,(CK6+Grid_import_max_ud*Grid_import_yes_no_PB_strategy-(CM6-CN6))/(Overall_harmonious_var_max_cons+Overall_fix_cons+(CM6-CN6)+MAX(0,(Overall_harmonious_var_heat_max_cons+Overall_heat_fix_cons-CL6))/El_boiler_eff)*(Overall_harmonious_var_heat_max_cons+Overall_heat_fix_cons))/(Overall_harmonious_var_heat_max_cons+Overall_heat_fix_cons)*(Overall_harmonious_var_max_cons+Overall_fix_cons))<Overall_harmonious_var_min_cons+Overall_fix_cons,0,MIN(Overall_harmonious_var_max_cons+Overall_fix_cons,CK6+Grid_import_max_ud*Grid_import_yes_no_PB_strategy-(CM6-CN6),MIN(CL6+El_boiler_cap_ud*El_boiler_eff,(CK6+Grid_import_max_ud*Grid_import_yes_no_PB_strategy-(CM6-CN6))/(Overall_harmonious_var_max_cons+Overall_fix_cons+(CM6-CN6)+MAX(0,(Overall_harmonious_var_heat_max_cons+Overall_heat_fix_cons-CL6))/El_boiler_eff)*(Overall_harmonious_var_heat_max_cons+Overall_heat_fix_cons))/(Overall_harmonious_var_heat_max_cons+Overall_heat_fix_cons)*(Overall_harmonious_var_max_cons+Overall_fix_cons)))", "DH" : "=IF(AND(DG6>0,DG5=0,OR(DG6=0,DG7=0)),0,DG6)", "DI" : "=DH6/(Overall_harmonious_var_max_cons+Overall_fix_cons)*(Overall_harmonious_var_heat_max_cons+Overall_heat_fix_cons)", "DJ" : "=MAX(0,IF(CC6>0,BX6,0)+CK6-(CM6-CN6)-DH6-CT6-MAX(0,(DI6+CU6-IF(CC6>0,CB6/PB_Ratio_Heat_input_vs_output,0)-CL6)/El_boiler_eff))", "DK" : "=MAX(0,CL6+IF(CC6=0,0,CB6/PB_Ratio_Heat_input_vs_output)-DI6-CU6)", "DL" : "=MAX(0,-(IF(CC6>0,BX6,0)+CK6-(CM6-CN6)-DH6-CT6-MAX(0,(DI6+CU6-IF(CC6>0,CB6/PB_Ratio_Heat_input_vs_output,0)-CL6)/El_boiler_eff)))", "DM" : "=Grid_import_max_ud-DL6", "DN" : "=MIN(El_boiler_cap_ud,MAX(0,(DI6+CU6-CL6-IF(CC6>0,CB6/PB_Ratio_Heat_input_vs_output,0))/El_boiler_eff))", "DO" : "=MAX(0,El_boiler_cap_ud-DN6)", "DP" : "=MAX(0,1-((MAX(0,DH6-Overall_fix_cons)-Overall_harmonious_var_min_cons)/(Overall_harmonious_var_max_cons-Overall_harmonious_var_min_cons)*(MethSynt_harmonious_max_perc-MethSynt_harmonious_min_perc)+MethSynt_harmonious_min_perc))*MethSynt_RawMeth_nom_prod_ud", "DQ" : "=MAX(0,1-((MAX(0,DH6-Overall_fix_cons)-Overall_harmonious_var_min_cons)/(Overall_harmonious_var_max_cons-Overall_harmonious_var_min_cons)*(CCU_harmonious_max_perc-CCU_harmonious_min_perc)+CCU_harmonious_min_perc))*CCU_CO2_nom_prod_ud", "DR" : "=MAX(0,1-((MAX(0,DH6-Overall_fix_cons)-Overall_harmonious_var_min_cons)/(Overall_harmonious_var_max_cons-Overall_harmonious_var_min_cons)*(EY_harmonious_max_perc-EY_harmonious_min_perc)+EY_harmonious_min_perc))*EY_Hydrogen_nom_prod", "DS" : "=MIN(BESS_chrg_max_cons,DJ6)", "DT" : "=MIN(Grid_export_max_ud,DJ6)",  "DV" : "=VLOOKUP($BO6,DailyCalc_1$A$3:$R$367,COLUMN(DailyCalc_1R$3))", "DW" : "=IF($BM6>0,0,IF(((A_overall_var_max_cons-A_overall_var_min_cons)*(DV6-A_equiv_harmonious_min_perc)+A_overall_var_min_cons)+A_overall_fix_stby_cons+$BK6+IF($BM7=0,0,A_overall_stup_cons)+MAX(0,((A_overall_var_heat_max_cons-A_overall_var_heat_min_cons)*(DV6-A_equiv_harmonious_min_perc)+A_overall_var_heat_min_cons)+A_overall_heat_fix_stby_cons+IF($BM7=0,0,A_overall_heat_stup_cons)-$BQ6)/El_boiler_eff<$BP6-PB_stby_aux_cons,0,((A_overall_var_max_cons-A_overall_var_min_cons)*(DV6-A_equiv_harmonious_min_perc)+A_overall_var_min_cons)+A_overall_fix_stby_cons+IF($BM7=0,0,A_overall_stup_cons)))", "DX" : "=IF(AND(DW7>0,DW6=0,DW5>0),DW5,DW6)", "DY" : "=IF(DX6=0,0,$BK6+((MIN(PB_nom_net_cap,MAX(PB_net_min_cap,(1+TES_aux_cons_perc)*(DX6+$BK6-$BP6)))+PB_nom_net_cap*PB_nom_var_aux_cons_perc_net*POLY(MIN(PB_nom_net_cap,MAX(PB_net_min_cap,(1+TES_aux_cons_perc)*(DX6+$BK6-$BP6)))/PB_nom_net_cap,PB_n2g_var_aux_el_Coeff)+PB_fix_aux_el)/(PB_gross_min_eff+(PB_nom_gross_eff-PB_gross_min_eff)/(PB_nom_net_cap-PB_net_min_cap)*(MIN(PB_nom_net_cap,MAX(0,DX6+$BK6-$BP6))-PB_net_min_cap))+MAX(0,((A_overall_var_heat_max_cons-A_overall_var_heat_min_cons)*(DV6-A_equiv_harmonious_min_perc)+A_overall_var_heat_min_cons)+A_overall_heat_fix_stby_cons-$BQ6)*PB_Ratio_Heat_input_vs_output)*TES_aux_cons_perc+IF(AND(DX6=0,DX7>0),MAX(0,IF(COUNTIF(DX$1:DX6,\"0\")=PB_warm_start_duration,PB_warm_start_heat_req,PB_hot_start_heat_req)-$BQ6)*TES_aux_cons_perc,0))", "DZ" : "=IF(DX6=0,0,MAX(PB_net_min_cap,MIN(PB_nom_net_cap,DX6+DY6-$BP6)))", "EA" : "=IF(DZ6=0,0,DZ6+PB_nom_net_cap*PB_nom_var_aux_cons_perc_net*POLY(DZ6/PB_nom_net_cap,PB_n2g_var_aux_el_Coeff)+PB_fix_aux_el)", "EB" : "=IF(AND(EA6=0,EA7>0),IF(COUNTIF(EA1:EA6,\"0\")=PB_warm_start_duration,PB_warm_start_heat_req,PB_hot_start_heat_req),0)", "EC" : "=IF(EA6=0,0,EA6/PB_nom_gross_eff/POLY(EA6/PB_nom_gross_cap_ud,el_Coeff))", "ED" : "=IF(EC6=0,0,MAX(0,PB_Ratio_Heat_input_vs_output*(MIN(((A_overall_var_heat_max_cons-A_overall_var_heat_min_cons)*(DV6-A_equiv_harmonious_min_perc)+A_overall_var_heat_min_cons)+A_overall_heat_fix_stby_cons+IF($BM7=0,0,A_overall_heat_stup_cons),(DZ6-DY6+$BP6)/(((A_overall_var_max_cons-A_overall_var_min_cons)*(DV6-A_equiv_harmonious_min_perc)+A_overall_var_min_cons)+A_overall_fix_stby_cons+IF($BM7=0,0,A_overall_stup_cons))*(((A_overall_var_heat_max_cons-A_overall_var_heat_min_cons)*(DV6-A_equiv_harmonious_min_perc)+A_overall_var_heat_min_cons)+A_overall_heat_fix_stby_cons+IF($BM7=0,0,A_overall_heat_stup_cons)))-$BQ6-MAX(0,DZ6-DX6-DY6)*El_boiler_eff)))", "EE" : "=IF(CC6=0,0,MIN(SUMIF($BO$5:$BO$8763,\"=\"&$BO6,$AY$5:$AY$8763)*Heater_eff*(1+1/Ratio_CSP_vs_Heater),TES_thermal_cap,SUMIF($BO$5:$BO$8763,\"=\"&$BO6,EB$5:EB$8763)+SUMIF($BO$5:$BO$8763,\"=\"&$BO6,EC$5:EC$8763)+SUMIF($BO$5:$BO$8763,\"=\"&$BO6,ED$5:ED$8763)))", "EF" : "=IF(EE6=0,0,(EE6-SUMIF($BO$5:$BO$8763,\"=\"&$BO6,EB$5:EB$8763))/(SUMIF($BO$5:$BO$8763,\"=\"&$BO6,EC$5:EC$8763)+SUMIF($BO$5:$BO$8763,\"=\"&$BO6,ED$5:ED$8763))*EC6)", "EG" : "=IF(EF6=0,0,EF6*PB_nom_gross_eff*POLY(EF6/PB_nom_heat_cons,th_Coeff))", "EH" : "=IF(EG6=0,0,EG6-PB_nom_net_cap*PB_nom_var_aux_cons_perc_net*POLY(EG6/PB_nom_gross_cap_ud,PB_g2n_var_aux_el_Coeff)-PB_fix_aux_el)", "EI" : "=IF(EE6=0,0,(EE6-SUMIF($BO$5:$BO$8763,\"=\"&$BO6,EB$5:EB$8763))/(SUMIF($BO$5:$BO$8763,\"=\"&$BO6,EC$5:EC$8763)+SUMIF($BO$5:$BO$8763,\"=\"&$BO6,ED$5:ED$8763))*ED6)", "EJ" : "=IF(MIN(SUMIF($BO$5:$BO$8763,\"=\"&$BO6,$AY$5:$AY$8763)*Heater_eff*(1+1/Ratio_CSP_vs_Heater),TES_thermal_cap)<SUMIF($BO$5:$BO$8763,\"=\"&$BO6,EB$5:EB$8763)+SUMIF($BO$5:$BO$8763,\"=\"&$BO6,EC$5:EC$8763)+SUMIF($BO$5:$BO$8763,\"=\"&$BO6,ED$5:ED$8763),EE6,SUMIF($BO$5:$BO$8763,\"=\"&$BO6,EB$5:EB$8763)+SUMIF($BO$5:$BO$8763,\"=\"&$BO6,EC$5:EC$8763)+SUMIF($BO$5:$BO$8763,\"=\"&$BO6,ED$5:ED$8763))", "EK" : "=IF(EJ6=0,0,MAX(0,SUMIF($BO$5:$BO$8763,\"=\"&$BO6,$AY$5:$AY$8763)*Heater_eff*(1+1/Ratio_CSP_vs_Heater)-EJ6))", "EL" : "=IF(OR(AND(EK6>0,$AY6>0,$AY5=0),AND(EK6>0,$AY7=0,$AY6>0)),$AY6,0)", "EM" : "=MAX(0,EK6-SUMIF($BO$5:$BO$8763,\"=\"&$BO6,EL$5:EL$8763)*Heater_eff*(1+1/Ratio_CSP_vs_Heater))", "EN" : "=IF(EK6=0,0,$AY6-(EK6-EM6)/(SUMIF($BO$5:$BO$8763,\"=\"&$BO6,EL$5:EL$8763)*Heater_eff*(1+1/Ratio_CSP_vs_Heater))*EL6)", "EO" : "=IF(OR(EN6=0,EM6=0),0,MAX(($AW6-EN6)/(EM6/(1+1/Ratio_CSP_vs_Heater)/Heater_eff/COUNTIFS($BO$5:$BO$8763,\"=\"&$BO6,EN$5:EN$8763,\">0\")),($J6-EN6*Heater_eff/Ratio_CSP_vs_Heater)/(EM6/(1+Ratio_CSP_vs_Heater)/COUNTIFS($BO$5:$BO$8763,\"=\"&$BO6,EN$5:EN$8763,\">0\")))/SUMIF($BO$5:$BO$8763,\"=\"&$BO6,EN$5:EN$8763)*EN6)", "EP" : "=IF(EJ6=0,0,EN6-IF(EM6=0,0,EM6/(1+1/Ratio_CSP_vs_Heater)/Heater_eff/SUMIF($BO$5:$BO$8763,\"=\"&$BO6,EO$5:EO$8763)*EO6))", "EQ" : "=MIN($J6,EP6*Heater_eff/Ratio_CSP_vs_Heater)", "ER" : "=MAX(0,$L6-EP6)", "ES" : "=MAX(0,$J6-EQ6)", "ET" : "=IF($J6>0,$J6*CSP_var_aux_nom_perc,CSP_nonsolar_aux_cons)+$M6+(EP6*Heater_eff+EQ6)*TES_aux_cons_perc+IF(EH6=0,PB_stby_aux_cons+EB6*TES_aux_cons_perc,(EB6+EF6+EI6)*TES_aux_cons_perc)", "EU" : "=MAX(0,-($L6+IF(EJ6>0,DZ6,0)-EP6-ET6))",  "EW" : "=IF(MIN(Overall_harmonious_var_max_cons+Overall_fix_cons,ER6+Grid_import_max_ud*Grid_import_yes_no_PB_strategy-(ET6-EU6),MIN(ES6+El_boiler_cap_ud*El_boiler_eff,(ER6+Grid_import_max_ud*Grid_import_yes_no_PB_strategy-(ET6-EU6))/(Overall_harmonious_var_max_cons+Overall_fix_cons+(ET6-EU6)+MAX(0,(Overall_harmonious_var_heat_max_cons+Overall_heat_fix_cons-ES6))/El_boiler_eff)*(Overall_harmonious_var_heat_max_cons+Overall_heat_fix_cons))/(Overall_harmonious_var_heat_max_cons+Overall_heat_fix_cons)*(Overall_harmonious_var_max_cons+Overall_fix_cons))<Overall_harmonious_var_min_cons+Overall_fix_cons,0,Overall_harmonious_var_min_cons+Overall_fix_cons)", "EX" : "=IF(AND(EW6>0,EW5=0,OR(EW6=0,EW7=0)),0,EW6)", "EY" : "=EX6/(Overall_harmonious_var_max_cons+Overall_fix_cons)*(Overall_harmonious_var_heat_max_cons+Overall_heat_fix_cons)", "EZ" : "=IF(AND(EX5<=0,EX6>0),EZ5+1,IF(AND(ER6>0,$BO6<>$BO5,SUM(EX6:EX8)=0),EZ5+1,EZ5))", "FA" : "=IF(OR(EX6>0,EJ6=0),0,MIN((EH6+ER6+(ES6+EI6/PB_Ratio_Heat_input_vs_output)/El_boiler_eff-(ET6-EU6))/(((A_overall_var_max_cons-A_overall_var_min_cons)*(DV6-A_equiv_harmonious_min_perc)+A_overall_var_min_cons)+A_overall_fix_stby_cons+IF(EX7=0,0,A_overall_stup_cons)+(((A_overall_var_heat_max_cons-A_overall_var_heat_min_cons)*(DV6-A_equiv_harmonious_min_perc)+A_overall_var_heat_min_cons)+A_overall_heat_fix_stby_cons+IF(EY7=0,0,A_overall_heat_stup_cons))/El_boiler_eff)*(((A_overall_var_max_cons-A_overall_var_min_cons)*(DV6-A_equiv_harmonious_min_perc)+A_overall_var_min_cons)+A_overall_fix_stby_cons+IF(EX7=0,0,A_overall_stup_cons)),((A_overall_var_max_cons-A_overall_var_min_cons)*(DV6-A_equiv_harmonious_min_perc)+A_overall_var_min_cons)+A_overall_fix_stby_cons+IF(EX7=0,0,A_overall_stup_cons)))", "FB" : "=IF(FA6=0,0,MIN((EH6+ER6+(ES6+EI6/PB_Ratio_Heat_input_vs_output)/El_boiler_eff-(ET6-EU6))/(((A_overall_var_max_cons-A_overall_var_min_cons)*(DV6-A_equiv_harmonious_min_perc)+A_overall_var_min_cons)+A_overall_fix_stby_cons+IF(EX7=0,0,A_overall_stup_cons)+(((A_overall_var_heat_max_cons-A_overall_var_heat_min_cons)*(DV6-A_equiv_harmonious_min_perc)+A_overall_var_heat_min_cons)+A_overall_heat_fix_stby_cons+IF(EY7=0,0,A_overall_heat_stup_cons))/El_boiler_eff)*(((A_overall_var_heat_max_cons-A_overall_var_heat_min_cons)*(DV6-A_equiv_harmonious_min_perc)+A_overall_var_heat_min_cons)+A_overall_heat_fix_stby_cons+IF(EY7=0,0,A_overall_heat_stup_cons)),((A_overall_var_heat_max_cons-A_overall_var_heat_min_cons)*(DV6-A_equiv_harmonious_min_perc)+A_overall_var_heat_min_cons)+A_overall_heat_fix_stby_cons+IF(EY7=0,0,A_overall_heat_stup_cons)))", "FC" : "=MAX(0,EH6+ER6-(ET6-EU6)-EX6-FA6-MAX(0,(EY6+FB6-EI6/PB_Ratio_Heat_input_vs_output-ES6)/El_boiler_eff))", "FD" : "=MAX(0,ES6+EI6/PB_Ratio_Heat_input_vs_output-EY6-FB6)", "FE" : "=MAX(0,-(EH6+ER6-(ET6-EU6)-EX6-FA6-MAX(0,(EY6+FB6-EI6/PB_Ratio_Heat_input_vs_output-ES6)/El_boiler_eff)))", "FF" : "=Grid_import_max_ud-FE6", "FG" : "=MIN(El_boiler_cap_ud,MAX(0,(EY6+FB6-ES6-EI6/PB_Ratio_Heat_input_vs_output)/El_boiler_eff))", "FH" : "=MAX(0,El_boiler_cap_ud-FG6)", "FI" : "=MAX(0,1-((MAX(0,EX6-Overall_fix_cons)-Overall_harmonious_var_min_cons)/(Overall_harmonious_var_max_cons-Overall_harmonious_var_min_cons)*(MethSynt_harmonious_max_perc-MethSynt_harmonious_min_perc)+MethSynt_harmonious_min_perc))*MethSynt_RawMeth_nom_prod_ud", "FJ" : "=MAX(0,1-((MAX(0,EX6-Overall_fix_cons)-Overall_harmonious_var_min_cons)/(Overall_harmonious_var_max_cons-Overall_harmonious_var_min_cons)*(CCU_harmonious_max_perc-CCU_harmonious_min_perc)+CCU_harmonious_min_perc))*CCU_CO2_nom_prod_ud", "FK" : "=MAX(0,1-((MAX(0,EX6-Overall_fix_cons)-Overall_harmonious_var_min_cons)/(Overall_harmonious_var_max_cons-Overall_harmonious_var_min_cons)*(EY_harmonious_max_perc-EY_harmonious_min_perc)+EY_harmonious_min_perc))*EY_Hydrogen_nom_prod", "FL" : "=MIN(BESS_chrg_max_cons,FC6)", "FM" : "=MIN(Grid_export_max_ud,FC6)", "FN" : "=IF(MIN(Overall_harmonious_var_max_cons+Overall_fix_cons,ER6+Grid_import_max_ud*Grid_import_yes_no_PB_strategy-(ET6-EU6),MIN(ES6+El_boiler_cap_ud*El_boiler_eff,(ER6+Grid_import_max_ud*Grid_import_yes_no_PB_strategy-(ET6-EU6))/(Overall_harmonious_var_max_cons+Overall_fix_cons+(ET6-EU6)+MAX(0,(Overall_harmonious_var_heat_max_cons+Overall_heat_fix_cons-ES6))/El_boiler_eff)*(Overall_harmonious_var_heat_max_cons+Overall_heat_fix_cons))/(Overall_harmonious_var_heat_max_cons+Overall_heat_fix_cons)*(Overall_harmonious_var_max_cons+Overall_fix_cons))<Overall_harmonious_var_min_cons+Overall_fix_cons,0,MIN(Overall_harmonious_var_max_cons+Overall_fix_cons,ER6+Grid_import_max_ud*Grid_import_yes_no_PB_strategy-(ET6-EU6),MIN(ES6+El_boiler_cap_ud*El_boiler_eff,(ER6+Grid_import_max_ud*Grid_import_yes_no_PB_strategy-(ET6-EU6))/(Overall_harmonious_var_max_cons+Overall_fix_cons+(ET6-EU6)+MAX(0,(Overall_harmonious_var_heat_max_cons+Overall_heat_fix_cons-ES6))/El_boiler_eff)*(Overall_harmonious_var_heat_max_cons+Overall_heat_fix_cons))/(Overall_harmonious_var_heat_max_cons+Overall_heat_fix_cons)*(Overall_harmonious_var_max_cons+Overall_fix_cons)))", "FO" : "=IF(AND(FN6>0,FN5=0,OR(FN6=0,FN7=0)),0,FN6)", "FP" : "=FO6/(Overall_harmonious_var_max_cons+Overall_fix_cons)*(Overall_harmonious_var_heat_max_cons+Overall_heat_fix_cons)", "FQ" : "=MAX(0,EH6+ER6-(ET6-EU6)-FO6-FA6-MAX(0,(FP6+FB6-EI6/PB_Ratio_Heat_input_vs_output-ES6)/El_boiler_eff))", "FR" : "=MAX(0,ES6+EI6/PB_Ratio_Heat_input_vs_output-FP6-FB6)", "FS" : "=MAX(0,-(EH6+ER6-(ET6-EU6)-FO6-FA6-MAX(0,(FP6+FB6-EI6/PB_Ratio_Heat_input_vs_output-ES6)/El_boiler_eff)))", "FT" : "=Grid_import_max_ud-FS6", "FU" : "=MIN(El_boiler_cap_ud,MAX(0,(FP6+FB6-ES6-EI6/PB_Ratio_Heat_input_vs_output)/El_boiler_eff))", "FV" : "=MAX(0,El_boiler_cap_ud-FU6)", "FW" : "=MAX(0,1-((MAX(0,FO6-Overall_fix_cons)-Overall_harmonious_var_min_cons)/(Overall_harmonious_var_max_cons-Overall_harmonious_var_min_cons)*(MethSynt_harmonious_max_perc-MethSynt_harmonious_min_perc)+MethSynt_harmonious_min_perc))*MethSynt_RawMeth_nom_prod_ud", "FX" : "=MAX(0,1-((MAX(0,FO6-Overall_fix_cons)-Overall_harmonious_var_min_cons)/(Overall_harmonious_var_max_cons-Overall_harmonious_var_min_cons)*(CCU_harmonious_max_perc-CCU_harmonious_min_perc)+CCU_harmonious_min_perc))*CCU_CO2_nom_prod_ud", "FY" : "=MAX(0,1-((MAX(0,FO6-Overall_fix_cons)-Overall_harmonious_var_min_cons)/(Overall_harmonious_var_max_cons-Overall_harmonious_var_min_cons)*(EY_harmonious_max_perc-EY_harmonious_min_perc)+EY_harmonious_min_perc))*EY_Hydrogen_nom_prod", "FZ" : "=MIN(BESS_chrg_max_cons,FQ6)", "GA" : "=MIN(Grid_export_max_ud,FQ6)",  "GC" : "=IF($BM6>0,0,IF(B_overall_var_min_cons+B_overall_fix_stby_cons+$BK6+IF($BM7=0,0,B_overall_stup_cons)+MAX(0,B_overall_var_heat_min_cons+B_overall_heat_fix_stby_cons+IF($BM7=0,0,B_overall_heat_stup_cons)-$BQ6)/El_boiler_eff<$BP6-PB_stby_aux_cons,0,B_overall_var_min_cons+B_overall_fix_stby_cons+IF($BM7=0,0,B_overall_stup_cons)))", "GD" : "=IF(AND(GC7>0,GC6=0,GC5>0),GC5,GC6)", "GE" : "=IF(GD6=0,0,$BK6+((MIN(PB_nom_net_cap,MAX(PB_net_min_cap,(1+TES_aux_cons_perc)*(GD6+$BK6-$BP6)))+PB_nom_net_cap*PB_nom_var_aux_cons_perc_net*POLY(MIN(PB_nom_net_cap,MAX(PB_net_min_cap,(1+TES_aux_cons_perc)*(GD6+$BK6-$BP6)))/PB_nom_net_cap,PB_n2g_var_aux_el_Coeff)+PB_fix_aux_el)/(PB_gross_min_eff+(PB_nom_gross_eff-PB_gross_min_eff)/(PB_nom_net_cap-PB_net_min_cap)*(MIN(PB_nom_net_cap,MAX(0,GD6+$BK6-$BP6))-PB_net_min_cap))+MAX(0,B_overall_var_heat_min_cons+B_overall_heat_fix_stby_cons-$BQ6)*PB_Ratio_Heat_input_vs_output)*TES_aux_cons_perc+IF(AND(GD6=0,GD7>0),MAX(0,IF(COUNTIF(GD1:GD6,\"0\")=PB_warm_start_duration,PB_warm_start_heat_req,PB_hot_start_heat_req)-$BQ6)*TES_aux_cons_perc,0))", "GF" : "=IF(GD6=0,0,MAX(PB_net_min_cap,MIN(PB_nom_net_cap,GD6+GE6-$BP6)))", "GG" : "=IF(GF6=0,0,GF6+PB_nom_net_cap*PB_nom_var_aux_cons_perc_net*POLY(GF6/PB_nom_net_cap,PB_n2g_var_aux_el_Coeff)+PB_fix_aux_el)", "GH" : "=IF(AND(GG6=0,GG7>0),IF(COUNTIF(GG1:GG6,\"0\")=PB_warm_start_duration,PB_warm_start_heat_req,PB_hot_start_heat_req),0)", "GI" : "=IF(GG6=0,0,GG6/PB_nom_gross_eff/POLY(GG6/PB_nom_gross_cap_ud,el_Coeff))", "GJ" : "=IF(GI6=0,0,MAX(0,PB_Ratio_Heat_input_vs_output*(MIN(B_overall_var_heat_min_cons+B_overall_heat_fix_stby_cons+IF($BM7=0,0,B_overall_heat_stup_cons),(GF6-GE6+$BP6)/(B_overall_var_min_cons+B_overall_fix_stby_cons+IF($BM7=0,0,B_overall_stup_cons))*(B_overall_var_heat_min_cons+B_overall_heat_fix_stby_cons+IF($BM7=0,0,B_overall_heat_stup_cons)))-$BQ6-MAX(0,GF6-GD6-GE6)*El_boiler_eff)))", "GK" : "=IF(MIN(SUMIF($BO$5:$BO$8763,\"=\"&$BO6,$AY$5:$AY$8763)*Heater_eff*(1+1/Ratio_CSP_vs_Heater),TES_thermal_cap)<SUMIF($BO$5:$BO$8763,\"=\"&$BO6,GH$5:GH$8763)+SUMIF($BO$5:$BO$8763,\"=\"&$BO6,GI$5:GI$8763)+SUMIF($BO$5:$BO$8763,\"=\"&$BO6,GJ$5:GJ$8763),0,SUMIF($BO$5:$BO$8763,\"=\"&$BO6,GH$5:GH$8763)+SUMIF($BO$5:$BO$8763,\"=\"&$BO6,GI$5:GI$8763)+SUMIF($BO$5:$BO$8763,\"=\"&$BO6,GJ$5:GJ$8763))", "GL" : "=IF(GK6=0,0,MAX(0,SUMIF($BO$5:$BO$8763,\"=\"&$BO6,$AY$5:$AY$8763)*Heater_eff*(1+1/Ratio_CSP_vs_Heater)-GK6))", "GM" : "=IF(OR(AND(GL6>0,$AY6>0,$AY5=0),AND(GL6>0,$AY7=0,$AY6>0)),$AY6,0)", "GN" : "=MAX(0,GL6-SUMIF($BO$5:$BO$8763,\"=\"&$BO6,GM$5:GM$8763)*Heater_eff*(1+1/Ratio_CSP_vs_Heater))", "GO" : "=IF(GL6=0,0,$AY6-(GL6-GN6)/(SUMIF($BO$5:$BO$8763,\"=\"&$BO6,GM$5:GM$8763)*Heater_eff*(1+1/Ratio_CSP_vs_Heater))*GM6)", "GP" : "=IF(OR(GO6=0,GN6=0),0,MAX(($AW6-GO6)/(GN6/(1+1/Ratio_CSP_vs_Heater)/Heater_eff/COUNTIFS($BO$5:$BO$8763,\"=\"&$BO6,GO$5:GO$8763,\">0\")),($J6-GO6*Heater_eff/Ratio_CSP_vs_Heater)/(GN6/(1+Ratio_CSP_vs_Heater)/COUNTIFS($BO$5:$BO$8763,\"=\"&$BO6,GO$5:GO$8763,\">0\")))/SUMIF($BO$5:$BO$8763,\"=\"&$BO6,GO$5:GO$8763)*GO6)", "GQ" : "=IF(GK6=0,0,GO6-IF(GN6=0,0,GN6/(1+1/Ratio_CSP_vs_Heater)/Heater_eff/SUMIF($BO$5:$BO$8763,\"=\"&$BO6,GP$5:GP$8763)*GP6))", "GR" : "=MIN($J6,GQ6*Heater_eff/Ratio_CSP_vs_Heater)", "GS" : "=MAX(0,$L6-GQ6)", "GT" : "=MAX(0,$J6-GR6)", "GU" : "=IF($J6>0,$J6*CSP_var_aux_nom_perc,CSP_nonsolar_aux_cons)+$M6+(GQ6*Heater_eff+GR6)*TES_aux_cons_perc+IF(OR(GG6=0,AND(GG6>0,GK6=0)),PB_stby_aux_cons+GH6*TES_aux_cons_perc,(GH6+GI6+GJ6)*TES_aux_cons_perc)", "GV" : "=MAX(0,-($L6+IF(GK6>0,GF6,0)-GQ6-GU6))",  "GX" : "=IF(MIN(Overall_harmonious_var_max_cons+Overall_fix_cons,GS6+Grid_import_max_ud*Grid_import_yes_no_PB_strategy-(GU6-GV6),MIN(GT6+El_boiler_cap_ud*El_boiler_eff,(GS6+Grid_import_max_ud*Grid_import_yes_no_PB_strategy-(GU6-GV6))/(Overall_harmonious_var_max_cons+Overall_fix_cons+(GU6-GV6)+MAX(0,(Overall_harmonious_var_heat_max_cons+Overall_heat_fix_cons-GT6))/El_boiler_eff)*(Overall_harmonious_var_heat_max_cons+Overall_heat_fix_cons))/(Overall_harmonious_var_heat_max_cons+Overall_heat_fix_cons)*(Overall_harmonious_var_max_cons+Overall_fix_cons))<Overall_harmonious_var_min_cons+Overall_fix_cons,0,Overall_harmonious_var_min_cons+Overall_fix_cons)", "GY" : "=IF(AND(GX6>0,GX5=0,OR(GX6=0,GX7=0)),0,GX6)", "GZ" : "=GY6/(Overall_harmonious_var_max_cons+Overall_fix_cons)*(Overall_harmonious_var_heat_max_cons+Overall_heat_fix_cons)", "HA" : "=IF(AND(GY5<=0,GY6>0),HA5+1,IF(AND(GS6>0,$BO6<>$BO5,SUM(GY6:GY8)=0),HA5+1,HA5))", "HB" : "=IF(OR(GY6>0,GK6=0),0,MIN((GF6+GS6+(GT6+GJ6/PB_Ratio_Heat_input_vs_output)/El_boiler_eff-(GU6-GV6))/(B_overall_var_min_cons+B_overall_fix_stby_cons+IF(GY7=0,0,B_overall_stup_cons)+(B_overall_var_heat_min_cons+B_overall_heat_fix_stby_cons+IF(GZ7=0,0,B_overall_heat_stup_cons))/El_boiler_eff)*(B_overall_var_min_cons+B_overall_fix_stby_cons+IF(GY7=0,0,B_overall_stup_cons)),B_overall_var_min_cons+B_overall_fix_stby_cons+IF(GY7=0,0,B_overall_stup_cons)))", "HC" : "=IF(HB6=0,0,MIN((GF6+GS6+(GT6+GJ6/PB_Ratio_Heat_input_vs_output)/El_boiler_eff-(GU6-GV6))/(B_overall_var_min_cons+B_overall_fix_stby_cons+IF(GY7=0,0,B_overall_stup_cons)+(B_overall_var_heat_min_cons+B_overall_heat_fix_stby_cons+IF(GZ7=0,0,B_overall_heat_stup_cons))/El_boiler_eff)*(B_overall_var_heat_min_cons+B_overall_heat_fix_stby_cons+IF(GZ7=0,0,B_overall_heat_stup_cons)),B_overall_var_heat_min_cons+B_overall_heat_fix_stby_cons+IF(GZ7=0,0,B_overall_heat_stup_cons)))", "HD" : "=MAX(0,IF(GK6>0,GF6,0)+GS6-(GU6-GV6)-GY6-HB6-MAX(0,(GZ6+HC6-IF(GK6>0,GJ6/PB_Ratio_Heat_input_vs_output,0)-GT6)/El_boiler_eff))", "HE" : "=MAX(0,GT6+IF(GK6=0,0,GJ6/PB_Ratio_Heat_input_vs_output)-GZ6-HC6)", "HF" : "=MAX(0,-(IF(GK6>0,GF6,0)+GS6-(GU6-GV6)-GY6-HB6-MAX(0,(GZ6+HC6-IF(GK6>0,GJ6/PB_Ratio_Heat_input_vs_output,0)-GT6)/El_boiler_eff)))", "HG" : "=Grid_import_max_ud-HF6", "HH" : "=MIN(El_boiler_cap_ud,MAX(0,(GZ6+HC6-GT6-IF(GK6>0,GJ6/PB_Ratio_Heat_input_vs_output,0))/El_boiler_eff))", "HI" : "=MAX(0,El_boiler_cap_ud-HH6)", "HJ" : "=MAX(0,1-GY6/(Overall_harmonious_var_max_cons+Overall_fix_cons)*MethSynt_harmonious_max_perc)*MethSynt_RawMeth_nom_prod_ud", "HK" : "=MAX(0,1-GY6/(Overall_harmonious_var_max_cons+Overall_fix_cons)*CCU_harmonious_max_perc)*CCU_CO2_nom_prod_ud", "HL" : "=MAX(0,1-GY6/(Overall_harmonious_var_max_cons+Overall_fix_cons)*EY_harmonious_max_perc)*EY_Hydrogen_nom_prod", "HM" : "=MIN(BESS_chrg_max_cons,HD6)", "HN" : "=MIN(Grid_export_max_ud,HD6)", "HO" : "=IF(MIN(Overall_harmonious_var_max_cons+Overall_fix_cons,GS6+Grid_import_max_ud*Grid_import_yes_no_PB_strategy-(GU6-GV6),MIN(GT6+El_boiler_cap_ud*El_boiler_eff,(GS6+Grid_import_max_ud*Grid_import_yes_no_PB_strategy-(GU6-GV6))/(Overall_harmonious_var_max_cons+Overall_fix_cons+(GU6-GV6)+MAX(0,(Overall_harmonious_var_heat_max_cons+Overall_heat_fix_cons-GT6))/El_boiler_eff)*(Overall_harmonious_var_heat_max_cons+Overall_heat_fix_cons))/(Overall_harmonious_var_heat_max_cons+Overall_heat_fix_cons)*(Overall_harmonious_var_max_cons+Overall_fix_cons))<Overall_harmonious_var_min_cons+Overall_fix_cons,0,MIN(Overall_harmonious_var_max_cons+Overall_fix_cons,GS6+Grid_import_max_ud*Grid_import_yes_no_PB_strategy-(GU6-GV6),MIN(GT6+El_boiler_cap_ud*El_boiler_eff,(GS6+Grid_import_max_ud*Grid_import_yes_no_PB_strategy-(GU6-GV6))/(Overall_harmonious_var_max_cons+Overall_fix_cons+(GU6-GV6)+MAX(0,(Overall_harmonious_var_heat_max_cons+Overall_heat_fix_cons-GT6))/El_boiler_eff)*(Overall_harmonious_var_heat_max_cons+Overall_heat_fix_cons))/(Overall_harmonious_var_heat_max_cons+Overall_heat_fix_cons)*(Overall_harmonious_var_max_cons+Overall_fix_cons)))", "HP" : "=IF(AND(HO6>0,HO5=0,OR(HO6=0,HO7=0)),0,HO6)", "HQ" : "=HP6/(Overall_harmonious_var_max_cons+Overall_fix_cons)*(Overall_harmonious_var_heat_max_cons+Overall_heat_fix_cons)", "HR" : "=MAX(0,IF(GK6>0,GF6,0)+GS6-(GU6-GV6)-HP6-HB6-MAX(0,(HQ6+HC6-IF(GK6>0,GJ6/PB_Ratio_Heat_input_vs_output,0)-GT6)/El_boiler_eff))", "HS" : "=MAX(0,GT6+IF(GK6=0,0,GJ6/PB_Ratio_Heat_input_vs_output)-HQ6-HC6)", "HT" : "=MAX(0,-(IF(GK6>0,GF6,0)+GS6-(GU6-GV6)-HP6-HB6-MAX(0,(HQ6+HC6-IF(GK6>0,GJ6/PB_Ratio_Heat_input_vs_output,0)-GT6)/El_boiler_eff)))", "HU" : "=Grid_import_max_ud-HT6", "HV" : "=MIN(El_boiler_cap_ud,MAX(0,(HQ6+HC6-GT6-IF(GK6>0,GJ6/PB_Ratio_Heat_input_vs_output,0))/El_boiler_eff))", "HW" : "=MAX(0,El_boiler_cap_ud-HV6)", "HX" : "=MAX(0,1-HP6/(Overall_harmonious_var_max_cons+Overall_fix_cons)*MethSynt_harmonious_max_perc)*MethSynt_RawMeth_nom_prod_ud", "HY" : "=MAX(0,1-HP6/(Overall_harmonious_var_max_cons+Overall_fix_cons)*CCU_harmonious_max_perc)*CCU_CO2_nom_prod_ud", "HZ" : "=MAX(0,1-HP6/(Overall_harmonious_var_max_cons+Overall_fix_cons)*EY_harmonious_max_perc)*EY_Hydrogen_nom_prod", "IA" : "=MIN(BESS_chrg_max_cons,HR6)", "IB" : "=MIN(Grid_export_max_ud,HR6)",  "ID" : "=VLOOKUP($BO6,DailyCalc_1$A$3:$BD$367,COLUMN(DailyCalc_1BD$3))", "IE" : "=IF($BM6>0,0,IF(B_overall_var_max_cons*ID6+B_overall_fix_stby_cons+$BK6+IF($BM7=0,0,B_overall_stup_cons)+MAX(0,B_overall_var_heat_max_cons*ID6+B_overall_heat_fix_stby_cons+IF($BM7=0,0,B_overall_heat_stup_cons)-$BQ6)/El_boiler_eff<$BP6-PB_stby_aux_cons,0,B_overall_var_max_cons*ID6+B_overall_fix_stby_cons+IF($BM7=0,0,B_overall_stup_cons)))", "IF" : "=IF(AND(IE7>0,IE6=0,IE5>0),IE5,IE6)", "IG" : "=IF(IF6=0,0,$BK6+((MIN(PB_nom_net_cap,MAX(PB_net_min_cap,(1+TES_aux_cons_perc)*(IF6+$BK6-$BP6)))+PB_nom_net_cap*PB_nom_var_aux_cons_perc_net*POLY(MIN(PB_nom_net_cap,MAX(PB_net_min_cap,(1+TES_aux_cons_perc)*(IF6+$BK6-$BP6)))/PB_nom_net_cap,PB_n2g_var_aux_el_Coeff)+PB_fix_aux_el)/(PB_gross_min_eff+(PB_nom_gross_eff-PB_gross_min_eff)/(PB_nom_net_cap-PB_net_min_cap)*(MIN(PB_nom_net_cap,MAX(0,IF6+$BK6-$BP6))-PB_net_min_cap))+MAX(0,B_overall_var_heat_max_cons*ID6+B_overall_heat_fix_stby_cons-$BQ6)*PB_Ratio_Heat_input_vs_output)*TES_aux_cons_perc+IF(AND(IF6=0,IF7>0),MAX(0,IF(COUNTIF(IF1:IF6,\"0\")=PB_warm_start_duration,PB_warm_start_heat_req,PB_hot_start_heat_req)-$BQ6)*TES_aux_cons_perc,0))", "IH" : "=IF(IF6=0,0,MAX(PB_net_min_cap,MIN(PB_nom_net_cap,IF6+IG6-$BP6)))", "II" : "=IF(IH6=0,0,IH6+PB_nom_net_cap*PB_nom_var_aux_cons_perc_net*POLY(IH6/PB_nom_net_cap,PB_n2g_var_aux_el_Coeff)+PB_fix_aux_el)", "IJ" : "=IF(AND(II6=0,II7>0),IF(COUNTIF(II1:II6,\"0\")=PB_warm_start_duration,PB_warm_start_heat_req,PB_hot_start_heat_req),0)", "IK" : "=IF(II6=0,0,II6/PB_nom_gross_eff/POLY(II6/PB_nom_gross_cap_ud,el_Coeff))", "IL" : "=IF(IK6=0,0,MAX(0,PB_Ratio_Heat_input_vs_output*(MIN(B_overall_var_heat_max_cons*ID6+B_overall_heat_fix_stby_cons+IF($BM7=0,0,B_overall_heat_stup_cons),(IH6-IG6+$BP6)/(B_overall_var_max_cons*ID6+B_overall_fix_stby_cons+IF($BM7=0,0,B_overall_stup_cons))*(B_overall_var_heat_max_cons*ID6+B_overall_heat_fix_stby_cons+IF($BM7=0,0,B_overall_heat_stup_cons)))-$BQ6-MAX(0,IH6-IF6-IG6)*El_boiler_eff)))", "IM" : "=IF(GK6=0,0,MIN(SUMIF($BO$5:$BO$8763,\"=\"&$BO6,$AY$5:$AY$8763)*Heater_eff*(1+1/Ratio_CSP_vs_Heater),TES_thermal_cap,SUMIF($BO$5:$BO$8763,\"=\"&$BO6,IJ$5:IJ$8763)+SUMIF($BO$5:$BO$8763,\"=\"&$BO6,IK$5:IK$8763)+SUMIF($BO$5:$BO$8763,\"=\"&$BO6,IL$5:IL$8763)))", "IN" : "=IF(IM6=0,0,(IM6-SUMIF($BO$5:$BO$8763,\"=\"&$BO6,IJ$5:IJ$8763))/(SUMIF($BO$5:$BO$8763,\"=\"&$BO6,IK$5:IK$8763)+SUMIF($BO$5:$BO$8763,\"=\"&$BO6,IL$5:IL$8763))*IK6)", "IO" : "=IF(IN6=0,0,IN6*PB_nom_gross_eff*POLY(IN6/PB_nom_heat_cons,th_Coeff))", "IP" : "=IF(IO6=0,0,IO6-PB_nom_net_cap*PB_nom_var_aux_cons_perc_net*POLY(IO6/PB_nom_gross_cap_ud,PB_g2n_var_aux_el_Coeff)-PB_fix_aux_el)", "IQ" : "=IF(IM6=0,0,(IM6-SUMIF($BO$5:$BO$8763,\"=\"&$BO6,IJ$5:IJ$8763))/(SUMIF($BO$5:$BO$8763,\"=\"&$BO6,IK$5:IK$8763)+SUMIF($BO$5:$BO$8763,\"=\"&$BO6,IL$5:IL$8763))*IL6)", "IR" : "=IF(MIN(SUMIF($BO$5:$BO$8763,\"=\"&$BO6,$AY$5:$AY$8763)*Heater_eff*(1+1/Ratio_CSP_vs_Heater),TES_thermal_cap)<SUMIF($BO$5:$BO$8763,\"=\"&$BO6,IJ$5:IJ$8763)+SUMIF($BO$5:$BO$8763,\"=\"&$BO6,IK$5:IK$8763)+SUMIF($BO$5:$BO$8763,\"=\"&$BO6,IL$5:IL$8763),IM6,SUMIF($BO$5:$BO$8763,\"=\"&$BO6,IJ$5:IJ$8763)+SUMIF($BO$5:$BO$8763,\"=\"&$BO6,IK$5:IK$8763)+SUMIF($BO$5:$BO$8763,\"=\"&$BO6,IL$5:IL$8763))", "IS" : "=IF(IR6=0,0,MAX(0,SUMIF($BO$5:$BO$8763,\"=\"&$BO6,$AY$5:$AY$8763)*Heater_eff*(1+1/Ratio_CSP_vs_Heater)-IR6))", "IT" : "=IF(OR(AND(IS6>0,$AY6>0,$AY5=0),AND(IS6>0,$AY7=0,$AY6>0)),$AY6,0)", "IU" : "=MAX(0,IS6-SUMIF($BO$5:$BO$8763,\"=\"&$BO6,IT$5:IT$8763)*Heater_eff*(1+1/Ratio_CSP_vs_Heater))", "IV" : "=IF(IS6=0,0,$AY6-(IS6-IU6)/(SUMIF($BO$5:$BO$8763,\"=\"&$BO6,IT$5:IT$8763)*Heater_eff*(1+1/Ratio_CSP_vs_Heater))*IT6)", "IW" : "=IF(OR(IV6=0,IU6=0),0,MAX(($AW6-IV6)/(IU6/(1+1/Ratio_CSP_vs_Heater)/Heater_eff/COUNTIFS($BO$5:$BO$8763,\"=\"&$BO6,IV$5:IV$8763,\">0\")),($J6-IV6*Heater_eff/Ratio_CSP_vs_Heater)/(IU6/(1+Ratio_CSP_vs_Heater)/COUNTIFS($BO$5:$BO$8763,\"=\"&$BO6,IV$5:IV$8763,\">0\")))/SUMIF($BO$5:$BO$8763,\"=\"&$BO6,IV$5:IV$8763)*IV6)", "IX" : "=IF(IR6=0,0,IV6-IF(IU6=0,0,IU6/(1+1/Ratio_CSP_vs_Heater)/Heater_eff/SUMIF($BO$5:$BO$8763,\"=\"&$BO6,IW$5:IW$8763)*IW6))", "IY" : "=MIN($J6,IX6*Heater_eff/Ratio_CSP_vs_Heater)", "IZ" : "=MAX(0,$L6-IX6)", "JA" : "=MAX(0,$J6-IY6)", "JB" : "=IF($J6>0,$J6*CSP_var_aux_nom_perc,CSP_nonsolar_aux_cons)+$M6+(IX6*Heater_eff+IY6)*TES_aux_cons_perc+IF(IP6=0,PB_stby_aux_cons+IJ6*TES_aux_cons_perc,(IJ6+IN6+IQ6)*TES_aux_cons_perc)", "JC" : "=MAX(0,-($L6+IF(IR6>0,IH6,0)-IX6-JB6))",  "JE" : "=IF(MIN(Overall_harmonious_var_max_cons+Overall_fix_cons,IZ6+Grid_import_max_ud*Grid_import_yes_no_PB_strategy-(JB6-JC6),MIN(JA6+El_boiler_cap_ud*El_boiler_eff,(IZ6+Grid_import_max_ud*Grid_import_yes_no_PB_strategy-(JB6-JC6))/(Overall_harmonious_var_max_cons+Overall_fix_cons+(JB6-JC6)+MAX(0,(Overall_harmonious_var_heat_max_cons+Overall_heat_fix_cons-JA6))/El_boiler_eff)*(Overall_harmonious_var_heat_max_cons+Overall_heat_fix_cons))/(Overall_harmonious_var_heat_max_cons+Overall_heat_fix_cons)*(Overall_harmonious_var_max_cons+Overall_fix_cons))<Overall_harmonious_var_min_cons+Overall_fix_cons,0,Overall_harmonious_var_min_cons+Overall_fix_cons)", "JF" : "=IF(AND(JE6>0,JE5=0,OR(JE6=0,JE7=0)),0,JE6)", "JG" : "=JF6/(Overall_harmonious_var_max_cons+Overall_fix_cons)*(Overall_harmonious_var_heat_max_cons+Overall_heat_fix_cons)", "JH" : "=IF(AND(JF5<=0,JF6>0),JH5+1,IF(AND(IZ6>0,$BO6<>$BO5,SUM(JF6:JF8)=0),JH5+1,JH5))", "JI" : "=IF(OR(JF6>0,IR6=0),0,MIN((IP6+IZ6+(JA6+IQ6/PB_Ratio_Heat_input_vs_output)/El_boiler_eff-(JB6-JC6))/(B_overall_var_max_cons*ID6+B_overall_fix_stby_cons+IF(JF7=0,0,B_overall_stup_cons)+(B_overall_var_heat_max_cons*ID6+B_overall_heat_fix_stby_cons+IF(JG7=0,0,B_overall_heat_stup_cons))/El_boiler_eff)*(B_overall_var_max_cons*ID6+B_overall_fix_stby_cons+IF(JF7=0,0,B_overall_stup_cons)),B_overall_var_max_cons*ID6+B_overall_fix_stby_cons+IF(JF7=0,0,B_overall_stup_cons)))", "JJ" : "=IF(JI6=0,0,MIN((IP6+IZ6+(JA6+IQ6/PB_Ratio_Heat_input_vs_output)/El_boiler_eff-(JB6-JC6))/(B_overall_var_max_cons*ID6+B_overall_fix_stby_cons+IF(JF7=0,0,B_overall_stup_cons)+(B_overall_var_heat_max_cons*ID6+B_overall_heat_fix_stby_cons+IF(JG7=0,0,B_overall_heat_stup_cons))/El_boiler_eff)*(B_overall_var_heat_max_cons*ID6+B_overall_heat_fix_stby_cons+IF(JG7=0,0,B_overall_heat_stup_cons)),B_overall_var_heat_max_cons*ID6+B_overall_heat_fix_stby_cons+IF(JG7=0,0,B_overall_heat_stup_cons)))", "JK" : "=MAX(0,IP6+IZ6-(JB6-JC6)-JF6-JI6-MAX(0,(JG6+JJ6-IQ6/PB_Ratio_Heat_input_vs_output-JA6)/El_boiler_eff))", "JL" : "=MAX(0,JA6+IQ6/PB_Ratio_Heat_input_vs_output-JG6-JJ6)", "JM" : "=MAX(0,-(IP6+IZ6-(JB6-JC6)-JF6-JI6-MAX(0,(JG6+JJ6-IQ6/PB_Ratio_Heat_input_vs_output-JA6)/El_boiler_eff)))", "JN" : "=Grid_import_max_ud-JM6", "JO" : "=MIN(El_boiler_cap_ud,MAX(0,(JG6+JJ6-JA6-IQ6/PB_Ratio_Heat_input_vs_output)/El_boiler_eff))", "JP" : "=MAX(0,El_boiler_cap_ud-JO6)", "JQ" : "=MAX(0,1-JF6/(Overall_harmonious_var_max_cons+Overall_fix_cons)*MethSynt_harmonious_max_perc)*MethSynt_RawMeth_nom_prod_ud", "JR" : "=MAX(0,1-JF6/(Overall_harmonious_var_max_cons+Overall_fix_cons)*CCU_harmonious_max_perc)*CCU_CO2_nom_prod_ud", "JS" : "=MAX(0,1-JF6/(Overall_harmonious_var_max_cons+Overall_fix_cons)*EY_harmonious_max_perc)*EY_Hydrogen_nom_prod", "JT" : "=MIN(BESS_chrg_max_cons,JK6)", "JU" : "=MIN(Grid_export_max_ud,JK6)", "JV" : "=IF(MIN(Overall_harmonious_var_max_cons+Overall_fix_cons,IZ6+Grid_import_max_ud*Grid_import_yes_no_PB_strategy-(JB6-JC6),MIN(JA6+El_boiler_cap_ud*El_boiler_eff,(IZ6+Grid_import_max_ud*Grid_import_yes_no_PB_strategy-(JB6-JC6))/(Overall_harmonious_var_max_cons+Overall_fix_cons+(JB6-JC6)+MAX(0,(Overall_harmonious_var_heat_max_cons+Overall_heat_fix_cons-JA6))/El_boiler_eff)*(Overall_harmonious_var_heat_max_cons+Overall_heat_fix_cons))/(Overall_harmonious_var_heat_max_cons+Overall_heat_fix_cons)*(Overall_harmonious_var_max_cons+Overall_fix_cons))<Overall_harmonious_var_min_cons+Overall_fix_cons,0,MIN(Overall_harmonious_var_max_cons+Overall_fix_cons,IZ6+Grid_import_max_ud*Grid_import_yes_no_PB_strategy-(JB6-JC6),MIN(JA6+El_boiler_cap_ud*El_boiler_eff,(IZ6+Grid_import_max_ud*Grid_import_yes_no_PB_strategy-(JB6-JC6))/(Overall_harmonious_var_max_cons+Overall_fix_cons+(JB6-JC6)+MAX(0,(Overall_harmonious_var_heat_max_cons+Overall_heat_fix_cons-JA6))/El_boiler_eff)*(Overall_harmonious_var_heat_max_cons+Overall_heat_fix_cons))/(Overall_harmonious_var_heat_max_cons+Overall_heat_fix_cons)*(Overall_harmonious_var_max_cons+Overall_fix_cons)))", "JW" : "=IF(AND(JV6>0,JV5=0,OR(JV6=0,JV7=0)),0,JV6)", "JX" : "=JW6/(Overall_harmonious_var_max_cons+Overall_fix_cons)*(Overall_harmonious_var_heat_max_cons+Overall_heat_fix_cons)", "JY" : "=MAX(0,IP6+IZ6-(JB6-JC6)-JW6-JI6-MAX(0,(JX6+JJ6-IQ6/PB_Ratio_Heat_input_vs_output-JA6)/El_boiler_eff))", "JZ" : "=MAX(0,JA6+IQ6/PB_Ratio_Heat_input_vs_output-JX6-JJ6)", "KA" : "=MAX(0,-(IP6+IZ6-(JB6-JC6)-JW6-JI6-MAX(0,(JX6+JJ6-IQ6/PB_Ratio_Heat_input_vs_output-JA6)/El_boiler_eff)))", "KB" : "=Grid_import_max_ud-KA6", "KC" : "=MIN(El_boiler_cap_ud,MAX(0,(JX6+JJ6-JA6-IQ6/PB_Ratio_Heat_input_vs_output)/El_boiler_eff))", "KD" : "=MAX(0,El_boiler_cap_ud-KC6)", "KE" : "=MAX(0,1-JW6/(Overall_harmonious_var_max_cons+Overall_fix_cons)*MethSynt_harmonious_max_perc)*MethSynt_RawMeth_nom_prod_ud", "KF" : "=MAX(0,1-JW6/(Overall_harmonious_var_max_cons+Overall_fix_cons)*CCU_harmonious_max_perc)*CCU_CO2_nom_prod_ud", "KG" : "=MAX(0,1-JW6/(Overall_harmonious_var_max_cons+Overall_fix_cons)*EY_harmonious_max_perc)*EY_Hydrogen_nom_prod", "KH" : "=MIN(BESS_chrg_max_cons,JY6)", "KI" : "=MIN(Grid_export_max_ud,JY6)",  "KK" : "=IF($BM6>0,0,IF(C_overall_var_min_cons+C_overall_fix_stby_cons+$BK6+IF($BM7=0,0,C_overall_stup_cons)+MAX(0,C_overall_var_heat_min_cons+C_overall_heat_fix_stby_cons+IF($BM7=0,0,C_overall_heat_stup_cons)-$BQ6)/El_boiler_eff<$BP6-PB_stby_aux_cons,0,C_overall_var_min_cons+C_overall_fix_stby_cons+IF($BM7=0,0,C_overall_stup_cons)))", "KL" : "=IF(AND(KK7>0,KK6=0,KK5>0),KK5,KK6)", "KM" : "=IF(KL6=0,0,$BK6+((MIN(PB_nom_net_cap,MAX(PB_net_min_cap,(1+TES_aux_cons_perc)*(KL6+$BK6-$BP6)))+PB_nom_net_cap*PB_nom_var_aux_cons_perc_net*POLY(MIN(PB_nom_net_cap,MAX(PB_net_min_cap,(1+TES_aux_cons_perc)*(KL6+$BK6-$BP6)))/PB_nom_net_cap,PB_n2g_var_aux_el_Coeff)+PB_fix_aux_el)/(PB_gross_min_eff+(PB_nom_gross_eff-PB_gross_min_eff)/(PB_nom_net_cap-PB_net_min_cap)*(MIN(PB_nom_net_cap,MAX(0,KL6+$BK6-$BP6))-PB_net_min_cap))+MAX(0,C_overall_var_heat_min_cons+C_overall_heat_fix_stby_cons-$BQ6)*PB_Ratio_Heat_input_vs_output)*TES_aux_cons_perc+IF(AND(KL6=0,KL7>0),MAX(0,IF(COUNTIF(KL1:KL6,\"0\")=PB_warm_start_duration,PB_warm_start_heat_req,PB_hot_start_heat_req)-$BQ6)*TES_aux_cons_perc,0))", "KN" : "=IF(KL6=0,0,MAX(PB_net_min_cap,MIN(PB_nom_net_cap,KL6+KM6-$BP6)))", "KO" : "=IF(KN6=0,0,KN6+PB_nom_net_cap*PB_nom_var_aux_cons_perc_net*POLY(KN6/PB_nom_net_cap,PB_n2g_var_aux_el_Coeff)+PB_fix_aux_el)", "KP" : "=IF(AND(KO6=0,KO7>0),IF(COUNTIF(KO1:KO6,\"0\")=PB_warm_start_duration,PB_warm_start_heat_req,PB_hot_start_heat_req),0)", "KQ" : "=IF(KO6=0,0,KO6/PB_nom_gross_eff/POLY(KO6/PB_nom_gross_cap_ud,el_Coeff))", "KR" : "=IF(KQ6=0,0,MAX(0,PB_Ratio_Heat_input_vs_output*(MIN(C_overall_var_heat_min_cons+C_overall_heat_fix_stby_cons+IF($BM7=0,0,C_overall_heat_stup_cons),(KN6-KM6+$BP6)/(C_overall_var_min_cons+C_overall_fix_stby_cons+IF($BM7=0,0,C_overall_stup_cons))*(C_overall_var_heat_min_cons+C_overall_heat_fix_stby_cons+IF($BM7=0,0,C_overall_heat_stup_cons)))-$BQ6-MAX(0,KN6-KL6-KM6)*El_boiler_eff)))", "KS" : "=IF(MIN(SUMIF($BO$5:$BO$8763,\"=\"&$BO6,$AY$5:$AY$8763)*Heater_eff*(1+1/Ratio_CSP_vs_Heater),TES_thermal_cap)<SUMIF($BO$5:$BO$8763,\"=\"&$BO6,KP$5:KP$8763)+SUMIF($BO$5:$BO$8763,\"=\"&$BO6,KQ$5:KQ$8763)+SUMIF($BO$5:$BO$8763,\"=\"&$BO6,KR$5:KR$8763),0,SUMIF($BO$5:$BO$8763,\"=\"&$BO6,KP$5:KP$8763)+SUMIF($BO$5:$BO$8763,\"=\"&$BO6,KQ$5:KQ$8763)+SUMIF($BO$5:$BO$8763,\"=\"&$BO6,KR$5:KR$8763))", "KT" : "=IF(KS6=0,0,MAX(0,SUMIF($BO$5:$BO$8763,\"=\"&$BO6,$AY$5:$AY$8763)*Heater_eff*(1+1/Ratio_CSP_vs_Heater)-KS6))", "KU" : "=IF(OR(AND(KT6>0,$AY6>0,$AY5=0),AND(KT6>0,$AY7=0,$AY6>0)),$AY6,0)", "KV" : "=MAX(0,KT6-SUMIF($BO$5:$BO$8763,\"=\"&$BO6,KU$5:KU$8763)*Heater_eff*(1+1/Ratio_CSP_vs_Heater))", "KW" : "=IF(KT6=0,0,$AY6-(KT6-KV6)/(SUMIF($BO$5:$BO$8763,\"=\"&$BO6,KU$5:KU$8763)*Heater_eff*(1+1/Ratio_CSP_vs_Heater))*KU6)", "KX" : "=IF(OR(KW6=0,KV6=0),0,MAX(($AW6-KW6)/(KV6/(1+1/Ratio_CSP_vs_Heater)/Heater_eff/COUNTIFS($BO$5:$BO$8763,\"=\"&$BO6,KW$5:KW$8763,\">0\")),($J6-KW6*Heater_eff/Ratio_CSP_vs_Heater)/(KV6/(1+Ratio_CSP_vs_Heater)/COUNTIFS($BO$5:$BO$8763,\"=\"&$BO6,KW$5:KW$8763,\">0\")))/SUMIF($BO$5:$BO$8763,\"=\"&$BO6,KW$5:KW$8763)*KW6)", "KY" : "=IF(KS6=0,0,KW6-IF(KV6=0,0,KV6/(1+1/Ratio_CSP_vs_Heater)/Heater_eff/SUMIF($BO$5:$BO$8763,\"=\"&$BO6,KX$5:KX$8763)*KX6))", "KZ" : "=MIN($J6,KY6*Heater_eff/Ratio_CSP_vs_Heater)", "LA" : "=MAX(0,$L6-KY6)", "LB" : "=MAX(0,$J6-KZ6)", "LC" : "=IF($J6>0,$J6*CSP_var_aux_nom_perc,CSP_nonsolar_aux_cons)+$M6+(KY6*Heater_eff+KZ6)*TES_aux_cons_perc+IF(OR(KO6=0,AND(KO6>0,KS6=0)),PB_stby_aux_cons+KP6*TES_aux_cons_perc,(KP6+KQ6+KR6)*TES_aux_cons_perc)", "LD" : "=MAX(0,-($L6+IF(KS6>0,KN6,0)-KY6-LC6))",  "LF" : "=IF(MIN(Overall_harmonious_var_max_cons+Overall_fix_cons,LA6+Grid_import_max_ud*Grid_import_yes_no_PB_strategy-(LC6-LD6),MIN(LB6+El_boiler_cap_ud*El_boiler_eff,(LA6+Grid_import_max_ud*Grid_import_yes_no_PB_strategy-(LC6-LD6))/(Overall_harmonious_var_max_cons+Overall_fix_cons+(LC6-LD6)+MAX(0,(Overall_harmonious_var_heat_max_cons+Overall_heat_fix_cons-LB6))/El_boiler_eff)*(Overall_harmonious_var_heat_max_cons+Overall_heat_fix_cons))/(Overall_harmonious_var_heat_max_cons+Overall_heat_fix_cons)*(Overall_harmonious_var_max_cons+Overall_fix_cons))<Overall_harmonious_var_min_cons+Overall_fix_cons,0,Overall_harmonious_var_min_cons+Overall_fix_cons)", "LG" : "=IF(AND(LF6>0,LF5=0,OR(LF6=0,LF7=0)),0,LF6)", "LH" : "=LG6/(Overall_harmonious_var_max_cons+Overall_fix_cons)*(Overall_harmonious_var_heat_max_cons+Overall_heat_fix_cons)", "LI" : "=IF(AND(LG5<=0,LG6>0),LI5+1,IF(AND(LA6>0,$BO6<>$BO5,SUM(LG6:LG8)=0),LI5+1,LI5))", "LJ" : "=IF(OR(LG6>0,KS6=0),0,MIN((KN6+LA6+(LB6+KR6/PB_Ratio_Heat_input_vs_output)/El_boiler_eff-(LC6-LD6))/(C_overall_var_min_cons+C_overall_fix_stby_cons+IF(LG7=0,0,C_overall_stup_cons)+(C_overall_var_heat_min_cons+C_overall_heat_fix_stby_cons+IF(LH7=0,0,C_overall_heat_stup_cons))/El_boiler_eff)*(C_overall_var_min_cons+C_overall_fix_stby_cons+IF(LG7=0,0,C_overall_stup_cons)),C_overall_var_min_cons+C_overall_fix_stby_cons+IF(LG7=0,0,C_overall_stup_cons)))", "LK" : "=IF(LJ6=0,0,MIN((KN6+LA6+(LB6+KR6/PB_Ratio_Heat_input_vs_output)/El_boiler_eff-(LC6-LD6))/(C_overall_var_min_cons+C_overall_fix_stby_cons+IF(LG7=0,0,C_overall_stup_cons)+(C_overall_var_heat_min_cons+C_overall_heat_fix_stby_cons+IF(LH7=0,0,C_overall_heat_stup_cons))/El_boiler_eff)*(C_overall_var_heat_min_cons+C_overall_heat_fix_stby_cons+IF(LH7=0,0,C_overall_heat_stup_cons)),C_overall_var_heat_min_cons+C_overall_heat_fix_stby_cons+IF(LH7=0,0,C_overall_heat_stup_cons)))", "LL" : "=MAX(0,IF(KS6>0,KN6,0)+LA6-(LC6-LD6)-LG6-LJ6-MAX(0,(LH6+LK6-IF(KS6>0,KR6/PB_Ratio_Heat_input_vs_output,0)-LB6)/El_boiler_eff))", "LM" : "=MAX(0,LB6+IF(KS6=0,0,KR6/PB_Ratio_Heat_input_vs_output)-LH6-LK6)", "LN" : "=MAX(0,-(IF(KS6>0,KN6,0)+LA6-(LC6-LD6)-LG6-LJ6-MAX(0,(LH6+LK6-IF(KS6>0,KR6/PB_Ratio_Heat_input_vs_output,0)-LB6)/El_boiler_eff)))", "LO" : "=Grid_import_max_ud-LN6", "LP" : "=MIN(El_boiler_cap_ud,MAX(0,(LH6+LK6-LB6-IF(KS6>0,KR6/PB_Ratio_Heat_input_vs_output,0))/El_boiler_eff))", "LQ" : "=MAX(0,El_boiler_cap_ud-LP6)", "LR" : "=MAX(0,1-LG6/(Overall_harmonious_var_max_cons+Overall_fix_cons)*MethSynt_harmonious_max_perc)*MethSynt_RawMeth_nom_prod_ud", "LS" : "=MAX(0,1-LG6/(Overall_harmonious_var_max_cons+Overall_fix_cons)*CCU_harmonious_max_perc)*CCU_CO2_nom_prod_ud", "LT" : "=MAX(0,1-LG6/(Overall_harmonious_var_max_cons+Overall_fix_cons)*EY_harmonious_max_perc)*EY_Hydrogen_nom_prod", "LU" : "=MIN(BESS_chrg_max_cons,LL6)", "LV" : "=MIN(Grid_export_max_ud,LL6)", "LW" : "=IF(MIN(Overall_harmonious_var_max_cons+Overall_fix_cons,LA6+Grid_import_max_ud*Grid_import_yes_no_PB_strategy-(LC6-LD6),MIN(LB6+El_boiler_cap_ud*El_boiler_eff,(LA6+Grid_import_max_ud*Grid_import_yes_no_PB_strategy-(LC6-LD6))/(Overall_harmonious_var_max_cons+Overall_fix_cons+(LC6-LD6)+MAX(0,(Overall_harmonious_var_heat_max_cons+Overall_heat_fix_cons-LB6))/El_boiler_eff)*(Overall_harmonious_var_heat_max_cons+Overall_heat_fix_cons))/(Overall_harmonious_var_heat_max_cons+Overall_heat_fix_cons)*(Overall_harmonious_var_max_cons+Overall_fix_cons))<Overall_harmonious_var_min_cons+Overall_fix_cons,0,MIN(Overall_harmonious_var_max_cons+Overall_fix_cons,LA6+Grid_import_max_ud*Grid_import_yes_no_PB_strategy-(LC6-LD6),MIN(LB6+El_boiler_cap_ud*El_boiler_eff,(LA6+Grid_import_max_ud*Grid_import_yes_no_PB_strategy-(LC6-LD6))/(Overall_harmonious_var_max_cons+Overall_fix_cons+(LC6-LD6)+MAX(0,(Overall_harmonious_var_heat_max_cons+Overall_heat_fix_cons-LB6))/El_boiler_eff)*(Overall_harmonious_var_heat_max_cons+Overall_heat_fix_cons))/(Overall_harmonious_var_heat_max_cons+Overall_heat_fix_cons)*(Overall_harmonious_var_max_cons+Overall_fix_cons)))", "LX" : "=IF(AND(LW6>0,LW5=0,OR(LW6=0,LW7=0)),0,LW6)", "LY" : "=LX6/(Overall_harmonious_var_max_cons+Overall_fix_cons)*(Overall_harmonious_var_heat_max_cons+Overall_heat_fix_cons)", "LZ" : "=MAX(0,IF(KS6>0,KN6,0)+LA6-(LC6-LD6)-LX6-LJ6-MAX(0,(LY6+LK6-IF(KS6>0,KR6/PB_Ratio_Heat_input_vs_output,0)-LB6)/El_boiler_eff))", "MA" : "=MAX(0,LB6+IF(KS6=0,0,KR6/PB_Ratio_Heat_input_vs_output)-LY6-LK6)", "MB" : "=MAX(0,-(IF(KS6>0,KN6,0)+LA6-(LC6-LD6)-LX6-LJ6-MAX(0,(LY6+LK6-IF(KS6>0,KR6/PB_Ratio_Heat_input_vs_output,0)-LB6)/El_boiler_eff)))", "MC" : "=Grid_import_max_ud-MB6", "MD" : "=MIN(El_boiler_cap_ud,MAX(0,(LY6+LK6-LB6-IF(KS6>0,KR6/PB_Ratio_Heat_input_vs_output,0))/El_boiler_eff))", "ME" : "=MAX(0,El_boiler_cap_ud-MD6)", "MF" : "=MAX(0,1-LX6/(Overall_harmonious_var_max_cons+Overall_fix_cons)*MethSynt_harmonious_max_perc)*MethSynt_RawMeth_nom_prod_ud", "MG" : "=MAX(0,1-LX6/(Overall_harmonious_var_max_cons+Overall_fix_cons)*CCU_harmonious_max_perc)*CCU_CO2_nom_prod_ud", "MH" : "=MAX(0,1-LX6/(Overall_harmonious_var_max_cons+Overall_fix_cons)*EY_harmonious_max_perc)*EY_Hydrogen_nom_prod", "MI" : "=MIN(BESS_chrg_max_cons,LZ6)", "MJ" : "=MIN(Grid_export_max_ud,LZ6)",  "ML" : "=VLOOKUP($BO6,DailyCalc_1$A$3:$CP$367,COLUMN(DailyCalc_1CP$3))", "MM" : "=IF($BM6>0,0,IF(C_overall_var_max_cons*ML6+C_overall_fix_stby_cons+$BK6+IF($BM7=0,0,C_overall_stup_cons)+MAX(0,C_overall_var_heat_max_cons*ML6+C_overall_heat_fix_stby_cons+IF($BM7=0,0,C_overall_heat_stup_cons)-$BQ6)/El_boiler_eff<$BP6-PB_stby_aux_cons,0,C_overall_var_max_cons*ML6+C_overall_fix_stby_cons+IF($BM7=0,0,C_overall_stup_cons)))", "MN" : "=IF(AND(MM7>0,MM6=0,MM5>0),MM5,MM6)", "MO" : "=IF(MN6=0,0,$BK6+((MIN(PB_nom_net_cap,MAX(PB_net_min_cap,(1+TES_aux_cons_perc)*(MN6+$BK6-$BP6)))+PB_nom_net_cap*PB_nom_var_aux_cons_perc_net*POLY(MIN(PB_nom_net_cap,MAX(PB_net_min_cap,(1+TES_aux_cons_perc)*(MN6+$BK6-$BP6)))/PB_nom_net_cap,PB_n2g_var_aux_el_Coeff)+PB_fix_aux_el)/(PB_gross_min_eff+(PB_nom_gross_eff-PB_gross_min_eff)/(PB_nom_net_cap-PB_net_min_cap)*(MIN(PB_nom_net_cap,MAX(0,MN6+$BK6-$BP6))-PB_net_min_cap))+MAX(0,C_overall_var_heat_max_cons*ML6+C_overall_heat_fix_stby_cons-$BQ6)*PB_Ratio_Heat_input_vs_output)*TES_aux_cons_perc+IF(AND(MN6=0,MN7>0),MAX(0,IF(COUNTIF(MN1:MN6,\"0\")=PB_warm_start_duration,PB_warm_start_heat_req,PB_hot_start_heat_req)-$BQ6)*TES_aux_cons_perc,0))", "MP" : "=IF(MN6=0,0,MAX(PB_net_min_cap,MIN(PB_nom_net_cap,MN6+MO6-$BP6)))", "MQ" : "=IF(MP6=0,0,MP6+PB_nom_net_cap*PB_nom_var_aux_cons_perc_net*POLY(MP6/PB_nom_net_cap,PB_n2g_var_aux_el_Coeff)+PB_fix_aux_el)", "MR" : "=IF(AND(MQ6=0,MQ7>0),IF(COUNTIF(MQ1:MQ6,\"0\")=PB_warm_start_duration,PB_warm_start_heat_req,PB_hot_start_heat_req),0)", "MS" : "=IF(MQ6=0,0,MQ6/PB_nom_gross_eff/POLY(MQ6/PB_nom_gross_cap_ud,el_Coeff))", "MT" : "=IF(MS6=0,0,MAX(0,PB_Ratio_Heat_input_vs_output*(MIN(C_overall_var_heat_max_cons*ML6+C_overall_heat_fix_stby_cons+IF($BM7=0,0,C_overall_heat_stup_cons),(MP6-MO6+$BP6)/(C_overall_var_max_cons*ML6+C_overall_fix_stby_cons+IF($BM7=0,0,C_overall_stup_cons))*(C_overall_var_heat_max_cons*ML6+C_overall_heat_fix_stby_cons+IF($BM7=0,0,C_overall_heat_stup_cons)))-$BQ6-MAX(0,MP6-MN6-MO6)*El_boiler_eff)))", "MU" : "=IF(KS6=0,0,MIN(SUMIF($BO$5:$BO$8763,\"=\"&$BO6,$AY$5:$AY$8763)*Heater_eff*(1+1/Ratio_CSP_vs_Heater),TES_thermal_cap,SUMIF($BO$5:$BO$8763,\"=\"&$BO6,MR$5:MR$8763)+SUMIF($BO$5:$BO$8763,\"=\"&$BO6,MS$5:MS$8763)+SUMIF($BO$5:$BO$8763,\"=\"&$BO6,MT$5:MT$8763)))", "MV" : "=IF(MU6=0,0,(MU6-SUMIF($BO$5:$BO$8763,\"=\"&$BO6,MR$5:MR$8763))/(SUMIF($BO$5:$BO$8763,\"=\"&$BO6,MS$5:MS$8763)+SUMIF($BO$5:$BO$8763,\"=\"&$BO6,MT$5:MT$8763))*MS6)", "MW" : "=IF(MV6=0,0,MV6*PB_nom_gross_eff*POLY(MV6/PB_nom_heat_cons,th_Coeff))", "MX" : "=IF(MW6=0,0,MW6-PB_nom_net_cap*PB_nom_var_aux_cons_perc_net*POLY(MW6/PB_nom_gross_cap_ud,PB_g2n_var_aux_el_Coeff)-PB_fix_aux_el)", "MY" : "=IF(MU6=0,0,(MU6-SUMIF($BO$5:$BO$8763,\"=\"&$BO6,MR$5:MR$8763))/(SUMIF($BO$5:$BO$8763,\"=\"&$BO6,MS$5:MS$8763)+SUMIF($BO$5:$BO$8763,\"=\"&$BO6,MT$5:MT$8763))*MT6)", "MZ" : "=IF(MIN(SUMIF($BO$5:$BO$8763,\"=\"&$BO6,$AY$5:$AY$8763)*Heater_eff*(1+1/Ratio_CSP_vs_Heater),TES_thermal_cap)<SUMIF($BO$5:$BO$8763,\"=\"&$BO6,MR$5:MR$8763)+SUMIF($BO$5:$BO$8763,\"=\"&$BO6,MS$5:MS$8763)+SUMIF($BO$5:$BO$8763,\"=\"&$BO6,MT$5:MT$8763),MU6,SUMIF($BO$5:$BO$8763,\"=\"&$BO6,MR$5:MR$8763)+SUMIF($BO$5:$BO$8763,\"=\"&$BO6,MS$5:MS$8763)+SUMIF($BO$5:$BO$8763,\"=\"&$BO6,MT$5:MT$8763))", "NA" : "=IF(MZ6=0,0,MAX(0,SUMIF($BO$5:$BO$8763,\"=\"&$BO6,$AY$5:$AY$8763)*Heater_eff*(1+1/Ratio_CSP_vs_Heater)-MZ6))", "NB" : "=IF(OR(AND(NA6>0,$AY6>0,$AY5=0),AND(NA6>0,$AY7=0,$AY6>0)),$AY6,0)", "NC" : "=MAX(0,NA6-SUMIF($BO$5:$BO$8763,\"=\"&$BO6,NB$5:NB$8763)*Heater_eff*(1+1/Ratio_CSP_vs_Heater))", "ND" : "=IF(NA6=0,0,$AY6-(NA6-NC6)/(SUMIF($BO$5:$BO$8763,\"=\"&$BO6,NB$5:NB$8763)*Heater_eff*(1+1/Ratio_CSP_vs_Heater))*NB6)", "NE" : "=IF(OR(ND6=0,NC6=0),0,MAX(($AW6-ND6)/(NC6/(1+1/Ratio_CSP_vs_Heater)/Heater_eff/COUNTIFS($BO$5:$BO$8763,\"=\"&$BO6,ND$5:ND$8763,\">0\")),($J6-ND6*Heater_eff/Ratio_CSP_vs_Heater)/(NC6/(1+Ratio_CSP_vs_Heater)/COUNTIFS($BO$5:$BO$8763,\"=\"&$BO6,ND$5:ND$8763,\">0\")))/SUMIF($BO$5:$BO$8763,\"=\"&$BO6,ND$5:ND$8763)*ND6)", "NF" : "=IF(MZ6=0,0,ND6-IF(NC6=0,0,NC6/(1+1/Ratio_CSP_vs_Heater)/Heater_eff/SUMIF($BO$5:$BO$8763,\"=\"&$BO6,NE$5:NE$8763)*NE6))", "NG" : "=MIN($J6,NF6*Heater_eff/Ratio_CSP_vs_Heater)", "NH" : "=MAX(0,$L6-NF6)", "NI" : "=MAX(0,$J6-NG6)", "NJ" : "=IF($J6>0,$J6*CSP_var_aux_nom_perc,CSP_nonsolar_aux_cons)+$M6+(NF6*Heater_eff+NG6)*TES_aux_cons_perc+IF(MX6=0,PB_stby_aux_cons+MR6*TES_aux_cons_perc,(MR6+MV6+MY6)*TES_aux_cons_perc)", "NK" : "=MAX(0,-($L6+IF(MZ6>0,MP6,0)-NF6-NJ6))",  "NM" : "=IF(MIN(Overall_harmonious_var_max_cons+Overall_fix_cons,NH6+Grid_import_max_ud*Grid_import_yes_no_PB_strategy-(NJ6-NK6),MIN(NI6+El_boiler_cap_ud*El_boiler_eff,(NH6+Grid_import_max_ud*Grid_import_yes_no_PB_strategy-(NJ6-NK6))/(Overall_harmonious_var_max_cons+Overall_fix_cons+(NJ6-NK6)+MAX(0,(Overall_harmonious_var_heat_max_cons+Overall_heat_fix_cons-NI6))/El_boiler_eff)*(Overall_harmonious_var_heat_max_cons+Overall_heat_fix_cons))/(Overall_harmonious_var_heat_max_cons+Overall_heat_fix_cons)*(Overall_harmonious_var_max_cons+Overall_fix_cons))<Overall_harmonious_var_min_cons+Overall_fix_cons,0,Overall_harmonious_var_min_cons+Overall_fix_cons)", "NN" : "=IF(AND(NM6>0,NM5=0,OR(NM6=0,NM7=0)),0,NM6)", "NO" : "=NN6/(Overall_harmonious_var_max_cons+Overall_fix_cons)*(Overall_harmonious_var_heat_max_cons+Overall_heat_fix_cons)", "NP" : "=IF(AND(NN5<=0,NN6>0),NP5+1,IF(AND(NH6>0,$BO6<>$BO5,SUM(NN6:NN8)=0),NP5+1,NP5))", "NQ" : "=IF(OR(NN6>0,MZ6=0),0,MIN((MX6+NH6+(NI6+MY6/PB_Ratio_Heat_input_vs_output)/El_boiler_eff-(NJ6-NK6))/(C_overall_var_max_cons*ML6+C_overall_fix_stby_cons+IF(NN7=0,0,C_overall_stup_cons)+(C_overall_var_heat_max_cons*ML6+C_overall_heat_fix_stby_cons+IF(NO7=0,0,C_overall_heat_stup_cons))/El_boiler_eff)*(C_overall_var_max_cons*ML6+C_overall_fix_stby_cons+IF(NN7=0,0,C_overall_stup_cons)),C_overall_var_max_cons*ML6+C_overall_fix_stby_cons+IF(NN7=0,0,C_overall_stup_cons)))", "NR" : "=IF(NQ6=0,0,MIN((MX6+NH6+(NI6+MY6/PB_Ratio_Heat_input_vs_output)/El_boiler_eff-(NJ6-NK6))/(C_overall_var_max_cons*ML6+C_overall_fix_stby_cons+IF(NN7=0,0,C_overall_stup_cons)+(C_overall_var_heat_max_cons*ML6+C_overall_heat_fix_stby_cons+IF(NO7=0,0,C_overall_heat_stup_cons))/El_boiler_eff)*(C_overall_var_heat_max_cons*ML6+C_overall_heat_fix_stby_cons+IF(NO7=0,0,C_overall_heat_stup_cons)),C_overall_var_heat_max_cons*ML6+C_overall_heat_fix_stby_cons+IF(NO7=0,0,C_overall_heat_stup_cons)))", "NS" : "=MAX(0,MX6+NH6-(NJ6-NK6)-NN6-NQ6-MAX(0,(NO6+NR6-MY6/PB_Ratio_Heat_input_vs_output-NI6)/El_boiler_eff))", "NT" : "=MAX(0,NI6+MY6/PB_Ratio_Heat_input_vs_output-NO6-NR6)", "NU" : "=MAX(0,-(MX6+NH6-(NJ6-NK6)-NN6-NQ6-MAX(0,(NO6+NR6-MY6/PB_Ratio_Heat_input_vs_output-NI6)/El_boiler_eff)))", "NV" : "=Grid_import_max_ud-NU6", "NW" : "=MIN(El_boiler_cap_ud,MAX(0,(NO6+NR6-NI6-MY6/PB_Ratio_Heat_input_vs_output)/El_boiler_eff))", "NX" : "=MAX(0,El_boiler_cap_ud-NW6)", "NY" : "=MAX(0,1-NN6/(Overall_harmonious_var_max_cons+Overall_fix_cons)*MethSynt_harmonious_max_perc)*MethSynt_RawMeth_nom_prod_ud", "NZ" : "=MAX(0,1-NN6/(Overall_harmonious_var_max_cons+Overall_fix_cons)*CCU_harmonious_max_perc)*CCU_CO2_nom_prod_ud", "OA" : "=MAX(0,1-NN6/(Overall_harmonious_var_max_cons+Overall_fix_cons)*EY_harmonious_max_perc)*EY_Hydrogen_nom_prod", "OB" : "=MIN(BESS_chrg_max_cons,NS6)", "OC" : "=MIN(Grid_export_max_ud,NS6)", "OD" : "=IF(MIN(Overall_harmonious_var_max_cons+Overall_fix_cons,NH6+Grid_import_max_ud*Grid_import_yes_no_PB_strategy-(NJ6-NK6),MIN(NI6+El_boiler_cap_ud*El_boiler_eff,(NH6+Grid_import_max_ud*Grid_import_yes_no_PB_strategy-(NJ6-NK6))/(Overall_harmonious_var_max_cons+Overall_fix_cons+(NJ6-NK6)+MAX(0,(Overall_harmonious_var_heat_max_cons+Overall_heat_fix_cons-NI6))/El_boiler_eff)*(Overall_harmonious_var_heat_max_cons+Overall_heat_fix_cons))/(Overall_harmonious_var_heat_max_cons+Overall_heat_fix_cons)*(Overall_harmonious_var_max_cons+Overall_fix_cons))<Overall_harmonious_var_min_cons+Overall_fix_cons,0,MIN(Overall_harmonious_var_max_cons+Overall_fix_cons,NH6+Grid_import_max_ud*Grid_import_yes_no_PB_strategy-(NJ6-NK6),MIN(NI6+El_boiler_cap_ud*El_boiler_eff,(NH6+Grid_import_max_ud*Grid_import_yes_no_PB_strategy-(NJ6-NK6))/(Overall_harmonious_var_max_cons+Overall_fix_cons+(NJ6-NK6)+MAX(0,(Overall_harmonious_var_heat_max_cons+Overall_heat_fix_cons-NI6))/El_boiler_eff)*(Overall_harmonious_var_heat_max_cons+Overall_heat_fix_cons))/(Overall_harmonious_var_heat_max_cons+Overall_heat_fix_cons)*(Overall_harmonious_var_max_cons+Overall_fix_cons)))", "OE" : "=IF(AND(OD6>0,OD5=0,OR(OD6=0,OD7=0)),0,OD6)", "OF" : "=OE6/(Overall_harmonious_var_max_cons+Overall_fix_cons)*(Overall_harmonious_var_heat_max_cons+Overall_heat_fix_cons)", "OG" : "=MAX(0,MX6+NH6-(NJ6-NK6)-OE6-NQ6-MAX(0,(OF6+NR6-MY6/PB_Ratio_Heat_input_vs_output-NI6)/El_boiler_eff))", "OH" : "=MAX(0,NI6+MY6/PB_Ratio_Heat_input_vs_output-OF6-NR6)", "OI" : "=MAX(0,-(MX6+NH6-(NJ6-NK6)-OE6-NQ6-MAX(0,(OF6+NR6-MY6/PB_Ratio_Heat_input_vs_output-NI6)/El_boiler_eff)))", "OJ" : "=Grid_import_max_ud-OI6", "OK" : "=MIN(El_boiler_cap_ud,MAX(0,(OF6+NR6-NI6-MY6/PB_Ratio_Heat_input_vs_output)/El_boiler_eff))", "OL" : "=MAX(0,El_boiler_cap_ud-OK6)", "OM" : "=MAX(0,1-OE6/(Overall_harmonious_var_max_cons+Overall_fix_cons)*MethSynt_harmonious_max_perc)*MethSynt_RawMeth_nom_prod_ud", "ON" : "=MAX(0,1-OE6/(Overall_harmonious_var_max_cons+Overall_fix_cons)*CCU_harmonious_max_perc)*CCU_CO2_nom_prod_ud", "OO" : "=MAX(0,1-OE6/(Overall_harmonious_var_max_cons+Overall_fix_cons)*EY_harmonious_max_perc)*EY_Hydrogen_nom_prod", "OP" : "=MIN(BESS_chrg_max_cons,OG6)", "OQ" : "=MIN(Grid_export_max_ud,OG6)",  "OS" : "=IF($BM6>0,0,IF(D_overall_var_min_cons+D_overall_fix_stby_cons+$BK6+IF($BM7=0,0,D_overall_stup_cons)+MAX(0,D_overall_var_heat_min_cons+D_overall_heat_fix_stby_cons+IF($BM7=0,0,D_overall_heat_stup_cons)-$BQ6)/El_boiler_eff<$BP6-PB_stby_aux_cons,0,D_overall_var_min_cons+D_overall_fix_stby_cons+IF($BM7=0,0,D_overall_stup_cons)))", "OT" : "=IF(AND(OS7>0,OS6=0,OS5>0),OS5,OS6)", "OU" : "=IF(OT6=0,0,$BK6+((MIN(PB_nom_net_cap,MAX(PB_net_min_cap,(1+TES_aux_cons_perc)*(OT6+$BK6-$BP6)))+PB_nom_net_cap*PB_nom_var_aux_cons_perc_net*POLY(MIN(PB_nom_net_cap,MAX(PB_net_min_cap,(1+TES_aux_cons_perc)*(OT6+$BK6-$BP6)))/PB_nom_net_cap,PB_n2g_var_aux_el_Coeff)+PB_fix_aux_el)/(PB_gross_min_eff+(PB_nom_gross_eff-PB_gross_min_eff)/(PB_nom_net_cap-PB_net_min_cap)*(MIN(PB_nom_net_cap,MAX(0,OT6+$BK6-$BP6))-PB_net_min_cap))+MAX(0,D_overall_var_heat_min_cons+D_overall_heat_fix_stby_cons-$BQ6)*PB_Ratio_Heat_input_vs_output)*TES_aux_cons_perc+IF(AND(OT6=0,OT7>0),MAX(0,IF(COUNTIF(OT1:OT6,\"0\")=PB_warm_start_duration,PB_warm_start_heat_req,PB_hot_start_heat_req)-$BQ6)*TES_aux_cons_perc,0))", "OV" : "=IF(OT6=0,0,MAX(PB_net_min_cap,MIN(PB_nom_net_cap,OT6+OU6-$BP6)))", "OW" : "=IF(OV6=0,0,OV6+PB_nom_net_cap*PB_nom_var_aux_cons_perc_net*POLY(OV6/PB_nom_net_cap,PB_n2g_var_aux_el_Coeff)+PB_fix_aux_el)", "OX" : "=IF(AND(OW6=0,OW7>0),IF(COUNTIF(OW1:OW6,\"0\")=PB_warm_start_duration,PB_warm_start_heat_req,PB_hot_start_heat_req),0)", "OY" : "=IF(OW6=0,0,OW6/PB_nom_gross_eff/POLY(OW6/PB_nom_gross_cap_ud,el_Coeff))", "OZ" : "=IF(OY6=0,0,MAX(0,PB_Ratio_Heat_input_vs_output*(MIN(D_overall_var_heat_min_cons+D_overall_heat_fix_stby_cons+IF($BM7=0,0,D_overall_heat_stup_cons),(OV6-OU6+$BP6)/(D_overall_var_min_cons+D_overall_fix_stby_cons+IF($BM7=0,0,D_overall_stup_cons))*(D_overall_var_heat_min_cons+D_overall_heat_fix_stby_cons+IF($BM7=0,0,D_overall_heat_stup_cons)))-$BQ6-MAX(0,OV6-OT6-OU6)*El_boiler_eff)))", "PA" : "=IF(MIN(SUMIF($BO$5:$BO$8763,\"=\"&$BO6,$AY$5:$AY$8763)*Heater_eff*(1+1/Ratio_CSP_vs_Heater),TES_thermal_cap)<SUMIF($BO$5:$BO$8763,\"=\"&$BO6,OX$5:OX$8763)+SUMIF($BO$5:$BO$8763,\"=\"&$BO6,OY$5:OY$8763)+SUMIF($BO$5:$BO$8763,\"=\"&$BO6,OZ$5:OZ$8763),0,SUMIF($BO$5:$BO$8763,\"=\"&$BO6,OX$5:OX$8763)+SUMIF($BO$5:$BO$8763,\"=\"&$BO6,OY$5:OY$8763)+SUMIF($BO$5:$BO$8763,\"=\"&$BO6,OZ$5:OZ$8763))", "PB" : "=IF(PA6=0,0,MAX(0,SUMIF($BO$5:$BO$8763,\"=\"&$BO6,$AY$5:$AY$8763)*Heater_eff*(1+1/Ratio_CSP_vs_Heater)-PA6))", "PC" : "=IF(OR(AND(PB6>0,$AY6>0,$AY5=0),AND(PB6>0,$AY7=0,$AY6>0)),$AY6,0)", "PD" : "=MAX(0,PB6-SUMIF($BO$5:$BO$8763,\"=\"&$BO6,PC$5:PC$8763)*Heater_eff*(1+1/Ratio_CSP_vs_Heater))", "PE" : "=IF(PB6=0,0,$AY6-(PB6-PD6)/(SUMIF($BO$5:$BO$8763,\"=\"&$BO6,PC$5:PC$8763)*Heater_eff*(1+1/Ratio_CSP_vs_Heater))*PC6)", "PF" : "=IF(OR(PE6=0,PD6=0),0,MAX(($AW6-PE6)/(PD6/(1+1/Ratio_CSP_vs_Heater)/Heater_eff/COUNTIFS($BO$5:$BO$8763,\"=\"&$BO6,PE$5:PE$8763,\">0\")),($J6-PE6*Heater_eff/Ratio_CSP_vs_Heater)/(PD6/(1+Ratio_CSP_vs_Heater)/COUNTIFS($BO$5:$BO$8763,\"=\"&$BO6,PE$5:PE$8763,\">0\")))/SUMIF($BO$5:$BO$8763,\"=\"&$BO6,PE$5:PE$8763)*PE6)", "PG" : "=IF(PA6=0,0,PE6-IF(PD6=0,0,PD6/(1+1/Ratio_CSP_vs_Heater)/Heater_eff/SUMIF($BO$5:$BO$8763,\"=\"&$BO6,PF$5:PF$8763)*PF6))", "PH" : "=MIN($J6,PG6*Heater_eff/Ratio_CSP_vs_Heater)", "PI" : "=MAX(0,$L6-PG6)", "PJ" : "=MAX(0,$J6-PH6)", "PK" : "=IF($J6>0,$J6*CSP_var_aux_nom_perc,CSP_nonsolar_aux_cons)+$M6+(PG6*Heater_eff+PH6)*TES_aux_cons_perc+IF(OR(OW6=0,AND(OW6>0,PA6=0)),PB_stby_aux_cons+OX6*TES_aux_cons_perc,(OX6+OY6+OZ6)*TES_aux_cons_perc)", "PL" : "=MAX(0,-($L6+IF(PA6>0,OV6,0)-PG6-PK6))",  "PN" : "=IF(MIN(Overall_harmonious_var_max_cons+Overall_fix_cons,PI6+Grid_import_max_ud*Grid_import_yes_no_PB_strategy-(PK6-PL6),MIN(PJ6+El_boiler_cap_ud*El_boiler_eff,(PI6+Grid_import_max_ud*Grid_import_yes_no_PB_strategy-(PK6-PL6))/(Overall_harmonious_var_max_cons+Overall_fix_cons+(PK6-PL6)+MAX(0,(Overall_harmonious_var_heat_max_cons+Overall_heat_fix_cons-PJ6))/El_boiler_eff)*(Overall_harmonious_var_heat_max_cons+Overall_heat_fix_cons))/(Overall_harmonious_var_heat_max_cons+Overall_heat_fix_cons)*(Overall_harmonious_var_max_cons+Overall_fix_cons))<Overall_harmonious_var_min_cons+Overall_fix_cons,0,Overall_harmonious_var_min_cons+Overall_fix_cons)", "PO" : "=IF(AND(PN6>0,PN5=0,OR(PN6=0,PN7=0)),0,PN6)", "PP" : "=PO6/(Overall_harmonious_var_max_cons+Overall_fix_cons)*(Overall_harmonious_var_heat_max_cons+Overall_heat_fix_cons)", "PQ" : "=IF(AND(PO5<=0,PO6>0),PQ5+1,IF(AND(PI6>0,$BO6<>$BO5,SUM(PO6:PO8)=0),PQ5+1,PQ5))", "PR" : "=IF(OR(PO6>0,PA6=0),0,MIN((OV6+PI6+(PJ6+OZ6/PB_Ratio_Heat_input_vs_output)/El_boiler_eff-(PK6-PL6))/(D_overall_var_min_cons+D_overall_fix_stby_cons+IF(PO7=0,0,D_overall_stup_cons)+(D_overall_var_heat_min_cons+D_overall_heat_fix_stby_cons+IF(PP7=0,0,D_overall_heat_stup_cons))/El_boiler_eff)*(D_overall_var_min_cons+D_overall_fix_stby_cons+IF(PO7=0,0,D_overall_stup_cons)),D_overall_var_min_cons+D_overall_fix_stby_cons+IF(PO7=0,0,D_overall_stup_cons)))", "PS" : "=IF(PR6=0,0,MIN((OV6+PI6+(PJ6+OZ6/PB_Ratio_Heat_input_vs_output)/El_boiler_eff-(PK6-PL6))/(D_overall_var_min_cons+D_overall_fix_stby_cons+IF(PO7=0,0,D_overall_stup_cons)+(D_overall_var_heat_min_cons+D_overall_heat_fix_stby_cons+IF(PP7=0,0,D_overall_heat_stup_cons))/El_boiler_eff)*(D_overall_var_heat_min_cons+D_overall_heat_fix_stby_cons+IF(PP7=0,0,D_overall_heat_stup_cons)),D_overall_var_heat_min_cons+D_overall_heat_fix_stby_cons+IF(PP7=0,0,D_overall_heat_stup_cons)))", "PT" : "=MAX(0,IF(PA6>0,OV6,0)+PI6-(PK6-PL6)-PO6-PR6-MAX(0,(PP6+PS6-IF(PA6>0,OZ6/PB_Ratio_Heat_input_vs_output,0)-PJ6)/El_boiler_eff))", "PU" : "=MAX(0,PJ6+IF(PA6=0,0,OZ6/PB_Ratio_Heat_input_vs_output)-PP6-PS6)", "PV" : "=MAX(0,-(IF(PA6>0,OV6,0)+PI6-(PK6-PL6)-PO6-PR6-MAX(0,(PP6+PS6-IF(PA6>0,OZ6/PB_Ratio_Heat_input_vs_output,0)-PJ6)/El_boiler_eff)))", "PW" : "=Grid_import_max_ud-PV6", "PX" : "=MIN(El_boiler_cap_ud,MAX(0,(PP6+PS6-PJ6-IF(PA6>0,OZ6/PB_Ratio_Heat_input_vs_output,0))/El_boiler_eff))", "PY" : "=MAX(0,El_boiler_cap_ud-PX6)", "PZ" : "=MAX(0,1-PO6/(Overall_harmonious_var_max_cons+Overall_fix_cons)*MethSynt_harmonious_max_perc)*MethSynt_RawMeth_nom_prod_ud", "QA" : "=MAX(0,1-PO6/(Overall_harmonious_var_max_cons+Overall_fix_cons)*CCU_harmonious_max_perc)*CCU_CO2_nom_prod_ud", "QB" : "=MAX(0,1-PO6/(Overall_harmonious_var_max_cons+Overall_fix_cons)*EY_harmonious_max_perc)*EY_Hydrogen_nom_prod", "QC" : "=MIN(BESS_chrg_max_cons,PT6)", "QD" : "=MIN(Grid_export_max_ud,PT6)", "QE" : "=IF(MIN(Overall_harmonious_var_max_cons+Overall_fix_cons,PI6+Grid_import_max_ud*Grid_import_yes_no_PB_strategy-(PK6-PL6),MIN(PJ6+El_boiler_cap_ud*El_boiler_eff,(PI6+Grid_import_max_ud*Grid_import_yes_no_PB_strategy-(PK6-PL6))/(Overall_harmonious_var_max_cons+Overall_fix_cons+(PK6-PL6)+MAX(0,(Overall_harmonious_var_heat_max_cons+Overall_heat_fix_cons-PJ6))/El_boiler_eff)*(Overall_harmonious_var_heat_max_cons+Overall_heat_fix_cons))/(Overall_harmonious_var_heat_max_cons+Overall_heat_fix_cons)*(Overall_harmonious_var_max_cons+Overall_fix_cons))<Overall_harmonious_var_min_cons+Overall_fix_cons,0,MIN(Overall_harmonious_var_max_cons+Overall_fix_cons,PI6+Grid_import_max_ud*Grid_import_yes_no_PB_strategy-(PK6-PL6),MIN(PJ6+El_boiler_cap_ud*El_boiler_eff,(PI6+Grid_import_max_ud*Grid_import_yes_no_PB_strategy-(PK6-PL6))/(Overall_harmonious_var_max_cons+Overall_fix_cons+(PK6-PL6)+MAX(0,(Overall_harmonious_var_heat_max_cons+Overall_heat_fix_cons-PJ6))/El_boiler_eff)*(Overall_harmonious_var_heat_max_cons+Overall_heat_fix_cons))/(Overall_harmonious_var_heat_max_cons+Overall_heat_fix_cons)*(Overall_harmonious_var_max_cons+Overall_fix_cons)))", "QF" : "=IF(AND(QE6>0,QE5=0,OR(QE6=0,QE7=0)),0,QE6)", "QG" : "=QF6/(Overall_harmonious_var_max_cons+Overall_fix_cons)*(Overall_harmonious_var_heat_max_cons+Overall_heat_fix_cons)", "QH" : "=MAX(0,IF(PA6>0,OV6,0)+PI6-(PK6-PL6)-QF6-PR6-MAX(0,(QG6+PS6-IF(PA6>0,OZ6/PB_Ratio_Heat_input_vs_output,0)-PJ6)/El_boiler_eff))", "QI" : "=MAX(0,PJ6+IF(PA6=0,0,OZ6/PB_Ratio_Heat_input_vs_output)-QG6-PS6)", "QJ" : "=MAX(0,-(IF(PA6>0,OV6,0)+PI6-(PK6-PL6)-QF6-PR6-MAX(0,(QG6+PS6-IF(PA6>0,OZ6/PB_Ratio_Heat_input_vs_output,0)-PJ6)/El_boiler_eff)))", "QK" : "=Grid_import_max_ud-QJ6", "QL" : "=MIN(El_boiler_cap_ud,MAX(0,(QG6+PS6-PJ6-IF(PA6>0,OZ6/PB_Ratio_Heat_input_vs_output,0))/El_boiler_eff))", "QM" : "=MAX(0,El_boiler_cap_ud-QL6)", "QN" : "=MAX(0,1-QF6/(Overall_harmonious_var_max_cons+Overall_fix_cons)*MethSynt_harmonious_max_perc)*MethSynt_RawMeth_nom_prod_ud", "QO" : "=MAX(0,1-QF6/(Overall_harmonious_var_max_cons+Overall_fix_cons)*CCU_harmonious_max_perc)*CCU_CO2_nom_prod_ud", "QP" : "=MAX(0,1-QF6/(Overall_harmonious_var_max_cons+Overall_fix_cons)*EY_harmonious_max_perc)*EY_Hydrogen_nom_prod", "QQ" : "=MIN(BESS_chrg_max_cons,QH6)", "QR" : "=MIN(Grid_export_max_ud,QH6)",  "QT" : "=VLOOKUP($BO6,DailyCalc_1$A$3:$EB$367,COLUMN(DailyCalc_1EB$3))", "QU" : "=IF($BM6>0,0,IF(D_overall_var_max_cons*QT6+D_overall_fix_stby_cons+$BK6+IF($BM7=0,0,D_overall_stup_cons)+MAX(0,D_overall_var_heat_max_cons*QT6+D_overall_heat_fix_stby_cons+IF($BM7=0,0,D_overall_heat_stup_cons)-$BQ6)/El_boiler_eff<$BP6-PB_stby_aux_cons,0,D_overall_var_max_cons*QT6+D_overall_fix_stby_cons+IF($BM7=0,0,D_overall_stup_cons)))", "QV" : "=IF(AND(QU7>0,QU6=0,QU5>0),QU5,QU6)", "QW" : "=IF(QV6=0,0,$BK6+((MIN(PB_nom_net_cap,MAX(PB_net_min_cap,(1+TES_aux_cons_perc)*(QV6+$BK6-$BP6)))+PB_nom_net_cap*PB_nom_var_aux_cons_perc_net*POLY(MIN(PB_nom_net_cap,MAX(PB_net_min_cap,(1+TES_aux_cons_perc)*(QV6+$BK6-$BP6)))/PB_nom_net_cap,PB_n2g_var_aux_el_Coeff)+PB_fix_aux_el)/(PB_gross_min_eff+(PB_nom_gross_eff-PB_gross_min_eff)/(PB_nom_net_cap-PB_net_min_cap)*(MIN(PB_nom_net_cap,MAX(0,QV6+$BK6-$BP6))-PB_net_min_cap))+MAX(0,D_overall_var_heat_max_cons*QT6+D_overall_heat_fix_stby_cons-$BQ6)*PB_Ratio_Heat_input_vs_output)*TES_aux_cons_perc+IF(AND(QV6=0,QV7>0),MAX(0,IF(COUNTIF(QV1:QV6,\"0\")=PB_warm_start_duration,PB_warm_start_heat_req,PB_hot_start_heat_req)-$BQ6)*TES_aux_cons_perc,0))", "QX" : "=IF(QV6=0,0,MAX(PB_net_min_cap,MIN(PB_nom_net_cap,QV6+QW6-$BP6)))", "QY" : "=IF(QX6=0,0,QX6+PB_nom_net_cap*PB_nom_var_aux_cons_perc_net*POLY(QX6/PB_nom_net_cap,PB_n2g_var_aux_el_Coeff)+PB_fix_aux_el)", "QZ" : "=IF(AND(QY6=0,QY7>0),IF(COUNTIF(QY1:QY6,\"0\")=PB_warm_start_duration,PB_warm_start_heat_req,PB_hot_start_heat_req),0)", "RA" : "=IF(QY6=0,0,QY6/PB_nom_gross_eff/POLY(QY6/PB_nom_gross_cap_ud,el_Coeff))", "RB" : "=IF(RA6=0,0,MAX(0,PB_Ratio_Heat_input_vs_output*(MIN(D_overall_var_heat_max_cons*QT6+D_overall_heat_fix_stby_cons+IF($BM7=0,0,D_overall_heat_stup_cons),(QX6-QW6+$BP6)/(D_overall_var_max_cons*QT6+D_overall_fix_stby_cons+IF($BM7=0,0,D_overall_stup_cons))*(D_overall_var_heat_max_cons*QT6+D_overall_heat_fix_stby_cons+IF($BM7=0,0,D_overall_heat_stup_cons)))-$BQ6-MAX(0,QX6-QV6-QW6)*El_boiler_eff)))", "RC" : "=IF(PA6=0,0,MIN(SUMIF($BO$5:$BO$8763,\"=\"&$BO6,$AY$5:$AY$8763)*Heater_eff*(1+1/Ratio_CSP_vs_Heater),TES_thermal_cap,SUMIF($BO$5:$BO$8763,\"=\"&$BO6,QZ$5:QZ$8763)+SUMIF($BO$5:$BO$8763,\"=\"&$BO6,RA$5:RA$8763)+SUMIF($BO$5:$BO$8763,\"=\"&$BO6,RB$5:RB$8763)))", "RD" : "=IF(RC6=0,0,(RC6-SUMIF($BO$5:$BO$8763,\"=\"&$BO6,QZ$5:QZ$8763))/(SUMIF($BO$5:$BO$8763,\"=\"&$BO6,RA$5:RA$8763)+SUMIF($BO$5:$BO$8763,\"=\"&$BO6,RB$5:RB$8763))*RA6)", "RE" : "=IF(RD6=0,0,RD6*PB_nom_gross_eff*POLY(RD6/PB_nom_heat_cons,th_Coeff))", "RF" : "=IF(RE6=0,0,RE6-PB_nom_net_cap*PB_nom_var_aux_cons_perc_net*POLY(RE6/PB_nom_gross_cap_ud,PB_g2n_var_aux_el_Coeff)-PB_fix_aux_el)", "RG" : "=IF(RC6=0,0,(RC6-SUMIF($BO$5:$BO$8763,\"=\"&$BO6,QZ$5:QZ$8763))/(SUMIF($BO$5:$BO$8763,\"=\"&$BO6,RA$5:RA$8763)+SUMIF($BO$5:$BO$8763,\"=\"&$BO6,RB$5:RB$8763))*RB6)", "RH" : "=IF(MIN(SUMIF($BO$5:$BO$8763,\"=\"&$BO6,$AY$5:$AY$8763)*Heater_eff*(1+1/Ratio_CSP_vs_Heater),TES_thermal_cap)<SUMIF($BO$5:$BO$8763,\"=\"&$BO6,QZ$5:QZ$8763)+SUMIF($BO$5:$BO$8763,\"=\"&$BO6,RA$5:RA$8763)+SUMIF($BO$5:$BO$8763,\"=\"&$BO6,RB$5:RB$8763),RC6,SUMIF($BO$5:$BO$8763,\"=\"&$BO6,QZ$5:QZ$8763)+SUMIF($BO$5:$BO$8763,\"=\"&$BO6,RA$5:RA$8763)+SUMIF($BO$5:$BO$8763,\"=\"&$BO6,RB$5:RB$8763))", "RI" : "=IF(RH6=0,0,MAX(0,SUMIF($BO$5:$BO$8763,\"=\"&$BO6,$AY$5:$AY$8763)*Heater_eff*(1+1/Ratio_CSP_vs_Heater)-RH6))", "RJ" : "=IF(OR(AND(RI6>0,$AY6>0,$AY5=0),AND(RI6>0,$AY7=0,$AY6>0)),$AY6,0)", "RK" : "=MAX(0,RI6-SUMIF($BO$5:$BO$8763,\"=\"&$BO6,RJ$5:RJ$8763)*Heater_eff*(1+1/Ratio_CSP_vs_Heater))", "RL" : "=IF(RI6=0,0,$AY6-(RI6-RK6)/(SUMIF($BO$5:$BO$8763,\"=\"&$BO6,RJ$5:RJ$8763)*Heater_eff*(1+1/Ratio_CSP_vs_Heater))*RJ6)", "RM" : "=IF(OR(RL6=0,RK6=0),0,MAX(($AW6-RL6)/(RK6/(1+1/Ratio_CSP_vs_Heater)/Heater_eff/COUNTIFS($BO$5:$BO$8763,\"=\"&$BO6,RL$5:RL$8763,\">0\")),($J6-RL6*Heater_eff/Ratio_CSP_vs_Heater)/(RK6/(1+Ratio_CSP_vs_Heater)/COUNTIFS($BO$5:$BO$8763,\"=\"&$BO6,RL$5:RL$8763,\">0\")))/SUMIF($BO$5:$BO$8763,\"=\"&$BO6,RL$5:RL$8763)*RL6)", "RN" : "=IF(RH6=0,0,IF(RI6>0,RL6-IF(RK6=0,0,RK6/(1+1/Ratio_CSP_vs_Heater)/Heater_eff/SUMIF($BO$5:$BO$8763,\"=\"&$BO6,RM$5:RM$8763)*RM6),AY6))", "RO" : "=MIN($J6,RN6*Heater_eff/Ratio_CSP_vs_Heater)", "RP" : "=MAX(0,$L6-RN6)", "RQ" : "=MAX(0,$J6-RO6)", "RR" : "=IF($J6>0,$J6*CSP_var_aux_nom_perc,CSP_nonsolar_aux_cons)+$M6+(RN6*Heater_eff+RO6)*TES_aux_cons_perc+IF(RF6=0,PB_stby_aux_cons+QZ6*TES_aux_cons_perc,(QZ6+RD6+RG6)*TES_aux_cons_perc)", "RS" : "=MAX(0,-($L6+RF6-RN6-RR6))",  "RU" : "=IF(MIN(Overall_harmonious_var_max_cons+Overall_fix_cons,RP6+Grid_import_max_ud*Grid_import_yes_no_PB_strategy-(RR6-RS6),MIN(RQ6+El_boiler_cap_ud*El_boiler_eff,(RP6+Grid_import_max_ud*Grid_import_yes_no_PB_strategy-(RR6-RS6))/(Overall_harmonious_var_max_cons+Overall_fix_cons+(RR6-RS6)+MAX(0,(Overall_harmonious_var_heat_max_cons+Overall_heat_fix_cons-RQ6))/El_boiler_eff)*(Overall_harmonious_var_heat_max_cons+Overall_heat_fix_cons))/(Overall_harmonious_var_heat_max_cons+Overall_heat_fix_cons)*(Overall_harmonious_var_max_cons+Overall_fix_cons))<Overall_harmonious_var_min_cons+Overall_fix_cons,0,Overall_harmonious_var_min_cons+Overall_fix_cons)", "RV" : "=IF(AND(RU6>0,RU5=0,OR(RU6=0,RU7=0)),0,RU6)", "RW" : "=RV6/(Overall_harmonious_var_max_cons+Overall_fix_cons)*(Overall_harmonious_var_heat_max_cons+Overall_heat_fix_cons)", "RX" : "=IF(AND(RV5<=0,RV6>0),RX5+1,IF(AND(RP6>0,$BO6<>$BO5,SUM(RV6:RV8)=0),RX5+1,RX5))", "RY" : "=IF(OR(RV6>0,RH6=0),0,MIN((RF6+RP6+(RQ6+RG6/PB_Ratio_Heat_input_vs_output)/El_boiler_eff-(RR6-RS6))/(D_overall_var_max_cons*QT6+D_overall_fix_stby_cons+IF(RV7=0,0,D_overall_stup_cons)+(D_overall_var_heat_max_cons*QT6+D_overall_heat_fix_stby_cons+IF(RW7=0,0,D_overall_heat_stup_cons))/El_boiler_eff)*(D_overall_var_max_cons*QT6+D_overall_fix_stby_cons+IF(RV7=0,0,D_overall_stup_cons)),D_overall_var_max_cons*QT6+D_overall_fix_stby_cons+IF(RV7=0,0,D_overall_stup_cons)))", "RZ" : "=IF(RY6=0,0,MIN((RF6+RP6+(RQ6+RG6/PB_Ratio_Heat_input_vs_output)/El_boiler_eff-(RR6-RS6))/(D_overall_var_max_cons*QT6+D_overall_fix_stby_cons+IF(RV7=0,0,D_overall_stup_cons)+(D_overall_var_heat_max_cons*QT6+D_overall_heat_fix_stby_cons+IF(RW7=0,0,D_overall_heat_stup_cons))/El_boiler_eff)*(D_overall_var_heat_max_cons*QT6+D_overall_heat_fix_stby_cons+IF(RW7=0,0,D_overall_heat_stup_cons)),D_overall_var_heat_max_cons*QT6+D_overall_heat_fix_stby_cons+IF(RW7=0,0,D_overall_heat_stup_cons)))", "SA" : "=MAX(0,RF6+RP6-(RR6-RS6)-RV6-RY6-MAX(0,(RW6+RZ6-RG6/PB_Ratio_Heat_input_vs_output-RQ6)/El_boiler_eff))", "SB" : "=MAX(0,RQ6+RG6/PB_Ratio_Heat_input_vs_output-RW6-RZ6)", "SC" : "=MAX(0,-(RF6+RP6-(RR6-RS6)-RV6-RY6-MAX(0,(RW6+RZ6-RG6/PB_Ratio_Heat_input_vs_output-RQ6)/El_boiler_eff)))", "SD" : "=Grid_import_max_ud-SC6", "SE" : "=MIN(El_boiler_cap_ud,MAX(0,(RW6+RZ6-RQ6-RG6/PB_Ratio_Heat_input_vs_output)/El_boiler_eff))", "SF" : "=MAX(0,El_boiler_cap_ud-SE6)", "SG" : "=MAX(0,1-RV6/(Overall_harmonious_var_max_cons+Overall_fix_cons)*MethSynt_harmonious_max_perc)*MethSynt_RawMeth_nom_prod_ud", "SH" : "=MAX(0,1-RV6/(Overall_harmonious_var_max_cons+Overall_fix_cons)*CCU_harmonious_max_perc)*CCU_CO2_nom_prod_ud", "SI" : "=MAX(0,1-RV6/(Overall_harmonious_var_max_cons+Overall_fix_cons)*EY_harmonious_max_perc)*EY_Hydrogen_nom_prod", "SJ" : "=MIN(BESS_chrg_max_cons,SA6)", "SK" : "=MIN(Grid_export_max_ud,SA6)", "SL" : "=IF(MIN(Overall_harmonious_var_max_cons+Overall_fix_cons,RP6+Grid_import_max_ud*Grid_import_yes_no_PB_strategy-(RR6-RS6),MIN(RQ6+El_boiler_cap_ud*El_boiler_eff,(RP6+Grid_import_max_ud*Grid_import_yes_no_PB_strategy-(RR6-RS6))/(Overall_harmonious_var_max_cons+Overall_fix_cons+(RR6-RS6)+MAX(0,(Overall_harmonious_var_heat_max_cons+Overall_heat_fix_cons-RQ6))/El_boiler_eff)*(Overall_harmonious_var_heat_max_cons+Overall_heat_fix_cons))/(Overall_harmonious_var_heat_max_cons+Overall_heat_fix_cons)*(Overall_harmonious_var_max_cons+Overall_fix_cons))<Overall_harmonious_var_min_cons+Overall_fix_cons,0,MIN(Overall_harmonious_var_max_cons+Overall_fix_cons,RP6+Grid_import_max_ud*Grid_import_yes_no_PB_strategy-(RR6-RS6),MIN(RQ6+El_boiler_cap_ud*El_boiler_eff,(RP6+Grid_import_max_ud*Grid_import_yes_no_PB_strategy-(RR6-RS6))/(Overall_harmonious_var_max_cons+Overall_fix_cons+(RR6-RS6)+MAX(0,(Overall_harmonious_var_heat_max_cons+Overall_heat_fix_cons-RQ6))/El_boiler_eff)*(Overall_harmonious_var_heat_max_cons+Overall_heat_fix_cons))/(Overall_harmonious_var_heat_max_cons+Overall_heat_fix_cons)*(Overall_harmonious_var_max_cons+Overall_fix_cons)))", "SM" : "=IF(AND(SL6>0,SL5=0,OR(SL6=0,SL7=0)),0,SL6)", "SN" : "=SM6/(Overall_harmonious_var_max_cons+Overall_fix_cons)*(Overall_harmonious_var_heat_max_cons+Overall_heat_fix_cons)", "SO" : "=MAX(0,RF6+RP6-(RR6-RS6)-SM6-RY6-MAX(0,(SN6+RZ6-RG6/PB_Ratio_Heat_input_vs_output-RQ6)/El_boiler_eff))", "SP" : "=MAX(0,RQ6+RG6/PB_Ratio_Heat_input_vs_output-SN6-RZ6)", "SQ" : "=MAX(0,-(RF6+RP6-(RR6-RS6)-SM6-RY6-MAX(0,(SN6+RZ6-RG6/PB_Ratio_Heat_input_vs_output-RQ6)/El_boiler_eff)))", "SR" : "=Grid_import_max_ud-SQ6", "SS" : "=MIN(El_boiler_cap_ud,MAX(0,(SN6+RZ6-RQ6-RG6/PB_Ratio_Heat_input_vs_output)/El_boiler_eff))", "ST" : "=MAX(0,El_boiler_cap_ud-SS6)", "SU" : "=MAX(0,1-SM6/(Overall_harmonious_var_max_cons+Overall_fix_cons)*MethSynt_harmonious_max_perc)*MethSynt_RawMeth_nom_prod_ud", "SV" : "=MAX(0,1-SM6/(Overall_harmonious_var_max_cons+Overall_fix_cons)*CCU_harmonious_max_perc)*CCU_CO2_nom_prod_ud", "SW" : "=MAX(0,1-SM6/(Overall_harmonious_var_max_cons+Overall_fix_cons)*EY_harmonious_max_perc)*EY_Hydrogen_nom_prod", "SX" : "=MIN(BESS_chrg_max_cons,SO6)", "SY" : "=MIN(Grid_export_max_ud,SO6)"
]

let formulasDaily1: [String: String] = [
"A" : "=A5+1",  "C" : "=COUNTIFS(Calculation$CS$5:$CS$8763,\"=\"&$A6,Calculation$CQ$5:$CQ$8763,\"<=0\")", "D" : "=COUNTIFS(Calculation$CS$5:$CS$8763,\"=\"&$A6,Calculation$CQ$5:$CQ$8763,\">0\")", "E" : "=COUNTIFS(Calculation$CS$5:$CS$8763,\"=\"&$A6,Calculation$BX$5:$BX$8763,\">0\",Calculation$CC$5:$CC$8763,\">0\")", "F" : "=A_RawMeth_min_cons*$C6", "G" : "=A_RawMeth_max_cons*$C6", "H" : "=A_CO2_min_cons*$C6", "I" : "=A_CO2_max_cons*$C6", "J" : "=A_Hydrogen_min_cons*$C6", "K" : "=A_Hydrogen_max_cons*$C6", "L" : "=1-F6/RawMeth_storage_cap_ud", "M" : "=1-G6/RawMeth_storage_cap_ud", "N" : "=1-H6/CO2_storage_cap_ud", "O" : "=1-I6/CO2_storage_cap_ud", "P" : "=1-J6/Hydrogen_storage_cap_ud", "Q" : "=1-K6/Hydrogen_storage_cap_ud", "R" : "=IF(OR(L6<=0,N6<=0,P6<=0),0,MIN(1,IFERROR(L6/(L6-M6),1),IFERROR(N6/(N6-O6),1),IFERROR(P6/(P6-Q6),1))*(A_equiv_harmonious_max_perc-A_equiv_harmonious_min_perc)+A_equiv_harmonious_min_perc)",  "T" : "=COUNTIFS(Calculation$EZ$5:$EZ$8763,\"=\"&$A6,Calculation$EX$5:$EX$8763,\"<=0\")", "U" : "=COUNTIFS(Calculation$EZ$5:$EZ$8763,\"=\"&$A6,Calculation$EX$5:$EX$8763,\">0\")", "V" : "=COUNTIFS(Calculation$EZ$5:$EZ$8763,\"=\"&$A6,Calculation$EH$5:$EH$8763,\">0\")", "W" : "=A_RawMeth_max_cons*$T6", "X" : "=A_CO2_max_cons*$T6", "Y" : "=A_Hydrogen_max_cons*$T6", "Z" : "=(J6+F6/(MethSynt_CO2_nom_cons+MethSynt_Hydrogen_nom_cons)*MethSynt_Hydrogen_nom_cons)/EY_Hydrogen_nom_prod*EY_var_gross_nom_cons+D6*EY_fix_cons+(H6+F6/(MethSynt_CO2_nom_cons+MethSynt_Hydrogen_nom_cons)*MethSynt_CO2_nom_cons)/CCU_CO2_nom_prod_ud*CCU_var_nom_cons+D6*CCU_fix_cons+F6/MethSynt_RawMeth_nom_prod_ud*MethSynt_var_nom_cons+D6*MethSynt_fix_cons", "AA" : "=(Y6+W6/(MethSynt_CO2_nom_cons+MethSynt_Hydrogen_nom_cons)*MethSynt_Hydrogen_nom_cons)/EY_Hydrogen_nom_prod*EY_var_gross_nom_cons+U6*EY_fix_cons+(X6+W6/(MethSynt_CO2_nom_cons+MethSynt_Hydrogen_nom_cons)*MethSynt_CO2_nom_cons)/CCU_CO2_nom_prod_ud*CCU_var_nom_cons+U6*CCU_fix_cons+W6/MethSynt_RawMeth_nom_prod_ud*MethSynt_var_nom_cons+U6*MethSynt_fix_cons", "AB" : "=(J6+F6/(MethSynt_CO2_nom_cons+MethSynt_Hydrogen_nom_cons)*MethSynt_Hydrogen_nom_cons)/EY_Hydrogen_nom_prod*EY_var_heat_nom_cons+D6*EY_heat_fix_cons+(H6+F6/(MethSynt_CO2_nom_cons+MethSynt_Hydrogen_nom_cons)*MethSynt_CO2_nom_cons)/CCU_CO2_nom_prod_ud*CCU_var_heat_nom_cons+D6*CCU_fix_heat_cons-F6/MethSynt_RawMeth_nom_prod_ud*MethSynt_var_heat_nom_prod-D6*MethSynt_heat_fix_prod", "AC" : "=(Y6+W6/(MethSynt_CO2_nom_cons+MethSynt_Hydrogen_nom_cons)*MethSynt_Hydrogen_nom_cons)/EY_Hydrogen_nom_prod*EY_var_heat_nom_cons+U6*EY_heat_fix_cons+(X6+W6/(MethSynt_CO2_nom_cons+MethSynt_Hydrogen_nom_cons)*MethSynt_CO2_nom_cons)/CCU_CO2_nom_prod_ud*CCU_var_heat_nom_cons+U6*CCU_fix_heat_cons-W6/MethSynt_RawMeth_nom_prod_ud*MethSynt_var_heat_nom_prod-U6*MethSynt_heat_fix_prod", "AD" : "=F6", "AE" : "=W6", "AF" : "=H6+F6/(MethSynt_CO2_nom_cons+MethSynt_Hydrogen_nom_cons)*MethSynt_CO2_nom_cons", "AG" : "=X6+W6/(MethSynt_CO2_nom_cons+MethSynt_Hydrogen_nom_cons)*MethSynt_CO2_nom_cons", "AH" : "=J6+F6/(MethSynt_CO2_nom_cons+MethSynt_Hydrogen_nom_cons)*MethSynt_Hydrogen_nom_cons", "AI" : "=Y6+W6/(MethSynt_CO2_nom_cons+MethSynt_Hydrogen_nom_cons)*MethSynt_Hydrogen_nom_cons", "AJ" : "=1-W6/RawMeth_storage_cap_ud", "AK" : "=1-X6/CO2_storage_cap_ud", "AL" : "=1-Y6/Hydrogen_storage_cap_ud", "AM" : "=IF(OR(L6<=0,N6<=0,P6<=0),0,MIN(1,IFERROR(L6/(L6-AJ6),1),IFERROR(N6/(N6-AK6),1),IFERROR(P6/(P6-AL6),1))*(A_equiv_harmonious_max_perc-A_equiv_harmonious_min_perc)+A_equiv_harmonious_min_perc)",  "AO" : "=COUNTIFS(Calculation$HA$5:$HA$8763,\"=\"&$A6,Calculation$GY$5:$GY$8763,\"<=0\")", "AP" : "=COUNTIFS(Calculation$HA$5:$HA$8763,\"=\"&$A6,Calculation$GY$5:$GY$8763,\">0\")", "AQ" : "=COUNTIFS(Calculation$HA$5:$HA$8763,\"=\"&$A6,Calculation$GF$5:$GF$8763,\">0\",Calculation$GK$5:$GK$8763,\">0\")", "AR" : "=B_RawMeth_min_cons*AO6", "AS" : "=B_RawMeth_max_cons*AO6", "AT" : "=B_CO2_min_cons*AO6", "AU" : "=B_CO2_max_cons*AO6", "AV" : "=B_Hydrogen_min_cons*AO6", "AW" : "=B_Hydrogen_max_cons*AO6", "AX" : "=1-AR6/RawMeth_storage_cap_ud", "AY" : "=1-AS6/RawMeth_storage_cap_ud", "AZ" : "=1-AT6/CO2_storage_cap_ud", "BA" : "=1-AU6/CO2_storage_cap_ud", "BB" : "=1-AV6/Hydrogen_storage_cap_ud", "BC" : "=1-AW6/Hydrogen_storage_cap_ud", "BD" : "=IF(OR(AX6<=0,AZ6<=0,BB6<=0),0,MIN(1,IFERROR(AX6/(AX6-AY6),1),IFERROR(AZ6/(AZ6-BA6),1),IFERROR(BB6/(BB6-BC6),1))*(B_equiv_harmonious_max_perc-B_equiv_harmonious_min_perc)+B_equiv_harmonious_min_perc)",  "BF" : "=COUNTIFS(Calculation$JH$5:$JH$8763,\"=\"&$A6,Calculation$JF$5:$JF$8763,\"<=0\")", "BG" : "=COUNTIFS(Calculation$JH$5:$JH$8763,\"=\"&$A6,Calculation$JF$5:$JF$8763,\">0\")", "BH" : "=COUNTIFS(Calculation$JH$5:$JH$8763,\"=\"&$A6,Calculation$IP$5:$IP$8763,\">0\")", "BI" : "=B_RawMeth_max_cons*BF6", "BJ" : "=B_CO2_max_cons*BF6", "BK" : "=B_Hydrogen_max_cons*BF6", "BL" : "=(AV6+AR6/(MethSynt_CO2_nom_cons+MethSynt_Hydrogen_nom_cons)*MethSynt_Hydrogen_nom_cons)/EY_Hydrogen_nom_prod*EY_var_gross_nom_cons+AP6*EY_fix_cons+(AT6+AR6/(MethSynt_CO2_nom_cons+MethSynt_Hydrogen_nom_cons)*MethSynt_CO2_nom_cons)/CCU_CO2_nom_prod_ud*CCU_var_nom_cons+AP6*CCU_fix_cons+AR6/MethSynt_RawMeth_nom_prod_ud*MethSynt_var_nom_cons+AP6*MethSynt_fix_cons", "BM" : "=(BK6+BI6/(MethSynt_CO2_nom_cons+MethSynt_Hydrogen_nom_cons)*MethSynt_Hydrogen_nom_cons)/EY_Hydrogen_nom_prod*EY_var_gross_nom_cons+BG6*EY_fix_cons+(BJ6+BI6/(MethSynt_CO2_nom_cons+MethSynt_Hydrogen_nom_cons)*MethSynt_CO2_nom_cons)/CCU_CO2_nom_prod_ud*CCU_var_nom_cons+BG6*CCU_fix_cons+BI6/MethSynt_RawMeth_nom_prod_ud*MethSynt_var_nom_cons+BG6*MethSynt_fix_cons", "BN" : "=(AV6+AR6/(MethSynt_CO2_nom_cons+MethSynt_Hydrogen_nom_cons)*MethSynt_Hydrogen_nom_cons)/EY_Hydrogen_nom_prod*EY_var_heat_nom_cons+AP6*EY_heat_fix_cons+(AT6+AR6/(MethSynt_CO2_nom_cons+MethSynt_Hydrogen_nom_cons)*MethSynt_CO2_nom_cons)/CCU_CO2_nom_prod_ud*CCU_var_heat_nom_cons+AP6*CCU_fix_heat_cons-AR6/MethSynt_RawMeth_nom_prod_ud*MethSynt_var_heat_nom_prod-AP6*MethSynt_heat_fix_prod", "BO" : "=(BK6+BI6/(MethSynt_CO2_nom_cons+MethSynt_Hydrogen_nom_cons)*MethSynt_Hydrogen_nom_cons)/EY_Hydrogen_nom_prod*EY_var_heat_nom_cons+BG6*EY_heat_fix_cons+(BJ6+BI6/(MethSynt_CO2_nom_cons+MethSynt_Hydrogen_nom_cons)*MethSynt_CO2_nom_cons)/CCU_CO2_nom_prod_ud*CCU_var_heat_nom_cons+BG6*CCU_fix_heat_cons-BI6/MethSynt_RawMeth_nom_prod_ud*MethSynt_var_heat_nom_prod-BG6*MethSynt_heat_fix_prod", "BP" : "=AR6", "BQ" : "=BI6", "BR" : "=AT6+AR6/(MethSynt_CO2_nom_cons+MethSynt_Hydrogen_nom_cons)*MethSynt_CO2_nom_cons", "BS" : "=BJ6+BI6/(MethSynt_CO2_nom_cons+MethSynt_Hydrogen_nom_cons)*MethSynt_CO2_nom_cons", "BT" : "=AV6+AR6/(MethSynt_CO2_nom_cons+MethSynt_Hydrogen_nom_cons)*MethSynt_Hydrogen_nom_cons", "BU" : "=BK6+BI6/(MethSynt_CO2_nom_cons+MethSynt_Hydrogen_nom_cons)*MethSynt_Hydrogen_nom_cons", "BV" : "=1-BI6/RawMeth_storage_cap_ud", "BW" : "=1-BJ6/CO2_storage_cap_ud", "BX" : "=1-BK6/Hydrogen_storage_cap_ud", "BY" : "=IF(OR(AX6<=0,AZ6<=0,BB6<=0),0,MIN(1,IFERROR(AX6/(AX6-BV6),1),IFERROR(AZ6/(AZ6-BW6),1),IFERROR(BB6/(BB6-BX6),1))*(B_equiv_harmonious_max_perc-B_equiv_harmonious_min_perc)+B_equiv_harmonious_min_perc)",  "CA" : "=COUNTIFS(Calculation$LI$5:$LI$8763,\"=\"&$A6,Calculation$LG$5:$LG$8763,\"<=0\")", "CB" : "=COUNTIFS(Calculation$LI$5:$LI$8763,\"=\"&$A6,Calculation$LG$5:$LG$8763,\">0\")", "CC" : "=COUNTIFS(Calculation$LI$5:$LI$8763,\"=\"&$A6,Calculation$KN$5:$KN$8763,\">0\",Calculation$KS$5:$KS$8763,\">0\")", "CD" : "=C_RawMeth_min_cons*CA6", "CE" : "=C_RawMeth_max_cons*CA6", "CF" : "=C_CO2_min_cons*CA6", "CG" : "=C_CO2_max_cons*CA6", "CH" : "=C_Hydrogen_min_cons*CA6", "CI" : "=C_Hydrogen_max_cons*CA6", "CJ" : "=1-CD6/RawMeth_storage_cap_ud", "CK" : "=1-CE6/RawMeth_storage_cap_ud", "CL" : "=1-CF6/CO2_storage_cap_ud", "CM" : "=1-CG6/CO2_storage_cap_ud", "CN" : "=1-CH6/Hydrogen_storage_cap_ud", "CO" : "=1-CI6/Hydrogen_storage_cap_ud", "CP" : "=IF(OR(CJ6<=0,CL6<=0,CN6<=0),0,MIN(1,IFERROR(CJ6/(CJ6-CK6),1),IFERROR(CL6/(CL6-CM6),1),IFERROR(CN6/(CN6-CO6),1))*(C_equiv_harmonious_max_perc-C_equiv_harmonious_min_perc)+C_equiv_harmonious_min_perc)",  "CR" : "=COUNTIFS(Calculation$NP$5:$NP$8763,\"=\"&$A6,Calculation$NN$5:$NN$8763,\"<=0\")", "CS" : "=COUNTIFS(Calculation$NP$5:$NP$8763,\"=\"&$A6,Calculation$NN$5:$NN$8763,\">0\")", "CT" : "=COUNTIFS(Calculation$NP$5:$NP$8763,\"=\"&$A6,Calculation$MX$5:$MX$8763,\">0\")", "CU" : "=C_RawMeth_max_cons*CR6", "CV" : "=C_CO2_max_cons*CR6", "CW" : "=C_Hydrogen_max_cons*CR6", "CX" : "=(CH6+CD6/(MethSynt_CO2_nom_cons+MethSynt_Hydrogen_nom_cons)*MethSynt_Hydrogen_nom_cons)/EY_Hydrogen_nom_prod*EY_var_gross_nom_cons+CB6*EY_fix_cons+(CF6+CD6/(MethSynt_CO2_nom_cons+MethSynt_Hydrogen_nom_cons)*MethSynt_CO2_nom_cons)/CCU_CO2_nom_prod_ud*CCU_var_nom_cons+CB6*CCU_fix_cons+CD6/MethSynt_RawMeth_nom_prod_ud*MethSynt_var_nom_cons+CB6*MethSynt_fix_cons", "CY" : "=(CW6+CU6/(MethSynt_CO2_nom_cons+MethSynt_Hydrogen_nom_cons)*MethSynt_Hydrogen_nom_cons)/EY_Hydrogen_nom_prod*EY_var_gross_nom_cons+CS6*EY_fix_cons+(CV6+CU6/(MethSynt_CO2_nom_cons+MethSynt_Hydrogen_nom_cons)*MethSynt_CO2_nom_cons)/CCU_CO2_nom_prod_ud*CCU_var_nom_cons+CS6*CCU_fix_cons+CU6/MethSynt_RawMeth_nom_prod_ud*MethSynt_var_nom_cons+CS6*MethSynt_fix_cons", "CZ" : "=(CH6+CD6/(MethSynt_CO2_nom_cons+MethSynt_Hydrogen_nom_cons)*MethSynt_Hydrogen_nom_cons)/EY_Hydrogen_nom_prod*EY_var_heat_nom_cons+CB6*EY_heat_fix_cons+(CF6+CD6/(MethSynt_CO2_nom_cons+MethSynt_Hydrogen_nom_cons)*MethSynt_CO2_nom_cons)/CCU_CO2_nom_prod_ud*CCU_var_heat_nom_cons+CB6*CCU_fix_heat_cons-CD6/MethSynt_RawMeth_nom_prod_ud*MethSynt_var_heat_nom_prod-CB6*MethSynt_heat_fix_prod", "DA" : "=(CW6+CU6/(MethSynt_CO2_nom_cons+MethSynt_Hydrogen_nom_cons)*MethSynt_Hydrogen_nom_cons)/EY_Hydrogen_nom_prod*EY_var_heat_nom_cons+CS6*EY_heat_fix_cons+(CV6+CU6/(MethSynt_CO2_nom_cons+MethSynt_Hydrogen_nom_cons)*MethSynt_CO2_nom_cons)/CCU_CO2_nom_prod_ud*CCU_var_heat_nom_cons+CS6*CCU_fix_heat_cons-CU6/MethSynt_RawMeth_nom_prod_ud*MethSynt_var_heat_nom_prod-CS6*MethSynt_heat_fix_prod", "DB" : "=CD6", "DC" : "=CU6", "DD" : "=CF6+CD6/(MethSynt_CO2_nom_cons+MethSynt_Hydrogen_nom_cons)*MethSynt_CO2_nom_cons", "DE" : "=CV6+CU6/(MethSynt_CO2_nom_cons+MethSynt_Hydrogen_nom_cons)*MethSynt_CO2_nom_cons", "DF" : "=CH6+CD6/(MethSynt_CO2_nom_cons+MethSynt_Hydrogen_nom_cons)*MethSynt_Hydrogen_nom_cons", "DG" : "=CW6+CU6/(MethSynt_CO2_nom_cons+MethSynt_Hydrogen_nom_cons)*MethSynt_Hydrogen_nom_cons", "DH" : "=1-CU6/RawMeth_storage_cap_ud", "DI" : "=1-CV6/CO2_storage_cap_ud", "DJ" : "=1-CW6/Hydrogen_storage_cap_ud", "DK" : "=IF(OR(CJ6<=0,CL6<=0,CN6<=0),0,MIN(1,IFERROR(CJ6/(CJ6-DH6),1),IFERROR(CL6/(CL6-DI6),1),IFERROR(CN6/(CN6-DJ6),1))*(C_equiv_harmonious_max_perc-C_equiv_harmonious_min_perc)+C_equiv_harmonious_min_perc)",  "DM" : "=COUNTIFS(Calculation$PQ$5:$PQ$8763,\"=\"&$A6,Calculation$PO$5:$PO$8763,\"<=0\")", "DN" : "=COUNTIFS(Calculation$PQ$5:$PQ$8763,\"=\"&$A6,Calculation$PO$5:$PO$8763,\">0\")", "DO" : "=COUNTIFS(Calculation$PQ$5:$PQ$8763,\"=\"&$A6,Calculation$OV$5:$OV$8763,\">0\",Calculation$PA$5:$PA$8763,\">0\")", "DP" : "=D_RawMeth_min_cons*DM6", "DQ" : "=D_RawMeth_max_cons*DM6", "DR" : "=D_CO2_min_cons*DM6", "DS" : "=D_CO2_max_cons*DM6", "DT" : "=D_Hydrogen_min_cons*DM6", "DU" : "=D_Hydrogen_max_cons*DM6", "DV" : "=1-DP6/RawMeth_storage_cap_ud", "DW" : "=1-DQ6/RawMeth_storage_cap_ud", "DX" : "=1-DR6/CO2_storage_cap_ud", "DY" : "=1-DS6/CO2_storage_cap_ud", "DZ" : "=1-DT6/Hydrogen_storage_cap_ud", "EA" : "=1-DU6/Hydrogen_storage_cap_ud", "EB" : "=IF(OR(DV6<=0,DX6<=0,DZ6<=0),0,MIN(1,IFERROR(DV6/(DV6-DW6),1),IFERROR(DX6/(DX6-DY6),1),IFERROR(DZ6/(DZ6-EA6),1))*(D_equiv_harmonious_max_perc-D_equiv_harmonious_min_perc)+D_equiv_harmonious_min_perc)",  "ED" : "=COUNTIFS(Calculation$RX$5:$RX$8763,\"=\"&$A6,Calculation$RV$5:$RV$8763,\"<=0\")", "EE" : "=COUNTIFS(Calculation$RX$5:$RX$8763,\"=\"&$A6,Calculation$RV$5:$RV$8763,\">0\")", "EF" : "=COUNTIFS(Calculation$RX$5:$RX$8763,\"=\"&$A6,Calculation$RF$5:$RF$8763,\">0\")", "EG" : "=D_RawMeth_max_cons*ED6", "EH" : "=D_CO2_max_cons*ED6", "EI" : "=D_Hydrogen_max_cons*ED6", "EJ" : "=(DT6+DP6/(MethSynt_CO2_nom_cons+MethSynt_Hydrogen_nom_cons)*MethSynt_Hydrogen_nom_cons)/EY_Hydrogen_nom_prod*EY_var_gross_nom_cons+DN6*EY_fix_cons+(DR6+DP6/(MethSynt_CO2_nom_cons+MethSynt_Hydrogen_nom_cons)*MethSynt_CO2_nom_cons)/CCU_CO2_nom_prod_ud*CCU_var_nom_cons+DN6*CCU_fix_cons+DP6/MethSynt_RawMeth_nom_prod_ud*MethSynt_var_nom_cons+DN6*MethSynt_fix_cons", "EK" : "=(EI6+EG6/(MethSynt_CO2_nom_cons+MethSynt_Hydrogen_nom_cons)*MethSynt_Hydrogen_nom_cons)/EY_Hydrogen_nom_prod*EY_var_gross_nom_cons+EE6*EY_fix_cons+(EH6+EG6/(MethSynt_CO2_nom_cons+MethSynt_Hydrogen_nom_cons)*MethSynt_CO2_nom_cons)/CCU_CO2_nom_prod_ud*CCU_var_nom_cons+EE6*CCU_fix_cons+EG6/MethSynt_RawMeth_nom_prod_ud*MethSynt_var_nom_cons+EE6*MethSynt_fix_cons", "EL" : "=(DT6+DP6/(MethSynt_CO2_nom_cons+MethSynt_Hydrogen_nom_cons)*MethSynt_Hydrogen_nom_cons)/EY_Hydrogen_nom_prod*EY_var_heat_nom_cons+DN6*EY_heat_fix_cons+(DR6+DP6/(MethSynt_CO2_nom_cons+MethSynt_Hydrogen_nom_cons)*MethSynt_CO2_nom_cons)/CCU_CO2_nom_prod_ud*CCU_var_heat_nom_cons+DN6*CCU_fix_heat_cons-DP6/MethSynt_RawMeth_nom_prod_ud*MethSynt_var_heat_nom_prod-DN6*MethSynt_heat_fix_prod", "EM" : "=(EI6+EG6/(MethSynt_CO2_nom_cons+MethSynt_Hydrogen_nom_cons)*MethSynt_Hydrogen_nom_cons)/EY_Hydrogen_nom_prod*EY_var_heat_nom_cons+EE6*EY_heat_fix_cons+(EH6+EG6/(MethSynt_CO2_nom_cons+MethSynt_Hydrogen_nom_cons)*MethSynt_CO2_nom_cons)/CCU_CO2_nom_prod_ud*CCU_var_heat_nom_cons+EE6*CCU_fix_heat_cons-EG6/MethSynt_RawMeth_nom_prod_ud*MethSynt_var_heat_nom_prod-EE6*MethSynt_heat_fix_prod", "EN" : "=DP6", "EO" : "=EG6", "EP" : "=DR6+DP6/(MethSynt_CO2_nom_cons+MethSynt_Hydrogen_nom_cons)*MethSynt_CO2_nom_cons", "EQ" : "=EH6+EG6/(MethSynt_CO2_nom_cons+MethSynt_Hydrogen_nom_cons)*MethSynt_CO2_nom_cons", "ER" : "=DT6+DP6/(MethSynt_CO2_nom_cons+MethSynt_Hydrogen_nom_cons)*MethSynt_Hydrogen_nom_cons", "ES" : "=EI6+EG6/(MethSynt_CO2_nom_cons+MethSynt_Hydrogen_nom_cons)*MethSynt_Hydrogen_nom_cons", "ET" : "=1-EG6/RawMeth_storage_cap_ud", "EU" : "=1-EH6/CO2_storage_cap_ud", "EV" : "=1-EI6/Hydrogen_storage_cap_ud", "EW" : "=IF(OR(DV6<=0,DX6<=0,DZ6<=0),0,MIN(1,IFERROR(DV6/(DV6-ET6),1),IFERROR(DX6/(DX6-EU6),1),IFERROR(DZ6/(DZ6-EV6),1))*(D_equiv_harmonious_max_perc-D_equiv_harmonious_min_perc)+D_equiv_harmonious_min_perc)",  "EY" : "=SUMIFS(Calculation$L$5:$L$8763,Calculation$CS$5:$CS$8763,\"=\"&$A6,Calculation$CQ$5:$CQ$8763,\">0\")+SUMIFS(Calculation$BX$5:$BX$8763,Calculation$CC$5:$CC$8763,\">0\",Calculation$CS$5:$CS$8763,\"=\"&$A6,Calculation$CQ$5:$CQ$8763,\">0\")-SUMIFS(Calculation$CI$5:$CI$8763,Calculation$CS$5:$CS$8763,\"=\"&$A6,Calculation$CQ$5:$CQ$8763,\">0\")", "EZ" : "=SUMIFS(Calculation$L$5:$L$8763,Calculation$CS$5:$CS$8763,\"=\"&$A6,Calculation$CQ$5:$CQ$8763,\"=0\")+SUMIFS(Calculation$BX$5:$BX$8763,Calculation$CC$5:$CC$8763,\">0\",Calculation$CS$5:$CS$8763,\"=\"&$A6,Calculation$CQ$5:$CQ$8763,\"=0\")-SUMIFS(Calculation$CI$5:$CI$8763,Calculation$CS$5:$CS$8763,\"=\"&$A6,Calculation$CQ$5:$CQ$8763,\"=0\")", "FA" : "=SUMIFS(Calculation$J$5:$J$8763,Calculation$CS$5:$CS$8763,\"=\"&$A6,Calculation$CQ$5:$CQ$8763,\">0\")+SUMIFS(Calculation$CB$5:$CB$8763,Calculation$CC$5:$CC$8763,\">0\",Calculation$CS$5:$CS$8763,\"=\"&$A6,Calculation$CQ$5:$CQ$8763,\">0\")/PB_Ratio_Heat_input_vs_output-SUMIFS(Calculation$CJ$5:$CJ$8763,Calculation$CS$5:$CS$8763,\"=\"&$A6,Calculation$CQ$5:$CQ$8763,\">0\")", "FB" : "=SUMIFS(Calculation$J$5:$J$8763,Calculation$CS$5:$CS$8763,\"=\"&$A6,Calculation$CQ$5:$CQ$8763,\"=0\")+SUMIFS(Calculation$CB$5:$CB$8763,Calculation$CC$5:$CC$8763,\">0\",Calculation$CS$5:$CS$8763,\"=\"&$A6,Calculation$CQ$5:$CQ$8763,\"=0\")/PB_Ratio_Heat_input_vs_output-SUMIFS(Calculation$CJ$5:$CJ$8763,Calculation$CS$5:$CS$8763,\"=\"&$A6,Calculation$CQ$5:$CQ$8763,\"=0\")", "FC" : "=SUMIF(Calculation$CS$5:$CS$8763,\"=\"&$A6,Calculation$CQ$5:$CQ$8763)+SUMIFS(Calculation$CT$5:$CT$8763,Calculation$CS$5:$CS$8763,\"=\"&$A6,Calculation$CQ$5:$CQ$8763,\">0\")", "FD" : "=SUMIF(Calculation$CS$5:$CS$8763,\"=\"&$A6,Calculation$DH$5:$DH$8763)+SUMIFS(Calculation$CT$5:$CT$8763,Calculation$CS$5:$CS$8763,\"=\"&$A6,Calculation$DH$5:$DH$8763,\">0\")", "FE" : "=SUMIFS(Calculation$CT$5:$CT$8763,Calculation$CS$5:$CS$8763,\"=\"&$A6,Calculation$CQ$5:$CQ$8763,\"=0\")", "FF" : "=SUMIF(Calculation$CS$5:$CS$8763,\"=\"&$A6,Calculation$CR$5:$CR$8763)+SUMIFS(Calculation$CU$5:$CU$8763,Calculation$CS$5:$CS$8763,\"=\"&$A6,Calculation$CQ$5:$CQ$8763,\">0\")", "FG" : "=SUMIF(Calculation$CS$5:$CS$8763,\"=\"&$A6,Calculation$DI$5:$DI$8763)+SUMIFS(Calculation$CU$5:$CU$8763,Calculation$CS$5:$CS$8763,\"=\"&$A6,Calculation$DH$5:$DH$8763,\">0\")", "FH" : "=SUMIFS(Calculation$CU$5:$CU$8763,Calculation$CS$5:$CS$8763,\"=\"&$A6,Calculation$CQ$5:$CQ$8763,\"=0\")", "FI" : "=SUMIFS(Calculation$CX$5:$CX$8763,Calculation$CS$5:$CS$8763,\"=\"&$A6,Calculation$CQ$5:$CQ$8763,\">0\")", "FJ" : "=SUMIFS(Calculation$DL$5:$DL$8763,Calculation$CS$5:$CS$8763,\"=\"&$A6,Calculation$DH$5:$DH$8763,\">0\")", "FK" : "=SUMIF(Calculation$CS$5:$CS$8763,\"=\"&$A6,Calculation$CX$5:$CX$8763)-FI6", "FL" : "=SUMIFS(Calculation$CZ$5:$CZ$8763,Calculation$CS$5:$CS$8763,\"=\"&$A6,Calculation$CQ$5:$CQ$8763,\">0\")", "FM" : "=SUMIFS(Calculation$DN$5:$DN$8763,Calculation$CS$5:$CS$8763,\"=\"&$A6,Calculation$DH$5:$DH$8763,\">0\")", "FN" : "=SUMIF(Calculation$CS$5:$CS$8763,\"=\"&$A6,Calculation$CZ$5:$CZ$8763)-FL6", "FO" : "=SUMIFS(Calculation$CM$5:$CM$8763,Calculation$CS$5:$CS$8763,\"=\"&$A6,Calculation$CQ$5:$CQ$8763,\">0\")", "FP" : "=SUMIF(Calculation$CS$5:$CS$8763,\"=\"&$A6,Calculation$CM$5:$CM$8763)-FO6", "FQ" : "=SUMIFS(Calculation$CN$5:$CN$8763,Calculation$CS$5:$CS$8763,\"=\"&$A6,Calculation$CQ$5:$CQ$8763,\">0\")", "FR" : "=SUMIF(Calculation$CS$5:$CS$8763,\"=\"&$A6,Calculation$CN$5:$CN$8763)-FQ6", "FS" : "=SUMIFS(Calculation$CV$5:$CV$8763,Calculation$CS$5:$CS$8763,\"=\"&$A6,Calculation$CQ$5:$CQ$8763,\">0\")", "FT" : "=SUMIFS(Calculation$DJ$5:$DJ$8763,Calculation$CS$5:$CS$8763,\"=\"&$A6,Calculation$DH$5:$DH$8763,\">0\")", "FU" : "=SUMIF(Calculation$CS$5:$CS$8763,\"=\"&$A6,Calculation$CV$5:$CV$8763)-FS6", "FV" : "=SUMIFS(Calculation$CW$5:$CW$8763,Calculation$CS$5:$CS$8763,\"=\"&$A6,Calculation$CQ$5:$CQ$8763,\">0\")", "FW" : "=SUMIFS(Calculation$DK$5:$DK$8763,Calculation$CS$5:$CS$8763,\"=\"&$A6,Calculation$DH$5:$DH$8763,\">0\")", "FX" : "=SUMIF(Calculation$CS$5:$CS$8763,\"=\"&$A6,Calculation$CW$5:$CW$8763)-FV6", "FY" : "=MIN(SUMIFS(Calculation$DE$5:$DE$8763,Calculation$CS$5:$CS$8763,\"=\"&$A6,Calculation$CQ$5:$CQ$8763,\">0\"),BESS_cap_ud/BESS_chrg_eff)", "FZ" : "=MIN(SUMIFS(Calculation$DS$5:$DS$8763,Calculation$CS$5:$CS$8763,\"=\"&$A6,Calculation$DH$5:$DH$8763,\">0\"),BESS_cap_ud/BESS_chrg_eff)", "GA" : "=MIN(SUMIFS(Calculation$DE$5:$DE$8763,Calculation$CS$5:$CS$8763,\"=\"&$A6,Calculation$CQ$5:$CQ$8763,\"=0\"),BESS_cap_ud/BESS_chrg_eff)", "GB" : "=SUMIFS(Calculation$DF$5:$DF$8763,Calculation$CS$5:$CS$8763,\"=\"&$A6,Calculation$CQ$5:$CQ$8763,\">0\")", "GC" : "=SUMIFS(Calculation$DT$5:$DT$8763,Calculation$CS$5:$CS$8763,\"=\"&$A6,Calculation$DH$5:$DH$8763,\">0\")", "GD" : "=SUMIF(Calculation$CS$5:$CS$8763,\"=\"&$A6,Calculation$DF$5:$DF$8763)-GB6", "GE" : "=SUMIFS(Calculation$CY$5:$CY$8763,Calculation$CS$5:$CS$8763,\"=\"&$A6,Calculation$CQ$5:$CQ$8763,\">0\")", "GF" : "=SUMIFS(Calculation$DM$5:$DM$8763,Calculation$CS$5:$CS$8763,\"=\"&$A6,Calculation$DH$5:$DH$8763,\">0\")", "GG" : "=SUMIF(Calculation$CS$5:$CS$8763,\"=\"&$A6,Calculation$CY$5:$CY$8763)-GE6", "GH" : "=SUMIFS(Calculation$DA$5:$DA$8763,Calculation$CS$5:$CS$8763,\"=\"&$A6,Calculation$CQ$5:$CQ$8763,\">0\")", "GI" : "=SUMIFS(Calculation$DO$5:$DO$8763,Calculation$CS$5:$CS$8763,\"=\"&$A6,Calculation$DH$5:$DH$8763,\">0\")", "GJ" : "=SUMIF(Calculation$CS$5:$CS$8763,\"=\"&$A6,Calculation$DA$5:$DA$8763)-GH6", "GK" : "=SUMIFS(Calculation$DB$5:$DB$8763,Calculation$CS$5:$CS$8763,\"=\"&$A6,Calculation$CQ$5:$CQ$8763,\">0\")", "GL" : "=SUMIFS(Calculation$DP$5:$DP$8763,Calculation$CS$5:$CS$8763,\"=\"&$A6,Calculation$DH$5:$DH$8763,\">0\")", "GM" : "=SUMIF(Calculation$CS$5:$CS$8763,\"=\"&$A6,Calculation$DB$5:$DB$8763)-GK6", "GN" : "=SUMIFS(Calculation$DC$5:$DC$8763,Calculation$CS$5:$CS$8763,\"=\"&$A6,Calculation$CQ$5:$CQ$8763,\">0\")", "GO" : "=SUMIFS(Calculation$DQ$5:$DQ$8763,Calculation$CS$5:$CS$8763,\"=\"&$A6,Calculation$DH$5:$DH$8763,\">0\")", "GP" : "=SUMIF(Calculation$CS$5:$CS$8763,\"=\"&$A6,Calculation$DC$5:$DC$8763)-GN6", "GQ" : "=SUMIFS(Calculation$DD$5:$DD$8763,Calculation$CS$5:$CS$8763,\"=\"&$A6,Calculation$CQ$5:$CQ$8763,\">0\")", "GR" : "=SUMIFS(Calculation$DR$5:$DR$8763,Calculation$CS$5:$CS$8763,\"=\"&$A6,Calculation$DH$5:$DH$8763,\">0\")", "GS" : "=SUMIF(Calculation$CS$5:$CS$8763,\"=\"&$A6,Calculation$DD$5:$DD$8763)-GQ6",  "GU" : "=SUMIFS(Calculation$L$5:$L$8763,Calculation$EZ$5:$EZ$8763,\"=\"&$A6,Calculation$EX$5:$EX$8763,\">0\")+SUMIFS(Calculation$EH$5:$EH$8763,Calculation$EZ$5:$EZ$8763,\"=\"&$A6,Calculation$EX$5:$EX$8763,\">0\")-SUMIFS(Calculation$EP$5:$EP$8763,Calculation$EZ$5:$EZ$8763,\"=\"&$A6,Calculation$EX$5:$EX$8763,\">0\")", "GV" : "=SUMIFS(Calculation$L$5:$L$8763,Calculation$EZ$5:$EZ$8763,\"=\"&$A6,Calculation$EX$5:$EX$8763,\"=0\")+SUMIFS(Calculation$EH$5:$EH$8763,Calculation$EZ$5:$EZ$8763,\"=\"&$A6,Calculation$EX$5:$EX$8763,\"=0\")-SUMIFS(Calculation$EP$5:$EP$8763,Calculation$EZ$5:$EZ$8763,\"=\"&$A6,Calculation$EX$5:$EX$8763,\"=0\")", "GW" : "=SUMIFS(Calculation$J$5:$J$8763,Calculation$EZ$5:$EZ$8763,\"=\"&$A6,Calculation$EX$5:$EX$8763,\">0\")+SUMIFS(Calculation$EI$5:$EI$8763,Calculation$EZ$5:$EZ$8763,\"=\"&$A6,Calculation$EX$5:$EX$8763,\">0\")/PB_Ratio_Heat_input_vs_output-SUMIFS(Calculation$EQ$5:$EQ$8763,Calculation$EZ$5:$EZ$8763,\"=\"&$A6,Calculation$EX$5:$EX$8763,\">0\")", "GX" : "=SUMIFS(Calculation$J$5:$J$8763,Calculation$EZ$5:$EZ$8763,\"=\"&$A6,Calculation$EX$5:$EX$8763,\"=0\")+SUMIFS(Calculation$EI$5:$EI$8763,Calculation$EZ$5:$EZ$8763,\"=\"&$A6,Calculation$EX$5:$EX$8763,\"=0\")/PB_Ratio_Heat_input_vs_output-SUMIFS(Calculation$EQ$5:$EQ$8763,Calculation$EZ$5:$EZ$8763,\"=\"&$A6,Calculation$EX$5:$EX$8763,\"=0\")", "GY" : "=SUMIF(Calculation$EZ$5:$EZ$8763,\"=\"&$A6,Calculation$EX$5:$EX$8763)+SUMIFS(Calculation$FA$5:$FA$8763,Calculation$EZ$5:$EZ$8763,\"=\"&$A6,Calculation$EX$5:$EX$8763,\">0\")", "GZ" : "=SUMIF(Calculation$EZ$5:$EZ$8763,\"=\"&$A6,Calculation$FO$5:$FO$8763)+SUMIFS(Calculation$FA$5:$FA$8763,Calculation$EZ$5:$EZ$8763,\"=\"&$A6,Calculation$FO$5:$FO$8763,\">0\")", "HA" : "=SUMIFS(Calculation$FA$5:$FA$8763,Calculation$EZ$5:$EZ$8763,\"=\"&$A6,Calculation$EX$5:$EX$8763,\"=0\")", "HB" : "=SUMIF(Calculation$EZ$5:$EZ$8763,\"=\"&$A6,Calculation$EY$5:$EY$8763)+SUMIFS(Calculation$FB$5:$FB$8763,Calculation$EZ$5:$EZ$8763,\"=\"&$A6,Calculation$EX$5:$EX$8763,\">0\")", "HC" : "=SUMIF(Calculation$EZ$5:$EZ$8763,\"=\"&$A6,Calculation$FP$5:$FP$8763)+SUMIFS(Calculation$FB$5:$FB$8763,Calculation$EZ$5:$EZ$8763,\"=\"&$A6,Calculation$FO$5:$FO$8763,\">0\")", "HD" : "=SUMIFS(Calculation$FB$5:$FB$8763,Calculation$EZ$5:$EZ$8763,\"=\"&$A6,Calculation$EX$5:$EX$8763,\"=0\")", "HE" : "=SUMIFS(Calculation$FE$5:$FE$8763,Calculation$EZ$5:$EZ$8763,\"=\"&$A6,Calculation$EX$5:$EX$8763,\">0\")", "HF" : "=SUMIFS(Calculation$FS$5:$FS$8763,Calculation$EZ$5:$EZ$8763,\"=\"&$A6,Calculation$FO$5:$FO$8763,\">0\")", "HG" : "=SUMIF(Calculation$EZ$5:$EZ$8763,\"=\"&$A6,Calculation$FE$5:$FE$8763)-HE6", "HH" : "=SUMIFS(Calculation$FG$5:$FG$8763,Calculation$EZ$5:$EZ$8763,\"=\"&$A6,Calculation$EX$5:$EX$8763,\">0\")", "HI" : "=SUMIFS(Calculation$FU$5:$FU$8763,Calculation$EZ$5:$EZ$8763,\"=\"&$A6,Calculation$FO$5:$FO$8763,\">0\")", "HJ" : "=SUMIF(Calculation$EZ$5:$EZ$8763,\"=\"&$A6,Calculation$FG$5:$FG$8763)-HH6", "HK" : "=SUMIFS(Calculation$ET$5:$ET$8763,Calculation$EZ$5:$EZ$8763,\"=\"&$A6,Calculation$EX$5:$EX$8763,\">0\")", "HL" : "=SUMIF(Calculation$EZ$5:$EZ$8763,\"=\"&$A6,Calculation$ET$5:$ET$8763)-HK6", "HM" : "=SUMIFS(Calculation$EU$5:$EU$8763,Calculation$EZ$5:$EZ$8763,\"=\"&$A6,Calculation$EX$5:$EX$8763,\">0\")", "HN" : "=SUMIF(Calculation$EZ$5:$EZ$8763,\"=\"&$A6,Calculation$EU$5:$EU$8763)-HM6", "HO" : "=SUMIFS(Calculation$FC$5:$FC$8763,Calculation$EZ$5:$EZ$8763,\"=\"&$A6,Calculation$EX$5:$EX$8763,\">0\")", "HP" : "=SUMIFS(Calculation$FQ$5:$FQ$8763,Calculation$EZ$5:$EZ$8763,\"=\"&$A6,Calculation$FO$5:$FO$8763,\">0\")", "HQ" : "=SUMIF(Calculation$EZ$5:$EZ$8763,\"=\"&$A6,Calculation$FC$5:$FC$8763)-HO6", "HR" : "=SUMIFS(Calculation$FD$5:$FD$8763,Calculation$EZ$5:$EZ$8763,\"=\"&$A6,Calculation$EX$5:$EX$8763,\">0\")", "HS" : "=SUMIFS(Calculation$FR$5:$FR$8763,Calculation$EZ$5:$EZ$8763,\"=\"&$A6,Calculation$FO$5:$FO$8763,\">0\")", "HT" : "=SUMIF(Calculation$EZ$5:$EZ$8763,\"=\"&$A6,Calculation$FD$5:$FD$8763)-HR6", "HU" : "=MIN(SUMIFS(Calculation$FL$5:$FL$8763,Calculation$EZ$5:$EZ$8763,\"=\"&$A6,Calculation$EX$5:$EX$8763,\">0\"),BESS_cap_ud/BESS_chrg_eff)", "HV" : "=MIN(SUMIFS(Calculation$FZ$5:$FZ$8763,Calculation$EZ$5:$EZ$8763,\"=\"&$A6,Calculation$FO$5:$FO$8763,\">0\"),BESS_cap_ud/BESS_chrg_eff)", "HW" : "=MIN(SUMIFS(Calculation$FL$5:$FL$8763,Calculation$EZ$5:$EZ$8763,\"=\"&$A6,Calculation$EX$5:$EX$8763,\"=0\"),BESS_cap_ud/BESS_chrg_eff)", "HX" : "=SUMIFS(Calculation$FM$5:$FM$8763,Calculation$EZ$5:$EZ$8763,\"=\"&$A6,Calculation$EX$5:$EX$8763,\">0\")", "HY" : "=SUMIFS(Calculation$GA$5:$GA$8763,Calculation$EZ$5:$EZ$8763,\"=\"&$A6,Calculation$FO$5:$FO$8763,\">0\")", "HZ" : "=SUMIF(Calculation$EZ$5:$EZ$8763,\"=\"&$A6,Calculation$FM$5:$FM$8763)-HX6", "IA" : "=SUMIFS(Calculation$FF$5:$FF$8763,Calculation$EZ$5:$EZ$8763,\"=\"&$A6,Calculation$EX$5:$EX$8763,\">0\")", "IB" : "=SUMIFS(Calculation$FT$5:$FT$8763,Calculation$EZ$5:$EZ$8763,\"=\"&$A6,Calculation$FO$5:$FO$8763,\">0\")", "IC" : "=SUMIF(Calculation$EZ$5:$EZ$8763,\"=\"&$A6,Calculation$FF$5:$FF$8763)-IA6", "ID" : "=SUMIFS(Calculation$FH$5:$FH$8763,Calculation$EZ$5:$EZ$8763,\"=\"&$A6,Calculation$EX$5:$EX$8763,\">0\")", "IE" : "=SUMIFS(Calculation$FV$5:$FV$8763,Calculation$EZ$5:$EZ$8763,\"=\"&$A6,Calculation$FO$5:$FO$8763,\">0\")", "IF" : "=SUMIF(Calculation$EZ$5:$EZ$8763,\"=\"&$A6,Calculation$FH$5:$FH$8763)-ID6", "IG" : "=SUMIFS(Calculation$FI$5:$FI$8763,Calculation$EZ$5:$EZ$8763,\"=\"&$A6,Calculation$EX$5:$EX$8763,\">0\")", "IH" : "=SUMIFS(Calculation$FW$5:$FW$8763,Calculation$EZ$5:$EZ$8763,\"=\"&$A6,Calculation$FO$5:$FO$8763,\">0\")", "II" : "=SUMIF(Calculation$EZ$5:$EZ$8763,\"=\"&$A6,Calculation$FI$5:$FI$8763)-IG6", "IJ" : "=SUMIFS(Calculation$FJ$5:$FJ$8763,Calculation$EZ$5:$EZ$8763,\"=\"&$A6,Calculation$EX$5:$EX$8763,\">0\")", "IK" : "=SUMIFS(Calculation$FX$5:$FX$8763,Calculation$EZ$5:$EZ$8763,\"=\"&$A6,Calculation$FO$5:$FO$8763,\">0\")", "IL" : "=SUMIF(Calculation$EZ$5:$EZ$8763,\"=\"&$A6,Calculation$FJ$5:$FJ$8763)-IJ6", "IM" : "=SUMIFS(Calculation$FK$5:$FK$8763,Calculation$EZ$5:$EZ$8763,\"=\"&$A6,Calculation$EX$5:$EX$8763,\">0\")", "IN" : "=SUMIFS(Calculation$FY$5:$FY$8763,Calculation$EZ$5:$EZ$8763,\"=\"&$A6,Calculation$FO$5:$FO$8763,\">0\")", "IO" : "=SUMIF(Calculation$EZ$5:$EZ$8763,\"=\"&$A6,Calculation$FK$5:$FK$8763)-IM6",  "IQ" : "=FS6+GE6-$Z6-MAX(0,$AB6-FV6)/El_boiler_eff-FR6/BESS_chrg_eff", "IR" : "=HO6+IA6-($Z6+($AA6-$Z6)/(A_equiv_harmonious_max_perc-A_equiv_harmonious_min_perc)*($AM6-A_equiv_harmonious_min_perc))-MAX(0,($AB6+($AC6-$AB6)/(A_equiv_harmonious_max_perc-A_equiv_harmonious_min_perc)*($AM6-A_equiv_harmonious_min_perc))-HR6)/El_boiler_eff-HN6/BESS_chrg_eff", "IS" : "=FT6+GF6-$Z6-MAX(0,$AB6-FW6)/El_boiler_eff-FR6/BESS_chrg_eff", "IT" : "=FV6+MAX(0,FS6+GE6-$Z6-FR6/BESS_chrg_eff)*El_boiler_eff-$AB6", "IU" : "=HR6+MAX(0,HO6+IA6-($Z6+($AA6-$Z6)/(A_equiv_harmonious_max_perc-A_equiv_harmonious_min_perc)*($AM6-A_equiv_harmonious_min_perc))-HN6/BESS_chrg_eff)*El_boiler_eff-($AB6+($AC6-$AB6)/(A_equiv_harmonious_max_perc-A_equiv_harmonious_min_perc)*($AM6-A_equiv_harmonious_min_perc))", "IV" : "=FW6+MAX(0,FT6+GF6-$Z6-FR6/BESS_chrg_eff)*El_boiler_eff-$AB6", "IW" : "=GH6-($AB6-FV6)/El_boiler_eff", "IX" : "=ID6-(($AB6+($AC6-$AB6)/(A_equiv_harmonious_max_perc-A_equiv_harmonious_min_perc)*($AM6-A_equiv_harmonious_min_perc))-HR6)/El_boiler_eff", "IY" : "=GI6-($AB6-FW6)/El_boiler_eff", "IZ" : "=FY6-FR6/BESS_chrg_eff", "JA" : "=HU6-HN6/BESS_chrg_eff", "JB" : "=FZ6-FR6/BESS_chrg_eff", "JC" : "=GK6-$AD6", "JD" : "=IG6-($AD6+($AE6-$AD6)/(A_equiv_harmonious_max_perc-A_equiv_harmonious_min_perc)*($AM6-A_equiv_harmonious_min_perc))", "JE" : "=GL6-$AD6", "JF" : "=GN6-$AF6", "JG" : "=IJ6-($AF6+($AG6-$AF6)/(A_equiv_harmonious_max_perc-A_equiv_harmonious_min_perc)*($AM6-A_equiv_harmonious_min_perc))", "JH" : "=GO6-$AF6", "JI" : "=GQ6-$AH6", "JJ" : "=IM6-($AH6+($AI6-$AH6)/(A_equiv_harmonious_max_perc-A_equiv_harmonious_min_perc)*($AM6-A_equiv_harmonious_min_perc))", "JK" : "=GR6-$AH6",  "JM" : "=IF(OR(IQ6<0,IT6<0,IW6<0,IZ6<0,JC6<0,JF6<0,JI6<0),0,MIN(1,IFERROR(IQ6/(IQ6-IS6),1),IFERROR(IT6/(IT6-IV6),1),IFERROR(IW6/(IW6-IY6),1),IFERROR(IZ6/(IZ6-JB6),1),IFERROR(JC6/(JC6-JE6),1),IFERROR(JF6/(JF6-JH6),1),IFERROR(JI6/(JI6-JK6),1))*(Overall_harmonious_max_perc-Overall_harmonious_min_perc)+Overall_harmonious_min_perc)", "JN" : "=IF(JM6=0,0,ROUND((FS6+(FT6-FS6)/(Overall_harmonious_max_perc-Overall_harmonious_min_perc)*(JM6-Overall_harmonious_min_perc))+(GE6+(GF6-GE6)/(Overall_harmonious_max_perc-Overall_harmonious_min_perc)*(JM6-Overall_harmonious_min_perc))-$Z6-MAX(0,$AB6-(FV6+(FW6-FV6)/(Overall_harmonious_max_perc-Overall_harmonious_min_perc)*(JM6-Overall_harmonious_min_perc)))/El_boiler_eff-FR6/BESS_chrg_eff,5))", "JO" : "=IF(JM6=0,0,ROUND((HO6+(HP6-HO6)/(Overall_harmonious_max_perc-Overall_harmonious_min_perc)*(JM6-Overall_harmonious_min_perc))+(IA6+(IB6-IA6)/(Overall_harmonious_max_perc-Overall_harmonious_min_perc)*(JM6-Overall_harmonious_min_perc))-($Z6+($AA6-$Z6)/(A_equiv_harmonious_max_perc-A_equiv_harmonious_min_perc)*($AM6-A_equiv_harmonious_min_perc))-MAX(0,($AB6+($AC6-$AB6)/(A_equiv_harmonious_max_perc-A_equiv_harmonious_min_perc)*($AM6-A_equiv_harmonious_min_perc))-(HR6+(HS6-HR6)/(Overall_harmonious_max_perc-Overall_harmonious_min_perc)*(JM6-Overall_harmonious_min_perc)))/El_boiler_eff-HN6/BESS_chrg_eff,5))", "JP" : "=IF(JM6=0,0,ROUND((FV6+(FW6-FV6)/(Overall_harmonious_max_perc-Overall_harmonious_min_perc)*(JM6-Overall_harmonious_min_perc))+MAX(0,(FS6+(FT6-FS6)/(Overall_harmonious_max_perc-Overall_harmonious_min_perc)*(JM6-Overall_harmonious_min_perc))+(GE6+(GF6-GE6)/(Overall_harmonious_max_perc-Overall_harmonious_min_perc)*(JM6-Overall_harmonious_min_perc))-$Z6-FR6/BESS_chrg_eff)*El_boiler_eff-$AB6,5))", "JQ" : "=IF(JM6=0,0,ROUND((HR6+(HS6-HR6)/(Overall_harmonious_max_perc-Overall_harmonious_min_perc)*(JM6-Overall_harmonious_min_perc))+MAX(0,(HO6+(HP6-HO6)/(Overall_harmonious_max_perc-Overall_harmonious_min_perc)*(JM6-Overall_harmonious_min_perc))+(IA6+(IB6-IA6)/(Overall_harmonious_max_perc-Overall_harmonious_min_perc)*(JM6-Overall_harmonious_min_perc))-($Z6+($AA6-$Z6)/(A_equiv_harmonious_max_perc-A_equiv_harmonious_min_perc)*($AM6-A_equiv_harmonious_min_perc))-HN6/BESS_chrg_eff)*El_boiler_eff-($AB6+($AC6-$AB6)/(A_equiv_harmonious_max_perc-A_equiv_harmonious_min_perc)*($AM6-A_equiv_harmonious_min_perc)),5))", "JR" : "=IF(JM6=0,0,ROUND((GH6+(GI6-GH6)/(Overall_harmonious_max_perc-Overall_harmonious_min_perc)*(JM6-Overall_harmonious_min_perc))-($AB6-(FV6+(FW6-FV6)/(Overall_harmonious_max_perc-Overall_harmonious_min_perc)*(JM6-Overall_harmonious_min_perc)))/El_boiler_eff,5))", "JS" : "=IF(JM6=0,0,ROUND((ID6+(IE6-ID6)/(Overall_harmonious_max_perc-Overall_harmonious_min_perc)*(JM6-Overall_harmonious_min_perc))-(($AB6+($AC6-$AB6)/(A_equiv_harmonious_max_perc-A_equiv_harmonious_min_perc)*($AM6-A_equiv_harmonious_min_perc))-(HR6+(HS6-HR6)/(Overall_harmonious_max_perc-Overall_harmonious_min_perc)*(JM6-Overall_harmonious_min_perc)))/El_boiler_eff,5))", "JT" : "=IF(JM6=0,0,ROUND((FY6+(FZ6-FY6)/(Overall_harmonious_max_perc-Overall_harmonious_min_perc)*(JM6-Overall_harmonious_min_perc))-FR6/BESS_chrg_eff,5))", "JU" : "=IF(JM6=0,0,ROUND((HU6+(HV6-HU6)/(Overall_harmonious_max_perc-Overall_harmonious_min_perc)*(JM6-Overall_harmonious_min_perc))-HN6/BESS_chrg_eff,5))", "JV" : "=IF(JM6=0,0,ROUND((GK6+(GL6-GK6)/(Overall_harmonious_max_perc-Overall_harmonious_min_perc)*(JM6-Overall_harmonious_min_perc))-$AD6,5))", "JW" : "=IF(JM6=0,0,ROUND(GK6+(GL6-GK6)/(Overall_harmonious_max_perc-Overall_harmonious_min_perc)*(JM6-Overall_harmonious_min_perc)-($AD6+($AE6-$AD6)/(A_equiv_harmonious_max_perc-A_equiv_harmonious_min_perc)*($AM6-A_equiv_harmonious_min_perc)),5))", "JX" : "=IF(JM6=0,0,ROUND((GN6+(GO6-GN6)/(Overall_harmonious_max_perc-Overall_harmonious_min_perc)*(JM6-Overall_harmonious_min_perc))-$AF6,5))", "JY" : "=IF(JM6=0,0,ROUND(GN6+(GO6-GN6)/(Overall_harmonious_max_perc-Overall_harmonious_min_perc)*(JM6-Overall_harmonious_min_perc)-($AF6+($AG6-$AF6)/(A_equiv_harmonious_max_perc-A_equiv_harmonious_min_perc)*($AM6-A_equiv_harmonious_min_perc)),5))", "JZ" : "=IF(JM6=0,0,ROUND((GQ6+(GR6-GQ6)/(Overall_harmonious_max_perc-Overall_harmonious_min_perc)*(JM6-Overall_harmonious_min_perc))-$AH6,5))", "KA" : "=IF(JM6=0,0,ROUND(GQ6+(GR6-GQ6)/(Overall_harmonious_max_perc-Overall_harmonious_min_perc)*(JM6-Overall_harmonious_min_perc)-($AH6+($AI6-$AH6)/(A_equiv_harmonious_max_perc-A_equiv_harmonious_min_perc)*($AM6-A_equiv_harmonious_min_perc)),5))", "KB" : "=IF(OR(JM6=0,JN6<0,JP6<0,JR6<0,JT6<0,JV6<0,JX6<0,JZ6<0),0,MIN(1,IFERROR(JN6/(JN6-JO6),1),IFERROR(JP6/(JP6-JQ6),1),IFERROR(JR6/(JR6-JS6),1),IFERROR(JT6/(JT6-JU6),1),IFERROR(JV6/(JV6-JW6),1),IFERROR(JX6/(JX6-JY6),1),IFERROR(JZ6/(JZ6-KA6),1))*($AM6-A_equiv_harmonious_min_perc)+A_equiv_harmonious_min_perc)",  "KD" : "=IF(OR(IQ6<0,IT6<0,IW6<0,IZ6<0,JC6<0,JF6<0,JI6<0),0,MIN(1,IFERROR(IQ6/(IQ6-IR6),1),IFERROR(IT6/(IT6-IU6),1),IFERROR(IW6/(IW6-IX6),1),IFERROR(IZ6/(IZ6-JA6),1),IFERROR(JC6/(JC6-JD6),1),IFERROR(JF6/(JF6-JG6),1),IFERROR(JI6/(JI6-JJ6),1))*($AM6-A_equiv_harmonious_min_perc)+A_equiv_harmonious_min_perc)", "KE" : "=IF(KD6=0,0,ROUND((FS6+(HO6-FS6)/($AM6-A_equiv_harmonious_min_perc)*(KD6-A_equiv_harmonious_min_perc))+(GE6+(IA6-GE6)/($AM6-A_equiv_harmonious_min_perc)*(KD6-A_equiv_harmonious_min_perc))-($Z6+($AA6-$Z6)/(A_equiv_harmonious_max_perc-A_equiv_harmonious_min_perc)*(KD6-A_equiv_harmonious_min_perc))-MAX(0,($AB6+($AC6-$AB6)/(A_equiv_harmonious_max_perc-A_equiv_harmonious_min_perc)*(KD6-A_equiv_harmonious_min_perc))-(FV6+(HR6-FV6)/($AM6-A_equiv_harmonious_min_perc)*(KD6-A_equiv_harmonious_min_perc)))/El_boiler_eff-(FR6+(HN6-FR6)/($AM6-A_equiv_harmonious_min_perc)*(KD6-A_equiv_harmonious_min_perc))/BESS_chrg_eff,5))", "KF" : "=IF(KD6=0,0,ROUND((FT6+(HP6-FT6)/($AM6-A_equiv_harmonious_min_perc)*(KD6-A_equiv_harmonious_min_perc))+(GF6+(IB6-GF6)/($AM6-A_equiv_harmonious_min_perc)*(KD6-A_equiv_harmonious_min_perc))-($Z6+($AA6-$Z6)/(A_equiv_harmonious_max_perc-A_equiv_harmonious_min_perc)*(KD6-A_equiv_harmonious_min_perc))-MAX(0,($AB6+($AC6-$AB6)/(A_equiv_harmonious_max_perc-A_equiv_harmonious_min_perc)*(KD6-A_equiv_harmonious_min_perc))-(FW6+(HS6-FW6)/($AM6-A_equiv_harmonious_min_perc)*(KD6-A_equiv_harmonious_min_perc)))/El_boiler_eff-(FR6+(HN6-FR6)/($AM6-A_equiv_harmonious_min_perc)*(KD6-A_equiv_harmonious_min_perc))/BESS_chrg_eff,5))", "KG" : "=IF(KD6=0,0,ROUND((FV6+(HR6-FV6)/($AM6-A_equiv_harmonious_min_perc)*(KD6-A_equiv_harmonious_min_perc))+(MAX(0,(FS6+(HO6-FS6)/($AM6-A_equiv_harmonious_min_perc)*(KD6-A_equiv_harmonious_min_perc))+(GE6+(IA6-GE6)/($AM6-A_equiv_harmonious_min_perc)*(KD6-A_equiv_harmonious_min_perc))-($Z6+($AA6-$Z6)/(A_equiv_harmonious_max_perc-A_equiv_harmonious_min_perc)*(KD6-A_equiv_harmonious_min_perc))-((FR6+(HN6-FR6)/($AM6-A_equiv_harmonious_min_perc)*(KD6-A_equiv_harmonious_min_perc))/BESS_chrg_eff)))*El_boiler_eff-($AB6+($AC6-$AB6)/(A_equiv_harmonious_max_perc-A_equiv_harmonious_min_perc)*(KD6-A_equiv_harmonious_min_perc)),5))", "KH" : "=IF(KD6=0,0,ROUND((FW6+(HS6-FW6)/($AM6-A_equiv_harmonious_min_perc)*(KD6-A_equiv_harmonious_min_perc))+(MAX(0,(FT6+(HP6-FT6)/($AM6-A_equiv_harmonious_min_perc)*(KD6-A_equiv_harmonious_min_perc))+(GF6+(IB6-GF6)/($AM6-A_equiv_harmonious_min_perc)*(KD6-A_equiv_harmonious_min_perc))-($Z6+($AA6-$Z6)/(A_equiv_harmonious_max_perc-A_equiv_harmonious_min_perc)*(KD6-A_equiv_harmonious_min_perc))-((FR6+(HN6-FR6)/($AM6-A_equiv_harmonious_min_perc)*(KD6-A_equiv_harmonious_min_perc))/BESS_chrg_eff)))*El_boiler_eff-($AB6+($AC6-$AB6)/(A_equiv_harmonious_max_perc-A_equiv_harmonious_min_perc)*(KD6-A_equiv_harmonious_min_perc)),5))", "KI" : "=IF(KD6=0,0,ROUND((GH6+(ID6-GH6)/($AM6-A_equiv_harmonious_min_perc)*(KD6-A_equiv_harmonious_min_perc))-(($AB6+($AC6-$AB6)/(A_equiv_harmonious_max_perc-A_equiv_harmonious_min_perc)*(KD6-A_equiv_harmonious_min_perc))-(FV6+(HR6-FV6)/($AM6-A_equiv_harmonious_min_perc)*(KD6-A_equiv_harmonious_min_perc)))/El_boiler_eff,5))", "KJ" : "=IF(KD6=0,0,ROUND((GI6+(IE6-GI6)/($AM6-A_equiv_harmonious_min_perc)*(KD6-A_equiv_harmonious_min_perc))-(($AB6+($AC6-$AB6)/(A_equiv_harmonious_max_perc-A_equiv_harmonious_min_perc)*(KD6-A_equiv_harmonious_min_perc))-(FW6+(HS6-FW6)/($AM6-A_equiv_harmonious_min_perc)*(KD6-A_equiv_harmonious_min_perc)))/El_boiler_eff,5))", "KK" : "=IF(KD6=0,0,ROUND((FY6+(HU6-FY6)/($AM6-A_equiv_harmonious_min_perc)*(KD6-A_equiv_harmonious_min_perc))-(FR6+(HN6-FR6)/($AM6-A_equiv_harmonious_min_perc)*(KD6-A_equiv_harmonious_min_perc))/BESS_chrg_eff,5))", "KL" : "=IF(KD6=0,0,ROUND((FZ6+(HV6-FZ6)/($AM6-A_equiv_harmonious_min_perc)*(KD6-A_equiv_harmonious_min_perc))-(FR6+(HN6-FR6)/($AM6-A_equiv_harmonious_min_perc)*(KD6-A_equiv_harmonious_min_perc))/BESS_chrg_eff,5))", "KM" : "=IF(KD6=0,0,ROUND((GK6+(IG6-GK6)/($AM6-A_equiv_harmonious_min_perc)*(KD6-A_equiv_harmonious_min_perc))-($AD6+($AE6-$AD6)/(A_equiv_harmonious_max_perc-A_equiv_harmonious_min_perc)*(KD6-A_equiv_harmonious_min_perc)),5))", "KN" : "=IF(KD6=0,0,ROUND((GL6+(IH6-GL6)/($AM6-A_equiv_harmonious_min_perc)*(KD6-A_equiv_harmonious_min_perc))-($AD6+($AE6-$AD6)/(A_equiv_harmonious_max_perc-A_equiv_harmonious_min_perc)*(KD6-A_equiv_harmonious_min_perc)),5))", "KO" : "=IF(KD6=0,0,ROUND((GN6+(IJ6-GN6)/($AM6-A_equiv_harmonious_min_perc)*(KD6-A_equiv_harmonious_min_perc))-($AF6+($AG6-$AF6)/(A_equiv_harmonious_max_perc-A_equiv_harmonious_min_perc)*(KD6-A_equiv_harmonious_min_perc)),5))", "KP" : "=IF(KD6=0,0,ROUND((GO6+(IK6-GO6)/($AM6-A_equiv_harmonious_min_perc)*(KD6-A_equiv_harmonious_min_perc))-($AF6+($AG6-$AF6)/(A_equiv_harmonious_max_perc-A_equiv_harmonious_min_perc)*(KD6-A_equiv_harmonious_min_perc)),5))", "KQ" : "=IF(KD6=0,0,ROUND((GQ6+(IM6-GQ6)/($AM6-A_equiv_harmonious_min_perc)*(KD6-A_equiv_harmonious_min_perc))-($AH6+($AI6-$AH6)/(A_equiv_harmonious_max_perc-A_equiv_harmonious_min_perc)*(KD6-A_equiv_harmonious_min_perc)),5))", "KR" : "=IF(KD6=0,0,ROUND((GR6+(IN6-GR6)/($AM6-A_equiv_harmonious_min_perc)*(KD6-A_equiv_harmonious_min_perc))-($AH6+($AI6-$AH6)/(A_equiv_harmonious_max_perc-A_equiv_harmonious_min_perc)*(KD6-A_equiv_harmonious_min_perc)),5))", "KS" : "=IF(KD6<=0,0,MIN(1,IFERROR(KE6/(KE6-KF6),1),IFERROR(KG6/(KG6-KH6),1),IFERROR(KI6/(KI6-KJ6),1),IFERROR(KK6/(KK6-KL6),1),IFERROR(KM6/(KM6-KN6),1),IFERROR(KO6/(KO6-KP6),1),IFERROR(KQ6/(KQ6-KR6),1))*(Overall_harmonious_max_perc-Overall_harmonious_min_perc)+Overall_harmonious_min_perc)",  "KU" : "=IF(OR(JM6=0,KB6=0),0,(FC6+(GY6-FC6)/($AM6-A_equiv_harmonious_min_perc)*(KB6-A_equiv_harmonious_min_perc))+((FD6+(GZ6-FD6)/($AM6-A_equiv_harmonious_min_perc)*(KB6-A_equiv_harmonious_min_perc))-(FC6+(GY6-FC6)/($AM6-A_equiv_harmonious_min_perc)*(KB6-A_equiv_harmonious_min_perc)))/(Overall_harmonious_max_perc-Overall_harmonious_min_perc)*(JM6-Overall_harmonious_min_perc))", "KV" : "=IF(OR(JM6=0,KB6=0),0,($Z6+($AA6-$Z6)/(A_equiv_harmonious_max_perc-A_equiv_harmonious_min_perc)*(KB6-A_equiv_harmonious_min_perc)))", "KW" : "=IF(OR(JM6=0,KB6=0),0,FO6+(HK6-FO6)/($AM6-A_equiv_harmonious_min_perc)*(KB6-A_equiv_harmonious_min_perc))", "KX" : "=IF(OR(JM6=0,KB6=0),0,MIN(((FY6+(HU6-FY6)/($AM6-A_equiv_harmonious_min_perc)*(KB6-A_equiv_harmonious_min_perc))+((FZ6+(HV6-FZ6)/($AM6-A_equiv_harmonious_min_perc)*(KB6-A_equiv_harmonious_min_perc))-(FY6+(HU6-FY6)/($AM6-A_equiv_harmonious_min_perc)*(KB6-A_equiv_harmonious_min_perc)))/(Overall_harmonious_max_perc-Overall_harmonious_min_perc)*(JM6-Overall_harmonious_min_perc)),(FR6+(HN6-FR6)/($AM6-A_equiv_harmonious_min_perc)*(KB6-A_equiv_harmonious_min_perc))/BESS_chrg_eff))", "KY" : "=IF(OR(JM6=0,KB6=0),0,(FL6+(HH6-FL6)/($AM6-A_equiv_harmonious_min_perc)*(KB6-A_equiv_harmonious_min_perc))+((FM6+(HI6-FM6)/($AM6-A_equiv_harmonious_min_perc)*(KB6-A_equiv_harmonious_min_perc))-(FL6+(HH6-FL6)/($AM6-A_equiv_harmonious_min_perc)*(KB6-A_equiv_harmonious_min_perc)))/(Overall_harmonious_max_perc-Overall_harmonious_min_perc)*(JM6-Overall_harmonious_min_perc))", "KZ" : "=LH6/El_boiler_eff", "LA" : "=IF(OR(JM6=0,KB6=0),0,EY6+(GU6-EY6)/($AM6-A_equiv_harmonious_min_perc)*(KB6-A_equiv_harmonious_min_perc))", "LB" : "=IF(OR(JM6=0,KB6=0),0,(FI6+(HE6-FI6)/($AM6-A_equiv_harmonious_min_perc)*(KB6-A_equiv_harmonious_min_perc))+((FJ6+(HF6-FJ6)/($AM6-A_equiv_harmonious_min_perc)*(KB6-A_equiv_harmonious_min_perc))-(FI6+(HE6-FI6)/($AM6-A_equiv_harmonious_min_perc)*(KB6-A_equiv_harmonious_min_perc)))/(Overall_harmonious_max_perc-Overall_harmonious_min_perc)*(JM6-Overall_harmonious_min_perc))", "LC" : "=IF(OR(JM6=0,KB6=0),0,MIN((GE6+(IA6-GE6)/($AM6-A_equiv_harmonious_min_perc)*(KB6-A_equiv_harmonious_min_perc))+((GF6+(IB6-GF6)/($AM6-A_equiv_harmonious_min_perc)*(KB6-A_equiv_harmonious_min_perc))-(GE6+(IA6-GE6)/($AM6-A_equiv_harmonious_min_perc)*(KB6-A_equiv_harmonious_min_perc)))/(Overall_harmonious_max_perc-Overall_harmonious_min_perc)*(JM6-Overall_harmonious_min_perc),MAX(0,-(LA6+LB6-KU6-KV6-KW6-KX6-KY6-KZ6))))", "LD" : "=LA6+LB6+LC6-KU6-KV6-KW6-KX6-KY6-KZ6", "LE" : "=IF(OR(JM6=0,KB6=0),0,(FF6+(HB6-FF6)/($AM6-A_equiv_harmonious_min_perc)*(KB6-A_equiv_harmonious_min_perc))+((FG6+(HC6-FG6)/($AM6-A_equiv_harmonious_min_perc)*(KB6-A_equiv_harmonious_min_perc))-(FF6+(HB6-FF6)/($AM6-A_equiv_harmonious_min_perc)*(KB6-A_equiv_harmonious_min_perc)))/(Overall_harmonious_max_perc-Overall_harmonious_min_perc)*(JM6-Overall_harmonious_min_perc))", "LF" : "=IF(OR(JM6=0,KB6=0),0,($AB6+($AC6-$AB6)/(A_equiv_harmonious_max_perc-A_equiv_harmonious_min_perc)*(KB6-A_equiv_harmonious_min_perc)))", "LG" : "=IF(OR(JM6=0,KB6=0),0,KY6*El_boiler_eff)", "LH" : "=IF(OR(JM6=0,KB6=0),0,MAX(0,LF6-((FV6+(HR6-FV6)/($AM6-A_equiv_harmonious_min_perc)*(KB6-A_equiv_harmonious_min_perc))+((FW6+(HS6-FW6)/($AM6-A_equiv_harmonious_min_perc)*(KB6-A_equiv_harmonious_min_perc))-(FV6+(HR6-FV6)/($AM6-A_equiv_harmonious_min_perc)*(KB6-A_equiv_harmonious_min_perc)))/(Overall_harmonious_max_perc-Overall_harmonious_min_perc)*(JM6-Overall_harmonious_min_perc))))", "LI" : "=IF(OR(JM6=0,KB6=0),0,FA6+(GW6-FA6)/($AM6-A_equiv_harmonious_min_perc)*(KB6-A_equiv_harmonious_min_perc))", "LJ" : "=LG6+LH6+LI6-LE6-LF6", "LK" : "=IF(OR(JM6=0,KB6=0),0,FE6+(HA6-FE6)/($AM6-A_equiv_harmonious_min_perc)*(KB6-A_equiv_harmonious_min_perc))", "LL" : "=IF(OR(JM6=0,KB6=0),0,FP6+(HL6-FP6)/($AM6-A_equiv_harmonious_min_perc)*(KB6-A_equiv_harmonious_min_perc))", "LM" : "=IF(OR(JM6=0,KB6=0),0,FN6+(HJ6-FN6)/($AM6-A_equiv_harmonious_min_perc)*(KB6-A_equiv_harmonious_min_perc))", "LN" : "=KX6*BESS_chrg_eff", "LO" : "=IF(OR(JM6=0,KB6=0),0,EZ6+(GV6-EZ6)/($AM6-A_equiv_harmonious_min_perc)*(KB6-A_equiv_harmonious_min_perc))", "LP" : "=IF(OR(JM6=0,KB6=0),0,MIN(GG6+(IC6-GG6)/($AM6-A_equiv_harmonious_min_perc)*(KB6-A_equiv_harmonious_min_perc),MAX(0,-(LN6+LO6-LK6-LL6-LM6))))", "LQ" : "=LN6+LO6+LP6-LK6-LL6-LM6", "LR" : "=IF(OR(JM6=0,KB6=0),0,FH6+(HD6-FH6)/($AM6-A_equiv_harmonious_min_perc)*(KB6-A_equiv_harmonious_min_perc))", "LS" : "=IF(OR(JM6=0,KB6=0),0,LM6*El_boiler_eff)", "LT" : "=IF(OR(JM6=0,KB6=0),0,FB6+(GX6-FB6)/($AM6-A_equiv_harmonious_min_perc)*(KB6-A_equiv_harmonious_min_perc))", "LU" : "=LS6+LT6-LR6", "LV" : "=IF(KU6<=0,0,KU6/(Overall_harmonious_var_max_cons+Overall_fix_cons)*MethDist_harmonious_max_perc*MethDist_Meth_nom_prod_ud)+IF(LK6<=0,0,(LK6-A_overall_stup_cons)/(A_overall_var_max_cons+A_overall_fix_stby_cons)*A_MethDist_max_perc*MethDist_Meth_nom_prod_ud)", "LW" : "=MIN(LD6,IF(OR(JM6=0,KB6=0),0,(GB6+(HX6-GB6)/($AM6-A_equiv_harmonious_min_perc)*(KB6-A_equiv_harmonious_min_perc))+((GC6+(HY6-GC6)/($AM6-A_equiv_harmonious_min_perc)*(KB6-A_equiv_harmonious_min_perc))-(GB6+(HX6-GB6)/($AM6-A_equiv_harmonious_min_perc)*(KB6-A_equiv_harmonious_min_perc)))/(Overall_harmonious_max_perc-Overall_harmonious_min_perc)*(JM6-Overall_harmonious_min_perc)))+MIN(LQ6,IF(OR(JM6=0,KB6=0),0,GD6+(HZ6-GD6)/($AM6-A_equiv_harmonious_min_perc)*(KB6-A_equiv_harmonious_min_perc)))", "LX" : "=LP6+LC6", "LY" : "=IF(KB6<=0,0,($C6+($T6-$C6)/(A_equiv_harmonious_max_perc-A_equiv_harmonious_min_perc)*(KB6-A_equiv_harmonious_min_perc)))", "LZ" : "=IF(KB6<=0,0,($D6+($U6-$D6)/(A_equiv_harmonious_max_perc-A_equiv_harmonious_min_perc)*(KB6-A_equiv_harmonious_min_perc)))", "MA" : "=IF(KB6<=0,0,($E6+($V6-$E6)/(A_equiv_harmonious_max_perc-A_equiv_harmonious_min_perc)*(KB6-A_equiv_harmonious_min_perc)))", "MB" : "=MAX(0,-LD6)+MAX(0,-LJ6)+MAX(0,-LQ6)+MAX(0,-LU6)",  "MD" : "=IF(OR(KS6=0,KD6=0),0,(FC6+(GY6-FC6)/($AM6-A_equiv_harmonious_min_perc)*(KD6-A_equiv_harmonious_min_perc))+((FD6+(GZ6-FD6)/($AM6-A_equiv_harmonious_min_perc)*(KD6-A_equiv_harmonious_min_perc))-(FC6+(GY6-$FC6)/($AM6-A_equiv_harmonious_min_perc)*(KD6-A_equiv_harmonious_min_perc)))/(Overall_harmonious_max_perc-Overall_harmonious_min_perc)*(KS6-Overall_harmonious_min_perc))", "ME" : "=IF(OR(KS6=0,KD6=0),0,($Z6+($AA6-$Z6)/(A_equiv_harmonious_max_perc-A_equiv_harmonious_min_perc)*(KD6-A_equiv_harmonious_min_perc)))", "MF" : "=IF(OR(KS6=0,KD6=0),0,FO6+(HK6-FO6)/($AM6-A_equiv_harmonious_min_perc)*(KD6-A_equiv_harmonious_min_perc))", "MG" : "=IF(OR(KS6=0,KD6=0),0,MIN(((FY6+(HU6-FY6)/($AM6-A_equiv_harmonious_min_perc)*(KD6-A_equiv_harmonious_min_perc))+((FZ6+(HV6-FZ6)/($AM6-A_equiv_harmonious_min_perc)*(KD6-A_equiv_harmonious_min_perc))-(FY6+(HU6-FY6)/($AM6-A_equiv_harmonious_min_perc)*(KD6-A_equiv_harmonious_min_perc)))/(Overall_harmonious_max_perc-Overall_harmonious_min_perc)*(KS6-Overall_harmonious_min_perc)),(FR6+(HN6-FR6)/($AM6-A_equiv_harmonious_min_perc)*(KD6-A_equiv_harmonious_min_perc))/BESS_chrg_eff))", "MH" : "=IF(OR(KS6=0,KD6=0),0,(FL6+(HH6-FL6)/($AM6-A_equiv_harmonious_min_perc)*(KD6-A_equiv_harmonious_min_perc))+((FM6+(HI6-FM6)/($AM6-A_equiv_harmonious_min_perc)*(KD6-A_equiv_harmonious_min_perc))-(FL6+(HH6-FL6)/($AM6-A_equiv_harmonious_min_perc)*(KD6-A_equiv_harmonious_min_perc)))/(Overall_harmonious_max_perc-Overall_harmonious_min_perc)*(KS6-Overall_harmonious_min_perc))", "MI" : "=MQ6/El_boiler_eff", "MJ" : "=IF(OR(KS6=0,KD6=0),0,EY6+(GU6-EY6)/($AM6-A_equiv_harmonious_min_perc)*(KD6-A_equiv_harmonious_min_perc))", "MK" : "=IF(OR(KD6=0,KS6=0),0,(FI6+(HE6-FI6)/($AM6-A_equiv_harmonious_min_perc)*(KD6-A_equiv_harmonious_min_perc))+((FJ6+(HF6-FJ6)/($AM6-A_equiv_harmonious_min_perc)*(KD6-A_equiv_harmonious_min_perc))-(FI6+(HE6-FI6)/($AM6-A_equiv_harmonious_min_perc)*(KD6-A_equiv_harmonious_min_perc)))/(Overall_harmonious_max_perc-Overall_harmonious_min_perc)*(KS6-Overall_harmonious_min_perc))", "ML" : "=IF(OR(KD6=0,KS6=0),0,MIN((GE6+(IA6-GE6)/($AM6-A_equiv_harmonious_min_perc)*(KD6-A_equiv_harmonious_min_perc))+((GF6+(IB6-GF6)/($AM6-A_equiv_harmonious_min_perc)*(KD6-A_equiv_harmonious_min_perc))-(GE6+(IA6-GE6)/($AM6-A_equiv_harmonious_min_perc)*(KD6-A_equiv_harmonious_min_perc)))/(Overall_harmonious_max_perc-Overall_harmonious_min_perc)*(KS6-Overall_harmonious_min_perc),MAX(0,-(MJ6+MK6-MD6-ME6-MF6-MG6-MH6-MI6))))", "MM" : "=MJ6+MK6+ML6-MD6-ME6-MF6-MG6-MH6-MI6", "MN" : "=IF(OR(KS6=0,KD6=0),0,(FF6+(HB6-FF6)/($AM6-A_equiv_harmonious_min_perc)*(KD6-A_equiv_harmonious_min_perc))+((FG6+(HC6-FG6)/($AM6-A_equiv_harmonious_min_perc)*(KD6-A_equiv_harmonious_min_perc))-(FF6+(HB6-FF6)/($AM6-A_equiv_harmonious_min_perc)*(KD6-A_equiv_harmonious_min_perc)))/(Overall_harmonious_max_perc-Overall_harmonious_min_perc)*(KS6-Overall_harmonious_min_perc))", "MO" : "=IF(OR(KS6=0,KD6=0),0,($AB6+($AC6-$AB6)/(A_equiv_harmonious_max_perc-A_equiv_harmonious_min_perc)*(KD6-A_equiv_harmonious_min_perc)))", "MP" : "=IF(OR(KS6=0,KD6=0),0,MH6*El_boiler_eff)", "MQ" : "=IF(OR(KS6=0,KD6=0),0,MAX(0,MO6-((FV6+(HR6-FV6)/($AM6-A_equiv_harmonious_min_perc)*(KD6-A_equiv_harmonious_min_perc))+((FW6+(HS6-FW6)/($AM6-A_equiv_harmonious_min_perc)*(KD6-A_equiv_harmonious_min_perc))-(FV6+(HR6-FV6)/($AM6-A_equiv_harmonious_min_perc)*(KD6-A_equiv_harmonious_min_perc)))/(Overall_harmonious_max_perc-Overall_harmonious_min_perc)*(KS6-Overall_harmonious_min_perc))))", "MR" : "=IF(OR(KS6=0,KD6=0),0,FA6+(GW6-FA6)/($AM6-A_equiv_harmonious_min_perc)*(KD6-A_equiv_harmonious_min_perc))", "MS" : "=MP6+MQ6+MR6-MN6-MO6", "MT" : "=IF(OR(KS6=0,KD6=0),0,FE6+(HA6-FE6)/($AM6-A_equiv_harmonious_min_perc)*(KD6-A_equiv_harmonious_min_perc))", "MU" : "=IF(OR(KS6=0,KD6=0),0,FP6+(HL6-FP6)/($AM6-A_equiv_harmonious_min_perc)*(KD6-A_equiv_harmonious_min_perc))", "MV" : "=IF(OR(KS6=0,KD6=0),0,FN6+(HJ6-FN6)/($AM6-A_equiv_harmonious_min_perc)*(KD6-A_equiv_harmonious_min_perc))", "MW" : "=MG6*BESS_chrg_eff", "MX" : "=IF(OR(KS6=0,KD6=0),0,EZ6+(GV6-EZ6)/($AM6-A_equiv_harmonious_min_perc)*(KD6-A_equiv_harmonious_min_perc))", "MY" : "=IF(OR(KS6=0,KD6=0),0,MIN(GG6+(IC6-GG6)/($AM6-A_equiv_harmonious_min_perc)*(KD6-A_equiv_harmonious_min_perc),MAX(0,-(MW6+MX6-MT6-MU6-MV6))))", "MZ" : "=MW6+MX6+MY6-MT6-MU6-MV6", "NA" : "=IF(OR(KS6=0,KD6=0),0,FH6+(HD6-FH6)/($AM6-A_equiv_harmonious_min_perc)*(KD6-A_equiv_harmonious_min_perc))", "NB" : "=IF(OR(KS6=0,KD6=0),0,MV6*El_boiler_eff)", "NC" : "=IF(OR(KS6=0,KD6=0),0,FB6+(GX6-FB6)/($AM6-A_equiv_harmonious_min_perc)*(KD6-A_equiv_harmonious_min_perc))", "ND" : "=NB6+NC6-NA6", "NE" : "=IF(MD6<=0,0,MD6/(Overall_harmonious_var_max_cons+Overall_fix_cons)*MethDist_harmonious_max_perc*MethDist_Meth_nom_prod_ud)+IF(MT6<=0,0,(MT6-A_overall_stup_cons)/(A_overall_var_max_cons+A_overall_fix_stby_cons)*A_MethDist_max_perc*MethDist_Meth_nom_prod_ud)", "NF" : "=MIN(MM6,IF(OR(KS6=0,KD6=0),0,(GB6+(HX6-GB6)/($AM6-A_equiv_harmonious_min_perc)*(KD6-A_equiv_harmonious_min_perc))+((GC6+(HY6-GC6)/($AM6-A_equiv_harmonious_min_perc)*(KD6-A_equiv_harmonious_min_perc))-(GB6+(HX6-GB6)/($AM6-A_equiv_harmonious_min_perc)*(KD6-A_equiv_harmonious_min_perc)))/(Overall_harmonious_max_perc-Overall_harmonious_min_perc)*(KS6-Overall_harmonious_min_perc)))+MIN(MZ6,IF(OR(KS6=0,KD6=0),0,GD6+(HZ6-GD6)/($AM6-A_equiv_harmonious_min_perc)*(KD6-A_equiv_harmonious_min_perc)))", "NG" : "=MY6+ML6", "NH" : "=IF(KD6<=0,0,($C6+($T6-$C6)/(A_equiv_harmonious_max_perc-A_equiv_harmonious_min_perc)*(KD6-A_equiv_harmonious_min_perc)))", "NI" : "=IF(KD6<=0,0,($D6+($U6-$D6)/(A_equiv_harmonious_max_perc-A_equiv_harmonious_min_perc)*(KD6-A_equiv_harmonious_min_perc)))", "NJ" : "=IF(KD6<=0,0,($E6+($V6-$E6)/(A_equiv_harmonious_max_perc-A_equiv_harmonious_min_perc)*(KD6-A_equiv_harmonious_min_perc)))", "NK" : "=MAX(0,-MM6)+MAX(0,-MS6)+MAX(0,-MZ6)+MAX(0,-ND6)"
]

let formulasDaily2: [String: String] = [
"A" : "=A5+1", "B" : "=COUNTIFS(Calculation$U$5:$U$8763,\"=\"&$A6,Calculation$S$5:$S$8763,\"<=0\")", "C" : "=COUNTIFS(Calculation$U$5:$U$8763,\"=\"&$A6,Calculation$S$5:$S$8763,\">0\")",  "E" : "=(A_overall_var_min_cons+A_overall_fix_stby_cons)*$B6+A_overall_stup_cons", "F" : "=(A_overall_var_max_cons+A_overall_fix_stby_cons)*$B6+A_overall_stup_cons", "G" : "=(A_overall_var_heat_min_cons+A_overall_heat_fix_stby_cons)*$B6+A_overall_heat_stup_cons", "H" : "=(A_overall_var_heat_max_cons+A_overall_heat_fix_stby_cons)*$B6+A_overall_heat_stup_cons", "I" : "=A_RawMeth_min_cons*$B6", "J" : "=A_RawMeth_max_cons*$B6", "K" : "=A_CO2_min_cons*$B6", "L" : "=A_CO2_max_cons*$B6", "M" : "=A_Hydrogen_min_cons*$B6", "N" : "=A_Hydrogen_max_cons*$B6", "O" : "=(M6+I6/(MethSynt_CO2_nom_cons+MethSynt_Hydrogen_nom_cons)*MethSynt_Hydrogen_nom_cons)/EY_Hydrogen_nom_prod*EY_var_gross_nom_cons+$C6*EY_fix_cons+(K6+I6/(MethSynt_CO2_nom_cons+MethSynt_Hydrogen_nom_cons)*MethSynt_CO2_nom_cons)/CCU_CO2_nom_prod_ud*CCU_var_nom_cons+$C6*CCU_fix_cons+I6/MethSynt_RawMeth_nom_prod_ud*MethSynt_var_nom_cons+$C6*MethSynt_fix_cons", "P" : "=(N6+J6/(MethSynt_CO2_nom_cons+MethSynt_Hydrogen_nom_cons)*MethSynt_Hydrogen_nom_cons)/EY_Hydrogen_nom_prod*EY_var_gross_nom_cons+$C6*EY_fix_cons+(L6+J6/(MethSynt_CO2_nom_cons+MethSynt_Hydrogen_nom_cons)*MethSynt_CO2_nom_cons)/CCU_CO2_nom_prod_ud*CCU_var_nom_cons+$C6*CCU_fix_cons+J6/MethSynt_RawMeth_nom_prod_ud*MethSynt_var_nom_cons+$C6*MethSynt_fix_cons", "Q" : "=(M6+I6/(MethSynt_CO2_nom_cons+MethSynt_Hydrogen_nom_cons)*MethSynt_Hydrogen_nom_cons)/EY_Hydrogen_nom_prod*EY_var_heat_nom_cons+$C6*EY_heat_fix_cons+(K6+I6/(MethSynt_CO2_nom_cons+MethSynt_Hydrogen_nom_cons)*MethSynt_CO2_nom_cons)/CCU_CO2_nom_prod_ud*CCU_var_heat_nom_cons+$C6*CCU_fix_heat_cons-I6/MethSynt_RawMeth_nom_prod_ud*MethSynt_var_heat_nom_prod-$C6*MethSynt_heat_fix_prod", "R" : "=(N6+J6/(MethSynt_CO2_nom_cons+MethSynt_Hydrogen_nom_cons)*MethSynt_Hydrogen_nom_cons)/EY_Hydrogen_nom_prod*EY_var_heat_nom_cons+$C6*EY_heat_fix_cons+(L6+J6/(MethSynt_CO2_nom_cons+MethSynt_Hydrogen_nom_cons)*MethSynt_CO2_nom_cons)/CCU_CO2_nom_prod_ud*CCU_var_heat_nom_cons+$C6*CCU_fix_heat_cons-J6/MethSynt_RawMeth_nom_prod_ud*MethSynt_var_heat_nom_prod-$C6*MethSynt_heat_fix_prod", "S" : "=I6", "T" : "=J6", "U" : "=K6+I6/(MethSynt_CO2_nom_cons+MethSynt_Hydrogen_nom_cons)*MethSynt_CO2_nom_cons", "V" : "=L6+J6/(MethSynt_CO2_nom_cons+MethSynt_Hydrogen_nom_cons)*MethSynt_CO2_nom_cons", "W" : "=M6+I6/(MethSynt_CO2_nom_cons+MethSynt_Hydrogen_nom_cons)*MethSynt_Hydrogen_nom_cons", "X" : "=N6+J6/(MethSynt_CO2_nom_cons+MethSynt_Hydrogen_nom_cons)*MethSynt_Hydrogen_nom_cons", "Y" : "=1-I6/RawMeth_storage_cap_ud", "Z" : "=1-J6/RawMeth_storage_cap_ud", "AA" : "=1-K6/CO2_storage_cap_ud", "AB" : "=1-L6/CO2_storage_cap_ud", "AC" : "=1-M6/Hydrogen_storage_cap_ud", "AD" : "=1-N6/Hydrogen_storage_cap_ud", "AE" : "=IF(OR(Y6<=0,AA6<=0,AC6<=0),0,MIN(1,IFERROR(Y6/(Y6-Z6),1),IFERROR(AA6/(AA6-AB6),1),IFERROR(AC6/(AC6-AD6),1))*(A_equiv_harmonious_max_perc-A_equiv_harmonious_min_perc)+A_equiv_harmonious_min_perc)",  "AG" : "=(B_overall_var_min_cons+B_overall_fix_stby_cons)*$B6+B_overall_stup_cons", "AH" : "=(B_overall_var_max_cons+B_overall_fix_stby_cons)*$B6+B_overall_stup_cons", "AI" : "=(B_overall_var_heat_min_cons+B_overall_heat_fix_stby_cons)*$B6+B_overall_heat_stup_cons", "AJ" : "=(B_overall_var_heat_max_cons+B_overall_heat_fix_stby_cons)*$B6+B_overall_heat_stup_cons", "AK" : "=B_RawMeth_min_cons*$B6", "AL" : "=B_RawMeth_max_cons*$B6", "AM" : "=B_CO2_min_cons*$B6", "AN" : "=B_CO2_max_cons*$B6", "AO" : "=B_Hydrogen_min_cons*$B6", "AP" : "=B_Hydrogen_max_cons*$B6", "AQ" : "=(AO6+AK6/(MethSynt_CO2_nom_cons+MethSynt_Hydrogen_nom_cons)*MethSynt_Hydrogen_nom_cons)/EY_Hydrogen_nom_prod*EY_var_gross_nom_cons+$C6*EY_fix_cons+(AM6+AK6/(MethSynt_CO2_nom_cons+MethSynt_Hydrogen_nom_cons)*MethSynt_CO2_nom_cons)/CCU_CO2_nom_prod_ud*CCU_var_nom_cons+$C6*CCU_fix_cons+AK6/MethSynt_RawMeth_nom_prod_ud*MethSynt_var_nom_cons+$C6*MethSynt_fix_cons", "AR" : "=(AP6+AL6/(MethSynt_CO2_nom_cons+MethSynt_Hydrogen_nom_cons)*MethSynt_Hydrogen_nom_cons)/EY_Hydrogen_nom_prod*EY_var_gross_nom_cons+$C6*EY_fix_cons+(AN6+AL6/(MethSynt_CO2_nom_cons+MethSynt_Hydrogen_nom_cons)*MethSynt_CO2_nom_cons)/CCU_CO2_nom_prod_ud*CCU_var_nom_cons+$C6*CCU_fix_cons+AL6/MethSynt_RawMeth_nom_prod_ud*MethSynt_var_nom_cons+$C6*MethSynt_fix_cons", "AS" : "=(AO6+AK6/(MethSynt_CO2_nom_cons+MethSynt_Hydrogen_nom_cons)*MethSynt_Hydrogen_nom_cons)/EY_Hydrogen_nom_prod*EY_var_heat_nom_cons+$C6*EY_heat_fix_cons+(AM6+AK6/(MethSynt_CO2_nom_cons+MethSynt_Hydrogen_nom_cons)*MethSynt_CO2_nom_cons)/CCU_CO2_nom_prod_ud*CCU_var_heat_nom_cons+$C6*CCU_fix_heat_cons-AK6/MethSynt_RawMeth_nom_prod_ud*MethSynt_var_heat_nom_prod-$C6*MethSynt_heat_fix_prod", "AT" : "=(AP6+AL6/(MethSynt_CO2_nom_cons+MethSynt_Hydrogen_nom_cons)*MethSynt_Hydrogen_nom_cons)/EY_Hydrogen_nom_prod*EY_var_heat_nom_cons+$C6*EY_heat_fix_cons+(AN6+AL6/(MethSynt_CO2_nom_cons+MethSynt_Hydrogen_nom_cons)*MethSynt_CO2_nom_cons)/CCU_CO2_nom_prod_ud*CCU_var_heat_nom_cons+$C6*CCU_fix_heat_cons-AL6/MethSynt_RawMeth_nom_prod_ud*MethSynt_var_heat_nom_prod-$C6*MethSynt_heat_fix_prod", "AU" : "=AK6", "AV" : "=AL6", "AW" : "=AM6+AK6/(MethSynt_CO2_nom_cons+MethSynt_Hydrogen_nom_cons)*MethSynt_CO2_nom_cons", "AX" : "=AN6+AL6/(MethSynt_CO2_nom_cons+MethSynt_Hydrogen_nom_cons)*MethSynt_CO2_nom_cons", "AY" : "=AO6+AK6/(MethSynt_CO2_nom_cons+MethSynt_Hydrogen_nom_cons)*MethSynt_Hydrogen_nom_cons", "AZ" : "=AP6+AL6/(MethSynt_CO2_nom_cons+MethSynt_Hydrogen_nom_cons)*MethSynt_Hydrogen_nom_cons", "BA" : "=1-AK6/RawMeth_storage_cap_ud", "BB" : "=1-AL6/RawMeth_storage_cap_ud", "BC" : "=1-AM6/CO2_storage_cap_ud", "BD" : "=1-AN6/CO2_storage_cap_ud", "BE" : "=1-AO6/Hydrogen_storage_cap_ud", "BF" : "=1-AP6/Hydrogen_storage_cap_ud", "BG" : "=IF(OR(BA6<=0,BC6<=0,BE6<=0),0,MIN(1,IFERROR(BA6/(BA6-BB6),1),IFERROR(BC6/(BC6-BD6),1),IFERROR(BE6/(BE6-BF6),1))*(B_equiv_harmonious_max_perc-B_equiv_harmonious_min_perc)+B_equiv_harmonious_min_perc)",  "BI" : "=(C_overall_var_min_cons+C_overall_fix_stby_cons)*$B6+C_overall_stup_cons", "BJ" : "=(C_overall_var_max_cons+C_overall_fix_stby_cons)*$B6+C_overall_stup_cons", "BK" : "=(C_overall_var_heat_min_cons+C_overall_heat_fix_stby_cons)*$B6+C_overall_heat_stup_cons", "BL" : "=(C_overall_var_heat_max_cons+C_overall_heat_fix_stby_cons)*$B6+C_overall_heat_stup_cons", "BM" : "=C_RawMeth_min_cons*$B6", "BN" : "=C_RawMeth_max_cons*$B6", "BO" : "=C_CO2_min_cons*$B6", "BP" : "=C_CO2_max_cons*$B6", "BQ" : "=C_Hydrogen_min_cons*$B6", "BR" : "=C_Hydrogen_max_cons*$B6", "BS" : "=(BQ6+BM6/(MethSynt_CO2_nom_cons+MethSynt_Hydrogen_nom_cons)*MethSynt_Hydrogen_nom_cons)/EY_Hydrogen_nom_prod*EY_var_gross_nom_cons+$C6*EY_fix_cons+(BO6+BM6/(MethSynt_CO2_nom_cons+MethSynt_Hydrogen_nom_cons)*MethSynt_CO2_nom_cons)/CCU_CO2_nom_prod_ud*CCU_var_nom_cons+$C6*CCU_fix_cons+BM6/MethSynt_RawMeth_nom_prod_ud*MethSynt_var_nom_cons+$C6*MethSynt_fix_cons", "BT" : "=(BR6+BN6/(MethSynt_CO2_nom_cons+MethSynt_Hydrogen_nom_cons)*MethSynt_Hydrogen_nom_cons)/EY_Hydrogen_nom_prod*EY_var_gross_nom_cons+$C6*EY_fix_cons+(BP6+BN6/(MethSynt_CO2_nom_cons+MethSynt_Hydrogen_nom_cons)*MethSynt_CO2_nom_cons)/CCU_CO2_nom_prod_ud*CCU_var_nom_cons+$C6*CCU_fix_cons+BN6/MethSynt_RawMeth_nom_prod_ud*MethSynt_var_nom_cons+$C6*MethSynt_fix_cons", "BU" : "=(BQ6+BM6/(MethSynt_CO2_nom_cons+MethSynt_Hydrogen_nom_cons)*MethSynt_Hydrogen_nom_cons)/EY_Hydrogen_nom_prod*EY_var_heat_nom_cons+$C6*EY_heat_fix_cons+(BO6+BM6/(MethSynt_CO2_nom_cons+MethSynt_Hydrogen_nom_cons)*MethSynt_CO2_nom_cons)/CCU_CO2_nom_prod_ud*CCU_var_heat_nom_cons+$C6*CCU_fix_heat_cons-BM6/MethSynt_RawMeth_nom_prod_ud*MethSynt_var_heat_nom_prod-$C6*MethSynt_heat_fix_prod", "BV" : "=(BR6+BN6/(MethSynt_CO2_nom_cons+MethSynt_Hydrogen_nom_cons)*MethSynt_Hydrogen_nom_cons)/EY_Hydrogen_nom_prod*EY_var_heat_nom_cons+$C6*EY_heat_fix_cons+(BP6+BN6/(MethSynt_CO2_nom_cons+MethSynt_Hydrogen_nom_cons)*MethSynt_CO2_nom_cons)/CCU_CO2_nom_prod_ud*CCU_var_heat_nom_cons+$C6*CCU_fix_heat_cons-BN6/MethSynt_RawMeth_nom_prod_ud*MethSynt_var_heat_nom_prod-$C6*MethSynt_heat_fix_prod", "BW" : "=BM6", "BX" : "=BN6", "BY" : "=BO6+BM6/(MethSynt_CO2_nom_cons+MethSynt_Hydrogen_nom_cons)*MethSynt_CO2_nom_cons", "BZ" : "=BP6+BN6/(MethSynt_CO2_nom_cons+MethSynt_Hydrogen_nom_cons)*MethSynt_CO2_nom_cons", "CA" : "=BQ6+BM6/(MethSynt_CO2_nom_cons+MethSynt_Hydrogen_nom_cons)*MethSynt_Hydrogen_nom_cons", "CB" : "=BR6+BN6/(MethSynt_CO2_nom_cons+MethSynt_Hydrogen_nom_cons)*MethSynt_Hydrogen_nom_cons", "CC" : "=1-BM6/RawMeth_storage_cap_ud", "CD" : "=1-BN6/RawMeth_storage_cap_ud", "CE" : "=1-BO6/CO2_storage_cap_ud", "CF" : "=1-BP6/CO2_storage_cap_ud", "CG" : "=1-BQ6/Hydrogen_storage_cap_ud", "CH" : "=1-BR6/Hydrogen_storage_cap_ud", "CI" : "=IF(OR(CC6<=0,CE6<=0,CG6<=0),0,MIN(1,IFERROR(CC6/(CC6-CD6),1),IFERROR(CE6/(CE6-CF6),1),IFERROR(CG6/(CG6-CH6),1))*(C_equiv_harmonious_max_perc-C_equiv_harmonious_min_perc)+C_equiv_harmonious_min_perc)",  "CK" : "=(D_overall_var_min_cons+D_overall_fix_stby_cons)*$B6+D_overall_stup_cons", "CL" : "=(D_overall_var_max_cons+D_overall_fix_stby_cons)*$B6+D_overall_stup_cons", "CM" : "=(D_overall_var_heat_min_cons+D_overall_heat_fix_stby_cons)*$B6+D_overall_heat_stup_cons", "CN" : "=(D_overall_var_heat_max_cons+D_overall_heat_fix_stby_cons)*$B6+D_overall_heat_stup_cons", "CO" : "=D_RawMeth_min_cons*$B6", "CP" : "=D_RawMeth_max_cons*$B6", "CQ" : "=D_CO2_min_cons*$B6", "CR" : "=D_CO2_max_cons*$B6", "CS" : "=D_Hydrogen_min_cons*$B6", "CT" : "=D_Hydrogen_max_cons*$B6", "CU" : "=(CS6+CO6/(MethSynt_CO2_nom_cons+MethSynt_Hydrogen_nom_cons)*MethSynt_Hydrogen_nom_cons)/EY_Hydrogen_nom_prod*EY_var_gross_nom_cons+$C6*EY_fix_cons+(CQ6+CO6/(MethSynt_CO2_nom_cons+MethSynt_Hydrogen_nom_cons)*MethSynt_CO2_nom_cons)/CCU_CO2_nom_prod_ud*CCU_var_nom_cons+$C6*CCU_fix_cons+CO6/MethSynt_RawMeth_nom_prod_ud*MethSynt_var_nom_cons+$C6*MethSynt_fix_cons", "CV" : "=(CT6+CP6/(MethSynt_CO2_nom_cons+MethSynt_Hydrogen_nom_cons)*MethSynt_Hydrogen_nom_cons)/EY_Hydrogen_nom_prod*EY_var_gross_nom_cons+$C6*EY_fix_cons+(CR6+CP6/(MethSynt_CO2_nom_cons+MethSynt_Hydrogen_nom_cons)*MethSynt_CO2_nom_cons)/CCU_CO2_nom_prod_ud*CCU_var_nom_cons+$C6*CCU_fix_cons+CP6/MethSynt_RawMeth_nom_prod_ud*MethSynt_var_nom_cons+$C6*MethSynt_fix_cons", "CW" : "=(CS6+CO6/(MethSynt_CO2_nom_cons+MethSynt_Hydrogen_nom_cons)*MethSynt_Hydrogen_nom_cons)/EY_Hydrogen_nom_prod*EY_var_heat_nom_cons+$C6*EY_heat_fix_cons+(CQ6+CO6/(MethSynt_CO2_nom_cons+MethSynt_Hydrogen_nom_cons)*MethSynt_CO2_nom_cons)/CCU_CO2_nom_prod_ud*CCU_var_heat_nom_cons+$C6*CCU_fix_heat_cons-CO6/MethSynt_RawMeth_nom_prod_ud*MethSynt_var_heat_nom_prod-$C6*MethSynt_heat_fix_prod", "CX" : "=(CT6+CP6/(MethSynt_CO2_nom_cons+MethSynt_Hydrogen_nom_cons)*MethSynt_Hydrogen_nom_cons)/EY_Hydrogen_nom_prod*EY_var_heat_nom_cons+$C6*EY_heat_fix_cons+(CR6+CP6/(MethSynt_CO2_nom_cons+MethSynt_Hydrogen_nom_cons)*MethSynt_CO2_nom_cons)/CCU_CO2_nom_prod_ud*CCU_var_heat_nom_cons+$C6*CCU_fix_heat_cons-CP6/MethSynt_RawMeth_nom_prod_ud*MethSynt_var_heat_nom_prod-$C6*MethSynt_heat_fix_prod", "CY" : "=CO6", "CZ" : "=CP6", "DA" : "=CQ6+CO6/(MethSynt_CO2_nom_cons+MethSynt_Hydrogen_nom_cons)*MethSynt_CO2_nom_cons", "DB" : "=CR6+CP6/(MethSynt_CO2_nom_cons+MethSynt_Hydrogen_nom_cons)*MethSynt_CO2_nom_cons", "DC" : "=CS6+CO6/(MethSynt_CO2_nom_cons+MethSynt_Hydrogen_nom_cons)*MethSynt_Hydrogen_nom_cons", "DD" : "=CT6+CP6/(MethSynt_CO2_nom_cons+MethSynt_Hydrogen_nom_cons)*MethSynt_Hydrogen_nom_cons", "DE" : "=1-CO6/RawMeth_storage_cap_ud", "DF" : "=1-CP6/RawMeth_storage_cap_ud", "DG" : "=1-CQ6/CO2_storage_cap_ud", "DH" : "=1-CR6/CO2_storage_cap_ud", "DI" : "=1-CS6/Hydrogen_storage_cap_ud", "DJ" : "=1-CT6/Hydrogen_storage_cap_ud", "DK" : "=IF(OR(DE6<=0,DG6<=0,DI6<=0),0,MIN(1,IFERROR(DE6/(DE6-DF6),1),IFERROR(DG6/(DG6-DH6),1),IFERROR(DI6/(DI6-DJ6),1))*(D_equiv_harmonious_max_perc-D_equiv_harmonious_min_perc)+D_equiv_harmonious_min_perc)",  "DM" : "=SUMIFS(Calculation$P$5:$P$8763,Calculation$U$5:$U$8763,\"=\"&$A6,Calculation$S$5:$S$8763,\">0\")", "DN" : "=SUMIF(Calculation$U$5:$U$8763,\"=\"&$A6,Calculation$P$5:$P$8763)-DM6", "DO" : "=SUMIFS(Calculation$J$5:$J$8763,Calculation$U$5:$U$8763,\"=\"&$A6,Calculation$T$5:$T$8763,\">0\")", "DP" : "=SUMIF(Calculation$U$5:$U$8763,\"=\"&$A6,Calculation$J$5:$J$8763)-DO6",  "DR" : "=SUMIF(Calculation$U$5:$U$8763,\"=\"&$A6,Calculation$S$5:$S$8763)", "DS" : "=SUMIF(Calculation$U$5:$U$8763,\"=\"&$A6,CalculationAH$5:AH$8763)", "DT" : "=SUMIF(Calculation$U$5:$U$8763,\"=\"&$A6,Calculation$T$5:$T$8763)", "DU" : "=SUMIF(Calculation$U$5:$U$8763,\"=\"&$A6,CalculationAI$5:AI$8763)", "DV" : "=SUMIFS(Calculation$AF$5:$AF$8763,Calculation$U$5:$U$8763,\"=\"&$A6,Calculation$S$5:$S$8763,\">0\")", "DW" : "=SUMIFS(Calculation$AT$5:$AT$8763,Calculation$U$5:$U$8763,\"=\"&$A6,Calculation$S$5:$S$8763,\">0\")", "DX" : "=SUMIF(Calculation$U$5:$U$8763,\"=\"&$A6,Calculation$AF$5:$AF$8763)-DV6", "DY" : "=SUMIFS(Calculation$X$5:$X$8763,Calculation$U$5:$U$8763,\"=\"&$A6,Calculation$S$5:$S$8763,\">0\")", "DZ" : "=SUMIFS(CalculationAL$5:AL$8763,Calculation$U$5:$U$8763,\"=\"&$A6,Calculation$AH$5:$AH$8763,\">0\")", "EA" : "=SUMIF(Calculation$U$5:$U$8763,\"=\"&$A6,Calculation$X$5:$X$8763)-DY6", "EB" : "=SUMIFS(Calculation$V$5:$V$8763,Calculation$U$5:$U$8763,\"=\"&$A6,Calculation$S$5:$S$8763,\">0\")", "EC" : "=SUMIFS(CalculationAJ$5:AJ$8763,Calculation$U$5:$U$8763,\"=\"&$A6,Calculation$AH$5:$AH$8763,\">0\")", "ED" : "=SUMIF(Calculation$U$5:$U$8763,\"=\"&$A6,Calculation$V$5:$V$8763)-EB6", "EE" : "=SUMIFS(Calculation$W$5:$W$8763,Calculation$U$5:$U$8763,\"=\"&$A6,Calculation$S$5:$S$8763,\">0\")", "EF" : "=SUMIFS(CalculationAK$5:AK$8763,Calculation$U$5:$U$8763,\"=\"&$A6,Calculation$AH$5:$AH$8763,\">0\")", "EG" : "=SUMIF(Calculation$U$5:$U$8763,\"=\"&$A6,Calculation$W$5:$W$8763)-EE6", "EH" : "=SUMIFS(Calculation$Y$5:$Y$8763,Calculation$U$5:$U$8763,\"=\"&$A6,Calculation$S$5:$S$8763,\">0\")", "EI" : "=SUMIFS(Calculation$AM$5:$AM$8763,Calculation$U$5:$U$8763,\"=\"&$A6,Calculation$AH$5:$AH$8763,\">0\")", "EJ" : "=SUMIF(Calculation$U$5:$U$8763,\"=\"&$A6,Calculation$Y$5:$Y$8763)-EH6", "EK" : "=MIN(SUMIFS(Calculation$AE$5:$AE$8763,Calculation$U$5:$U$8763,\"=\"&$A6,Calculation$S$5:$S$8763,\">0\"),BESS_cap_ud/BESS_chrg_eff)", "EL" : "=MIN(SUMIFS(Calculation$AS$5:$AS$8763,Calculation$U$5:$U$8763,\"=\"&$A6,Calculation$AH$5:$AH$8763,\">0\"),BESS_cap_ud/BESS_chrg_eff)", "EM" : "=MIN(SUMIFS(Calculation$AE$5:$AE$8763,Calculation$U$5:$U$8763,\"=\"&$A6,Calculation$S$5:$S$8763,\"=0\"),BESS_cap_ud/BESS_chrg_eff)", "EN" : "=SUMIFS(Calculation$Z$5:$Z$8763,Calculation$U$5:$U$8763,\"=\"&$A6,Calculation$S$5:$S$8763,\">0\")", "EO" : "=SUMIFS(Calculation$AN$5:$AN$8763,Calculation$U$5:$U$8763,\"=\"&$A6,Calculation$S$5:$S$8763,\">0\")", "EP" : "=SUMIFS(Calculation$AA$5:$AA$8763,Calculation$U$5:$U$8763,\"=\"&$A6,Calculation$S$5:$S$8763,\">0\")", "EQ" : "=SUMIFS(CalculationAO$5:AO$8763,Calculation$U$5:$U$8763,\"=\"&$A6,Calculation$AH$5:$AH$8763,\">0\")", "ER" : "=SUMIF(Calculation$U$5:$U$8763,\"=\"&$A6,Calculation$AA$5:$AA$8763)-EP6", "ES" : "=SUMIFS(Calculation$AB$5:$AB$8763,Calculation$U$5:$U$8763,\"=\"&$A6,Calculation$S$5:$S$8763,\">0\")", "ET" : "=SUMIFS(CalculationAP$5:AP$8763,Calculation$U$5:$U$8763,\"=\"&$A6,Calculation$AH$5:$AH$8763,\">0\")", "EU" : "=SUMIF(Calculation$U$5:$U$8763,\"=\"&$A6,Calculation$AB$5:$AB$8763)-ES6", "EV" : "=SUMIFS(Calculation$AC$5:$AC$8763,Calculation$U$5:$U$8763,\"=\"&$A6,Calculation$S$5:$S$8763,\">0\")", "EW" : "=SUMIFS(CalculationAQ$5:AQ$8763,Calculation$U$5:$U$8763,\"=\"&$A6,Calculation$AH$5:$AH$8763,\">0\")", "EX" : "=SUMIF(Calculation$U$5:$U$8763,\"=\"&$A6,Calculation$AC$5:$AC$8763)-EV6", "EY" : "=SUMIFS(Calculation$AD$5:$AD$8763,Calculation$U$5:$U$8763,\"=\"&$A6,Calculation$S$5:$S$8763,\">0\")", "EZ" : "=SUMIFS(CalculationAR$5:AR$8763,Calculation$U$5:$U$8763,\"=\"&$A6,Calculation$AH$5:$AH$8763,\">0\")", "FA" : "=SUMIF(Calculation$U$5:$U$8763,\"=\"&$A6,Calculation$AD$5:$AD$8763)-EY6",  "FC" : "=$EB6+$EH6-$O6-MIN($EK6,($EA6+$E6+$G6/El_boiler_eff)/BESS_chrg_eff)-MAX(0,$Q6-$EE6)/El_boiler_eff", "FD" : "=$EB6+$EH6-($O6+($P6-$O6)/(A_equiv_harmonious_max_perc-A_equiv_harmonious_min_perc)*($AE6-A_equiv_harmonious_min_perc))-MIN($EK6,($EA6+($E6+($F6-$E6)/(A_equiv_harmonious_max_perc-A_equiv_harmonious_min_perc)*($AE6-A_equiv_harmonious_min_perc))+($G6+($H6-$G6)/(A_equiv_harmonious_max_perc-A_equiv_harmonious_min_perc)*($AE6-A_equiv_harmonious_min_perc))/El_boiler_eff)/BESS_chrg_eff)-MAX(0,($Q6+($R6-$Q6)/(A_equiv_harmonious_max_perc-A_equiv_harmonious_min_perc)*($AE6-A_equiv_harmonious_min_perc))-$EE6)/El_boiler_eff", "FE" : "=$EC6+$EI6-$O6-MIN($EL6,($EA6+$E6+$G6/El_boiler_eff)/BESS_chrg_eff)-MAX(0,$Q6-$EF6)/El_boiler_eff", "FF" : "=($EK6+$EM6)*BESS_chrg_eff+$EJ6-$E6-$G6/El_boiler_eff", "FG" : "=($EK6+$EM6)*BESS_chrg_eff+$EJ6-($E6+($F6-$E6)/(A_equiv_harmonious_max_perc-A_equiv_harmonious_min_perc)*($AE6-A_equiv_harmonious_min_perc))-($G6+($H6-$G6)/(A_equiv_harmonious_max_perc-A_equiv_harmonious_min_perc)*($AE6-A_equiv_harmonious_min_perc))/El_boiler_eff", "FH" : "=($EL6+$EM6)*BESS_chrg_eff+$EJ6-$E6-$G6/El_boiler_eff", "FI" : "=$EE6+($EB6+$EH6-MIN($EK6,($EA6+$E6+$G6/El_boiler_eff)/BESS_chrg_eff)-$O6)*El_boiler_eff-$Q6", "FJ" : "=$EE6+($EB6+$EH6-MIN($EK6,($EA6+($E6+($F6-$E6)/(A_equiv_harmonious_max_perc-A_equiv_harmonious_min_perc)*($AE6-A_equiv_harmonious_min_perc))+($G6+($H6-$G6)/(A_equiv_harmonious_max_perc-A_equiv_harmonious_min_perc)*($AE6-A_equiv_harmonious_min_perc))/El_boiler_eff)/BESS_chrg_eff)-($O6+($P6-$O6)/(A_equiv_harmonious_max_perc-A_equiv_harmonious_min_perc)*($AE6-A_equiv_harmonious_min_perc)))*El_boiler_eff-($Q6+($R6-$Q6)/(A_equiv_harmonious_max_perc-A_equiv_harmonious_min_perc)*($AE6-A_equiv_harmonious_min_perc))", "FK" : "=$EF6+($EC6+$EI6-MIN($EL6,($EA6+$E6+$G6/El_boiler_eff)/BESS_chrg_eff)-$O6)*El_boiler_eff-$Q6", "FL" : "=$EG6+$ER6*El_boiler_eff-$G6", "FM" : "=$EG6+$ER6*El_boiler_eff-($G6+($H6-$G6)/(A_equiv_harmonious_max_perc-A_equiv_harmonious_min_perc)*($AE6-A_equiv_harmonious_min_perc))", "FN" : "=$EG6+$ER6*El_boiler_eff-$G6", "FO" : "=$EP6-MAX(0,$Q6-$EE6)/El_boiler_eff", "FP" : "=$EP6-MAX(0,($Q6+($R6-$Q6)/(A_equiv_harmonious_max_perc-A_equiv_harmonious_min_perc)*($AE6-A_equiv_harmonious_min_perc))-$EE6)/El_boiler_eff", "FQ" : "=$EQ6-MAX(0,$Q6-$EF6)/El_boiler_eff", "FR" : "=$ER6-MAX(0,$G6-$EG6)/El_boiler_eff", "FS" : "=$ER6-MAX(0,($G6+($H6-$G6)/(A_equiv_harmonious_max_perc-A_equiv_harmonious_min_perc)*($AE6-A_equiv_harmonious_min_perc))-$EG6)/El_boiler_eff", "FT" : "=$ER6-MAX(0,$G6-$EG6)/El_boiler_eff", "FU" : "=$ES6-$S6", "FV" : "=$ES6-($S6+($T6-$S6)/(A_equiv_harmonious_max_perc-A_equiv_harmonious_min_perc)*($AE6-A_equiv_harmonious_min_perc))", "FW" : "=$ET6-$S6", "FX" : "=$EV6-$U6", "FY" : "=$EV6-($U6+($V6-$U6)/(A_equiv_harmonious_max_perc-A_equiv_harmonious_min_perc)*($AE6-A_equiv_harmonious_min_perc))", "FZ" : "=$EW6-$U6", "GA" : "=$EY6-$W6", "GB" : "=$EY6-($W6+($X6-$W6)/(A_equiv_harmonious_max_perc-A_equiv_harmonious_min_perc)*($AE6-A_equiv_harmonious_min_perc))", "GC" : "=$EZ6-$W6",  "GE" : "=IF(OR(FC6<0,FF6<0,FI6<0,FL6<0,FO6<0,FR6<0,FU6<0,FX6<0,GA6<0),0,MIN(1,IFERROR(FC6/(FC6-FE6),1),IFERROR(FF6/(FF6-FH6),1),IFERROR(FI6/(FI6-FK6),1),IFERROR(FL6/(FL6-FN6),1),IFERROR(FO6/(FO6-FQ6),1),IFERROR(FR6/(FR6-FT6),1),IFERROR(FU6/(FU6-FW6),1),IFERROR(FX6/(FX6-FZ6),1),IFERROR(GA6/(GA6-GC6),1))*(Overall_harmonious_max_perc-Overall_harmonious_min_perc)+Overall_harmonious_min_perc)", "GF" : "=IF(GE6=0,0,ROUND(($EB6+($EC6-$EB6)/(Overall_harmonious_max_perc-Overall_harmonious_min_perc)*(GE6-Overall_harmonious_min_perc))+($EH6+($EI6-$EH6)/(Overall_harmonious_max_perc-Overall_harmonious_min_perc)*(GE6-Overall_harmonious_min_perc))-$O6-MIN($EK6+($EL6-$EK6)/(Overall_harmonious_max_perc-Overall_harmonious_min_perc)*(VK6-Overall_harmonious_min_perc),($EA6+$E6+$G6/El_boiler_eff)/BESS_chrg_eff)-MAX(0,$Q6-($EE6+($EF6-$EE6)/(Overall_harmonious_max_perc-Overall_harmonious_min_perc)*(GE6-Overall_harmonious_min_perc)))/El_boiler_eff,5))", "GG" : "=IF(GE6=0,0,ROUND(($EB6+($EC6-$EB6)/(Overall_harmonious_max_perc-Overall_harmonious_min_perc)*(GE6-Overall_harmonious_min_perc))+($EH6+($EI6-$EH6)/(Overall_harmonious_max_perc-Overall_harmonious_min_perc)*(GE6-Overall_harmonious_min_perc))-($O6+($P6-$O6)/(A_equiv_harmonious_max_perc-A_equiv_harmonious_min_perc)*($AE6-A_equiv_harmonious_min_perc))-MIN($EK6+($EL6-$EK6)/(Overall_harmonious_max_perc-Overall_harmonious_min_perc)*(VK6-Overall_harmonious_min_perc),($EA6+($E6+($F6-$E6)/(A_equiv_harmonious_max_perc-A_equiv_harmonious_min_perc)*($AE6-A_equiv_harmonious_min_perc))+($G6+($H6-$G6)/(A_equiv_harmonious_max_perc-A_equiv_harmonious_min_perc)*($AE6-A_equiv_harmonious_min_perc))/El_boiler_eff)/BESS_chrg_eff)-MAX(0,($Q6+($R6-$Q6)/(A_equiv_harmonious_max_perc-A_equiv_harmonious_min_perc)*($AE6-A_equiv_harmonious_min_perc))-($EE6+($EF6-$EE6)/(Overall_harmonious_max_perc-Overall_harmonious_min_perc)*(GE6-Overall_harmonious_min_perc)))/El_boiler_eff,5))", "GH" : "=IF(GE6=0,0,ROUND((($EK6+($EL6-$EK6)/(Overall_harmonious_max_perc-Overall_harmonious_min_perc)*(GE6-Overall_harmonious_min_perc))+$EM6)*BESS_chrg_eff+$EJ6-$E6-$G6/El_boiler_eff,5))", "GI" : "=IF(GE6=0,0,ROUND((($EK6+($EL6-$EK6)/(Overall_harmonious_max_perc-Overall_harmonious_min_perc)*(GE6-Overall_harmonious_min_perc))+$EM6)*BESS_chrg_eff+$EJ6-($E6+($F6-$E6)/(A_equiv_harmonious_max_perc-A_equiv_harmonious_min_perc)*($AE6-A_equiv_harmonious_min_perc))-($G6+($H6-$G6)/(A_equiv_harmonious_max_perc-A_equiv_harmonious_min_perc)*($AE6-A_equiv_harmonious_min_perc))/El_boiler_eff,5))", "GJ" : "=IF(GE6=0,0,ROUND(($EE6+($EF6-$EE6)/(Overall_harmonious_max_perc-Overall_harmonious_min_perc)*(GE6-Overall_harmonious_min_perc))+(($EB6+($EC6-$EB6)/(Overall_harmonious_max_perc-Overall_harmonious_min_perc)*(GE6-Overall_harmonious_min_perc))+($EH6+($EI6-$EH6)/(Overall_harmonious_max_perc-Overall_harmonious_min_perc)*(GE6-Overall_harmonious_min_perc))-MIN($EK6+($EL6-$EK6)/(Overall_harmonious_max_perc-Overall_harmonious_min_perc)*(VK6-Overall_harmonious_min_perc),($EA6+$E6+$G6/El_boiler_eff)/BESS_chrg_eff)-$O6)*El_boiler_eff-$Q6,5))", "GK" : "=IF(GE6=0,0,ROUND(($EE6+($EF6-$EE6)/(Overall_harmonious_max_perc-Overall_harmonious_min_perc)*(GE6-Overall_harmonious_min_perc))+(($EB6+($EC6-$EB6)/(Overall_harmonious_max_perc-Overall_harmonious_min_perc)*(GE6-Overall_harmonious_min_perc))+($EH6+($EI6-$EH6)/(Overall_harmonious_max_perc-Overall_harmonious_min_perc)*(GE6-Overall_harmonious_min_perc))-MIN($EK6+($EL6-$EK6)/(Overall_harmonious_max_perc-Overall_harmonious_min_perc)*(VK6-Overall_harmonious_min_perc),($EA6+($E6+($F6-$E6)/(A_equiv_harmonious_max_perc-A_equiv_harmonious_min_perc)*($AE6-A_equiv_harmonious_min_perc))+($G6+($H6-$G6)/(A_equiv_harmonious_max_perc-A_equiv_harmonious_min_perc)*($AE6-A_equiv_harmonious_min_perc))/El_boiler_eff)/BESS_chrg_eff)-($O6+($P6-$O6)/(A_equiv_harmonious_max_perc-A_equiv_harmonious_min_perc)*($AE6-A_equiv_harmonious_min_perc)))*El_boiler_eff-($Q6+($R6-$Q6)/(A_equiv_harmonious_max_perc-A_equiv_harmonious_min_perc)*($AE6-A_equiv_harmonious_min_perc)),5))", "GL" : "=IF(GE6=0,0,ROUND($EG6+$ER6*El_boiler_eff-$G6,5))", "GM" : "=IF(GE6=0,0,ROUND($EG6+$ER6*El_boiler_eff-($G6+($H6-$G6)/(A_equiv_harmonious_max_perc-A_equiv_harmonious_min_perc)*($AE6-A_equiv_harmonious_min_perc)),5))", "GN" : "=IF(GE6=0,0,ROUND(($EP6+($EQ6-$EP6)/(Overall_harmonious_max_perc-Overall_harmonious_min_perc)*(GE6-Overall_harmonious_min_perc))-MAX(0,$Q6-($EE6+($EF6-$EE6)/(Overall_harmonious_max_perc-Overall_harmonious_min_perc)*(GE6-Overall_harmonious_min_perc)))/El_boiler_eff,5))", "GO" : "=IF(GE6=0,0,ROUND(($EP6+($EQ6-$EP6)/(Overall_harmonious_max_perc-Overall_harmonious_min_perc)*(GE6-Overall_harmonious_min_perc))-MAX(0,($Q6+($R6-$Q6)/(A_equiv_harmonious_max_perc-A_equiv_harmonious_min_perc)*($AE6-A_equiv_harmonious_min_perc))-($EE6+($EF6-$EE6)/(Overall_harmonious_max_perc-Overall_harmonious_min_perc)*(GE6-Overall_harmonious_min_perc)))/El_boiler_eff,5))", "GP" : "=IF(GE6=0,0,ROUND($ER6-MAX(0,$G6-$EG6)/El_boiler_eff,5))", "GQ" : "=IF(GE6=0,0,ROUND($ER6-MAX(0,($G6+($H6-$G6)/(A_equiv_harmonious_max_perc-A_equiv_harmonious_min_perc)*($AE6-A_equiv_harmonious_min_perc))-$EG6)/El_boiler_eff,5))", "GR" : "=IF(GE6=0,0,ROUND(($ES6+($ET6-$ES6)/(Overall_harmonious_max_perc-Overall_harmonious_min_perc)*(GE6-Overall_harmonious_min_perc))-$S6,5))", "GS" : "=IF(GE6=0,0,ROUND(($ES6+($ET6-$ES6)/(Overall_harmonious_max_perc-Overall_harmonious_min_perc)*(GE6-Overall_harmonious_min_perc))-($S6+($T6-$S6)/(A_equiv_harmonious_max_perc-A_equiv_harmonious_min_perc)*($AE6-A_equiv_harmonious_min_perc)),5))", "GT" : "=IF(GE6=0,0,ROUND(($EV6+($EW6-$EV6)/(Overall_harmonious_max_perc-Overall_harmonious_min_perc)*(GE6-Overall_harmonious_min_perc))-$U6,5))", "GU" : "=IF(GE6=0,0,ROUND(($EV6+($EW6-$EV6)/(Overall_harmonious_max_perc-Overall_harmonious_min_perc)*(GE6-Overall_harmonious_min_perc))-($U6+($V6-$U6)/(A_equiv_harmonious_max_perc-A_equiv_harmonious_min_perc)*($AE6-A_equiv_harmonious_min_perc)),5))", "GV" : "=IF(GE6=0,0,ROUND(($EY6+($EZ6-$EY6)/(Overall_harmonious_max_perc-Overall_harmonious_min_perc)*(GE6-Overall_harmonious_min_perc))-$W6,5))", "GW" : "=IF(GE6=0,0,ROUND(($EY6+($EZ6-$EY6)/(Overall_harmonious_max_perc-Overall_harmonious_min_perc)*(GE6-Overall_harmonious_min_perc))-($W6+($X6-$W6)/(A_equiv_harmonious_max_perc-A_equiv_harmonious_min_perc)*($AE6-A_equiv_harmonious_min_perc)),5))", "GX" : "=IF(OR(GE6=0,GF6<0,GH6<0,GJ6<0,GL6<0,GN6<0,GP6<0,GR6<0,GT6<0,GV6<0),0,MIN(1,IFERROR(GF6/(GF6-GG6),1),IFERROR(GH6/(GH6-GI6),1),IFERROR(GJ6/(GJ6-GK6),1),IFERROR(GL6/(GL6-GM6),1),IFERROR(GN6/(GN6-GO6),1),IFERROR(GP6/(GP6-GQ6),1),IFERROR(GR6/(GR6-GS6),1),IFERROR(GT6/(GT6-GU6),1),IFERROR(GV6/(GV6-GW6),1))*($AE6-A_equiv_harmonious_min_perc)+A_equiv_harmonious_min_perc)",  "GZ" : "=IF(OR(FC6<0,FF6<0,FI6<0,FL6<0,FO6<0,FR6<0,FU6<0,FX6<0,GA6<0),0,MIN(1,IFERROR(FC6/(FC6-FD6),1),IFERROR(FF6/(FF6-FG6),1),IFERROR(FI6/(FI6-FJ6),1),IFERROR(FL6/(FL6-FM6),1),IFERROR(FO6/(FO6-FP6),1),IFERROR(FR6/(FR6-FS6),1),IFERROR(FU6/(FU6-FV6),1),IFERROR(FX6/(FX6-FY6),1),IFERROR(GA6/(GA6-GB6),1))*($AE6-A_equiv_harmonious_min_perc)+A_equiv_harmonious_min_perc)", "HA" : "=IF(GZ6=0,0,ROUND($EB6+$EH6-($O6+($P6-$O6)/(A_equiv_harmonious_max_perc-A_equiv_harmonious_min_perc)*(GZ6-A_equiv_harmonious_min_perc))-MIN($EK6,($EA6+($E6+($F6-$E6)/(A_equiv_harmonious_max_perc-A_equiv_harmonious_min_perc)*(GZ6-A_equiv_harmonious_min_perc))+($G6+($H6-$G6)/(A_equiv_harmonious_max_perc-A_equiv_harmonious_min_perc)*(GZ6-A_equiv_harmonious_min_perc))/El_boiler_eff)/BESS_chrg_eff)-MAX(0,($Q6+($R6-$Q6)/(A_equiv_harmonious_max_perc-A_equiv_harmonious_min_perc)*(GZ6-A_equiv_harmonious_min_perc))-$EE6)/El_boiler_eff,5))", "HB" : "=IF(GZ6=0,0,ROUND($EC6+$EI6-($O6+($P6-$O6)/(A_equiv_harmonious_max_perc-A_equiv_harmonious_min_perc)*(GZ6-A_equiv_harmonious_min_perc))-MIN($EL6,($EA6+($E6+($F6-$E6)/(A_equiv_harmonious_max_perc-A_equiv_harmonious_min_perc)*(GZ6-A_equiv_harmonious_min_perc))+($G6+($H6-$G6)/(A_equiv_harmonious_max_perc-A_equiv_harmonious_min_perc)*(GZ6-A_equiv_harmonious_min_perc))/El_boiler_eff)/BESS_chrg_eff)-MAX(0,($Q6+($R6-$Q6)/(A_equiv_harmonious_max_perc-A_equiv_harmonious_min_perc)*(GZ6-A_equiv_harmonious_min_perc))-$EF6)/El_boiler_eff,5))", "HC" : "=IF(GZ6=0,0,ROUND(($EK6+$EM6)*BESS_chrg_eff+$EJ6-($E6+($F6-$E6)/(A_equiv_harmonious_max_perc-A_equiv_harmonious_min_perc)*(GZ6-A_equiv_harmonious_min_perc))-($G6+($H6-$G6)/(A_equiv_harmonious_max_perc-A_equiv_harmonious_min_perc)*(GZ6-A_equiv_harmonious_min_perc))/El_boiler_eff,5))", "HD" : "=IF(GZ6=0,0,ROUND(($EL6+$EM6)*BESS_chrg_eff+$EJ6-($E6+($F6-$E6)/(A_equiv_harmonious_max_perc-A_equiv_harmonious_min_perc)*(GZ6-A_equiv_harmonious_min_perc))-($G6+($H6-$G6)/(A_equiv_harmonious_max_perc-A_equiv_harmonious_min_perc)*(GZ6-A_equiv_harmonious_min_perc))/El_boiler_eff,5))", "HE" : "=IF(GZ6=0,0,ROUND($EE6+($EB6+$EH6-MIN(EK6,($EA6+($E6+($F6-$E6)/(A_equiv_harmonious_max_perc-A_equiv_harmonious_min_perc)*(GZ6-A_equiv_harmonious_min_perc))+($G6+($H6-$G6)/(A_equiv_harmonious_max_perc-A_equiv_harmonious_min_perc)*(GZ6-A_equiv_harmonious_min_perc))/El_boiler_eff)/BESS_chrg_eff)-($O6+($P6-$O6)/(A_equiv_harmonious_max_perc-A_equiv_harmonious_min_perc)*(GZ6-A_equiv_harmonious_min_perc)))*El_boiler_eff-($Q6+($R6-$Q6)/(A_equiv_harmonious_max_perc-A_equiv_harmonious_min_perc)*(GZ6-A_equiv_harmonious_min_perc)),5))", "HF" : "=IF(GZ6=0,0,ROUND($EF6+($EC6+$EI6-MIN(EL6,($EA6+($E6+($F6-$E6)/(A_equiv_harmonious_max_perc-A_equiv_harmonious_min_perc)*(GZ6-A_equiv_harmonious_min_perc))+($G6+($H6-$G6)/(A_equiv_harmonious_max_perc-A_equiv_harmonious_min_perc)*(GZ6-A_equiv_harmonious_min_perc))/El_boiler_eff)/BESS_chrg_eff)-($O6+($P6-$O6)/(A_equiv_harmonious_max_perc-A_equiv_harmonious_min_perc)*(GZ6-A_equiv_harmonious_min_perc)))*El_boiler_eff-($Q6+($R6-$Q6)/(A_equiv_harmonious_max_perc-A_equiv_harmonious_min_perc)*(GZ6-A_equiv_harmonious_min_perc)),5))", "HG" : "=IF(GZ6=0,0,ROUND($EG6+$ER6*El_boiler_eff-($G6+($H6-$G6)/(A_equiv_harmonious_max_perc-A_equiv_harmonious_min_perc)*(GZ6-A_equiv_harmonious_min_perc)),5))", "HH" : "=IF(GZ6=0,0,ROUND($EG6+$ER6*El_boiler_eff-($G6+($H6-$G6)/(A_equiv_harmonious_max_perc-A_equiv_harmonious_min_perc)*(GZ6-A_equiv_harmonious_min_perc)),5))", "HI" : "=IF(GZ6=0,0,ROUND($EP6-MAX(0,($Q6+($R6-$Q6)/(A_equiv_harmonious_max_perc-A_equiv_harmonious_min_perc)*(GZ6-A_equiv_harmonious_min_perc))-$EE6)/El_boiler_eff,5))", "HJ" : "=IF(GZ6=0,0,ROUND($EQ6-MAX(0,($Q6+($R6-$Q6)/(A_equiv_harmonious_max_perc-A_equiv_harmonious_min_perc)*(GZ6-A_equiv_harmonious_min_perc))-$EF6)/El_boiler_eff,5))", "HK" : "=IF(GZ6=0,0,ROUND($ER6-MAX(0,($G6+($H6-$G6)/(A_equiv_harmonious_max_perc-A_equiv_harmonious_min_perc)*(GZ6-A_equiv_harmonious_min_perc))-$EG6)/El_boiler_eff,5))", "HL" : "=IF(GZ6=0,0,ROUND($ER6-MAX(0,($G6+($H6-$G6)/(A_equiv_harmonious_max_perc-A_equiv_harmonious_min_perc)*(GZ6-A_equiv_harmonious_min_perc))-$EG6)/El_boiler_eff,5))", "HM" : "=IF(GZ6=0,0,ROUND($ES6-($S6+($T6-$S6)/(A_equiv_harmonious_max_perc-A_equiv_harmonious_min_perc)*(GZ6-A_equiv_harmonious_min_perc)),5))", "HN" : "=IF(GZ6=0,0,ROUND($ET6-($S6+($T6-$S6)/(A_equiv_harmonious_max_perc-A_equiv_harmonious_min_perc)*(GZ6-A_equiv_harmonious_min_perc)),5))", "HO" : "=IF(GZ6=0,0,ROUND($EV6-($U6+($V6-$U6)/(A_equiv_harmonious_max_perc-A_equiv_harmonious_min_perc)*(GZ6-A_equiv_harmonious_min_perc)),5))", "HP" : "=IF(GZ6=0,0,ROUND($EW6-($U6+($V6-$U6)/(A_equiv_harmonious_max_perc-A_equiv_harmonious_min_perc)*(GZ6-A_equiv_harmonious_min_perc)),5))", "HQ" : "=IF(GZ6=0,0,ROUND($EY6-($W6+($X6-$W6)/(A_equiv_harmonious_max_perc-A_equiv_harmonious_min_perc)*(GZ6-A_equiv_harmonious_min_perc)),5))", "HR" : "=IF(GZ6=0,0,ROUND($EZ6-($W6+($X6-$W6)/(A_equiv_harmonious_max_perc-A_equiv_harmonious_min_perc)*(GZ6-A_equiv_harmonious_min_perc)),5))", "HS" : "=IF(GZ6<=0,0,MIN(1,MIN(IFERROR(HA6/(HA6-HB6),1),IFERROR(HC6/(HC6-HD6),1),IFERROR(HE6/(HE6-HF6),1),IFERROR(HG6/(HG6-HH6),1),IFERROR(HI6/(HI6-HJ6),1),IFERROR(HK6/(HK6-HL6),1),IFERROR(HM6/(HM6-HN6),1),IFERROR(HO6/(HO6-HP6),1),IFERROR(HQ6/(HQ6-HR6),1))*(Overall_harmonious_max_perc-Overall_harmonious_min_perc)+Overall_harmonious_min_perc))",  "HU" : "=IF(GE6=0,0,$DR6+($DS6-$DR6)/(Overall_harmonious_max_perc-Overall_harmonious_min_perc)*(GE6-Overall_harmonious_min_perc))", "HV" : "=IF(GX6=0,0,($O6+($P6-$O6)/(A_equiv_harmonious_max_perc-A_equiv_harmonious_min_perc)*(GX6-A_equiv_harmonious_min_perc)))", "HW" : "=IF(OR(GE6=0,GX6=0),0,MIN(($EA6+($E6+($F6-$E6)/(A_equiv_harmonious_max_perc-A_equiv_harmonious_min_perc)*(GX6-A_equiv_harmonious_min_perc))+MAX(0,($G6+($H6-$G6)/(A_equiv_harmonious_max_perc-A_equiv_harmonious_min_perc)*(GX6-A_equiv_harmonious_min_perc))-$EG6)/El_boiler_eff-$ED6)/BESS_chrg_eff,($EK6+($EL6-$EK6)/(Overall_harmonious_max_perc-Overall_harmonious_min_perc)*(GE6-Overall_harmonious_min_perc))))", "HX" : "=IF(GE6=0,0,$EN6+($EO6-$EN6)/(Overall_harmonious_max_perc-Overall_harmonious_min_perc)*(GE6-Overall_harmonious_min_perc))", "HY" : "=IH6/El_boiler_eff", "HZ" : "=IF(GE6=0,0,$EB6+($EC6-$EB6)/(Overall_harmonious_max_perc-Overall_harmonious_min_perc)*(GE6-Overall_harmonious_min_perc))", "IA" : "=IF(GE6=0,0,$DY6+($DZ6-$DY6)/(Overall_harmonious_max_perc-Overall_harmonious_min_perc)*(GE6-Overall_harmonious_min_perc))", "IB" : "=IF(GE6=0,0,MIN($EH6+($EI6-$EH6)/(Overall_harmonious_max_perc-Overall_harmonious_min_perc)*(GE6-Overall_harmonious_min_perc),MAX(0,-(HZ6-HV6-HW6-HY6))))", "IC" : "=HZ6+IB6-HV6-HW6-HY6", "ID" : "=IF(GE6=0,0,$DT6+($DU6-$DT6)/(Overall_harmonious_max_perc-Overall_harmonious_min_perc)*(GE6-Overall_harmonious_min_perc))", "IE" : "=IF(GX6=0,0,($Q6+($R6-$Q6)/(A_equiv_harmonious_max_perc-A_equiv_harmonious_min_perc)*(GX6-A_equiv_harmonious_min_perc)))", "IF" : "=IF(GE6=0,0,$EE6+($EF6-$EE6)/(Overall_harmonious_max_perc-Overall_harmonious_min_perc)*(GE6-Overall_harmonious_min_perc))", "IG" : "=IF(GE6=0,0,($EN6+($EO6-$EN6)/(Overall_harmonious_max_perc-Overall_harmonious_min_perc)*(GE6-Overall_harmonious_min_perc))*El_boiler_eff)", "IH" : "=IF(GE6=0,0,MIN(($EP6+($EQ6-$EP6)/(Overall_harmonious_max_perc-Overall_harmonious_min_perc)*(GE6-Overall_harmonious_min_perc))*El_boiler_eff,MAX(0,IE6-IF6)))", "II" : "=IF6+IH6-IE6", "IJ" : "=IF(OR(GE6=0,GX6=0),0,$E6+($F6-$E6)/(A_equiv_harmonious_max_perc-A_equiv_harmonious_min_perc)*(GX6-A_equiv_harmonious_min_perc))", "IK" : "=IS6/El_boiler_eff", "IL" : "=IF(OR(GE6=0,GX6=0),0,$EA6)", "IM" : "=IF(OR(GE6=0,GX6=0),0,$ED6)", "IN" : "=HW6*BESS_chrg_eff", "IO" : "=IF(OR(GE6=0,GX6=0),0,MIN($EJ6+$EA6,MAX(0,-(IM6+IN6-IJ6-IK6-IL6))))", "IP" : "=IM6+IN6+IO6-IJ6-IK6-IL6", "IQ" : "=IF(OR(GE6=0,GX6=0),0,$G6+($H6-$G6)/(A_equiv_harmonious_max_perc-A_equiv_harmonious_min_perc)*(GX6-A_equiv_harmonious_min_perc))", "IR" : "=IF(OR(GE6=0,GX6=0),0,$EG6)", "IS" : "=IF(OR(GE6=0,GX6=0),0,MIN($ER6*El_boiler_eff,MAX(0,IQ6-IR6)))", "IT" : "=IR6+IS6-IQ6", "IU" : "=IF(HU6<=0,0,HU6/(Overall_harmonious_var_max_cons+Overall_fix_cons)*MethDist_harmonious_max_perc*MethDist_Meth_nom_prod_ud)+IF(IJ6<=0,0,(IJ6-A_overall_stup_cons)/(A_overall_var_max_cons+A_overall_fix_stby_cons)*A_MethDist_max_perc*MethDist_Meth_nom_prod_ud)", "IV" : "=MIN(IC6,IF(OR(GE6=0,GX6=0),0,($DV6+($DW6-$DV6)/(Overall_harmonious_max_perc-Overall_harmonious_min_perc)*(GE6-Overall_harmonious_min_perc))))+MIN(IP6,IF(OR(GE6=0,GX6=0),0,$DX6))", "IW" : "=IA6+IB6+IO6", "IX" : "=MAX(0,-IC6)+MAX(0,-II6)+MAX(0,-IP6)+MAX(0,-IT6)",  "IZ" : "=IF(HS6=0,0,$DR6+($DS6-$DR6)/(Overall_harmonious_max_perc-Overall_harmonious_min_perc)*(HS6-Overall_harmonious_min_perc))", "JA" : "=IF(GZ6=0,0,($O6+($P6-$O6)/(A_equiv_harmonious_max_perc-A_equiv_harmonious_min_perc)*(GZ6-A_equiv_harmonious_min_perc)))", "JB" : "=IF(OR(HS6=0,GZ6=0),0,MIN(($EA6+($E6+($F6-$E6)/(A_equiv_harmonious_max_perc-A_equiv_harmonious_min_perc)*(GZ6-A_equiv_harmonious_min_perc))+MAX(0,($G6+($H6-$G6)/(A_equiv_harmonious_max_perc-A_equiv_harmonious_min_perc)*(GZ6-A_equiv_harmonious_min_perc))-$EG6)/El_boiler_eff-$ED6)/BESS_chrg_eff,($EK6+($EL6-$EK6)/(Overall_harmonious_max_perc-Overall_harmonious_min_perc)*(HS6-Overall_harmonious_min_perc))))", "JC" : "=IF(HS6=0,0,$EN6+($EO6-$EN6)/(Overall_harmonious_max_perc-Overall_harmonious_min_perc)*(HS6-Overall_harmonious_min_perc))", "JD" : "=JM6/El_boiler_eff", "JE" : "=IF(HS6=0,0,$EB6+($EC6-$EB6)/(Overall_harmonious_max_perc-Overall_harmonious_min_perc)*(HS6-Overall_harmonious_min_perc))", "JF" : "=IF(HS6=0,0,$DY6+($DZ6-$DY6)/(Overall_harmonious_max_perc-Overall_harmonious_min_perc)*(HS6-Overall_harmonious_min_perc))", "JG" : "=IF(HS6=0,0,MIN($EH6+($EI6-$EH6)/(Overall_harmonious_max_perc-Overall_harmonious_min_perc)*(HS6-Overall_harmonious_min_perc),MAX(0,-(JE6-JA6-JB6-JD6))))", "JH" : "=JE6+JG6-JA6-JB6-JD6", "JI" : "=IF(HS6=0,0,$DT6+($DU6-$DT6)/(Overall_harmonious_max_perc-Overall_harmonious_min_perc)*(HS6-Overall_harmonious_min_perc))", "JJ" : "=IF(GZ6=0,0,($Q6+($R6-$Q6)/(A_equiv_harmonious_max_perc-A_equiv_harmonious_min_perc)*(GZ6-A_equiv_harmonious_min_perc)))", "JK" : "=IF(HS6=0,0,$EE6+($EF6-$EE6)/(Overall_harmonious_max_perc-Overall_harmonious_min_perc)*(HS6-Overall_harmonious_min_perc))", "JL" : "=IF(HS6=0,0,($EN6+($EO6-$EN6)/(Overall_harmonious_max_perc-Overall_harmonious_min_perc)*(HS6-Overall_harmonious_min_perc))*El_boiler_eff)", "JM" : "=IF(HS6=0,0,MIN(($EP6+($EQ6-$EP6)/(Overall_harmonious_max_perc-Overall_harmonious_min_perc)*(HS6-Overall_harmonious_min_perc))*El_boiler_eff,MAX(0,JJ6-JK6)))", "JN" : "=JK6+JM6-JJ6", "JO" : "=IF(OR(HS6=0,GZ6=0),0,$E6+($F6-$E6)/(A_equiv_harmonious_max_perc-A_equiv_harmonious_min_perc)*(GZ6-A_equiv_harmonious_min_perc))", "JP" : "=JX6/El_boiler_eff", "JQ" : "=IF(OR(HS6=0,GZ6=0),0,$EA6)", "JR" : "=IF(OR(HS6=0,GZ6=0),0,$ED6)", "JS" : "=JB6*BESS_chrg_eff", "JT" : "=IF(OR(HS6=0,GZ6=0),0,MIN($EJ6+$EA6,MAX(0,-(JR6+JS6-JO6-JP6-JQ6))))", "JU" : "=JR6+JS6+JT6-JO6-JP6-JQ6", "JV" : "=IF(OR(HS6=0,GZ6=0),0,$G6+($H6-$G6)/(A_equiv_harmonious_max_perc-A_equiv_harmonious_min_perc)*(GZ6-A_equiv_harmonious_min_perc))", "JW" : "=IF(OR(HS6=0,GZ6=0),0,$EG6)", "JX" : "=IF(OR(HS6=0,GZ6=0),0,MIN($ER6*El_boiler_eff,MAX(0,JV6-JW6)))", "JY" : "=JW6+JX6-JV6", "JZ" : "=IF(IZ6<=0,0,IZ6/(Overall_harmonious_var_max_cons+Overall_fix_cons)*MethDist_harmonious_max_perc*MethDist_Meth_nom_prod_ud)+IF(GZ6<=0,0,($I6+($J6-$I6)/(A_equiv_harmonious_max_perc-A_equiv_harmonious_min_perc)*(GZ6-A_equiv_harmonious_min_perc))/MethDist_RawMeth_nom_cons*MethDist_Meth_nom_prod_ud)", "KA" : "=MIN(JH6,IF(OR(HS6=0,GZ6=0),0,($DV6+($DW6-$DV6)/(Overall_harmonious_max_perc-Overall_harmonious_min_perc)*(HS6-Overall_harmonious_min_perc))))+MIN(JU6,IF(OR(HS6=0,GZ6=0),0,$DX6))", "KB" : "=JF6+JG6+JT6", "KC" : "=MAX(0,-JH6)+MAX(0,-JN6)+MAX(0,-JU6)+MAX(0,-JY6)"
]

let titlesCalculation: [String: String] = [
"A" : "Month", "B" : "Day", "C" : "Hour", "D" : "Day of year", "E" : "Q_Sol (MW_th/Loop)", "F" : "Reference PV plant power at inverter inlet MWel_DC", "G" : "Reference PV MV power at transformer outlet MWel", "H" : "Inverter power fraction -", "I" : "Inverter efficiency -", "J" : "Q_solar (before dumping) MWth", "K" : "E_PV_Total _Scaled MWel_DC", "L" : "PV MV net power at transformer outlet MWel", "M" : "PV aux consumption at transformer level MWel", "N" : "", "O" : "Aux elec for PB stby, CSP SF and PV Plant MWel", "P" : "Available PV power MWel", "Q" : "Not covered aux elec for PB stby, CSP SF and PV Plant MWel", "R" : "Min harmonious net elec cons", "S" : "Optimized min harmonious net elec cons", "T" : "Min harmonious net heat cons", "U" : "Harmonious op day", "V" : "Remaining PV after min harmonious", "W" : "Remaining CSP heat after min harmonious", "X" : "Grid import necessary for min harmonious", "Y" : "Remaining grid import capacity after min harmonious", "Z" : "El to el boiler after min harm heat cons", "AA" : "Remaining el boiler cap after min harm heat cons", "AB" : "Remaining MethSynt cap after min harm cons", "AC" : "Remaining CCU cap after min harm cons", "AD" : "Remaining EY cap after min harm cons", "AE" : "Max BESS charging after min harm cons", "AF" : "Max grid export after min harm cons", "AG" : "Max harm net elec cons", "AH" : "Optimized max harm net elec cons", "AI" : "max harm net heat cons", "AJ" : "Remaining PV after max harm", "AK" : "Remaining CSP heat after max harm", "AL" : "Grid import necessary for max harm", "AM" : "Remaining grid import capacity after max harm", "AN" : "El to el boiler after max harm heat cons", "AO" : "Remaining el boiler cap after max harm heat cons", "AP" : "Remaining MethSynt cap after max harm cons", "AQ" : "Remaining CCU cap after max harm cons", "AR" : "Remaining EY cap after max harm cons", "AS" : "Max BESS charging after max harm cons", "AT" : "Max grid export after max harm cons", "AU" : "", "AV" : "Aux elec for CSP SF and PV Plant MWel", "AW" : "Available PV power MWel", "AX" : "Not covered aux elec for CSP SF and PV Plant MWel", "AY" : "Max possible PV elec to TES (considering TES chrg aux)", "AZ" : "Maximum TES energy per PV day", "BA" : "Surplus energy due to TES size limit", "BB" : "Peripherial PV hour PV to heater", "BC" : "Surplus energy due to op limit after removal of peripherial hours", "BD" : "intermediate resulting PV elec to TES", "BE" : "Partitions of PV hour PV to be dedicated to TES chrg", "BF" : "corrected max possible PV elec to TES", "BG" : "Max possible CSP heat to TES", "BH" : "Not covered aux elec for TES chrg, CSP SF and PV Plant MWel", "BI" : "Remaining PV after TES chrg", "BJ" : "Remaining CSP heat after TES", "BK" : "Not covered aux elec for TES chrg, CSP SF and PV Plant MWel", "BL" : "Min harmonious net elec cons not considering grid import", "BM" : "Optimized min harmonious net elec cons", "BN" : "Min harmonious net heat cons", "BO" : "Harmonious op day", "BP" : "Remaining PV after min harmonious", "BQ" : "Remaining CSP heat after min harmonious", "BR" : "Grid import necessary for min harm", "BS" : "Remaining grid import capacity after min harm", "BT" : "", "BU" : "Min net elec demand to power block", "BV" : "Optimized min net elec demand to power block", "BW" : "Outside harm op aux elec for TES dischrg, CSP SF and PV Plant MWel", "BX" : "Corresponding min PB net elec output", "BY" : "Corresponding min PB gross elec output", "BZ" : "ST startup heat cons", "CA" : "Min gross heat cons for ST", "CB" : "Min gross heat cons for extraction", "CC" : "TES energy needed to fulfil op case", "CD" : "Surplus TES energy due to op case", "CE" : "Peripherial PV hour PV to heater", "CF" : "Surplus energy due to op limit after removal of peripherial hours", "CG" : "intermediate resulting PV elec to TES", "CH" : "Partitions of PV hour PV to be dedicated to TES chrg", "CI" : "corrected max possible PV elec to TES", "CJ" : "Max possible CSP heat to TES", "CK" : "Available elec from PV after TES chrg", "CL" : "Available heat from CSP after TES", "CM" : "Total aux el TES chrg&disch CSP SF, PV, PB stby  MWel", "CN" : "Not covered aux elec MWel", "CO" : "", "CP" : "Min harmonious net elec cons not considering grid import", "CQ" : "Optimized min harmonious net elec cons", "CR" : "Min harmonious net heat cons", "CS" : "Harmonious op day", "CT" : "El cons due to op outside of harm op period", "CU" : "heat cons due to op outside of harm op period", "CV" : "Remaining el after min harmonious", "CW" : "Remaining heat after min harmonious", "CX" : "Grid import necessary for min harm", "CY" : "Remaining grid import capacity after min harm", "CZ" : "El boiler op after min harmonious heat cons", "DA" : "Remaining el boiler cap after min harmonious heat cons", "DB" : "Remaining MethSynt cap after min harmonious cons", "DC" : "Remaining CCU cap after min harmonious cons", "DD" : "Remaining EY cap after min harmonious cons", "DE" : "Max BESS charging after min harmonious cons", "DF" : "Max grid export after TES chrg, min harm, night and aux el  cons", "DG" : "Max harmonious net elec cons without considering grid", "DH" : "Optimized max harmonious net elec cons", "DI" : "max harmonious net heat cons", "DJ" : "Remaining el after max harmonious", "DK" : "Remaining heat after max harmonious", "DL" : "Grid import necessary for max harm", "DM" : "Remaining grid import capacity after max harm", "DN" : "El boiler op after max harmonious heat cons", "DO" : "Remaining el boiler cap after max harmonious heat cons", "DP" : "Remaining MethSynt cap after max harmonious cons", "DQ" : "Remaining CCU cap after max harmonious cons", "DR" : "Remaining EY cap after max harmonious cons", "DS" : "Max BESS charging after max harmonious cons", "DT" : "Max grid export after TES chrg, min harm, night and aux el  cons", "DU" : "", "DV" : "Maximum night op perc considering tank sizes", "DW" : "Max net elec demand outside harm op period", "DX" : "Optimized max net elec demand outside harm op period", "DY" : "Outside harm op aux elec for TES dischrg, CSP SF and PV Plant MWel", "DZ" : "Corresponding max PB net elec output", "EA" : "Corresponding max PB gross elec output", "EB" : "ST startup heat cons", "EC" : "Max gross heat cons for ST", "ED" : "Max gross heat cons for extraction", "EE" : "TES energy available if above min op case", "EF" : "Effective gross heat cons for ST", "EG" : "Effective PB gross elec output", "EH" : "Effective PB net elec output", "EI" : "Effective gross heat cons for extraction", "EJ" : "TES energy to fulfil op case if above", "EK" : "Surplus TES energy due to op case", "EL" : "Peripherial PV hour PV to heater", "EM" : "Surplus energy due to op limit after removal of peripherial hours", "EN" : "intermediate resulting PV elec to TES", "EO" : "Partitions of PV hour PV to be dedicated to TES chrg", "EP" : "corrected max possible PV elec to TES", "EQ" : "Max possible CSP heat to TES", "ER" : "Available elec from PV after TES chrg", "ES" : "Available heat from CSP after TES", "ET" : "Total aux el TES chrg&disch CSP SF, PV, PB stby  MWel", "EU" : "Not covered aux elec MWel", "EV" : "", "EW" : "Min harmonious net elec cons not considering grid import", "EX" : "Optimized min harmonious net elec cons", "EY" : "Min harmonious net heat cons", "EZ" : "Harmonious op day", "FA" : "El cons due to op outside of harm op period", "FB" : "heat cons due to op outside of harm op period", "FC" : "Remaining el after min harmonious", "FD" : "Remaining heat after min harmonious", "FE" : "Grid import necessary for min harm", "FF" : "Remaining grid import capacity after min harm", "FG" : "El boiler op after min harmonious heat cons", "FH" : "Remaining el boiler cap after min harmonious heat cons", "FI" : "Remaining MethSynt cap after min harmonious cons", "FJ" : "Remaining CCU cap after min harmonious cons", "FK" : "Remaining EY cap after min harmonious cons", "FL" : "Max BESS charging after min harmonious cons", "FM" : "Max grid export after TES chrg, min harm, night and aux el  cons", "FN" : "Max harmonious net elec cons without considering grid", "FO" : "Optimized max harmonious net elec cons", "FP" : "max harmonious net heat cons", "FQ" : "Remaining el after max harmonious", "FR" : "Remaining heat after max harmonious", "FS" : "Grid import necessary for max harm", "FT" : "Remaining grid import capacity after max harm", "FU" : "El boiler op after max harmonious heat cons", "FV" : "Remaining el boiler cap after max harmonious heat cons", "FW" : "Remaining MethSynt cap after max harmonious cons", "FX" : "Remaining CCU cap after max harmonious cons", "FY" : "Remaining EY cap after max harmonious cons", "FZ" : "Max BESS charging after max harmonious cons", "GA" : "Max grid export after TES chrg, min harm, night and aux el  cons", "GB" : "", "GC" : "Min net elec demand to power block", "GD" : "Optimized min net elec demand to power block", "GE" : "Outside harm op aux elec for TES dischrg, CSP SF and PV Plant MWel", "GF" : "Corresponding min PB net elec output", "GG" : "Corresponding min PB gross elec output", "GH" : "ST startup heat cons", "GI" : "Min gross heat cons for ST", "GJ" : "Min gross heat cons for extraction", "GK" : "TES energy needed to fulfil op case", "GL" : "Surplus TES energy due to op case", "GM" : "Peripherial PV hour PV to heater", "GN" : "Surplus energy due to op limit after removal of peripherial hours", "GO" : "intermediate resulting PV elec to TES", "GP" : "Partitions of PV hour PV to be dedicated to TES chrg", "GQ" : "corrected max possible PV elec to TES", "GR" : "Max possible CSP heat to TES", "GS" : "Available elec from PV after TES chrg", "GT" : "Available heat from CSP after TES", "GU" : "Total aux el TES chrg&disch CSP SF, PV, PB stby  MWel", "GV" : "Not covered aux elec MWel", "GW" : "", "GX" : "Min harmonious net elec cons not considering grid import", "GY" : "Optimized min harmonious net elec cons", "GZ" : "Min harmonious net heat cons", "HA" : "Harmonious op day", "HB" : "El cons due to op outside of harm op period", "HC" : "heat cons due to op outside of harm op period", "HD" : "Remaining el after min harmonious", "HE" : "Remaining heat after min harmonious", "HF" : "Grid import necessary for min harm", "HG" : "Remaining grid import capacity after min harm", "HH" : "El boiler op after min harmonious heat cons", "HI" : "Remaining el boiler cap after min harmonious heat cons", "HJ" : "Remaining MethSynt cap after min harmonious cons", "HK" : "Remaining CCU cap after min harmonious cons", "HL" : "Remaining EY cap after min harmonious cons", "HM" : "Max BESS charging after min harmonious cons", "HN" : "Max grid export after TES chrg, min harm, night and aux el  cons", "HO" : "Max harmonious net elec cons without considering grid", "HP" : "Optimized max harmonious net elec cons", "HQ" : "max harmonious net heat cons", "HR" : "Remaining el after max harmonious", "HS" : "Remaining heat after max harmonious", "HT" : "Grid import necessary for max harm", "HU" : "Remaining grid import capacity after max harm", "HV" : "El boiler op after max harmonious heat cons", "HW" : "Remaining el boiler cap after max harmonious heat cons", "HX" : "Remaining MethSynt cap after max harmonious cons", "HY" : "Remaining CCU cap after max harmonious cons", "HZ" : "Remaining EY cap after max harmonious cons", "IA" : "Max BESS charging after max harmonious cons", "IB" : "Max grid export after TES chrg, min harm, night and aux el  cons", "IC" : "", "ID" : "Maximum night op perc considering tank sizes", "IE" : "Max net elec demand outside harm op period", "IF" : "Optimized max net elec demand outside harm op period", "IG" : "Outside harm op aux elec for TES dischrg, CSP SF and PV Plant MWel", "IH" : "Corresponding max PB net elec output", "II" : "Corresponding max PB gross elec output", "IJ" : "ST startup heat cons", "IK" : "Max gross heat cons for ST", "IL" : "Max gross heat cons for extraction", "IM" : "TES energy available if above min op case", "IN" : "Effective gross heat cons for ST", "IO" : "Effective PB gross elec output", "IP" : "Effective PB net elec output", "IQ" : "Effective gross heat cons for extraction", "IR" : "TES energy to fulfil op case if above", "IS" : "Surplus TES energy due to op case", "IT" : "Peripherial PV hour PV to heater", "IU" : "Surplus energy due to op limit after removal of peripherial hours", "IV" : "intermediate resulting PV elec to TES", "IW" : "Partitions of PV hour PV to be dedicated to TES chrg", "IX" : "corrected max possible PV elec to TES", "IY" : "Max possible CSP heat to TES", "IZ" : "Available elec from PV after TES chrg", "JA" : "Available heat from CSP after TES", "JB" : "Total aux el TES chrg&disch CSP SF, PV, PB stby  MWel", "JC" : "Not covered aux elec MWel", "JD" : "", "JE" : "Min harmonious net elec cons not considering grid import", "JF" : "Optimized min harmonious net elec cons", "JG" : "Min harmonious net heat cons", "JH" : "Harmonious op day", "JI" : "El cons due to op outside of harm op period", "JJ" : "heat cons due to op outside of harm op period", "JK" : "Remaining el after min harmonious", "JL" : "Remaining heat after min harmonious", "JM" : "Grid import necessary for min harm", "JN" : "Remaining grid import capacity after min harm", "JO" : "El boiler op after min harmonious heat cons", "JP" : "Remaining el boiler cap after min harmonious heat cons", "JQ" : "Remaining MethSynt cap after min harmonious cons", "JR" : "Remaining CCU cap after min harmonious cons", "JS" : "Remaining EY cap after min harmonious cons", "JT" : "Max BESS charging after min harmonious cons", "JU" : "Max grid export after TES chrg, min harm, night and aux el  cons", "JV" : "Max harmonious net elec cons without considering grid", "JW" : "Optimized max harmonious net elec cons", "JX" : "max harmonious net heat cons", "JY" : "Remaining el after max harmonious", "JZ" : "Remaining heat after max harmonious", "KA" : "Grid import necessary for max harm", "KB" : "Remaining grid import capacity after max harm", "KC" : "El boiler op after max harmonious heat cons", "KD" : "Remaining el boiler cap after max harmonious heat cons", "KE" : "Remaining MethSynt cap after max harmonious cons", "KF" : "Remaining CCU cap after max harmonious cons", "KG" : "Remaining EY cap after max harmonious cons", "KH" : "Max BESS charging after max harmonious cons", "KI" : "Max grid export after TES chrg, min harm, night and aux el  cons", "KJ" : "", "KK" : "Min net elec demand to power block", "KL" : "Optimized min net elec demand to power block", "KM" : "Outside harm op aux elec for TES dischrg, CSP SF and PV Plant MWel", "KN" : "Corresponding min PB net elec output", "KO" : "Corresponding min PB gross elec output", "KP" : "ST startup heat cons", "KQ" : "Min gross heat cons for ST", "KR" : "Min gross heat cons for extraction", "KS" : "TES energy needed to fulfil op case", "KT" : "Surplus TES energy due to op case", "KU" : "Peripherial PV hour PV to heater", "KV" : "Surplus energy due to op limit after removal of peripherial hours", "KW" : "intermediate resulting PV elec to TES", "KX" : "Partitions of PV hour PV to be dedicated to TES chrg", "KY" : "corrected max possible PV elec to TES", "KZ" : "Max possible CSP heat to TES", "LA" : "Available elec from PV after TES chrg", "LB" : "Available heat from CSP after TES", "LC" : "Total aux el TES chrg&disch CSP SF, PV, PB stby  MWel", "LD" : "Not covered aux elec MWel", "LE" : "", "LF" : "Min harmonious net elec cons not considering grid import", "LG" : "Optimized min harmonious net elec cons", "LH" : "Min harmonious net heat cons", "LI" : "Harmonious op day", "LJ" : "El cons due to op outside of harm op period", "LK" : "heat cons due to op outside of harm op period", "LL" : "Remaining el after min harmonious", "LM" : "Remaining heat after min harmonious", "LN" : "Grid import necessary for min harm", "LO" : "Remaining grid import capacity after max harm", "LP" : "El boiler op after min harmonious heat cons", "LQ" : "Remaining el boiler cap after min harmonious heat cons", "LR" : "Remaining MethSynt cap after min harmonious cons", "LS" : "Remaining CCU cap after min harmonious cons", "LT" : "Remaining EY cap after min harmonious cons", "LU" : "Max BESS charging after min harmonious cons", "LV" : "Max grid export after TES chrg, min harm, night and aux el  cons", "LW" : "Max harmonious net elec cons without considering grid", "LX" : "Optimized max harmonious net elec cons", "LY" : "max harmonious net heat cons", "LZ" : "Remaining el after max harmonious", "MA" : "Remaining heat after max harmonious", "MB" : "Grid import necessary for max harm", "MC" : "Remaining grid import capacity after max harm", "MD" : "El boiler op after max harmonious heat cons", "ME" : "Remaining el boiler cap after max harmonious heat cons", "MF" : "Remaining MethSynt cap after max harmonious cons", "MG" : "Remaining CCU cap after max harmonious cons", "MH" : "Remaining EY cap after max harmonious cons", "MI" : "Max BESS charging after max harmonious cons", "MJ" : "Max grid export after TES chrg, min harm, night and aux el  cons", "MK" : "", "ML" : "Maximum night op perc considering tank sizes", "MM" : "Max net elec demand outside harm op period", "MN" : "Optimized max net elec demand outside harm op period", "MO" : "Outside harm op aux elec for TES dischrg, CSP SF and PV Plant MWel", "MP" : "Corresponding max PB net elec output", "MQ" : "Corresponding max PB gross elec output", "MR" : "ST startup heat cons", "MS" : "Max gross heat cons for ST", "MT" : "Max gross heat cons for extraction", "MU" : "TES energy available if above min op case", "MV" : "Effective gross heat cons for ST", "MW" : "Effective PB gross elec output", "MX" : "Effective PB net elec output", "MY" : "Effective gross heat cons for extraction", "MZ" : "TES energy to fulfil op case if above", "NA" : "Surplus TES energy due to op case", "NB" : "Peripherial PV hour PV to heater", "NC" : "Surplus energy due to op limit after removal of peripherial hours", "ND" : "intermediate resulting PV elec to TES", "NE" : "Partitions of PV hour PV to be dedicated to TES chrg", "NF" : "corrected max possible PV elec to TES", "NG" : "Max possible CSP heat to TES", "NH" : "Available elec from PV after TES chrg", "NI" : "Available heat from CSP after TES", "NJ" : "Total aux el TES chrg&disch CSP SF, PV, PB stby  MWel", "NK" : "Not covered aux elec MWel", "NL" : "", "NM" : "Min harmonious net elec cons not considering grid import", "NN" : "Optimized min harmonious net elec cons", "NO" : "Min harmonious net heat cons", "NP" : "Harmonious op day", "NQ" : "El cons due to op outside of harm op period", "NR" : "heat cons due to op outside of harm op period", "NS" : "Remaining el after min harmonious", "NT" : "Remaining heat after min harmonious", "NU" : "Grid import necessary for min harm", "NV" : "Remaining grid import capacity after min harm", "NW" : "El boiler op after min harmonious heat cons", "NX" : "Remaining el boiler cap after min harmonious heat cons", "NY" : "Remaining MethSynt cap after min harmonious cons", "NZ" : "Remaining CCU cap after min harmonious cons", "OA" : "Remaining EY cap after min harmonious cons", "OB" : "Max BESS charging after min harmonious cons", "OC" : "Max grid export after TES chrg, min harm, night and aux el  cons", "OD" : "Max harmonious net elec cons without considering grid", "OE" : "Optimized max harmonious net elec cons", "OF" : "max harmonious net heat cons", "OG" : "Remaining el after max harmonious", "OH" : "Remaining heat after max harmonious", "OI" : "Grid import necessary for max harm", "OJ" : "Remaining grid import capacity after max harm", "OK" : "El boiler op after max harmonious heat cons", "OL" : "Remaining el boiler cap after max harmonious heat cons", "OM" : "Remaining MethSynt cap after max harmonious cons", "ON" : "Remaining CCU cap after max harmonious cons", "OO" : "Remaining EY cap after max harmonious cons", "OP" : "Max BESS charging after max harmonious cons", "OQ" : "Max grid export after TES chrg, min harm, night and aux el  cons", "OR" : "", "OS" : "Min net elec demand to power block", "OT" : "Optimized min net elec demand to power block", "OU" : "Outside harm op aux elec for TES dischrg, CSP SF and PV Plant MWel", "OV" : "Corresponding min PB net elec output", "OW" : "Corresponding min PB gross elec output", "OX" : "ST startup heat cons", "OY" : "Min gross heat cons for ST", "OZ" : "Min gross heat cons for extraction", "PA" : "TES energy needed to fulfil op case", "PB" : "Surplus TES energy due to op case", "PC" : "Peripherial PV hour PV to heater", "PD" : "Surplus energy due to op limit after removal of peripherial hours", "PE" : "intermediate resulting PV elec to TES", "PF" : "Partitions of PV hour PV to be dedicated to TES chrg", "PG" : "corrected max possible PV elec to TES", "PH" : "Max possible CSP heat to TES", "PI" : "Available elec from PV after TES chrg", "PJ" : "Available heat from CSP after TES", "PK" : "Total aux el TES chrg&disch CSP SF, PV, PB stby  MWel", "PL" : "Not covered aux elec MWel", "PM" : "", "PN" : "Min harmonious net elec cons not considering grid import", "PO" : "Optimized min harmonious net elec cons", "PP" : "Min harmonious net heat cons", "PQ" : "Harmonious op day", "PR" : "El cons due to op outside of harm op period", "PS" : "heat cons due to op outside of harm op period", "PT" : "Remaining el after min harmonious", "PU" : "Remaining heat after min harmonious", "PV" : "Grid import necessary for min harm", "PW" : "Remaining grid import capacity after min harm", "PX" : "El boiler op after min harmonious heat cons", "PY" : "Remaining el boiler cap after min harmonious heat cons", "PZ" : "Remaining MethSynt cap after min harmonious cons", "QA" : "Remaining CCU cap after min harmonious cons", "QB" : "Remaining EY cap after min harmonious cons", "QC" : "Max BESS charging after min harmonious cons", "QD" : "Max grid export after TES chrg, min harm, night and aux el  cons", "QE" : "Max harmonious net elec cons without considering grid", "QF" : "Optimized max harmonious net elec cons", "QG" : "max harmonious net heat cons", "QH" : "Remaining el after max harmonious", "QI" : "Remaining heat after max harmonious", "QJ" : "Grid import necessary for max harm", "QK" : "Remaining grid import capacity after max harm", "QL" : "El boiler op after max harmonious heat cons", "QM" : "Remaining el boiler cap after max harmonious heat cons", "QN" : "Remaining MethSynt cap after max harmonious cons", "QO" : "Remaining CCU cap after max harmonious cons", "QP" : "Remaining EY cap after max harmonious cons", "QQ" : "Max BESS charging after max harmonious cons", "QR" : "Max grid export after TES chrg, min harm, night and aux el  cons", "QS" : "", "QT" : "Maximum night op perc considering tank sizes", "QU" : "Max net elec demand outside harm op period", "QV" : "Optimized max net elec demand outside harm op period", "QW" : "Outside harm op aux elec for TES dischrg, CSP SF and PV Plant MWel", "QX" : "Corresponding max PB net elec output", "QY" : "Corresponding max PB gross elec output", "QZ" : "ST startup heat cons", "RA" : "Max gross heat cons for ST", "RB" : "Max gross heat cons for extraction", "RC" : "TES energy available if above min op case", "RD" : "Effective gross heat cons for ST", "RE" : "Effective PB gross elec output", "RF" : "Effective PB net elec output", "RG" : "Effective gross heat cons for extraction", "RH" : "TES energy to fulfil op case if above", "RI" : "Surplus TES energy due to op case", "RJ" : "Peripherial PV hour PV to heater", "RK" : "Surplus energy due to op limit after removal of peripherial hours", "RL" : "intermediate resulting PV elec to TES", "RM" : "Partitions of PV hour PV to be dedicated to TES chrg", "RN" : "corrected max possible PV elec to TES", "RO" : "Max possible CSP heat to TES", "RP" : "Available elec from PV after TES chrg", "RQ" : "Available heat from CSP after TES", "RR" : "Total aux el TES chrg&disch CSP SF, PV, PB stby  MWel", "RS" : "Not covered aux elec MWel", "RT" : "", "RU" : "Min harmonious net elec cons not considering grid import", "RV" : "Optimized min harmonious net elec cons", "RW" : "Min harmonious net heat cons", "RX" : "Harmonious op day", "RY" : "El cons due to op outside of harm op period", "RZ" : "heat cons due to op outside of harm op period", "SA" : "Remaining el after min harmonious", "SB" : "Remaining heat after min harmonious", "SC" : "Grid import necessary for min harm", "SD" : "Remaining grid import capacity after min harm", "SE" : "El boiler op after min harmonious heat cons", "SF" : "Remaining el boiler cap after min harmonious heat cons", "SG" : "Remaining MethSynt cap after min harmonious cons", "SH" : "Remaining CCU cap after min harmonious cons", "SI" : "Remaining EY cap after min harmonious cons", "SJ" : "Max BESS charging after min harmonious cons", "SK" : "Max grid export after TES chrg, min harm, night and aux el  cons", "SL" : "Max harmonious net elec cons without considering grid", "SM" : "Optimized max harmonious net elec cons", "SN" : "max harmonious net heat cons", "SO" : "Remaining el after max harmonious", "SP" : "Remaining heat after max harmonious", "SQ" : "Grid import necessary for max harm", "SR" : "Remaining grid import capacity after max harm", "SS" : "El boiler op after max harmonious heat cons", "ST" : "Remaining el boiler cap after max harmonious heat cons", "SU" : "Remaining MethSynt cap after max harmonious cons", "SV" : "Remaining CCU cap after max harmonious cons", "SW" : "Remaining EY cap after max harmonious cons", "SX" : "Max BESS charging after max harmonious cons", "SY" : "Max grid export after TES chrg, min harm, night and aux el  cons"
]

let titlesDaily1: [String: String] = [
"A" : "Day", "B" : "", "C" : "Nr of hours outside of harm op period after min night prep", "D" : "Nr of harm op period hours after min night prep", "E" : "Nr of PB op hours after min night prep", "F" : "Min RawMeth cons during night", "G" : "Max RawMeth cons during night", "H" : "Min CO2 cons during night", "I" : "Max CO2 cons during night", "J" : "Min H2 cons during night", "K" : "Max H2 cons during night", "L" : "Surplus RawMeth storage cap after night min op  prep", "M" : "Surplus RawMeth storage cap after max night op prep", "N" : "Surplus CO2 storage cap after min night op prep", "O" : "Surplus CO2 storage cap after max night op prep", "P" : "Surplus H2 storage cap after min night op prep", "Q" : "Surplus H2 storage cap after max night op prep", "R" : "Max Equiv harmonious night prod due to physical limits", "S" : "", "T" : "Nr of hours outside of harm op period after max night prep", "U" : "Nr of harm op period hours after max night prep", "V" : "Nr of PB op hours after max night prep", "W" : "Max RawMeth cons during night", "X" : "Max CO2 cons during night", "Y" : "Max H2 cons during night", "Z" : "Min el cons during day for night op prep", "AA" : "Max el cons during day for night op prep", "AB" : "Min heat cons during day for night op prep", "AC" : "Max heat cons during day for prep of night", "AD" : "Min Rawmeth prod during day for night op prep", "AE" : "Max Rawmeth prod during day for night op prep", "AF" : "Min CO2 prod during day for night op prep", "AG" : "Max CO2 prod during day for night op prep", "AH" : "Min H2 prod during day for night op prep", "AI" : "Max H2 prod during day for night op prep", "AJ" : "Surplus RawMeth storage cap after max night op prep", "AK" : "Surplus CO2 storage cap after max night op prep", "AL" : "Surplus H2 storage cap after max night op prep", "AM" : "Max Equiv harmonious night prod due to physical limits", "AN" : "", "AO" : "Nr of hours outside of harm op period after min night prep", "AP" : "Nr of harm op period hours after min night prep", "AQ" : "Nr of PB op hours after min night prep", "AR" : "Min RawMeth cons during night", "AS" : "Max RawMeth cons during night", "AT" : "Min CO2 cons during night", "AU" : "Max CO2 cons during night", "AV" : "Min H2 cons during night", "AW" : "Max H2 cons during night", "AX" : "Surplus RawMeth storage cap after night min op  prep", "AY" : "Surplus RawMeth storage cap after max night op prep", "AZ" : "Surplus CO2 storage cap after min night op prep", "BA" : "Surplus CO2 storage cap after max night op prep", "BB" : "Surplus H2 storage cap after min night op prep", "BC" : "Surplus H2 storage cap after max night op prep", "BD" : "Max Equiv harmonious night prod due to physical limits", "BE" : "", "BF" : "Nr of hours outside of harm op period after max night prep", "BG" : "Nr of harm op period hours after max night prep", "BH" : "Nr of PB op hours after max night prep", "BI" : "Max RawMeth cons during night", "BJ" : "Max CO2 cons during night", "BK" : "Max H2 cons during night", "BL" : "Min el cons during day for night op prep", "BM" : "Max el cons during day for night op prep", "BN" : "Min heat cons during day for night op prep", "BO" : "Max heat cons during day for prep of night", "BP" : "Min Rawmeth prod during day for night op prep", "BQ" : "Max Rawmeth prod during day for night op prep", "BR" : "Min CO2 prod during day for night op prep", "BS" : "Max CO2 prod during day for night op prep", "BT" : "Min H2 prod during day for night op prep", "BU" : "Max H2 prod during day for night op prep", "BV" : "Surplus RawMeth storage cap after max night op prep", "BW" : "Surplus CO2 storage cap after max night op prep", "BX" : "Surplus H2 storage cap after max night op prep", "BY" : "Max Equiv harmonious night prod due to physical limits", "BZ" : "", "CA" : "Nr of hours outside of harm op period after min night prep", "CB" : "Nr of harm op period hours after min night prep", "CC" : "Nr of PB op hours after min night prep", "CD" : "Min RawMeth cons during night", "CE" : "Max RawMeth cons during night", "CF" : "Min CO2 cons during night", "CG" : "Max CO2 cons during night", "CH" : "Min H2 cons during night", "CI" : "Max H2 cons during night", "CJ" : "Surplus RawMeth storage cap after night min op  prep", "CK" : "Surplus RawMeth storage cap after max night op prep", "CL" : "Surplus CO2 storage cap after min night op prep", "CM" : "Surplus CO2 storage cap after max night op prep", "CN" : "Surplus H2 storage cap after min night op prep", "CO" : "Surplus H2 storage cap after max night op prep", "CP" : "Max Equiv harmonious night prod due to physical limits", "CQ" : "", "CR" : "Nr of hours outside of harm op period after max night prep", "CS" : "Nr of harm op period hours after max night prep", "CT" : "Nr of PB op hours after max night prep", "CU" : "Max RawMeth cons during night", "CV" : "Max CO2 cons during night", "CW" : "Max H2 cons during night", "CX" : "Min el cons during day for night op prep", "CY" : "Max el cons during day for night op prep", "CZ" : "Min heat cons during day for night op prep", "DA" : "Max heat cons during day for prep of night", "DB" : "Min Rawmeth prod during day for night op prep", "DC" : "Max Rawmeth prod during day for night op prep", "DD" : "Min CO2 prod during day for night op prep", "DE" : "Max CO2 prod during day for night op prep", "DF" : "Min H2 prod during day for night op prep", "DG" : "Max H2 prod during day for night op prep", "DH" : "Surplus RawMeth storage cap after max night op prep", "DI" : "Surplus CO2 storage cap after max night op prep", "DJ" : "Surplus H2 storage cap after max night op prep", "DK" : "Max Equiv harmonious night prod due to physical limits", "DL" : "", "DM" : "Nr of hours outside of harm op period after min night prep", "DN" : "Nr of harm op period hours after min night prep", "DO" : "Nr of PB op hours after min night prep", "DP" : "Min RawMeth cons during night", "DQ" : "Max RawMeth cons during night", "DR" : "Min CO2 cons during night", "DS" : "Max CO2 cons during night", "DT" : "Min H2 cons during night", "DU" : "Max H2 cons during night", "DV" : "Surplus RawMeth storage cap after night min op  prep", "DW" : "Surplus RawMeth storage cap after max night op prep", "DX" : "Surplus CO2 storage cap after min night op prep", "DY" : "Surplus CO2 storage cap after max night op prep", "DZ" : "Surplus H2 storage cap after min night op prep", "EA" : "Surplus H2 storage cap after max night op prep", "EB" : "Max Equiv harmonious night prod due to physical limits", "EC" : "", "ED" : "Nr of hours outside of harm op period after max night prep", "EE" : "Nr of harm op period hours after max night prep", "EF" : "Nr of PB op hours after max night prep", "EG" : "Max RawMeth cons during night", "EH" : "Max CO2 cons during night", "EI" : "Max H2 cons during night", "EJ" : "Min el cons during day for night op prep", "EK" : "Max el cons during day for night op prep", "EL" : "Min heat cons during day for night op prep", "EM" : "Max heat cons during day for prep of night", "EN" : "Min Rawmeth prod during day for night op prep", "EO" : "Max Rawmeth prod during day for night op prep", "EP" : "Min CO2 prod during day for night op prep", "EQ" : "Max CO2 prod during day for night op prep", "ER" : "Min H2 prod during day for night op prep", "ES" : "Max H2 prod during day for night op prep", "ET" : "Surplus RawMeth storage cap after max night op prep", "EU" : "Surplus CO2 storage cap after max night op prep", "EV" : "Surplus H2 storage cap after max night op prep", "EW" : "Max Equiv harmonious night prod due to physical limits", "EX" : "", "EY" : "Available elec after TES chrg during harm op period", "EZ" : "Available elec after TES chrg outside harm op period", "FA" : "Available heat after TES chrg during harm op period", "FB" : "Available heat after TES chrg outside of harm op period", "FC" : "Harm el cons considering min harm op during harm op period", "FD" : "Harm el cons considering max harm op during harm op period", "FE" : "Harm el cons outside of harm op period", "FF" : "Harm heat cons considering min harm op during harm op period", "FG" : "Harm heat cons considering max harm op during harm op period", "FH" : "Harm heat cons outside of harm op period", "FI" : "Grid import considering min harm op during harm op period", "FJ" : "Grid import considering max harm op during harm op period", "FK" : "Grid import  outside of harm op period", "FL" : "El boiler op considering min harm op during harm op period", "FM" : "El boiler op considering max harm op during harm op period", "FN" : "El boiler op outside harm op period", "FO" : "Total aux cons during harm op period", "FP" : "Total aux cons outside of harm op period", "FQ" : "El cons not covered during harm op period", "FR" : "El cons not covered outside of harm op period", "FS" : "Remaining PV el after TES chrg&min harm&aux during harm op period", "FT" : "Remaining PV el after TES chrg&max harm&aux op during harm op period", "FU" : "Remaining PV el outside of harm op period", "FV" : "Remaining CSP heat after min harm during harm op period", "FW" : "Remaining CSP heat after max harm op during harm op period", "FX" : "Remaining CSP heat outside of harm op period", "FY" : "Max BESS night prep after min harm cons during harm op period", "FZ" : "Max BESS night prep after max harm cons during harm op period", "GA" : "Max BESS night prep outside of harm op period", "GB" : "Max grid export after min harm cons during harm op period", "GC" : "Max grid export after max harm cons during harm op period", "GD" : "Max grid export outside of harm op period", "GE" : "Remaining grid import during harm op period after min harm", "GF" : "Remaining grid import during harm op period after max harm", "GG" : "Remaining grid import outside of harm op period", "GH" : "Remaining El boiler cap during harm op period after min harm", "GI" : "Remaining El boiler cap during harm op period after max harm", "GJ" : "Remaining El boiler cap outside of harm op period", "GK" : "Remaining MethSynt cap during harm op after min harm op", "GL" : "Remaining MethSynt cap during harm op period after max harm op", "GM" : "Remaining MethSynt cap outside of harm op period", "GN" : "Remaining CCU cap during harm op after min harm", "GO" : "Remaining CCU cap during harm op after max harm", "GP" : "Remaining CCU cap outside of harm op after min harm", "GQ" : "Remaining EY cap during harm op after min harm", "GR" : "Remaining EY cap during harm op period after max harm", "GS" : "Remaining EY cap outside of harm op period", "GT" : "", "GU" : "Available elec after TES chrg during harm op period", "GV" : "Available elec after TES chrg outside harm op period", "GW" : "Available heat after TES chrg during harm op period", "GX" : "Available heat after TES chrg outside of harm op period", "GY" : "Harm el cons considering min harm op during harm op period", "GZ" : "Harm el cons considering max harm op during harm op period", "HA" : "Harm el cons outside of harm op period", "HB" : "Harm heat cons considering min harm op during harm op period", "HC" : "Harm heat cons considering max harm op during harm op period", "HD" : "Harm heat cons outside of harm op period", "HE" : "Grid import considering min harm op during harm op period", "HF" : "Grid import considering max harm op during harm op period", "HG" : "Grid import  outside of harm op period", "HH" : "El boiler op considering min harm op during harm op period", "HI" : "El boiler op considering max harm op during harm op period", "HJ" : "El boiler op outside harm op period", "HK" : "Total aux cons during harm op period", "HL" : "Total aux cons outside of harm op period", "HM" : "El cons not covered during harm op period", "HN" : "El cons not covered outside of harm op period", "HO" : "Remaining PV el after TES chrg& min harm&aux during harm op period", "HP" : "Remaining PV el after TES chrg& max harm&aux during harm op period", "HQ" : "Remaining PV el outside of harm op period", "HR" : "Remaining CSP heat after min harm during harm op period", "HS" : "Remaining CSP heat after max harm op during harm op period", "HT" : "Remaining CSP heat outside of harm op period", "HU" : "Max elec to BESS for night prep after min harm op during harm op period", "HV" : "Max elec to BESS for night prep after max harm op during harm op period", "HW" : "Max elec to BESS for night prep outside of harm op period", "HX" : "Max grid export after min harm cons during harm op period", "HY" : "Max grid export after max harm cons during harm op period", "HZ" : "Max grid export outside of harm op period", "IA" : "Remaining grid import during harm op period after min harm", "IB" : "Remaining grid import during harm op period after max harm", "IC" : "Remaining grid import outside of harm op period", "ID" : "Remaining El boiler cap during harm op period after min harm", "IE" : "Remaining El boiler cap during harm op period after max harm", "IF" : "Remaining El boiler cap outside of harm op period", "IG" : "Remaining MethSynt cap during harm op after min harm op", "IH" : "Remaining MethSynt cap during harm op period after max harm op", "II" : "Remaining MethSynt cap outside of harm op period", "IJ" : "Remaining CCU cap during harm op after min harm", "IK" : "Remaining CCU cap during harm op after max harm", "IL" : "Remaining CCU cap outside of harm op after min harm", "IM" : "Remaining EY cap during harm op after min harm", "IN" : "Remaining EY cap during harm op period after max harm", "IO" : "Remaining EY cap outside of harm op period", "IP" : "", "IQ" : "Surplus harm op period electricity after min harm op and min night op prep", "IR" : "Surplus harm op period electricity after min harm op and max night op prep", "IS" : "Surplus harm op period electricity after max harm op and min night op prep", "IT" : "Surplus harm op heat+boiler prod after min harm op and min night op prep", "IU" : "Surplus harm op heat+boiler prod after min harm op and max night op prep", "IV" : "Surplus harm op heat+boiler prod after max harm op and min night op prep", "IW" : "Surplus el boiler cap after min harm op and min night op prep", "IX" : "Surplus el boiler cap after min harm op and max night op prep", "IY" : "Surplus el boiler cap after max harm op and min night op prep", "IZ" : "Surplus BESS chrg cap after min harm op and min night op prep", "JA" : "Surplus BESS chrg cap after min harm op and max night op prep", "JB" : "Surplus BESS chrg cap after max harm op and min night op prep", "JC" : "Surplus RawMeth prod cap after min harm op and min night op prep", "JD" : "Surplus RawMeth prod cap after min harm op and max night op prep", "JE" : "Surplus RawMeth prod cap after max harm op and min night op prep", "JF" : "Surplus CO2 prod cap after min harm op and min night op prep", "JG" : "Surplus CO2 prod cap after min harm op and max night op prep", "JH" : "Surplus CO2 prod cap after max harm op and min night op prep", "JI" : "Surplus H2 prod cap after min harm op and min night op prep", "JJ" : "Surplus H2 prod cap after min harm op and max night op prep", "JK" : "Surplus H2 prod cap after max harm op and min night op prep", "JL" : "", "JM" : "Optimal harmonious day prod after min night prep due to prod cap limits", "JN" : "Surplus harm op period electricity after opt harmonious and min night op prep", "JO" : "Surplus harm op period electricity after opt harmonious and max night op prep", "JP" : "Surplus harm op csp steam+boiler prod cap after opt day harm and min night op prep", "JQ" : "Surplus harm op csp steam+boiler prod cap after opt day harm and max night op prep", "JR" : "Surplus el boiler cap after opt day harm and min night op prep", "JS" : "Surplus el boiler cap after opt day harm and max night op prep", "JT" : "Surplus BESS chrg cap after opt day harm and min night op prep", "JU" : "Surplus BESS chrg cap after opt day harm and max night op prep", "JV" : "Surplus RawMeth prod cap after opt day harm and min night op prep", "JW" : "Surplus RawMeth prod cap after opt day harm and max night op prep", "JX" : "Surplus CO2 prod cap after opt day harm and min night op prep", "JY" : "Surplus CO2 prod cap after opt day harm and max night op prep", "JZ" : "Surplus H2 prod cap after opt day harm and min night op prep", "KA" : "Surplus H2 prod cap after opt day harm and max night op prep", "KB" : "Opt night prep during day prio operation", "KC" : "", "KD" : "min harmonious day prod after opt equiv harmonious night prod due to prod cap limits", "KE" : "Surplus harm op period electricity after min day harmonious and opti night op prep", "KF" : "Surplus harm op period electricity after max day harmonious and opti night op prep", "KG" : "Surplus harmonious op csp steam+boiler prod cap after min day harmonious and opti night op prep", "KH" : "Surplus harmonious op csp steam+boiler prod cap after max day harmonious and opti night op prep", "KI" : "Surplus el boiler cap after min day harmonious and opti night op prep", "KJ" : "Surplus el boiler cap after max day harmonious and opti night op prep", "KK" : "Surplus BESS cap after min day harmonious and opti night op prep", "KL" : "Surplus BESS cap after max day harmonious and opti night op prep", "KM" : "Surplus RawMeth prod cap after min day harmonious and opti night op prep", "KN" : "Surplus RawMeth prod cap after max day harmonious and opti night op prep", "KO" : "Surplus CO2 prod cap after min day harmonious and opti night op prep", "KP" : "Surplus CO2 prod cap after max day harmonious and opti night op prep", "KQ" : "Surplus H2 prod cap after min day harmonious and opti night op prep", "KR" : "Surplus H2 prod cap after max day harmonious and opti night op prep", "KS" : "Opt harm op period op during night prio operation", "KT" : "", "KU" : "el cons for harm op during harm op period", "KV" : "el cons for night prep during harm op period", "KW" : "el to cover aux cons during harm op period", "KX" : "el cons for BESS charging during harm op period", "KY" : "el cons for el boiler op for harm op during harm op period", "KZ" : "el cons for el boiler op for night prep during harm op period", "LA" : "El available during harm op period after TES chrg", "LB" : "Grid import for harm op during harm op period", "LC" : "Grid import for night prep during harm op period", "LD" : "Balance of electricity during harm op period", "LE" : "heat cons for harm op during harm op period", "LF" : "heat cons for night prep during harm op period", "LG" : "heat prod by el boiler for harm op during harm op period", "LH" : "heat prod by el boiler for night prep during harm op period", "LI" : "Heat available during harm op period after TES chrg", "LJ" : "Balance of heat during harm op period", "LK" : "el cons for harm op outside of harm op period", "LL" : "el to cover aux cons outside of harm op period", "LM" : "el cons for el boiler for harm op outside of harm op period", "LN" : "el from BESS discharging outside of harm op period", "LO" : "El available outside of harm op period after TES chrg", "LP" : "Grid import needed outside of harm op period", "LQ" : "Balance of electricity outside of harm op period", "LR" : "heat cons for harm op outside of harm op period", "LS" : "Heat prod by el boiler for harm op outside of harm op period", "LT" : "Heat available outside of harm op period after TES chrg", "LU" : "Balance of heat outside of harm op period", "LV" : "Pure Methanol prod with day priority and resp night op", "LW" : "grid export", "LX" : "Grid import", "LY" : "Outside harmonious operation period hours", "LZ" : "Harmonious operation period hours", "MA" : "PB operating hours", "MB" : "Checksum", "MC" : "", "MD" : "el cons for harm op during harm op period", "ME" : "el cons for night prep during harm op period", "MF" : "el to cover aux cons during harm op period", "MG" : "el cons for BESS charging during harm op period", "MH" : "el cons for el boiler op for harm op during harm op period", "MI" : "el cons for el boiler op for night prep during harm op period", "MJ" : "El available during harm op period after TES chrg", "MK" : "Grid import for harm op during harm op period", "ML" : "Grid import for night prep during harm op period", "MM" : "Balance of electricity during harm op period", "MN" : "heat cons for harm op during harm op period", "MO" : "heat cons for night prep during harm op period", "MP" : "heat prod by el boiler for harm op during harm op period", "MQ" : "heat prod by el boiler for night prep during harm op period", "MR" : "Heat available during harm op period after TES chrg", "MS" : "Balance of heat during harm op period", "MT" : "el cons for harm op outside of harm op period", "MU" : "el to cover aux cons outside of harm op period", "MV" : "el cons for el boiler for harm op outside of harm op period", "MW" : "el from BESS discharging outside of harm op period", "MX" : "El available outside of harm op period after TES chrg", "MY" : "Grid import needed outside of harm op period", "MZ" : "Balance of electricity outside of harm op period", "NA" : "heat cons for harm op outside of harm op period", "NB" : "Heat prod by el boiler for harm op outside of harm op period", "NC" : "Heat available outside of harm op period after TES chrg", "ND" : "Balance of heat outside of harm op period", "NE" : "Pure Methanol prod with night priority and resp day op", "NF" : "Grid export", "NG" : "Grid import", "NH" : "Outside harmonious operation period hours", "NI" : "Harmonious operation period hours", "NJ" : "PB operating hours", "NK" : "Checksum"
]

let titlesDaily2: [String: String] = [
"A" : "Day", "B" : "Nr of hours where min harmonious is not possible in spite of grid support", "C" : "Nr of hours where min harmonious is possible considering grid support", "D" : "", "E" : "Min el cons during night", "F" : "Max el cons during night", "G" : "Min heat cons during night", "H" : "Max heat cons during night", "I" : "Min RawMeth cons during night", "J" : "Max RawMeth cons during night", "K" : "Min CO2 cons during night", "L" : "Max CO2 cons during night", "M" : "Min H2 cons during night", "N" : "Max H2 cons during night", "O" : "Min el cons during day for night op prep", "P" : "Max el cons during day for night op prep", "Q" : "Min heat cons during day for night op prep", "R" : "Max heat cons during day for prep of night", "S" : "Min Rawmeth prod during day for night op prep", "T" : "Max Rawmeth prod during day for night op prep", "U" : "Min CO2 prod during day for night op prep", "V" : "Max CO2 prod during day for night op prep", "W" : "Min H2 prod during day for night op prep", "X" : "Max H2 prod during day for night op prep", "Y" : "Surplus RawMeth storage cap after night min op  prep", "Z" : "Surplus RawMeth storage cap after max night op prep", "AA" : "Surplus CO2 storage cap after min night op prep", "AB" : "Surplus CO2 storage cap after max night op prep", "AC" : "Surplus H2 storage cap after min night op prep", "AD" : "Surplus H2 storage cap after max night op prep", "AE" : "Max Equiv harmonious night prod due to physical limits", "AF" : "", "AG" : "Min el cons during night", "AH" : "Max el cons during night", "AI" : "Min heat cons during night", "AJ" : "Max heat cons during night", "AK" : "Min RawMeth cons during night", "AL" : "Max RawMeth cons during night", "AM" : "Min CO2 cons during night", "AN" : "Max CO2 cons during night", "AO" : "Min H2 cons during night", "AP" : "Max H2 cons during night", "AQ" : "Min el cons during day for night op prep", "AR" : "Max el cons during day for night op prep", "AS" : "Min heat cons during day for night op prep", "AT" : "Max heat cons during day for prep of night", "AU" : "Min Rawmeth prod during day for night op prep", "AV" : "Max Rawmeth prod during day for night op prep", "AW" : "Min CO2 prod during day for night op prep", "AX" : "Max CO2 prod during day for night op prep", "AY" : "Min H2 prod during day for night op prep", "AZ" : "Max H2 prod during day for night op prep", "BA" : "Surplus RawMeth storage cap after night min op  prep", "BB" : "Surplus RawMeth storage cap after max night op prep", "BC" : "Surplus CO2 storage cap after min night op prep", "BD" : "Surplus CO2 storage cap after max night op prep", "BE" : "Surplus H2 storage cap after min night op prep", "BF" : "Surplus H2 storage cap after max night op prep", "BG" : "Max Equiv harmonious night prod due to physical limits", "BH" : "", "BI" : "Min el cons during night", "BJ" : "Max el cons during night", "BK" : "Min heat cons during night", "BL" : "Max heat cons during night", "BM" : "Min RawMeth cons during night", "BN" : "Max RawMeth cons during night", "BO" : "Min CO2 cons during night", "BP" : "Max CO2 cons during night", "BQ" : "Min H2 cons during night", "BR" : "Max H2 cons during night", "BS" : "Min el cons during day for night op prep", "BT" : "Max el cons during day for night op prep", "BU" : "Min heat cons during day for night op prep", "BV" : "Max heat cons during day for prep of night", "BW" : "Min Rawmeth prod during day for night op prep", "BX" : "Max Rawmeth prod during day for night op prep", "BY" : "Min CO2 prod during day for night op prep", "BZ" : "Max CO2 prod during day for night op prep", "CA" : "Min H2 prod during day for night op prep", "CB" : "Max H2 prod during day for night op prep", "CC" : "Surplus RawMeth storage cap after night min op  prep", "CD" : "Surplus RawMeth storage cap after max night op prep", "CE" : "Surplus CO2 storage cap after min night op prep", "CF" : "Surplus CO2 storage cap after max night op prep", "CG" : "Surplus H2 storage cap after min night op prep", "CH" : "Surplus H2 storage cap after max night op prep", "CI" : "Max Equiv harmonious night prod due to physical limits", "CJ" : "", "CK" : "Min el cons during night", "CL" : "Max el cons during night", "CM" : "Min heat cons during night", "CN" : "Max heat cons during night", "CO" : "Min RawMeth cons during night", "CP" : "Max RawMeth cons during night", "CQ" : "Min CO2 cons during night", "CR" : "Max CO2 cons during night", "CS" : "Min H2 cons during night", "CT" : "Max H2 cons during night", "CU" : "Min el cons during day for night op prep", "CV" : "Max el cons during day for night op prep", "CW" : "Min heat cons during day for night op prep", "CX" : "Max heat cons during day for prep of night", "CY" : "Min Rawmeth prod during day for night op prep", "CZ" : "Max Rawmeth prod during day for night op prep", "DA" : "Min CO2 prod during day for night op prep", "DB" : "Max CO2 prod during day for night op prep", "DC" : "Min H2 prod during day for night op prep", "DD" : "Max H2 prod during day for night op prep", "DE" : "Surplus RawMeth storage cap after night min op  prep", "DF" : "Surplus RawMeth storage cap after max night op prep", "DG" : "Surplus CO2 storage cap after min night op prep", "DH" : "Surplus CO2 storage cap after max night op prep", "DI" : "Surplus H2 storage cap after min night op prep", "DJ" : "Surplus H2 storage cap after max night op prep", "DK" : "Max Equiv harmonious night prod due to physical limits", "DL" : "", "DM" : "Available day op PV elec after CSP, PB stby aux", "DN" : "Available night op PV elec after CSP, PB stby aux", "DO" : "Available day op  CSP heat", "DP" : "Available night op  CSP heat", "DQ" : "", "DR" : "El cons considering min harm op during harm op period", "DS" : "El cons considering max harm op during harm op period", "DT" : "Heat cons considering min harm op during harm op period", "DU" : "Heat cons considering max harm op during harm op period", "DV" : "Max grid export after min harm op during harm op period", "DW" : "Max grid export after max harm op during harm op period", "DX" : "Max grid export after min/max harm op outside of harm op period", "DY" : "Grid cons considering min harm op during harm op period", "DZ" : "Grid cons considering max harm op during harm op period", "EA" : "Grid cons considering min/max harm op outside harm op period", "EB" : "Remaining PV el after min harm during harm op period", "EC" : "Remaining PV el after max harm during harm op period", "ED" : "Remaining PV el after min harm outside harm op period", "EE" : "Remaining CSP heat after min harm during harm op period", "EF" : "Remaining CSP heat after max harm during harm op period", "EG" : "Remaining CSP heat after min harm outside harm op period", "EH" : "Remaining grid import cap after min harm during harm op period", "EI" : "Remaining grid import cap after max harm during harm op period", "EJ" : "Remaining grid import cap after min harm outside harm op period", "EK" : "Max elec to BESS for night prep after min harm op during harm op period", "EL" : "Max BESS night prep after max harm cons during harm op period", "EM" : "Max elec to BESS for night prep after min harm op outside harm op period", "EN" : "El boiler op for min harm during harm op period", "EO" : "El boiler op for max harm during harm op period", "EP" : "Remaining El boiler cap after min harm during harm op period", "EQ" : "Remaining El boiler cap after max harm during harm op period", "ER" : "Remaining El boiler cap after min harm outside harm op period", "ES" : "Remaining MethSynt cap after min harm during harm op period", "ET" : "Remaining MethSynt cap after max harm during harm op period", "EU" : "Remaining MethSynt cap after min harm outside of harm op period", "EV" : "Remaining CCU cap after min harm during harm op period", "EW" : "Remaining CCU cap after max harm during harm op period", "EX" : "Remaining CCU cap after min harm outside of harm op period", "EY" : "Remaining EY cap after min harm during harm op period", "EZ" : "Remaining EY cap after max harm during harm op period", "FA" : "Remaining EY cap after min harm outside of harm op period", "FB" : "", "FC" : "Surplus harm op period el after min day harm op and min night op prep", "FD" : "Surplus harm op period el after min day harm op and max night op prep", "FE" : "Surplus harm op period el after max day harm op and min night op prep", "FF" : "Surplus outside harm op period el after min day harm and min night op prep; comment: it is assumed that PV during off-harmonious period is not well distributed and must therefore be channelled during the BESS to be used", "FG" : "Surplus outside harm op period el after min day harm and max night op prep; comment: it is assumed that PV during off-harmonious period is not well distributed and must therefore be channelled during the BESS to be used", "FH" : "Surplus outside harm op period el after max day harm and min night op prep; comment: it is assumed that PV during off-harmonious period is not well distributed and must therefore be channelled during the BESS to be used", "FI" : "Surplus harm op heat after min day harm and min night op prep; Comment: it is assumed that PV electricity from outside harmonious period is used to charge BESS", "FJ" : "Surplus harm op heat after min day harm and max night op prep; Comment: it is assumed that PV electricity from outside harmonious period is used to charge BESS", "FK" : "Surplus harm op heat after max day harm and min night op prep; Comment: it is assumed that PV electricity from outside harmonious period is used to charge BESS", "FL" : "Surplus outside harm op heat after min day harm and min night op prep", "FM" : "Surplus outside harm op heat after min day harm and max night op prep", "FN" : "Surplus outside harm op heat after max day harm and min night op prep", "FO" : "Surplus el boiler cap after min harm op and min night op prep during harm op period", "FP" : "Surplus el boiler cap after min harm op and max night op prep during harm op period", "FQ" : "Surplus el boiler cap after max harm op and min night op prep during harm op period", "FR" : "Surplus el boiler cap after min harm op and min night op prep outside of harm op period", "FS" : "Surplus el boiler cap after min harm op and max night op prep outside of harm op period", "FT" : "Surplus el boiler cap after max harm op and min night op prep outside of harm op period", "FU" : "Surplus RawMeth prod cap after min day harm and min night op prep", "FV" : "Surplus RawMeth prod cap after min day harm and max night op prep", "FW" : "Surplus RawMeth prod cap after max day harm and min night op prep", "FX" : "Surplus CO2 prod cap after min day harm and min night op prep", "FY" : "Surplus CO2 prod cap after min day harm and max night op prep", "FZ" : "Surplus CO2 prod cap after max day harm and min night op prep", "GA" : "Surplus H2 prod cap after min day harm and min night op prep", "GB" : "Surplus H2 prod cap after min day harm and max night op prep", "GC" : "Surplus H2 prod cap after max day harm and min night op prep", "GD" : "", "GE" : "Optimal harmonious day prod after min night prep due to prod cap limits", "GF" : "Surplus harm op period el after opt day harm op and min night op prep", "GG" : "Surplus harm op period el after opt day harm op and max night op prep", "GH" : "Surplus outside harm op period el after opt day harm and min night op prep; comment: it is assumed that PV during off-harmonious period is not well distributed and must therefore be channelled during the BESS to be used", "GI" : "Surplus outside harm op period el after opt day harm and max night op prep; comment: it is assumed that PV during off-harmonious period is not well distributed and must therefore be channelled during the BESS to be used", "GJ" : "Surplus harm op heat after opt day harm and min night op prep; Comment: it is assumed that PV electricity from outside harmonious period is used to charge BESS", "GK" : "Surplus harm op heat after opt day harm and max night op prep; Comment: it is assumed that PV electricity from outside harmonious period is used to charge BESS", "GL" : "Surplus outside harm op heat after opt day harm and min night op prep", "GM" : "Surplus outside harm op heat after opt day harm and max night op prep", "GN" : "Surplus el boiler cap after opt harm op and min night op prep during harm op period", "GO" : "Surplus el boiler cap after opt harm op and max night op prep during harm op period", "GP" : "Surplus el boiler cap after opt harm op and min night op prep outside of harm op period", "GQ" : "Surplus el boiler cap after opt harm op and max night op prep outside of harm op period", "GR" : "Surplus RawMeth prod cap after opt day harm and min night op prep", "GS" : "Surplus RawMeth prod cap after opt day harm and max night op prep", "GT" : "Surplus CO2 prod cap after opt day harm and min night op prep", "GU" : "Surplus CO2 prod cap after opt day harm and max night op prep", "GV" : "Surplus H2 prod cap after opt day harm and min night op prep", "GW" : "Surplus H2 prod cap after opt day harm and max night op prep", "GX" : "Max harmonious day prod after min night prep due to prod cap limits", "GY" : "", "GZ" : "Max Equiv harmonious night prod due to prod cap limits", "HA" : "Surplus harm op period el after min day harm op and opt night op prep", "HB" : "Surplus harm op period el after max day harm op and opt night op prep", "HC" : "Surplus outside harm op period el after min day harm and opt night op prep; comment: it is assumed that PV during off-harmonious period is not well distributed and must therefore be channelled during the BESS to be used", "HD" : "Surplus outside harm op period el after max day harm and opt night op prep; comment: it is assumed that PV during off-harmonious period is not well distributed and must therefore be channelled during the BESS to be used", "HE" : "Surplus harm op heat after min day harm and opt night op prep; Comment: it is assumed that PV electricity from outside harmonious period is used to charge BESS", "HF" : "Surplus harm op heat after max day harm and opt night op prep; Comment: it is assumed that PV electricity from outside harmonious period is used to charge BESS", "HG" : "Surplus outside harm op heat after min day harm and opt night op prep", "HH" : "Surplus outside harm op heat after max day harm and opt night op prep", "HI" : "Surplus el boiler cap after min harm op and opt night op prep during harm op period", "HJ" : "Surplus el boiler cap after max harm op and opt night op prep during harm op period", "HK" : "Surplus el boiler cap after min harm op and opt night op prep outside of harm op period", "HL" : "Surplus el boiler cap after max harm op and opt night op prep outside of harm op period", "HM" : "Surplus RawMeth prod cap after min day harm and opt night op prep", "HN" : "Surplus RawMeth prod cap after max day harm and opt night op prep", "HO" : "Surplus CO2 prod cap after min day harm and opt night op prep", "HP" : "Surplus CO2 prod cap after max day harm and opt night op prep", "HQ" : "Surplus H2 prod cap after min day harm and opt night op prep", "HR" : "Surplus H2 prod cap after min day harm and opt night op prep", "HS" : "Opt harm op period op during night prio operation", "HT" : "", "HU" : "el cons for harm op during harm op period", "HV" : "el cons for night prep during harm op period", "HW" : "el cons for BESS charging during harm op period", "HX" : "el cons of el boiler for harm op during harm op period", "HY" : "el cons of el boiler for night prep during harm op period", "HZ" : "PV available after harm op during harm op period", "IA" : "grid input for harm op during harm op period", "IB" : "grid input for night prep during harm op period", "IC" : "Balance of electricity during harm op period", "ID" : "Heat cons for harm op during harm op period", "IE" : "Heat cons for night prep during harm op period", "IF" : "CSP heat available after harm op during harm op period", "IG" : "El boiler heat prod for harm op during harm op period", "IH" : "El boiler heat prod for night prep during harm op period", "II" : "Balance of heat during harm op period", "IJ" : "el cons for harm op outside of harm op period", "IK" : "el cons by el boiler outside of harm op period", "IL" : "el cons for aux cons outside of harm op period", "IM" : "el from PV outside of harm op period", "IN" : "el from BESS outside of harm op period", "IO" : "grid input outside of harm op period", "IP" : "Balance of electricity outside of harm op period", "IQ" : "heat cons for harm op outside of harm op period", "IR" : "heat from CSP outside of harm op period", "IS" : "heat from el boiler outside of harm op period", "IT" : "Balance of heat outside of harm op period", "IU" : "Pure Methanol prod with min night prep and resp day op", "IV" : "grid export", "IW" : "grid import", "IX" : "Checksum", "IY" : "", "IZ" : "el cons for harm op during harm op period", "JA" : "el cons for night prep during harm op period", "JB" : "el cons for BESS charging during harm op period", "JC" : "el cons of el boiler for harm op during harm op period", "JD" : "el cons of el boiler for night prep during harm op period", "JE" : "PV available after harm op during harm op period", "JF" : "grid input for harm op during harm op period", "JG" : "grid input for night prep during harm op period", "JH" : "Balance of electricity during harm op period", "JI" : "Heat cons for harm op during harm op period", "JJ" : "Heat cons for night prep during harm op period", "JK" : "CSP heat available after harm op during harm op period", "JL" : "El boiler heat prod for harm op during harm op period", "JM" : "El boiler heat prod for night prep during harm op period", "JN" : "Balance of heat during harm op period", "JO" : "el cons for harm op outside of harm op period", "JP" : "el cons by el boiler outside of harm op period", "JQ" : "el cons for aux cons outside of harm op period", "JR" : "el from PV outside of harm op period", "JS" : "el from BESS outside of harm op period", "JT" : "grid input outside of harm op period", "JU" : "Balance of electricity outside of harm op period", "JV" : "heat cons for harm op outside of harm op period", "JW" : "heat from CSP outside of harm op period", "JX" : "heat from el boiler outside of harm op period", "JY" : "Balance of heat outside of harm op period", "JZ" : "Pure Methanol prod with min night prep and resp day op", "KA" : "grid export", "KB" : "grid import", "KC" : "Checksum"
]
var keys = [String:String]()
import Utilities
var minima = 0
/*
func cleanUp(_ formulas: [String: String], _ titles: [String: String], _ count: Int = 8760, skip: [String], name: String)
  -> [String]
{
  var out = [String]()
  var out2 = [String]()
  var i = 0
  var r = 0
  
  out.append("do {\n")

  for k in columns {
    if skip.contains(k) {
      i = 0; r += 1; 
      out.append("}\ndo {\nvar \(name)\(r) = [Double]()\n")
      continue 
    }
    guard var formula = formulas[k], let title = titles[k] else {
      // out.append("var r\(r) = [Double](repeating: 0, count: \(i*count))\n\(name)(r\(r): &r\(r))\n") 
     
      continue 
    }
    keys["\(name)_[\(k)"] = "\(name)\(r)[\(name)\(k)"

    formula = formula.dropFirst().replacingOccurrences(of: "$", with: "")
    .replacingOccurrences(of: "&", with: "").replacingOccurrences(of: ";", with: ",")
    let og = formula
    
    var newFormula = ""
    for char in formula {
      switch char {
        case "*": newFormula.append(" * ")
        case "+": newFormula.append(" + ")
        case "/": newFormula.append(" / ")
        case "^": newFormula.append(" ** ")
        default: newFormula.append(char)
      }
    }
    formula = newFormula
    let matches1 = #"SUMIFS\(Calculation([A-Z]*)[^,]*,Calculation([A-Z]*)[^,]*,.....,Calculation([A-Z]*)[^\)]*\)"#.r!.findAll(in: formula)
    let matches2 = #"COUNTIFS\(Calculation([A-Z]*)\S{1,10}"="([A-Z]*)\S{1,15}Calculation([A-Z]*)\S{5,14}">0"\)"#.r!.findAll(in: formula)
    let matches3 = #"COUNTIFS\(Calculation([A-Z]*)\S{1,10}"="([A-Z]*)\S{1,15}Calculation([A-Z]*)\S{5,14}"<=0"\)"#.r!.findAll(in: formula)
    formula = #"SUMIF\(Calculation([A-Z]*)........,"="A6,Calculation([A-Z]*)........\)"#.r!.replaceAll(in: formula, with: "$2sum[i]")
    formula = #"SUMIF\(([A-Z]*)[^,]*,([A-Z]*)[^,]*,([A-Z]*)[^)]*\)"#.r!.replaceAll(in: formula, with: "$2sum[i]")
    formula = #"SUMIFS\(Calculation([A-Z]*)[^,]*,Calculation([A-Z]*)[^,]*,....,Calculation([A-Z]*)[^,]*,.....,Calculation([A-Z]*)[^\)]*\)"#.r!.replaceAll(in: formula, with: "$2_$3_$1sum[i]")
    formula = #"SUMIFS\(Calculation([A-Z]*)[^,]*,Calculation([A-Z]*)[^,]*,.....,Calculation([A-Z]*)[^\)]*\)"#.r!.replaceAll(in: formula, with: "$2_$3_$1sum[i]")
    formula = #"COUNTIFS\(Calculation([A-Z]*)\S{1,10}"="([A-Z]*)\S{1,15}Calculation([A-Z]*)\S{5,14}"<=0"\)"#.r!.replaceAll(in: formula, with: "$3_$1countZero[i]")
    formula = #"COUNTIFS\(Calculation([A-Z]*)\S{1,10}"="([A-Z]*)\S{1,15}Calculation([A-Z]*)\S{5,14}">0"\)"#.r!.replaceAll(in: formula, with: "$3_$1countNonZero[i]")
    formula = #"COUNTIFS\(([A-Z]*)\d...............([A-Z]*)\S{1,15}">0"\)"#.r!.replaceAll(in: formula, with: "$2_$1countNonZero[i]")
    
    for match in matches1 {
      if let x = match.group(at: 1), let y = match.group(at: 2), let z = match.group(at: 3) {
        if let a = keys["hourly_[\(x)"] {
          let n = String(a.prefix(while: { $0 != "[" }))
          print(
            "let \(y)_\(z)_\(x)sum\(match.matched.contains(">0") ? "" : "Zero") = "
              + n
              + ".sumOf(hourly\(x), days: days\(y), condition: hourly\(z), "
              + (match.matched.contains(">0")
                ? "predicate: {$0>0})"
                : (match.matched.contains("=0") ? "predicate: {$0.isZero})" : "")))
        }
      }
    }
    for match in matches2 {
      if let x = match.group(at: 1), let y = match.group(at: 2), let z = match.group(at: 3) {
        if let a = keys["hourly_[\(x)"] {
          print(
            "let \(y)_\(z)_\(x)count = " + String(a.prefix(while: { $0 != "[" }))
              + ".countOf(\(x), days: days\(y), condition: \(z), "
              + (match.matched.contains(">0")
                ? "predicate: {$0>0})" : (match.matched.contains("=0") ? "predicate: {$0>0})" : "")))
        }
      }
    }
    for match in matches3 {
      if let x = match.group(at: 1), let y = match.group(at: 2), let z = match.group(at: 3) {
        if let a = keys["hourly_[\(x)"] {
          print(
            "let \(y)_\(z)_\(x)countZero = " + String(a.prefix(while: { $0 != "[" }))
              + ".countOf(\(x), days: days\(y), condition: \(z), "
              + (match.matched.contains(">0")
                ? "predicate: {$0>0})" : (match.matched.contains("=0") ? "predicate: {$0<=0})" : "")))
        }
      }
    }

    // #"SUM\(([A-Z]*)([0-9]):([A-Z]*)([0-9])\)"#
    // if formula.contains("COUNT") { print(k, formula) }
    formula = formula.replacingOccurrences(of: "MAX(", with: "max(")
      .replacingOccurrences(of: "MIN(", with: " min(")
      .replacingOccurrences(of: "IFERROR(", with: " ifFinite(\n ")
      .replacingOccurrences(of: "IF(", with: "iff(\n ")
      .replacingOccurrences(of: "AND(", with: " and(\n ")
      .replacingOccurrences(of: "OR(", with: " or(\n ")
      .replacingOccurrences(of: "COUNT", with: " count")
      .replacingOccurrences(of: "ROUND", with: " round")

    formula = formula.replacingOccurrences(of: "_n2g_", with: "_n_g_")
    formula = formula.replacingOccurrences(of: "CO2_", with: "C_O_2_")
    formula = formula.replacingOccurrences(of: "_H2O_", with: "_H_2_O_")
    formula = formula.replacingOccurrences(of: "_H2_", with: "_H_2_")
    formula = formula.replacingOccurrences(of: "LEC_Calc", with: "Lec_calc").replacingOccurrences(of: "<>", with: " != ")
    formula = formula.replacingOccurrences(of: " = ", with: " == ")
    formula = formula.replacingOccurrences(of: "#", with: "_").replacingOccurrences(of: "$", with: "")
    formula = formula.replacingOccurrences(of: "!", with: "_")
    formula = formula.replacingOccurrences(of: " =", with: " == ")    
    formula = formula.replacingOccurrences(of: "\"0\"", with: "{$0.isZero}")
    formula = formula.replacingOccurrences(of: "\"=0\"", with: "{$0.isZero}")
    formula = formula.replacingOccurrences(of: "\">0\"", with: "{!$0.isZero}")
    if k == "AOF" {
      var index = 0
      Prio.allCases.map(\.rawValue).forEach {
        formula = formula.replacingOccurrences(of: "1" + $0, with: "\(index)")
        index += 1
      }
    }
    if k == "AAQ" {
      var index = 0
      Prio.allCases.map(\.rawValue).forEach {
        formula = formula.replacingOccurrences(of: "2" + $0, with: "\(index)")
        index += 1
      }
    }
    if og.contains("SUM(PO6:PO8)") {
    //  print(k, og)
    } 
    formula = #"([A-Z]+)[0-9]*:[A-Z]+[0-9]*"#.r!.replaceAll(in: formula, with: "\(name)_[($1+i)...].prefix()")
    formula = #"_C[0-9]"#.r!.replaceAll(in: formula, with: "")
    formula = #"([A-Z]{1,3})(5)"#.r!.replaceAll(in: formula, with: "\(name)_[$1 + i - 1]")
    formula = #"([A-Z]{1,3})([0-9])"#.r!.replaceAll(in: formula, with: "\(name)_[$1 + i]")
    formula = #"\$([A-Z]{1,3})\$([0-9])"#.r!.replaceAll(in: formula, with: "_$1_$2")
    formula = #"(A_)(\w*_\w*)"#.r!.replaceAll(in: formula, with: "$2[j]")
    formula = formula.replacingOccurrences(of: "-", with: " - ")
    formula = formula.replacingOccurrences(of: "] _=", with: "] ==")
    for key in keys {
      formula = formula.replacingOccurrences(of: key.key, with: key.value)
    }
    

    // let \(k)chunks = Array((0..<8760).chunked(by:) { r\(r)[$0 + \(k)] == 0.0 && r\(r)[$0 + \(k)] > 0.0) })
          // for chunk in \(k)chunks {
      //   r\(r)[chunk].reduce(0, +)        
      // }
    let Case = formula.contains("[j]")
    // out.append("let \(k) = \(i*count)\n")
    out2.append("let \(name)\(k) = \(i*count)")
    out.append(
      """
      /// \(title)
      let \(name)\(k) = \(i*count)
      // \(og)
      for i in 0..<\(count) {       
        \(name)\(r)[\(name)\(k) + i] = \(formula)        
      }
      """)
    i += 1
  }
  print(out2.joined(separator: "\n"))
  return out
}

enum Prio: String, CaseIterable {
  case aDay = "a day prio"
  case aNight = "a night prio"
  case bDay = "b day prio"
  case bNight = "b night prio"
  case cDay = "c day prio"
  case cNight = "c night prio"
  case dDay = "d day prio"
  case dNight = "d night prio"
}

*/