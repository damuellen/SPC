import Foundation
import Regex

let formulasCalculation: [String: String] = [
"D" : "=IF(C6=0,D5+1,D5)",    "H" : "=MAX(0,G6/MAX($G$5:$G$8763))", "I" : "=IFERROR(IF(G6<MAX($G$5:$G$8763),MAX(G6,0)/F6,0),0)", "J" : "=E6*CSP_loop_nr_ud", "K" : "=F6*PV_DC_cap_ud/PV_Ref_DC_cap", "L" : "=MIN(PV_AC_cap_ud,IF(K6/PV_DC_cap_ud>Inv_eff_Ref_approx_handover,K6*POLY(K6/PV_DC_cap_ud,HL_Coeff),IF(K6/PV_DC_cap_ud>0,K6*POLY(K6/PV_DC_cap_ud,LL_Coeff),0)))", "M" : "=MAX(0,-G6/PV_Ref_AC_cap*PV_AC_cap_ud)",  "O" : "=IF($J6>0,$J6*CSP_var_aux_nom_perc,CSP_nonsolar_aux_cons)+M6+PB_stby_aux_cons", "P" : "=MAX(0,$L6-O6)", "Q" : "=MAX(0,O6-P6)", "R" : "=IF(MIN(Overall_harmonious_var_max_cons+Overall_fix_cons,$P6+Grid_import_max_ud*Grid_import_yes_no_BESS_strategy,MIN($J6+El_boiler_cap_ud*El_boiler_eff,($P6+Grid_import_max_ud*Grid_import_yes_no_BESS_strategy)/(Overall_harmonious_var_max_cons+Overall_fix_cons+MAX(0,(Overall_harmonious_var_heat_max_cons+Overall_heat_fix_cons-$J6))/El_boiler_eff)*(Overall_harmonious_var_heat_max_cons+Overall_heat_fix_cons))/(Overall_harmonious_var_heat_max_cons+Overall_heat_fix_cons)*(Overall_harmonious_var_max_cons+Overall_fix_cons))<Overall_harmonious_var_min_cons+Overall_fix_cons,0,Overall_harmonious_var_min_cons+Overall_fix_cons)", "S" : "=IF(AND(R6>0,R5=0,OR(R6=0,R7=0)),0,R6)", "T" : "=S6/(Overall_harmonious_var_max_cons+Overall_fix_cons)*(Overall_harmonious_var_heat_max_cons+Overall_heat_fix_cons)", "U" : "=IF(AND(S5<=0,S6>0),U5+1,U5)", "V" : "=MAX(0,$P6-$Q6-$S6-MAX(0,($T6-$J6)/El_boiler_eff))", "W" : "=MAX(0,$J6-T6)", "X" : "=MAX(0,-($P6-$Q6-$S6-MAX(0,(T6-$J6)/El_boiler_eff)))", "Y" : "=Grid_import_max_ud-X6", "Z" : "=MAX(0,(T6-$J6)/El_boiler_eff)", "AA" : "=MAX(0,El_boiler_cap_ud-Z6)", "AB" : "=MAX(0,1-S6/(Overall_harmonious_var_max_cons+Overall_fix_cons)*MethSynt_harmonious_max_perc)*MethSynt_RawMeth_nom_prod_ud", "AC" : "=MAX(0,1-S6/(Overall_harmonious_var_max_cons+Overall_fix_cons)*CCU_harmonious_max_perc)*CCU_CO2_nom_prod_ud", "AD" : "=MAX(0,1-S6/(Overall_harmonious_var_max_cons+Overall_fix_cons)*EY_harmonious_max_perc)*EY_Hydrogen_nom_prod", "AE" : "=MIN(BESS_chrg_max_cons,V6)", "AF" : "=MIN(Grid_export_max_ud,V6)", "AG" : "=IF(MIN(Overall_harmonious_var_max_cons+Overall_fix_cons,$P6+Grid_import_max_ud*Grid_import_yes_no_BESS_strategy,MIN($J6+El_boiler_cap_ud*El_boiler_eff,($P6+Grid_import_max_ud*Grid_import_yes_no_BESS_strategy)/(Overall_harmonious_var_max_cons+Overall_fix_cons+MAX(0,(Overall_harmonious_var_heat_max_cons+Overall_heat_fix_cons-$J6))/El_boiler_eff)*(Overall_harmonious_var_heat_max_cons+Overall_heat_fix_cons))/(Overall_harmonious_var_heat_max_cons+Overall_heat_fix_cons)*(Overall_harmonious_var_max_cons+Overall_fix_cons))<Overall_harmonious_var_min_cons+Overall_fix_cons,0,MIN(Overall_harmonious_var_max_cons+Overall_fix_cons,$P6+Grid_import_max_ud*Grid_import_yes_no_BESS_strategy,MIN($J6+El_boiler_cap_ud*El_boiler_eff,($P6+Grid_import_max_ud*Grid_import_yes_no_BESS_strategy)/(Overall_harmonious_var_max_cons+Overall_fix_cons+MAX(0,(Overall_harmonious_var_heat_max_cons+Overall_heat_fix_cons-$J6))/El_boiler_eff)*(Overall_harmonious_var_heat_max_cons+Overall_heat_fix_cons))/(Overall_harmonious_var_heat_max_cons+Overall_heat_fix_cons)*(Overall_harmonious_var_max_cons+Overall_fix_cons)))", "AH" : "=IF(AND(AG6>0,AG5=0,OR(AG6=0,AG7=0)),0,AG6)", "AI" : "=AH6/(Overall_harmonious_var_max_cons+Overall_fix_cons)*(Overall_harmonious_var_heat_max_cons+Overall_heat_fix_cons)", "AJ" : "=MAX(0,$P6-$Q6-AH6-MAX(0,(AI6-$J6)/El_boiler_eff))", "AK" : "=MAX(0,$J6-AI6)", "AL" : "=MAX(0,-($P6-$Q6-AH6-MAX(0,(AI6-$J6)/El_boiler_eff)))", "AM" : "=Grid_import_max_ud-AL6", "AN" : "=MAX(0,(AI6-$J6)/El_boiler_eff)", "AO" : "=MAX(0,El_boiler_cap_ud-AN6)", "AP" : "=MAX(0,1-AH6/(Overall_harmonious_var_max_cons+Overall_fix_cons)*MethSynt_harmonious_max_perc)*MethSynt_RawMeth_nom_prod_ud", "AQ" : "=MAX(0,1-AH6/(Overall_harmonious_var_max_cons+Overall_fix_cons)*CCU_harmonious_max_perc)*CCU_CO2_nom_prod_ud", "AR" : "=MAX(0,1-AH6/(Overall_harmonious_var_max_cons+Overall_fix_cons)*EY_harmonious_max_perc)*EY_Hydrogen_nom_prod", "AS" : "=MIN(BESS_chrg_max_cons,AJ6)", "AT" : "=MIN(Grid_export_max_ud,AJ6)",  "AV" : "=IF($J6>0,$J6*CSP_var_aux_nom_perc,CSP_nonsolar_aux_cons)+$M6", "AW" : "=MAX(0,$L6-AV6)", "AX" : "=MAX(0,AV6-AW6)", "AY" : "=MAX(0,MIN(AW6*(1-Heater_eff*(1+1/Ratio_CSP_vs_Heater)*TES_aux_cons_perc),Heater_cap_ud,$J6*Ratio_CSP_vs_Heater/Heater_eff))", "AZ" : "=MIN(TES_thermal_cap,SUMIF($D$5:$D$8763,\"=\"&$D6,AY$5:AY$8763)*Heater_eff*(1+1/Ratio_CSP_vs_Heater))", "BA" : "=MAX(0,SUMIF($D$5:$D$8763,\"=\"&$D6,AY$5:AY$8763)*Heater_eff*(1+1/Ratio_CSP_vs_Heater)-TES_thermal_cap)", "BB" : "=IF(OR(AND(BA6>0,AY6>0,AY5=0),AND(BA6>0,AY7=0,AY6>0)),AY6,0)", "BC" : "=MAX(0,BA6-SUMIF($D$5:$D$8763,\"=\"&$D6,BB$5:BB$8763)*Heater_eff*(1+1/Ratio_CSP_vs_Heater))", "BD" : "=IF(AZ6=0,0,$AY6-IF(BA6=0,0,(BA6-BC6)/(SUMIF($D$5:$D$8763,\"=\"&$D6,BB$5:BB$8763)*Heater_eff*(1+1/Ratio_CSP_vs_Heater))*BB6))", "BE" : "=IF(OR($BD6=0,BC6=0),0,MAX(($AW6-$BD6)/(BC6/(1+1/Ratio_CSP_vs_Heater)/Heater_eff/COUNTIFS($D$5:$D$8763,\"=\"&$D6,$BD$4:$BD$8762,\">0\")),($J6-$BD6*Heater_eff/Ratio_CSP_vs_Heater)/(BC6/(1+Ratio_CSP_vs_Heater)/COUNTIFS($D$5:$D$8763,\"=\"&$D6,$BD$5:$BD$8763,\">0\")))/SUMIF($D$5:$D$8763,\"=\"&$D6,$BD$5:$BD$8763)*$BD6)", "BF" : "=IF(AZ6=0,0,BD6-IF(BC6=0,0,BC6/(1+1/Ratio_CSP_vs_Heater)/Heater_eff/SUMIF($D$5:$D$8763,\"=\"&$D6,BE$5:BE$8763)*BE6))", "BG" : "=MIN($J6,BF6*Heater_eff/Ratio_CSP_vs_Heater)", "BH" : "=AX6+(BF6*Heater_eff+BG6)*TES_aux_cons_perc", "BI" : "=MAX(0,AW6-BF6-BH6)", "BJ" : "=$J6-BG6", "BK" : "=MAX(0,-(AW6-BF6-BH6))", "BL" : "=IF(MIN(Overall_harmonious_var_max_cons+Overall_fix_cons,BI6+Grid_import_max_ud*Grid_import_yes_no_PB_strategy-PB_stby_aux_cons,MIN(BJ6+El_boiler_cap_ud*El_boiler_eff,(BI6+Grid_import_max_ud*Grid_import_yes_no_PB_strategy-PB_stby_aux_cons)/(Overall_harmonious_var_max_cons+Overall_fix_cons+PB_stby_aux_cons+MAX(0,(Overall_harmonious_var_heat_max_cons+Overall_heat_fix_cons-BJ6))/El_boiler_eff)*(Overall_harmonious_var_heat_max_cons+Overall_heat_fix_cons))/(Overall_harmonious_var_heat_max_cons+Overall_heat_fix_cons)*(Overall_harmonious_var_max_cons+Overall_fix_cons))<Overall_harmonious_var_min_cons+Overall_fix_cons,0,Overall_harmonious_var_min_cons+Overall_fix_cons)", "BM" : "=IF(AND(BL6>0,BL5=0,OR(BL6=0,BL7=0)),0,BL6)", "BN" : "=BM6/(Overall_harmonious_var_max_cons+Overall_fix_cons)*(Overall_harmonious_var_heat_max_cons+Overall_heat_fix_cons)", "BO" : "=IF(AND(BM5<=0,BM6>0),BO5+1,IF(AND(BI5<=0,BI6>0,COUNTIF(BM6:BM15,\"=0\")=10,COUNTIF(BI6:BI15,\">0\")>5),BO5+1,BO5))", "BP" : "=MAX(0,BI6-BK6-BM6-MAX(0,(BN6-BJ6)/El_boiler_eff))", "BQ" : "=MAX(0,BJ6-BN6)", "BR" : "=MAX(0,-(BI6-BK6-BM6-MAX(0,(BN6-BJ6)/El_boiler_eff)))", "BS" : "=Grid_import_max_ud-BR6",  "BU" : "=IF($BM6>0,0,IF(A_overall_var_min_cons+A_overall_fix_stby_cons+$BK6+IF($BM7=0,0,A_overall_stup_cons)+MAX(0,A_overall_var_heat_min_cons+A_overall_heat_fix_stby_cons+IF($BM7=0,0,A_overall_heat_stup_cons)-$BQ6)/El_boiler_eff<$BP6-PB_stby_aux_cons,0,A_overall_var_min_cons+A_overall_fix_stby_cons+IF($BM7=0,0,A_overall_stup_cons)))", "BV" : "=IF(AND(BU7>0,BU6=0,BU5>0),BU5,BU6)", "BW" : "=IF(BV6=0,0,$BK6+((MIN(PB_nom_net_cap,MAX(PB_net_min_cap,(1+TES_aux_cons_perc)*(BV6+$BK6-$BP6)))+PB_nom_net_cap*PB_nom_var_aux_cons_perc_net*POLY(MIN(PB_nom_net_cap,MAX(PB_net_min_cap,(1+TES_aux_cons_perc)*(BV6+$BK6-$BP6)))/PB_nom_net_cap,PB_n2g_var_aux_el_Coeff)+PB_fix_aux_el)/(PB_gross_min_eff+(PB_nom_gross_eff-PB_gross_min_eff)/(PB_nom_net_cap-PB_net_min_cap)*(MIN(PB_nom_net_cap,MAX(0,BV6+$BK6-$BP6))-PB_net_min_cap))+MAX(0,A_overall_var_heat_min_cons+A_overall_heat_fix_stby_cons-$BQ6)*PB_Ratio_Heat_input_vs_output)*TES_aux_cons_perc+IF(AND(BV6=0,BV7>0),MAX(0,IF(COUNTIF(BV$1:BV6,\"0\")=PB_warm_start_duration,PB_warm_start_heat_req,PB_hot_start_heat_req)-$BQ6)*TES_aux_cons_perc,0))", "BX" : "=IF(BV6=0,0,MAX(PB_net_min_cap,MIN(PB_nom_net_cap,BV6+BW6-$BP6)))", "BY" : "=IF(BX6=0,0,BX6+PB_nom_net_cap*PB_nom_var_aux_cons_perc_net*POLY(BX6/PB_nom_net_cap,PB_n2g_var_aux_el_Coeff)+PB_fix_aux_el)", "BZ" : "=IF(AND(BY6=0,BY7>0),IF(COUNTIF(BY1:BY6,\"0\")=PB_warm_start_duration,PB_warm_start_heat_req,PB_hot_start_heat_req),0)", "CA" : "=IF(BY6=0,0,BY6/PB_nom_gross_eff/POLY(BY6/PB_nom_gross_cap_ud,el_Coeff))", "CB" : "=IF(CA6=0,0,MAX(0,PB_Ratio_Heat_input_vs_output*(MIN(A_overall_var_heat_min_cons+A_overall_heat_fix_stby_cons+IF($BM7=0,0,A_overall_heat_stup_cons),(BX6-BW6+$BP6)/(A_overall_var_min_cons+A_overall_fix_stby_cons+IF($BM7=0,0,A_overall_stup_cons))*(A_overall_var_heat_min_cons+A_overall_heat_fix_stby_cons+IF($BM7=0,0,A_overall_heat_stup_cons)))-$BQ6-MAX(0,BX6-BV6-BW6)*El_boiler_eff)))", "CC" : "=IF(MIN(SUMIF($BO$5:$BO$8763,\"=\"&$BO6,$AY$5:$AY$8763)*Heater_eff*(1+1/Ratio_CSP_vs_Heater),TES_thermal_cap)<SUMIF($BO$5:$BO$8763,\"=\"&$BO6,BZ$5:BZ$8763)+SUMIF($BO$5:$BO$8763,\"=\"&$BO6,CA$5:CA$8763)+SUMIF($BO$5:$BO$8763,\"=\"&$BO6,CB$5:CB$8763),0,SUMIF($BO$5:$BO$8763,\"=\"&$BO6,BZ$5:BZ$8763)+SUMIF($BO$5:$BO$8763,\"=\"&$BO6,CA$5:CA$8763)+SUMIF($BO$5:$BO$8763,\"=\"&$BO6,CB$5:CB$8763))", "CD" : "=IF(CC6=0,0,MAX(0,SUMIF($BO$5:$BO$8763,\"=\"&$BO6,$AY$5:$AY$8763)*Heater_eff*(1+1/Ratio_CSP_vs_Heater)-CC6))", "CE" : "=IF(OR(AND(CD6>0,$AY6>0,$AY5=0),AND(CD6>0,$AY7=0,$AY6>0)),$AY6,0)", "CF" : "=MAX(0,CD6-SUMIF($BO$5:$BO$8763,\"=\"&$BO6,CE$5:CE$8763)*Heater_eff*(1+1/Ratio_CSP_vs_Heater))", "CG" : "=IF(CD6=0,0,$AY6-(CD6-CF6)/(SUMIF($BO$5:$BO$8763,\"=\"&$BO6,CE$5:CE$8763)*Heater_eff*(1+1/Ratio_CSP_vs_Heater))*CE6)", "CH" : "=IF(OR(CG6=0,CF6=0),0,MAX(($AW6-CG6)/(CF6/(1+1/Ratio_CSP_vs_Heater)/Heater_eff/COUNTIFS($BO$5:$BO$8763,\"=\"&$BO6,CG$5:CG$8763,\">0\")),($J6-CG6*Heater_eff/Ratio_CSP_vs_Heater)/(CF6/(1+Ratio_CSP_vs_Heater)/COUNTIFS($BO$5:$BO$8763,\"=\"&$BO6,CG$5:CG$8763,\">0\")))/SUMIF($BO$5:$BO$8763,\"=\"&$BO6,CG$5:CG$8763)*CG6)", "CI" : "=IF(CC6=0,0,CG6-IF(CF6=0,0,CF6/(1+1/Ratio_CSP_vs_Heater)/Heater_eff/SUMIF($BO$5:$BO$8763,\"=\"&$BO6,CH$5:CH$8763)*CH6))", "CJ" : "=MIN($J6,CI6*Heater_eff/Ratio_CSP_vs_Heater)", "CK" : "=MAX(0,$L6-CI6)", "CL" : "=MAX(0,$J6-CJ6)", "CM" : "=IF($J6>0,$J6*CSP_var_aux_nom_perc,CSP_nonsolar_aux_cons)+$M6+(CI6*Heater_eff+CJ6)*TES_aux_cons_perc+IF(OR(BY6=0,AND(BY6>0,CC6=0)),PB_stby_aux_cons+BZ6*TES_aux_cons_perc,(BZ6+CA6+CB6)*TES_aux_cons_perc)", "CN" : "=MAX(0,-($L6+IF(CC6>0,BX6,0)-CI6-CM6))",  "CP" : "=IF(MIN(Overall_harmonious_var_max_cons+Overall_fix_cons,CK6+Grid_import_max_ud*Grid_import_yes_no_PB_strategy-(CM6-CN6),MIN(CL6+El_boiler_cap_ud*El_boiler_eff,(CK6+Grid_import_max_ud*Grid_import_yes_no_PB_strategy-(CM6-CN6))/(Overall_harmonious_var_max_cons+Overall_fix_cons+(CM6-CN6)+MAX(0,(Overall_harmonious_var_heat_max_cons+Overall_heat_fix_cons-CL6))/El_boiler_eff)*(Overall_harmonious_var_heat_max_cons+Overall_heat_fix_cons))/(Overall_harmonious_var_heat_max_cons+Overall_heat_fix_cons)*(Overall_harmonious_var_max_cons+Overall_fix_cons))<Overall_harmonious_var_min_cons+Overall_fix_cons,0,Overall_harmonious_var_min_cons+Overall_fix_cons)", "CQ" : "=IF(AND(CP6>0,CP5=0,OR(CP6=0,CP7=0)),0,CP6)", "CR" : "=CQ6/(Overall_harmonious_var_max_cons+Overall_fix_cons)*(Overall_harmonious_var_heat_max_cons+Overall_heat_fix_cons)", "CS" : "=IF(AND(CQ5<=0,CQ6>0),CS5+1,IF(AND(CK6>0,$BO6<>$BO5,SUM(CQ6:CQ8)=0),CS5+1,CS5))", "CT" : "=IF(OR(CQ6>0,CC6=0),0,MIN((BX6+CK6+(CL6+CB6/PB_Ratio_Heat_input_vs_output)/El_boiler_eff-(CM6-CN6))/(A_overall_var_min_cons+A_overall_fix_stby_cons+IF(CQ7=0,0,A_overall_stup_cons)+(A_overall_var_heat_min_cons+A_overall_heat_fix_stby_cons+IF(CR7=0,0,A_overall_heat_stup_cons))/El_boiler_eff)*(A_overall_var_min_cons+A_overall_fix_stby_cons+IF(CQ7=0,0,A_overall_stup_cons)),A_overall_var_min_cons+A_overall_fix_stby_cons+IF(CQ7=0,0,A_overall_stup_cons)))", "CU" : "=IF(CT6=0,0,MIN((BX6+CK6+(CL6+CB6/PB_Ratio_Heat_input_vs_output)/El_boiler_eff-(CM6-CN6))/(A_overall_var_min_cons+A_overall_fix_stby_cons+IF(CQ7=0,0,A_overall_stup_cons)+(A_overall_var_heat_min_cons+A_overall_heat_fix_stby_cons+IF(CR7=0,0,A_overall_heat_stup_cons))/El_boiler_eff)*(A_overall_var_heat_min_cons+A_overall_heat_fix_stby_cons+IF(CR7=0,0,A_overall_heat_stup_cons)),A_overall_var_heat_min_cons+A_overall_heat_fix_stby_cons+IF(CR7=0,0,A_overall_heat_stup_cons)))", "CV" : "=MAX(0,IF(CC6>0,BX6,0)+CK6-(CM6-CN6)-CQ6-CT6-MAX(0,(CR6+CU6-IF(CC6>0,CB6/PB_Ratio_Heat_input_vs_output,0)-CL6)/El_boiler_eff))", "CW" : "=MAX(0,CL6+IF(CC6=0,0,CB6/PB_Ratio_Heat_input_vs_output)-CR6-CU6)", "CX" : "=MAX(0,-(IF(CC6>0,BX6,0)+CK6-(CM6-CN6)-CQ6-CT6-MAX(0,(CR6+CU6-IF(CC6>0,CB6/PB_Ratio_Heat_input_vs_output,0)-CL6)/El_boiler_eff)))", "CY" : "=Grid_import_max_ud-CX6", "CZ" : "=MIN(El_boiler_cap_ud,MAX(0,(CR6+CU6-CL6-IF(CC6>0,CB6/PB_Ratio_Heat_input_vs_output,0))/El_boiler_eff))", "DA" : "=MAX(0,El_boiler_cap_ud-CZ6)", "DB" : "=MAX(0,1-CQ6/(Overall_harmonious_var_max_cons+Overall_fix_cons)*MethSynt_harmonious_max_perc)*MethSynt_RawMeth_nom_prod_ud", "DC" : "=MAX(0,1-CQ6/(Overall_harmonious_var_max_cons+Overall_fix_cons)*CCU_harmonious_max_perc)*CCU_CO2_nom_prod_ud", "DD" : "=MAX(0,1-CQ6/(Overall_harmonious_var_max_cons+Overall_fix_cons)*EY_harmonious_max_perc)*EY_Hydrogen_nom_prod", "DE" : "=MIN(BESS_chrg_max_cons,CV6)", "DF" : "=MIN(Grid_export_max_ud,CV6)", "DG" : "=IF(MIN(Overall_harmonious_var_max_cons+Overall_fix_cons,CK6+Grid_import_max_ud*Grid_import_yes_no_PB_strategy-(CM6-CN6),MIN(CL6+El_boiler_cap_ud*El_boiler_eff,(CK6+Grid_import_max_ud*Grid_import_yes_no_PB_strategy-(CM6-CN6))/(Overall_harmonious_var_max_cons+Overall_fix_cons+(CM6-CN6)+MAX(0,(Overall_harmonious_var_heat_max_cons+Overall_heat_fix_cons-CL6))/El_boiler_eff)*(Overall_harmonious_var_heat_max_cons+Overall_heat_fix_cons))/(Overall_harmonious_var_heat_max_cons+Overall_heat_fix_cons)*(Overall_harmonious_var_max_cons+Overall_fix_cons))<Overall_harmonious_var_min_cons+Overall_fix_cons,0,MIN(Overall_harmonious_var_max_cons+Overall_fix_cons,CK6+Grid_import_max_ud*Grid_import_yes_no_PB_strategy-(CM6-CN6),MIN(CL6+El_boiler_cap_ud*El_boiler_eff,(CK6+Grid_import_max_ud*Grid_import_yes_no_PB_strategy-(CM6-CN6))/(Overall_harmonious_var_max_cons+Overall_fix_cons+(CM6-CN6)+MAX(0,(Overall_harmonious_var_heat_max_cons+Overall_heat_fix_cons-CL6))/El_boiler_eff)*(Overall_harmonious_var_heat_max_cons+Overall_heat_fix_cons))/(Overall_harmonious_var_heat_max_cons+Overall_heat_fix_cons)*(Overall_harmonious_var_max_cons+Overall_fix_cons)))", "DH" : "=IF(AND(DG6>0,DG5=0,OR(DG6=0,DG7=0)),0,DG6)", "DI" : "=DH6/(Overall_harmonious_var_max_cons+Overall_fix_cons)*(Overall_harmonious_var_heat_max_cons+Overall_heat_fix_cons)", "DJ" : "=MAX(0,IF(CC6>0,BX6,0)+CK6-(CM6-CN6)-DH6-CT6-MAX(0,(DI6+CU6-IF(CC6>0,CB6/PB_Ratio_Heat_input_vs_output,0)-CL6)/El_boiler_eff))", "DK" : "=MAX(0,CL6+IF(CC6=0,0,CB6/PB_Ratio_Heat_input_vs_output)-DI6-CU6)", "DL" : "=MAX(0,-(IF(CC6>0,BX6,0)+CK6-(CM6-CN6)-DH6-CT6-MAX(0,(DI6+CU6-IF(CC6>0,CB6/PB_Ratio_Heat_input_vs_output,0)-CL6)/El_boiler_eff)))", "DM" : "=Grid_import_max_ud-DL6", "DN" : "=MIN(El_boiler_cap_ud,MAX(0,(DI6+CU6-CL6-IF(CC6>0,CB6/PB_Ratio_Heat_input_vs_output,0))/El_boiler_eff))", "DO" : "=MAX(0,El_boiler_cap_ud-DN6)", "DP" : "=MAX(0,1-DH6/(Overall_harmonious_var_max_cons+Overall_fix_cons)*MethSynt_harmonious_max_perc)*MethSynt_RawMeth_nom_prod_ud", "DQ" : "=MAX(0,1-DH6/(Overall_harmonious_var_max_cons+Overall_fix_cons)*CCU_harmonious_max_perc)*CCU_CO2_nom_prod_ud", "DR" : "=MAX(0,1-DH6/(Overall_harmonious_var_max_cons+Overall_fix_cons)*EY_harmonious_max_perc)*EY_Hydrogen_nom_prod", "DS" : "=MIN(BESS_chrg_max_cons,DJ6)", "DT" : "=MIN(Grid_export_max_ud,DJ6)",  "DV" : "=VLOOKUP($BO6,DailyCalc_1$A$3:$U$367,COLUMN(DailyCalc_1U$3))", "DW" : "=IF($BM6>0,0,IF(A_overall_var_max_cons*DV6+A_overall_fix_stby_cons+$BK6+IF($BM7=0,0,A_overall_stup_cons)+MAX(0,A_overall_var_heat_max_cons*DV6+A_overall_heat_fix_stby_cons+IF($BM7=0,0,A_overall_heat_stup_cons)-$BQ6)/El_boiler_eff<$BP6-PB_stby_aux_cons,0,A_overall_var_max_cons*DV6+A_overall_fix_stby_cons+IF($BM7=0,0,A_overall_stup_cons)))", "DX" : "=IF(AND(DW7>0,DW6=0,DW5>0),DW5,DW6)", "DY" : "=IF(DX6=0,0,$BK6+((MIN(PB_nom_net_cap,MAX(PB_net_min_cap,(1+TES_aux_cons_perc)*(DX6+$BK6-$BP6)))+PB_nom_net_cap*PB_nom_var_aux_cons_perc_net*POLY(MIN(PB_nom_net_cap,MAX(PB_net_min_cap,(1+TES_aux_cons_perc)*(DX6+$BK6-$BP6)))/PB_nom_net_cap,PB_n2g_var_aux_el_Coeff)+PB_fix_aux_el)/(PB_gross_min_eff+(PB_nom_gross_eff-PB_gross_min_eff)/(PB_nom_net_cap-PB_net_min_cap)*(MIN(PB_nom_net_cap,MAX(0,DX6+$BK6-$BP6))-PB_net_min_cap))+MAX(0,A_overall_var_heat_max_cons*DV6+A_overall_heat_fix_stby_cons-$BQ6)*PB_Ratio_Heat_input_vs_output)*TES_aux_cons_perc+IF(AND(DX6=0,DX7>0),MAX(0,IF(COUNTIF(DX$1:DX6,\"0\")=PB_warm_start_duration,PB_warm_start_heat_req,PB_hot_start_heat_req)-$BQ6)*TES_aux_cons_perc,0))", "DZ" : "=IF(DX6=0,0,MAX(PB_net_min_cap,MIN(PB_nom_net_cap,DX6+DY6-$BP6)))", "EA" : "=IF(DZ6=0,0,DZ6+PB_nom_net_cap*PB_nom_var_aux_cons_perc_net*POLY(DZ6/PB_nom_net_cap,PB_n2g_var_aux_el_Coeff)+PB_fix_aux_el)", "EB" : "=IF(AND(EA6=0,EA7>0),IF(COUNTIF(EA1:EA6,\"0\")=PB_warm_start_duration,PB_warm_start_heat_req,PB_hot_start_heat_req),0)", "EC" : "=IF(EA6=0,0,EA6/PB_nom_gross_eff/POLY(EA6/PB_nom_gross_cap_ud,el_Coeff))", "ED" : "=IF(EC6=0,0,MAX(0,PB_Ratio_Heat_input_vs_output*(MIN(A_overall_var_heat_max_cons*DV6+A_overall_heat_fix_stby_cons+IF($BM7=0,0,A_overall_heat_stup_cons),(DZ6-DY6+$BP6)/(A_overall_var_max_cons*DV6+A_overall_fix_stby_cons+IF($BM7=0,0,A_overall_stup_cons))*(A_overall_var_heat_max_cons*DV6+A_overall_heat_fix_stby_cons+IF($BM7=0,0,A_overall_heat_stup_cons)))-$BQ6-MAX(0,DZ6-DX6-DY6)*El_boiler_eff)))", "EE" : "=IF(MIN(SUMIF($BO$5:$BO$8763,\"=\"&$BO6,$AY$5:$AY$8763)*Heater_eff*(1+1/Ratio_CSP_vs_Heater),TES_thermal_cap)<SUMIF($BO$5:$BO$8763,\"=\"&$BO6,EB$5:EB$8763)+SUMIF($BO$5:$BO$8763,\"=\"&$BO6,EC$5:EC$8763)+SUMIF($BO$5:$BO$8763,\"=\"&$BO6,ED$5:ED$8763),0,SUMIF($BO$5:$BO$8763,\"=\"&$BO6,EB$5:EB$8763)+SUMIF($BO$5:$BO$8763,\"=\"&$BO6,EC$5:EC$8763)+SUMIF($BO$5:$BO$8763,\"=\"&$BO6,ED$5:ED$8763))", "EF" : "=IF(EE6=0,0,MAX(0,SUMIF($BO$5:$BO$8763,\"=\"&$BO6,$AY$5:$AY$8763)*Heater_eff*(1+1/Ratio_CSP_vs_Heater)-EE6))", "EG" : "=IF(OR(AND(EF6>0,$AY6>0,$AY5=0),AND(EF6>0,$AY7=0,$AY6>0)),$AY6,0)", "EH" : "=MAX(0,EF6-SUMIF($BO$5:$BO$8763,\"=\"&$BO6,EG$5:EG$8763)*Heater_eff*(1+1/Ratio_CSP_vs_Heater))", "EI" : "=IF(EF6=0,0,$AY6-(EF6-EH6)/(SUMIF($BO$5:$BO$8763,\"=\"&$BO6,EG$5:EG$8763)*Heater_eff*(1+1/Ratio_CSP_vs_Heater))*EG6)", "EJ" : "=IF(OR(EI6=0,EH6=0),0,MAX(($AW6-EI6)/(EH6/(1+1/Ratio_CSP_vs_Heater)/Heater_eff/COUNTIFS($BO$5:$BO$8763,\"=\"&$BO6,EI$5:EI$8763,\">0\")),($J6-EI6*Heater_eff/Ratio_CSP_vs_Heater)/(EH6/(1+Ratio_CSP_vs_Heater)/COUNTIFS($BO$5:$BO$8763,\"=\"&$BO6,EI$5:EI$8763,\">0\")))/SUMIF($BO$5:$BO$8763,\"=\"&$BO6,EI$5:EI$8763)*EI6)", "EK" : "=IF(EE6=0,0,EI6-IF(EH6=0,0,EH6/(1+1/Ratio_CSP_vs_Heater)/Heater_eff/SUMIF($BO$5:$BO$8763,\"=\"&$BO6,EJ$5:EJ$8763)*EJ6))", "EL" : "=MIN($J6,EK6*Heater_eff/Ratio_CSP_vs_Heater)", "EM" : "=MAX(0,$L6-EK6)", "EN" : "=MAX(0,$J6-EL6)", "EO" : "=IF($J6>0,$J6*CSP_var_aux_nom_perc,CSP_nonsolar_aux_cons)+$M6+(EK6*Heater_eff+EL6)*TES_aux_cons_perc+IF(OR(EA6=0,AND(EA6>0,EE6=0)),PB_stby_aux_cons+EB6*TES_aux_cons_perc,(EB6+EC6+ED6)*TES_aux_cons_perc)", "EP" : "=MAX(0,-($L6+IF(EE6>0,DZ6,0)-EK6-EO6))",  "ER" : "=IF(MIN(Overall_harmonious_var_max_cons+Overall_fix_cons,EM6+Grid_import_max_ud*Grid_import_yes_no_PB_strategy-(EO6-EP6),MIN(EN6+El_boiler_cap_ud*El_boiler_eff,(EM6+Grid_import_max_ud*Grid_import_yes_no_PB_strategy-(EO6-EP6))/(Overall_harmonious_var_max_cons+Overall_fix_cons+(EO6-EP6)+MAX(0,(Overall_harmonious_var_heat_max_cons+Overall_heat_fix_cons-EN6))/El_boiler_eff)*(Overall_harmonious_var_heat_max_cons+Overall_heat_fix_cons))/(Overall_harmonious_var_heat_max_cons+Overall_heat_fix_cons)*(Overall_harmonious_var_max_cons+Overall_fix_cons))<Overall_harmonious_var_min_cons+Overall_fix_cons,0,Overall_harmonious_var_min_cons+Overall_fix_cons)", "ES" : "=IF(AND(ER6>0,ER5=0,OR(ER6=0,ER7=0)),0,ER6)", "ET" : "=ES6/(Overall_harmonious_var_max_cons+Overall_fix_cons)*(Overall_harmonious_var_heat_max_cons+Overall_heat_fix_cons)", "EU" : "=IF(AND(ES5<=0,ES6>0),EU5+1,IF(AND(EM6>0,$BO6<>$BO5,SUM(ES6:ES8)=0),EU5+1,EU5))", "EV" : "=IF(OR(ES6>0,EE6=0),0,MIN((DZ6+EM6+(EN6+ED6/PB_Ratio_Heat_input_vs_output)/El_boiler_eff-(EO6-EP6))/(A_overall_var_max_cons*DV6+A_overall_fix_stby_cons+IF(ES7=0,0,A_overall_stup_cons)+(A_overall_var_heat_max_cons*DV6+A_overall_heat_fix_stby_cons+IF(ET7=0,0,A_overall_heat_stup_cons))/El_boiler_eff)*(A_overall_var_max_cons*DV6+A_overall_fix_stby_cons+IF(ES7=0,0,A_overall_stup_cons)),A_overall_var_max_cons*DV6+A_overall_fix_stby_cons+IF(ES7=0,0,A_overall_stup_cons)))", "EW" : "=IF(EV6=0,0,MIN((DZ6+EM6+(EN6+ED6/PB_Ratio_Heat_input_vs_output)/El_boiler_eff-(EO6-EP6))/(A_overall_var_max_cons*DV6+A_overall_fix_stby_cons+IF(ES7=0,0,A_overall_stup_cons)+(A_overall_var_heat_max_cons*DV6+A_overall_heat_fix_stby_cons+IF(ET7=0,0,A_overall_heat_stup_cons))/El_boiler_eff)*(A_overall_var_heat_max_cons*DV6+A_overall_heat_fix_stby_cons+IF(ET7=0,0,A_overall_heat_stup_cons)),A_overall_var_heat_max_cons*DV6+A_overall_heat_fix_stby_cons+IF(ET7=0,0,A_overall_heat_stup_cons)))", "EX" : "=MAX(0,IF(EE6>0,DZ6,0)+EM6-(EO6-EP6)-ES6-EV6-MAX(0,(ET6+EW6-IF(EE6>0,ED6/PB_Ratio_Heat_input_vs_output,0)-EN6)/El_boiler_eff))", "EY" : "=MAX(0,EN6+IF(EE6=0,0,ED6/PB_Ratio_Heat_input_vs_output)-ET6-EW6)", "EZ" : "=MAX(0,-(IF(EE6>0,DZ6,0)+EM6-(EO6-EP6)-ES6-EV6-MAX(0,(ET6+EW6-IF(EE6>0,ED6/PB_Ratio_Heat_input_vs_output,0)-EN6)/El_boiler_eff)))", "FA" : "=Grid_import_max_ud-EZ6", "FB" : "=MIN(El_boiler_cap_ud,MAX(0,(ET6+EW6-EN6-IF(EE6>0,ED6/PB_Ratio_Heat_input_vs_output,0))/El_boiler_eff))", "FC" : "=MAX(0,El_boiler_cap_ud-FB6)", "FD" : "=MAX(0,1-ES6/(Overall_harmonious_var_max_cons+Overall_fix_cons)*MethSynt_harmonious_max_perc)*MethSynt_RawMeth_nom_prod_ud", "FE" : "=MAX(0,1-ES6/(Overall_harmonious_var_max_cons+Overall_fix_cons)*CCU_harmonious_max_perc)*CCU_CO2_nom_prod_ud", "FF" : "=MAX(0,1-ES6/(Overall_harmonious_var_max_cons+Overall_fix_cons)*EY_harmonious_max_perc)*EY_Hydrogen_nom_prod", "FG" : "=MIN(BESS_chrg_max_cons,EX6)", "FH" : "=MIN(Grid_export_max_ud,EX6)", "FI" : "=IF(MIN(Overall_harmonious_var_max_cons+Overall_fix_cons,EM6+Grid_import_max_ud*Grid_import_yes_no_PB_strategy-(EO6-EP6),MIN(EN6+El_boiler_cap_ud*El_boiler_eff,(EM6+Grid_import_max_ud*Grid_import_yes_no_PB_strategy-(EO6-EP6))/(Overall_harmonious_var_max_cons+Overall_fix_cons+(EO6-EP6)+MAX(0,(Overall_harmonious_var_heat_max_cons+Overall_heat_fix_cons-EN6))/El_boiler_eff)*(Overall_harmonious_var_heat_max_cons+Overall_heat_fix_cons))/(Overall_harmonious_var_heat_max_cons+Overall_heat_fix_cons)*(Overall_harmonious_var_max_cons+Overall_fix_cons))<Overall_harmonious_var_min_cons+Overall_fix_cons,0,MIN(Overall_harmonious_var_max_cons+Overall_fix_cons,EM6+Grid_import_max_ud*Grid_import_yes_no_PB_strategy-(EO6-EP6),MIN(EN6+El_boiler_cap_ud*El_boiler_eff,(EM6+Grid_import_max_ud*Grid_import_yes_no_PB_strategy-(EO6-EP6))/(Overall_harmonious_var_max_cons+Overall_fix_cons+(EO6-EP6)+MAX(0,(Overall_harmonious_var_heat_max_cons+Overall_heat_fix_cons-EN6))/El_boiler_eff)*(Overall_harmonious_var_heat_max_cons+Overall_heat_fix_cons))/(Overall_harmonious_var_heat_max_cons+Overall_heat_fix_cons)*(Overall_harmonious_var_max_cons+Overall_fix_cons)))", "FJ" : "=IF(AND(FI6>0,FI5=0,OR(FI6=0,FI7=0)),0,FI6)", "FK" : "=FJ6/(Overall_harmonious_var_max_cons+Overall_fix_cons)*(Overall_harmonious_var_heat_max_cons+Overall_heat_fix_cons)", "FL" : "=MAX(0,IF(EE6>0,DZ6,0)+EM6-(EO6-EP6)-FJ6-EV6-MAX(0,(FK6+EW6-IF(EE6>0,ED6/PB_Ratio_Heat_input_vs_output,0)-EN6)/El_boiler_eff))", "FM" : "=MAX(0,EN6+IF(EE6=0,0,ED6/PB_Ratio_Heat_input_vs_output)-FK6-EW6)", "FN" : "=MAX(0,-(IF(EE6>0,DZ6,0)+EM6-(EO6-EP6)-FJ6-EV6-MAX(0,(FK6+EW6-IF(EE6>0,ED6/PB_Ratio_Heat_input_vs_output,0)-EN6)/El_boiler_eff)))", "FO" : "=Grid_import_max_ud-FN6", "FP" : "=MIN(El_boiler_cap_ud,MAX(0,(FK6+EW6-EN6-IF(EE6>0,ED6/PB_Ratio_Heat_input_vs_output,0))/El_boiler_eff))", "FQ" : "=MAX(0,El_boiler_cap_ud-FP6)", "FR" : "=MAX(0,1-FJ6/(Overall_harmonious_var_max_cons+Overall_fix_cons)*MethSynt_harmonious_max_perc)*MethSynt_RawMeth_nom_prod_ud", "FS" : "=MAX(0,1-FJ6/(Overall_harmonious_var_max_cons+Overall_fix_cons)*CCU_harmonious_max_perc)*CCU_CO2_nom_prod_ud", "FT" : "=MAX(0,1-FJ6/(Overall_harmonious_var_max_cons+Overall_fix_cons)*EY_harmonious_max_perc)*EY_Hydrogen_nom_prod", "FU" : "=MIN(BESS_chrg_max_cons,FL6)", "FV" : "=MIN(Grid_export_max_ud,FL6)",  "FX" : "=IF($BM6>0,0,IF(B_overall_var_min_cons+B_overall_fix_stby_cons+$BK6+IF($BM7=0,0,B_overall_stup_cons)+MAX(0,B_overall_var_heat_min_cons+B_overall_heat_fix_stby_cons+IF($BM7=0,0,B_overall_heat_stup_cons)-$BQ6)/El_boiler_eff<$BP6-PB_stby_aux_cons,0,B_overall_var_min_cons+B_overall_fix_stby_cons+IF($BM7=0,0,B_overall_stup_cons)))", "FY" : "=IF(AND(FX7>0,FX6=0,FX5>0),FX5,FX6)", "FZ" : "=IF(FY6=0,0,$BK6+((MIN(PB_nom_net_cap,MAX(PB_net_min_cap,(1+TES_aux_cons_perc)*(FY6+$BK6-$BP6)))+PB_nom_net_cap*PB_nom_var_aux_cons_perc_net*POLY(MIN(PB_nom_net_cap,MAX(PB_net_min_cap,(1+TES_aux_cons_perc)*(FY6+$BK6-$BP6)))/PB_nom_net_cap,PB_n2g_var_aux_el_Coeff)+PB_fix_aux_el)/(PB_gross_min_eff+(PB_nom_gross_eff-PB_gross_min_eff)/(PB_nom_net_cap-PB_net_min_cap)*(MIN(PB_nom_net_cap,MAX(0,FY6+$BK6-$BP6))-PB_net_min_cap))+MAX(0,B_overall_var_heat_min_cons+B_overall_heat_fix_stby_cons-$BQ6)*PB_Ratio_Heat_input_vs_output)*TES_aux_cons_perc+IF(AND(FY6=0,FY7>0),MAX(0,IF(COUNTIF(FY1:FY6,\"0\")=PB_warm_start_duration,PB_warm_start_heat_req,PB_hot_start_heat_req)-$BQ6)*TES_aux_cons_perc,0))", "GA" : "=IF(FY6=0,0,MAX(PB_net_min_cap,MIN(PB_nom_net_cap,FY6+FZ6-$BP6)))", "GB" : "=IF(GA6=0,0,GA6+PB_nom_net_cap*PB_nom_var_aux_cons_perc_net*POLY(GA6/PB_nom_net_cap,PB_n2g_var_aux_el_Coeff)+PB_fix_aux_el)", "GC" : "=IF(AND(GB6=0,GB7>0),IF(COUNTIF(GB1:GB6,\"0\")=PB_warm_start_duration,PB_warm_start_heat_req,PB_hot_start_heat_req),0)", "GD" : "=IF(GB6=0,0,GB6/PB_nom_gross_eff/POLY(GB6/PB_nom_gross_cap_ud,el_Coeff))", "GE" : "=IF(GD6=0,0,MAX(0,PB_Ratio_Heat_input_vs_output*(MIN(B_overall_var_heat_min_cons+B_overall_heat_fix_stby_cons+IF($BM7=0,0,B_overall_heat_stup_cons),(GA6-FZ6+$BP6)/(B_overall_var_min_cons+B_overall_fix_stby_cons+IF($BM7=0,0,B_overall_stup_cons))*(B_overall_var_heat_min_cons+B_overall_heat_fix_stby_cons+IF($BM7=0,0,B_overall_heat_stup_cons)))-$BQ6-MAX(0,GA6-FY6-FZ6)*El_boiler_eff)))", "GF" : "=IF(MIN(SUMIF($BO$5:$BO$8763,\"=\"&$BO6,$AY$5:$AY$8763)*Heater_eff*(1+1/Ratio_CSP_vs_Heater),TES_thermal_cap)<SUMIF($BO$5:$BO$8763,\"=\"&$BO6,GC$5:GC$8763)+SUMIF($BO$5:$BO$8763,\"=\"&$BO6,GD$5:GD$8763)+SUMIF($BO$5:$BO$8763,\"=\"&$BO6,GE$5:GE$8763),0,SUMIF($BO$5:$BO$8763,\"=\"&$BO6,GC$5:GC$8763)+SUMIF($BO$5:$BO$8763,\"=\"&$BO6,GD$5:GD$8763)+SUMIF($BO$5:$BO$8763,\"=\"&$BO6,GE$5:GE$8763))", "GG" : "=IF(GF6=0,0,MAX(0,SUMIF($BO$5:$BO$8763,\"=\"&$BO6,$AY$5:$AY$8763)*Heater_eff*(1+1/Ratio_CSP_vs_Heater)-GF6))", "GH" : "=IF(OR(AND(GG6>0,$AY6>0,$AY5=0),AND(GG6>0,$AY7=0,$AY6>0)),$AY6,0)", "GI" : "=MAX(0,GG6-SUMIF($BO$5:$BO$8763,\"=\"&$BO6,GH$5:GH$8763)*Heater_eff*(1+1/Ratio_CSP_vs_Heater))", "GJ" : "=IF(GG6=0,0,$AY6-(GG6-GI6)/(SUMIF($BO$5:$BO$8763,\"=\"&$BO6,GH$5:GH$8763)*Heater_eff*(1+1/Ratio_CSP_vs_Heater))*GH6)", "GK" : "=IF(OR(GJ6=0,GI6=0),0,MAX(($AW6-GJ6)/(GI6/(1+1/Ratio_CSP_vs_Heater)/Heater_eff/COUNTIFS($BO$5:$BO$8763,\"=\"&$BO6,GJ$5:GJ$8763,\">0\")),($J6-GJ6*Heater_eff/Ratio_CSP_vs_Heater)/(GI6/(1+Ratio_CSP_vs_Heater)/COUNTIFS($BO$5:$BO$8763,\"=\"&$BO6,GJ$5:GJ$8763,\">0\")))/SUMIF($BO$5:$BO$8763,\"=\"&$BO6,GJ$5:GJ$8763)*GJ6)", "GL" : "=IF(GF6=0,0,GJ6-IF(GI6=0,0,GI6/(1+1/Ratio_CSP_vs_Heater)/Heater_eff/SUMIF($BO$5:$BO$8763,\"=\"&$BO6,GK$5:GK$8763)*GK6))", "GM" : "=MIN($J6,GL6*Heater_eff/Ratio_CSP_vs_Heater)", "GN" : "=MAX(0,$L6-GL6)", "GO" : "=MAX(0,$J6-GM6)", "GP" : "=IF($J6>0,$J6*CSP_var_aux_nom_perc,CSP_nonsolar_aux_cons)+$M6+(GL6*Heater_eff+GM6)*TES_aux_cons_perc+IF(OR(GB6=0,AND(GB6>0,GF6=0)),PB_stby_aux_cons+GC6*TES_aux_cons_perc,(GC6+GD6+GE6)*TES_aux_cons_perc)", "GQ" : "=MAX(0,-($L6+IF(GF6>0,GA6,0)-GL6-GP6))",  "GS" : "=IF(MIN(Overall_harmonious_var_max_cons+Overall_fix_cons,GN6+Grid_import_max_ud*Grid_import_yes_no_PB_strategy-(GP6-GQ6),MIN(GO6+El_boiler_cap_ud*El_boiler_eff,(GN6+Grid_import_max_ud*Grid_import_yes_no_PB_strategy-(GP6-GQ6))/(Overall_harmonious_var_max_cons+Overall_fix_cons+(GP6-GQ6)+MAX(0,(Overall_harmonious_var_heat_max_cons+Overall_heat_fix_cons-GO6))/El_boiler_eff)*(Overall_harmonious_var_heat_max_cons+Overall_heat_fix_cons))/(Overall_harmonious_var_heat_max_cons+Overall_heat_fix_cons)*(Overall_harmonious_var_max_cons+Overall_fix_cons))<Overall_harmonious_var_min_cons+Overall_fix_cons,0,Overall_harmonious_var_min_cons+Overall_fix_cons)", "GT" : "=IF(AND(GS6>0,GS5=0,OR(GS6=0,GS7=0)),0,GS6)", "GU" : "=GT6/(Overall_harmonious_var_max_cons+Overall_fix_cons)*(Overall_harmonious_var_heat_max_cons+Overall_heat_fix_cons)", "GV" : "=IF(AND(GT5<=0,GT6>0),GV5+1,IF(AND(GN6>0,$BO6<>$BO5,SUM(GT6:GT8)=0),GV5+1,GV5))", "GW" : "=IF(OR(GT6>0,GF6=0),0,MIN((GA6+GN6+(GO6+GE6/PB_Ratio_Heat_input_vs_output)/El_boiler_eff-(GP6-GQ6))/(B_overall_var_min_cons+B_overall_fix_stby_cons+IF(GT7=0,0,B_overall_stup_cons)+(B_overall_var_heat_min_cons+B_overall_heat_fix_stby_cons+IF(GU7=0,0,B_overall_heat_stup_cons))/El_boiler_eff)*(B_overall_var_min_cons+B_overall_fix_stby_cons+IF(GT7=0,0,B_overall_stup_cons)),B_overall_var_min_cons+B_overall_fix_stby_cons+IF(GT7=0,0,B_overall_stup_cons)))", "GX" : "=IF(GW6=0,0,MIN((GA6+GN6+(GO6+GE6/PB_Ratio_Heat_input_vs_output)/El_boiler_eff-(GP6-GQ6))/(B_overall_var_min_cons+B_overall_fix_stby_cons+IF(GT7=0,0,B_overall_stup_cons)+(B_overall_var_heat_min_cons+B_overall_heat_fix_stby_cons+IF(GU7=0,0,B_overall_heat_stup_cons))/El_boiler_eff)*(B_overall_var_heat_min_cons+B_overall_heat_fix_stby_cons+IF(GU7=0,0,B_overall_heat_stup_cons)),B_overall_var_heat_min_cons+B_overall_heat_fix_stby_cons+IF(GU7=0,0,B_overall_heat_stup_cons)))", "GY" : "=MAX(0,IF(GF6>0,GA6,0)+GN6-(GP6-GQ6)-GT6-GW6-MAX(0,(GU6+GX6-IF(GF6>0,GE6/PB_Ratio_Heat_input_vs_output,0)-GO6)/El_boiler_eff))", "GZ" : "=MAX(0,GO6+IF(GF6=0,0,GE6/PB_Ratio_Heat_input_vs_output)-GU6-GX6)", "HA" : "=MAX(0,-(IF(GF6>0,GA6,0)+GN6-(GP6-GQ6)-GT6-GW6-MAX(0,(GU6+GX6-IF(GF6>0,GE6/PB_Ratio_Heat_input_vs_output,0)-GO6)/El_boiler_eff)))", "HB" : "=Grid_import_max_ud-HA6", "HC" : "=MIN(El_boiler_cap_ud,MAX(0,(GU6+GX6-GO6-IF(GF6>0,GE6/PB_Ratio_Heat_input_vs_output,0))/El_boiler_eff))", "HD" : "=MAX(0,El_boiler_cap_ud-HC6)", "HE" : "=MAX(0,1-GT6/(Overall_harmonious_var_max_cons+Overall_fix_cons)*MethSynt_harmonious_max_perc)*MethSynt_RawMeth_nom_prod_ud", "HF" : "=MAX(0,1-GT6/(Overall_harmonious_var_max_cons+Overall_fix_cons)*CCU_harmonious_max_perc)*CCU_CO2_nom_prod_ud", "HG" : "=MAX(0,1-GT6/(Overall_harmonious_var_max_cons+Overall_fix_cons)*EY_harmonious_max_perc)*EY_Hydrogen_nom_prod", "HH" : "=MIN(BESS_chrg_max_cons,GY6)", "HI" : "=MIN(Grid_export_max_ud,GY6)", "HJ" : "=IF(MIN(Overall_harmonious_var_max_cons+Overall_fix_cons,GN6+Grid_import_max_ud*Grid_import_yes_no_PB_strategy-(GP6-GQ6),MIN(GO6+El_boiler_cap_ud*El_boiler_eff,(GN6+Grid_import_max_ud*Grid_import_yes_no_PB_strategy-(GP6-GQ6))/(Overall_harmonious_var_max_cons+Overall_fix_cons+(GP6-GQ6)+MAX(0,(Overall_harmonious_var_heat_max_cons+Overall_heat_fix_cons-GO6))/El_boiler_eff)*(Overall_harmonious_var_heat_max_cons+Overall_heat_fix_cons))/(Overall_harmonious_var_heat_max_cons+Overall_heat_fix_cons)*(Overall_harmonious_var_max_cons+Overall_fix_cons))<Overall_harmonious_var_min_cons+Overall_fix_cons,0,MIN(Overall_harmonious_var_max_cons+Overall_fix_cons,GN6+Grid_import_max_ud*Grid_import_yes_no_PB_strategy-(GP6-GQ6),MIN(GO6+El_boiler_cap_ud*El_boiler_eff,(GN6+Grid_import_max_ud*Grid_import_yes_no_PB_strategy-(GP6-GQ6))/(Overall_harmonious_var_max_cons+Overall_fix_cons+(GP6-GQ6)+MAX(0,(Overall_harmonious_var_heat_max_cons+Overall_heat_fix_cons-GO6))/El_boiler_eff)*(Overall_harmonious_var_heat_max_cons+Overall_heat_fix_cons))/(Overall_harmonious_var_heat_max_cons+Overall_heat_fix_cons)*(Overall_harmonious_var_max_cons+Overall_fix_cons)))", "HK" : "=IF(AND(HJ6>0,HJ5=0,OR(HJ6=0,HJ7=0)),0,HJ6)", "HL" : "=HK6/(Overall_harmonious_var_max_cons+Overall_fix_cons)*(Overall_harmonious_var_heat_max_cons+Overall_heat_fix_cons)", "HM" : "=MAX(0,IF(GF6>0,GA6,0)+GN6-(GP6-GQ6)-HK6-GW6-MAX(0,(HL6+GX6-IF(GF6>0,GE6/PB_Ratio_Heat_input_vs_output,0)-GO6)/El_boiler_eff))", "HN" : "=MAX(0,GO6+IF(GF6=0,0,GE6/PB_Ratio_Heat_input_vs_output)-HL6-GX6)", "HO" : "=MAX(0,-(IF(GF6>0,GA6,0)+GN6-(GP6-GQ6)-HK6-GW6-MAX(0,(HL6+GX6-IF(GF6>0,GE6/PB_Ratio_Heat_input_vs_output,0)-GO6)/El_boiler_eff)))", "HP" : "=Grid_import_max_ud-HO6", "HQ" : "=MIN(El_boiler_cap_ud,MAX(0,(HL6+GX6-GO6-IF(GF6>0,GE6/PB_Ratio_Heat_input_vs_output,0))/El_boiler_eff))", "HR" : "=MAX(0,El_boiler_cap_ud-HQ6)", "HS" : "=MAX(0,1-HK6/(Overall_harmonious_var_max_cons+Overall_fix_cons)*MethSynt_harmonious_max_perc)*MethSynt_RawMeth_nom_prod_ud", "HT" : "=MAX(0,1-HK6/(Overall_harmonious_var_max_cons+Overall_fix_cons)*CCU_harmonious_max_perc)*CCU_CO2_nom_prod_ud", "HU" : "=MAX(0,1-HK6/(Overall_harmonious_var_max_cons+Overall_fix_cons)*EY_harmonious_max_perc)*EY_Hydrogen_nom_prod", "HV" : "=MIN(BESS_chrg_max_cons,HM6)", "HW" : "=MIN(Grid_export_max_ud,HM6)",  "HY" : "=VLOOKUP($BO6,DailyCalc_1$A$3:$AO$367,COLUMN(DailyCalc_1AO$3))", "HZ" : "=IF($BM6>0,0,IF(B_overall_var_max_cons*HY6+B_overall_fix_stby_cons+$BK6+IF($BM7=0,0,B_overall_stup_cons)+MAX(0,B_overall_var_heat_max_cons*HY6+B_overall_heat_fix_stby_cons+IF($BM7=0,0,B_overall_heat_stup_cons)-$BQ6)/El_boiler_eff<$BP6-PB_stby_aux_cons,0,B_overall_var_max_cons*HY6+B_overall_fix_stby_cons+IF($BM7=0,0,B_overall_stup_cons)))", "IA" : "=IF(AND(HZ7>0,HZ6=0,HZ5>0),HZ5,HZ6)", "IB" : "=IF(IA6=0,0,$BK6+((MIN(PB_nom_net_cap,MAX(PB_net_min_cap,(1+TES_aux_cons_perc)*(IA6+$BK6-$BP6)))+PB_nom_net_cap*PB_nom_var_aux_cons_perc_net*POLY(MIN(PB_nom_net_cap,MAX(PB_net_min_cap,(1+TES_aux_cons_perc)*(IA6+$BK6-$BP6)))/PB_nom_net_cap,PB_n2g_var_aux_el_Coeff)+PB_fix_aux_el)/(PB_gross_min_eff+(PB_nom_gross_eff-PB_gross_min_eff)/(PB_nom_net_cap-PB_net_min_cap)*(MIN(PB_nom_net_cap,MAX(0,IA6+$BK6-$BP6))-PB_net_min_cap))+MAX(0,B_overall_var_heat_max_cons*HY6+B_overall_heat_fix_stby_cons-$BQ6)*PB_Ratio_Heat_input_vs_output)*TES_aux_cons_perc+IF(AND(IA6=0,IA7>0),MAX(0,IF(COUNTIF(IA1:IA6,\"0\")=PB_warm_start_duration,PB_warm_start_heat_req,PB_hot_start_heat_req)-$BQ6)*TES_aux_cons_perc,0))", "IC" : "=IF(IA6=0,0,MAX(PB_net_min_cap,MIN(PB_nom_net_cap,IA6+IB6-$BP6)))", "ID" : "=IF(IC6=0,0,IC6+PB_nom_net_cap*PB_nom_var_aux_cons_perc_net*POLY(IC6/PB_nom_net_cap,PB_n2g_var_aux_el_Coeff)+PB_fix_aux_el)", "IE" : "=IF(AND(ID6=0,ID7>0),IF(COUNTIF(ID1:ID6,\"0\")=PB_warm_start_duration,PB_warm_start_heat_req,PB_hot_start_heat_req),0)", "IF" : "=IF(ID6=0,0,ID6/PB_nom_gross_eff/POLY(ID6/PB_nom_gross_cap_ud,el_Coeff))", "IG" : "=IF(IF6=0,0,MAX(0,PB_Ratio_Heat_input_vs_output*(MIN(B_overall_var_heat_max_cons*HY6+B_overall_heat_fix_stby_cons+IF($BM7=0,0,B_overall_heat_stup_cons),(IC6-IB6+$BP6)/(B_overall_var_max_cons*HY6+B_overall_fix_stby_cons+IF($BM7=0,0,B_overall_stup_cons))*(B_overall_var_heat_max_cons*HY6+B_overall_heat_fix_stby_cons+IF($BM7=0,0,B_overall_heat_stup_cons)))-$BQ6-MAX(0,IC6-IA6-IB6)*El_boiler_eff)))", "IH" : "=IF(MIN(SUMIF($BO$5:$BO$8763,\"=\"&$BO6,$AY$5:$AY$8763)*Heater_eff*(1+1/Ratio_CSP_vs_Heater),TES_thermal_cap)<SUMIF($BO$5:$BO$8763,\"=\"&$BO6,IE$5:IE$8763)+SUMIF($BO$5:$BO$8763,\"=\"&$BO6,IF$5:IF$8763)+SUMIF($BO$5:$BO$8763,\"=\"&$BO6,IG$5:IG$8763),0,SUMIF($BO$5:$BO$8763,\"=\"&$BO6,IE$5:IE$8763)+SUMIF($BO$5:$BO$8763,\"=\"&$BO6,IF$5:IF$8763)+SUMIF($BO$5:$BO$8763,\"=\"&$BO6,IG$5:IG$8763))", "II" : "=IF(IH6=0,0,MAX(0,SUMIF($BO$5:$BO$8763,\"=\"&$BO6,$AY$5:$AY$8763)*Heater_eff*(1+1/Ratio_CSP_vs_Heater)-IH6))", "IJ" : "=IF(OR(AND(II6>0,$AY6>0,$AY5=0),AND(II6>0,$AY7=0,$AY6>0)),$AY6,0)", "IK" : "=MAX(0,II6-SUMIF($BO$5:$BO$8763,\"=\"&$BO6,IJ$5:IJ$8763)*Heater_eff*(1+1/Ratio_CSP_vs_Heater))", "IL" : "=IF(II6=0,0,$AY6-(II6-IK6)/(SUMIF($BO$5:$BO$8763,\"=\"&$BO6,IJ$5:IJ$8763)*Heater_eff*(1+1/Ratio_CSP_vs_Heater))*IJ6)", "IM" : "=IF(OR(IL6=0,IK6=0),0,MAX(($AW6-IL6)/(IK6/(1+1/Ratio_CSP_vs_Heater)/Heater_eff/COUNTIFS($BO$5:$BO$8763,\"=\"&$BO6,IL$5:IL$8763,\">0\")),($J6-IL6*Heater_eff/Ratio_CSP_vs_Heater)/(IK6/(1+Ratio_CSP_vs_Heater)/COUNTIFS($BO$5:$BO$8763,\"=\"&$BO6,IL$5:IL$8763,\">0\")))/SUMIF($BO$5:$BO$8763,\"=\"&$BO6,IL$5:IL$8763)*IL6)", "IN" : "=IF(IH6=0,0,IL6-IF(IK6=0,0,IK6/(1+1/Ratio_CSP_vs_Heater)/Heater_eff/SUMIF($BO$5:$BO$8763,\"=\"&$BO6,IM$5:IM$8763)*IM6))", "IO" : "=MIN($J6,IN6*Heater_eff/Ratio_CSP_vs_Heater)", "IP" : "=MAX(0,$L6-IN6)", "IQ" : "=MAX(0,$J6-IO6)", "IR" : "=IF($J6>0,$J6*CSP_var_aux_nom_perc,CSP_nonsolar_aux_cons)+$M6+(IN6*Heater_eff+IO6)*TES_aux_cons_perc+IF(OR(ID6=0,AND(ID6>0,IH6=0)),PB_stby_aux_cons+IE6*TES_aux_cons_perc,(IE6+IF6+IG6)*TES_aux_cons_perc)", "IS" : "=MAX(0,-($L6+IF(IH6>0,IC6,0)-IN6-IR6))",  "IU" : "=IF(MIN(Overall_harmonious_var_max_cons+Overall_fix_cons,IP6+Grid_import_max_ud*Grid_import_yes_no_PB_strategy-(IR6-IS6),MIN(IQ6+El_boiler_cap_ud*El_boiler_eff,(IP6+Grid_import_max_ud*Grid_import_yes_no_PB_strategy-(IR6-IS6))/(Overall_harmonious_var_max_cons+Overall_fix_cons+(IR6-IS6)+MAX(0,(Overall_harmonious_var_heat_max_cons+Overall_heat_fix_cons-IQ6))/El_boiler_eff)*(Overall_harmonious_var_heat_max_cons+Overall_heat_fix_cons))/(Overall_harmonious_var_heat_max_cons+Overall_heat_fix_cons)*(Overall_harmonious_var_max_cons+Overall_fix_cons))<Overall_harmonious_var_min_cons+Overall_fix_cons,0,Overall_harmonious_var_min_cons+Overall_fix_cons)", "IV" : "=IF(AND(IU6>0,IU5=0,OR(IU6=0,IU7=0)),0,IU6)", "IW" : "=IV6/(Overall_harmonious_var_max_cons+Overall_fix_cons)*(Overall_harmonious_var_heat_max_cons+Overall_heat_fix_cons)", "IX" : "=IF(AND(IV5<=0,IV6>0),IX5+1,IF(AND(IP6>0,$BO6<>$BO5,SUM(IV6:IV8)=0),IX5+1,IX5))", "IY" : "=IF(OR(IV6>0,IH6=0),0,MIN((IC6+IP6+(IQ6+IG6/PB_Ratio_Heat_input_vs_output)/El_boiler_eff-(IR6-IS6))/(B_overall_var_max_cons*HY6+B_overall_fix_stby_cons+IF(IV7=0,0,B_overall_stup_cons)+(B_overall_var_heat_max_cons*HY6+B_overall_heat_fix_stby_cons+IF(IW7=0,0,B_overall_heat_stup_cons))/El_boiler_eff)*(B_overall_var_max_cons*HY6+B_overall_fix_stby_cons+IF(IV7=0,0,B_overall_stup_cons)),B_overall_var_max_cons*HY6+B_overall_fix_stby_cons+IF(IV7=0,0,B_overall_stup_cons)))", "IZ" : "=IF(IY6=0,0,MIN((IC6+IP6+(IQ6+IG6/PB_Ratio_Heat_input_vs_output)/El_boiler_eff-(IR6-IS6))/(B_overall_var_max_cons*HY6+B_overall_fix_stby_cons+IF(IV7=0,0,B_overall_stup_cons)+(B_overall_var_heat_max_cons*HY6+B_overall_heat_fix_stby_cons+IF(IW7=0,0,B_overall_heat_stup_cons))/El_boiler_eff)*(B_overall_var_heat_max_cons*HY6+B_overall_heat_fix_stby_cons+IF(IW7=0,0,B_overall_heat_stup_cons)),B_overall_var_heat_max_cons*HY6+B_overall_heat_fix_stby_cons+IF(IW7=0,0,B_overall_heat_stup_cons)))", "JA" : "=MAX(0,IF(IH6>0,IC6,0)+IP6-(IR6-IS6)-IV6-IY6-MAX(0,(IW6+IZ6-IF(IH6>0,IG6/PB_Ratio_Heat_input_vs_output,0)-IQ6)/El_boiler_eff))", "JB" : "=MAX(0,IQ6+IF(IH6=0,0,IG6/PB_Ratio_Heat_input_vs_output)-IW6-IZ6)", "JC" : "=MAX(0,-(IF(IH6>0,IC6,0)+IP6-(IR6-IS6)-IV6-IY6-MAX(0,(IW6+IZ6-IF(IH6>0,IG6/PB_Ratio_Heat_input_vs_output,0)-IQ6)/El_boiler_eff)))", "JD" : "=Grid_import_max_ud-JC6", "JE" : "=MIN(El_boiler_cap_ud,MAX(0,(IW6+IZ6-IQ6-IF(IH6>0,IG6/PB_Ratio_Heat_input_vs_output,0))/El_boiler_eff))", "JF" : "=MAX(0,El_boiler_cap_ud-JE6)", "JG" : "=MAX(0,1-IV6/(Overall_harmonious_var_max_cons+Overall_fix_cons)*MethSynt_harmonious_max_perc)*MethSynt_RawMeth_nom_prod_ud", "JH" : "=MAX(0,1-IV6/(Overall_harmonious_var_max_cons+Overall_fix_cons)*CCU_harmonious_max_perc)*CCU_CO2_nom_prod_ud", "JI" : "=MAX(0,1-IV6/(Overall_harmonious_var_max_cons+Overall_fix_cons)*EY_harmonious_max_perc)*EY_Hydrogen_nom_prod", "JJ" : "=MIN(BESS_chrg_max_cons,JA6)", "JK" : "=MIN(Grid_export_max_ud,JA6)", "JL" : "=IF(MIN(Overall_harmonious_var_max_cons+Overall_fix_cons,IP6+Grid_import_max_ud*Grid_import_yes_no_PB_strategy-(IR6-IS6),MIN(IQ6+El_boiler_cap_ud*El_boiler_eff,(IP6+Grid_import_max_ud*Grid_import_yes_no_PB_strategy-(IR6-IS6))/(Overall_harmonious_var_max_cons+Overall_fix_cons+(IR6-IS6)+MAX(0,(Overall_harmonious_var_heat_max_cons+Overall_heat_fix_cons-IQ6))/El_boiler_eff)*(Overall_harmonious_var_heat_max_cons+Overall_heat_fix_cons))/(Overall_harmonious_var_heat_max_cons+Overall_heat_fix_cons)*(Overall_harmonious_var_max_cons+Overall_fix_cons))<Overall_harmonious_var_min_cons+Overall_fix_cons,0,MIN(Overall_harmonious_var_max_cons+Overall_fix_cons,IP6+Grid_import_max_ud*Grid_import_yes_no_PB_strategy-(IR6-IS6),MIN(IQ6+El_boiler_cap_ud*El_boiler_eff,(IP6+Grid_import_max_ud*Grid_import_yes_no_PB_strategy-(IR6-IS6))/(Overall_harmonious_var_max_cons+Overall_fix_cons+(IR6-IS6)+MAX(0,(Overall_harmonious_var_heat_max_cons+Overall_heat_fix_cons-IQ6))/El_boiler_eff)*(Overall_harmonious_var_heat_max_cons+Overall_heat_fix_cons))/(Overall_harmonious_var_heat_max_cons+Overall_heat_fix_cons)*(Overall_harmonious_var_max_cons+Overall_fix_cons)))", "JM" : "=IF(AND(JL6>0,JL5=0,OR(JL6=0,JL7=0)),0,JL6)", "JN" : "=JM6/(Overall_harmonious_var_max_cons+Overall_fix_cons)*(Overall_harmonious_var_heat_max_cons+Overall_heat_fix_cons)", "JO" : "=MAX(0,IF(IH6>0,IC6,0)+IP6-(IR6-IS6)-JM6-IY6-MAX(0,(JN6+IZ6-IF(IH6>0,IG6/PB_Ratio_Heat_input_vs_output,0)-IQ6)/El_boiler_eff))", "JP" : "=MAX(0,IQ6+IF(IH6=0,0,IG6/PB_Ratio_Heat_input_vs_output)-JN6-IZ6)", "JQ" : "=MAX(0,-(IF(IH6>0,IC6,0)+IP6-(IR6-IS6)-JM6-IY6-MAX(0,(JN6+IZ6-IF(IH6>0,IG6/PB_Ratio_Heat_input_vs_output,0)-IQ6)/El_boiler_eff)))", "JR" : "=Grid_import_max_ud-JQ6", "JS" : "=MIN(El_boiler_cap_ud,MAX(0,(JN6+IZ6-IQ6-IF(IH6>0,IG6/PB_Ratio_Heat_input_vs_output,0))/El_boiler_eff))", "JT" : "=MAX(0,El_boiler_cap_ud-JS6)", "JU" : "=MAX(0,1-JM6/(Overall_harmonious_var_max_cons+Overall_fix_cons)*MethSynt_harmonious_max_perc)*MethSynt_RawMeth_nom_prod_ud", "JV" : "=MAX(0,1-JM6/(Overall_harmonious_var_max_cons+Overall_fix_cons)*CCU_harmonious_max_perc)*CCU_CO2_nom_prod_ud", "JW" : "=MAX(0,1-JM6/(Overall_harmonious_var_max_cons+Overall_fix_cons)*EY_harmonious_max_perc)*EY_Hydrogen_nom_prod", "JX" : "=MIN(BESS_chrg_max_cons,JO6)", "JY" : "=MIN(Grid_export_max_ud,JO6)",  "KA" : "=IF($BM6>0,0,IF(C_overall_var_min_cons+C_overall_fix_stby_cons+$BK6+IF($BM7=0,0,C_overall_stup_cons)+MAX(0,C_overall_var_heat_min_cons+C_overall_heat_fix_stby_cons+IF($BM7=0,0,C_overall_heat_stup_cons)-$BQ6)/El_boiler_eff<$BP6-PB_stby_aux_cons,0,C_overall_var_min_cons+C_overall_fix_stby_cons+IF($BM7=0,0,C_overall_stup_cons)))", "KB" : "=IF(AND(KA7>0,KA6=0,KA5>0),KA5,KA6)", "KC" : "=IF(KB6=0,0,$BK6+((MIN(PB_nom_net_cap,MAX(PB_net_min_cap,(1+TES_aux_cons_perc)*(KB6+$BK6-$BP6)))+PB_nom_net_cap*PB_nom_var_aux_cons_perc_net*POLY(MIN(PB_nom_net_cap,MAX(PB_net_min_cap,(1+TES_aux_cons_perc)*(KB6+$BK6-$BP6)))/PB_nom_net_cap,PB_n2g_var_aux_el_Coeff)+PB_fix_aux_el)/(PB_gross_min_eff+(PB_nom_gross_eff-PB_gross_min_eff)/(PB_nom_net_cap-PB_net_min_cap)*(MIN(PB_nom_net_cap,MAX(0,KB6+$BK6-$BP6))-PB_net_min_cap))+MAX(0,C_overall_var_heat_min_cons+C_overall_heat_fix_stby_cons-$BQ6)*PB_Ratio_Heat_input_vs_output)*TES_aux_cons_perc+IF(AND(KB6=0,KB7>0),MAX(0,IF(COUNTIF(KB1:KB6,\"0\")=PB_warm_start_duration,PB_warm_start_heat_req,PB_hot_start_heat_req)-$BQ6)*TES_aux_cons_perc,0))", "KD" : "=IF(KB6=0,0,MAX(PB_net_min_cap,MIN(PB_nom_net_cap,KB6+KC6-$BP6)))", "KE" : "=IF(KD6=0,0,KD6+PB_nom_net_cap*PB_nom_var_aux_cons_perc_net*POLY(KD6/PB_nom_net_cap,PB_n2g_var_aux_el_Coeff)+PB_fix_aux_el)", "KF" : "=IF(AND(KE6=0,KE7>0),IF(COUNTIF(KE1:KE6,\"0\")=PB_warm_start_duration,PB_warm_start_heat_req,PB_hot_start_heat_req),0)", "KG" : "=IF(KE6=0,0,KE6/PB_nom_gross_eff/POLY(KE6/PB_nom_gross_cap_ud,el_Coeff))", "KH" : "=IF(KG6=0,0,MAX(0,PB_Ratio_Heat_input_vs_output*(MIN(C_overall_var_heat_min_cons+C_overall_heat_fix_stby_cons+IF($BM7=0,0,C_overall_heat_stup_cons),(KD6-KC6+$BP6)/(C_overall_var_min_cons+C_overall_fix_stby_cons+IF($BM7=0,0,C_overall_stup_cons))*(C_overall_var_heat_min_cons+C_overall_heat_fix_stby_cons+IF($BM7=0,0,C_overall_heat_stup_cons)))-$BQ6-MAX(0,KD6-KB6-KC6)*El_boiler_eff)))", "KI" : "=IF(MIN(SUMIF($BO$5:$BO$8763,\"=\"&$BO6,$AY$5:$AY$8763)*Heater_eff*(1+1/Ratio_CSP_vs_Heater),TES_thermal_cap)<SUMIF($BO$5:$BO$8763,\"=\"&$BO6,KF$5:KF$8763)+SUMIF($BO$5:$BO$8763,\"=\"&$BO6,KG$5:KG$8763)+SUMIF($BO$5:$BO$8763,\"=\"&$BO6,KH$5:KH$8763),0,SUMIF($BO$5:$BO$8763,\"=\"&$BO6,KF$5:KF$8763)+SUMIF($BO$5:$BO$8763,\"=\"&$BO6,KG$5:KG$8763)+SUMIF($BO$5:$BO$8763,\"=\"&$BO6,KH$5:KH$8763))", "KJ" : "=IF(KI6=0,0,MAX(0,SUMIF($BO$5:$BO$8763,\"=\"&$BO6,$AY$5:$AY$8763)*Heater_eff*(1+1/Ratio_CSP_vs_Heater)-KI6))", "KK" : "=IF(OR(AND(KJ6>0,$AY6>0,$AY5=0),AND(KJ6>0,$AY7=0,$AY6>0)),$AY6,0)", "KL" : "=MAX(0,KJ6-SUMIF($BO$5:$BO$8763,\"=\"&$BO6,KK$5:KK$8763)*Heater_eff*(1+1/Ratio_CSP_vs_Heater))", "KM" : "=IF(KJ6=0,0,$AY6-(KJ6-KL6)/(SUMIF($BO$5:$BO$8763,\"=\"&$BO6,KK$5:KK$8763)*Heater_eff*(1+1/Ratio_CSP_vs_Heater))*KK6)", "KN" : "=IF(OR(KM6=0,KL6=0),0,MAX(($AW6-KM6)/(KL6/(1+1/Ratio_CSP_vs_Heater)/Heater_eff/COUNTIFS($BO$5:$BO$8763,\"=\"&$BO6,KM$5:KM$8763,\">0\")),($J6-KM6*Heater_eff/Ratio_CSP_vs_Heater)/(KL6/(1+Ratio_CSP_vs_Heater)/COUNTIFS($BO$5:$BO$8763,\"=\"&$BO6,KM$5:KM$8763,\">0\")))/SUMIF($BO$5:$BO$8763,\"=\"&$BO6,KM$5:KM$8763)*KM6)", "KO" : "=IF(KI6=0,0,KM6-IF(KL6=0,0,KL6/(1+1/Ratio_CSP_vs_Heater)/Heater_eff/SUMIF($BO$5:$BO$8763,\"=\"&$BO6,KN$5:KN$8763)*KN6))", "KP" : "=MIN($J6,KO6*Heater_eff/Ratio_CSP_vs_Heater)", "KQ" : "=MAX(0,$L6-KO6)", "KR" : "=MAX(0,$J6-KP6)", "KS" : "=IF($J6>0,$J6*CSP_var_aux_nom_perc,CSP_nonsolar_aux_cons)+$M6+(KO6*Heater_eff+KP6)*TES_aux_cons_perc+IF(OR(KE6=0,AND(KE6>0,KI6=0)),PB_stby_aux_cons+KF6*TES_aux_cons_perc,(KF6+KG6+KH6)*TES_aux_cons_perc)", "KT" : "=MAX(0,-($L6+IF(KI6>0,KD6,0)-KO6-KS6))",  "KV" : "=IF(MIN(Overall_harmonious_var_max_cons+Overall_fix_cons,KQ6+Grid_import_max_ud*Grid_import_yes_no_PB_strategy-(KS6-KT6),MIN(KR6+El_boiler_cap_ud*El_boiler_eff,(KQ6+Grid_import_max_ud*Grid_import_yes_no_PB_strategy-(KS6-KT6))/(Overall_harmonious_var_max_cons+Overall_fix_cons+(KS6-KT6)+MAX(0,(Overall_harmonious_var_heat_max_cons+Overall_heat_fix_cons-KR6))/El_boiler_eff)*(Overall_harmonious_var_heat_max_cons+Overall_heat_fix_cons))/(Overall_harmonious_var_heat_max_cons+Overall_heat_fix_cons)*(Overall_harmonious_var_max_cons+Overall_fix_cons))<Overall_harmonious_var_min_cons+Overall_fix_cons,0,Overall_harmonious_var_min_cons+Overall_fix_cons)", "KW" : "=IF(AND(KV6>0,KV5=0,OR(KV6=0,KV7=0)),0,KV6)", "KX" : "=KW6/(Overall_harmonious_var_max_cons+Overall_fix_cons)*(Overall_harmonious_var_heat_max_cons+Overall_heat_fix_cons)", "KY" : "=IF(AND(KW5<=0,KW6>0),KY5+1,IF(AND(KQ6>0,$BO6<>$BO5,SUM(KW6:KW8)=0),KY5+1,KY5))", "KZ" : "=IF(OR(KW6>0,KI6=0),0,MIN((KD6+KQ6+(KR6+KH6/PB_Ratio_Heat_input_vs_output)/El_boiler_eff-(KS6-KT6))/(C_overall_var_min_cons+C_overall_fix_stby_cons+IF(KW7=0,0,C_overall_stup_cons)+(C_overall_var_heat_min_cons+C_overall_heat_fix_stby_cons+IF(KX7=0,0,C_overall_heat_stup_cons))/El_boiler_eff)*(C_overall_var_min_cons+C_overall_fix_stby_cons+IF(KW7=0,0,C_overall_stup_cons)),C_overall_var_min_cons+C_overall_fix_stby_cons+IF(KW7=0,0,C_overall_stup_cons)))", "LA" : "=IF(KZ6=0,0,MIN((KD6+KQ6+(KR6+KH6/PB_Ratio_Heat_input_vs_output)/El_boiler_eff-(KS6-KT6))/(C_overall_var_min_cons+C_overall_fix_stby_cons+IF(KW7=0,0,C_overall_stup_cons)+(C_overall_var_heat_min_cons+C_overall_heat_fix_stby_cons+IF(KX7=0,0,C_overall_heat_stup_cons))/El_boiler_eff)*(C_overall_var_heat_min_cons+C_overall_heat_fix_stby_cons+IF(KX7=0,0,C_overall_heat_stup_cons)),C_overall_var_heat_min_cons+C_overall_heat_fix_stby_cons+IF(KX7=0,0,C_overall_heat_stup_cons)))", "LB" : "=MAX(0,IF(KI6>0,KD6,0)+KQ6-(KS6-KT6)-KW6-KZ6-MAX(0,(KX6+LA6-IF(KI6>0,KH6/PB_Ratio_Heat_input_vs_output,0)-KR6)/El_boiler_eff))", "LC" : "=MAX(0,KR6+IF(KI6=0,0,KH6/PB_Ratio_Heat_input_vs_output)-KX6-LA6)", "LD" : "=MAX(0,-(IF(KI6>0,KD6,0)+KQ6-(KS6-KT6)-KW6-KZ6-MAX(0,(KX6+LA6-IF(KI6>0,KH6/PB_Ratio_Heat_input_vs_output,0)-KR6)/El_boiler_eff)))", "LE" : "=Grid_import_max_ud-LD6", "LF" : "=MIN(El_boiler_cap_ud,MAX(0,(KX6+LA6-KR6-IF(KI6>0,KH6/PB_Ratio_Heat_input_vs_output,0))/El_boiler_eff))", "LG" : "=MAX(0,El_boiler_cap_ud-LF6)", "LH" : "=MAX(0,1-KW6/(Overall_harmonious_var_max_cons+Overall_fix_cons)*MethSynt_harmonious_max_perc)*MethSynt_RawMeth_nom_prod_ud", "LI" : "=MAX(0,1-KW6/(Overall_harmonious_var_max_cons+Overall_fix_cons)*CCU_harmonious_max_perc)*CCU_CO2_nom_prod_ud", "LJ" : "=MAX(0,1-KW6/(Overall_harmonious_var_max_cons+Overall_fix_cons)*EY_harmonious_max_perc)*EY_Hydrogen_nom_prod", "LK" : "=MIN(BESS_chrg_max_cons,LB6)", "LL" : "=MIN(Grid_export_max_ud,LB6)", "LM" : "=IF(MIN(Overall_harmonious_var_max_cons+Overall_fix_cons,KQ6+Grid_import_max_ud*Grid_import_yes_no_PB_strategy-(KS6-KT6),MIN(KR6+El_boiler_cap_ud*El_boiler_eff,(KQ6+Grid_import_max_ud*Grid_import_yes_no_PB_strategy-(KS6-KT6))/(Overall_harmonious_var_max_cons+Overall_fix_cons+(KS6-KT6)+MAX(0,(Overall_harmonious_var_heat_max_cons+Overall_heat_fix_cons-KR6))/El_boiler_eff)*(Overall_harmonious_var_heat_max_cons+Overall_heat_fix_cons))/(Overall_harmonious_var_heat_max_cons+Overall_heat_fix_cons)*(Overall_harmonious_var_max_cons+Overall_fix_cons))<Overall_harmonious_var_min_cons+Overall_fix_cons,0,MIN(Overall_harmonious_var_max_cons+Overall_fix_cons,KQ6+Grid_import_max_ud*Grid_import_yes_no_PB_strategy-(KS6-KT6),MIN(KR6+El_boiler_cap_ud*El_boiler_eff,(KQ6+Grid_import_max_ud*Grid_import_yes_no_PB_strategy-(KS6-KT6))/(Overall_harmonious_var_max_cons+Overall_fix_cons+(KS6-KT6)+MAX(0,(Overall_harmonious_var_heat_max_cons+Overall_heat_fix_cons-KR6))/El_boiler_eff)*(Overall_harmonious_var_heat_max_cons+Overall_heat_fix_cons))/(Overall_harmonious_var_heat_max_cons+Overall_heat_fix_cons)*(Overall_harmonious_var_max_cons+Overall_fix_cons)))", "LN" : "=IF(AND(LM6>0,LM5=0,OR(LM6=0,LM7=0)),0,LM6)", "LO" : "=LN6/(Overall_harmonious_var_max_cons+Overall_fix_cons)*(Overall_harmonious_var_heat_max_cons+Overall_heat_fix_cons)", "LP" : "=MAX(0,IF(KI6>0,KD6,0)+KQ6-(KS6-KT6)-LN6-KZ6-MAX(0,(LO6+LA6-IF(KI6>0,KH6/PB_Ratio_Heat_input_vs_output,0)-KR6)/El_boiler_eff))", "LQ" : "=MAX(0,KR6+IF(KI6=0,0,KH6/PB_Ratio_Heat_input_vs_output)-LO6-LA6)", "LR" : "=MAX(0,-(IF(KI6>0,KD6,0)+KQ6-(KS6-KT6)-LN6-KZ6-MAX(0,(LO6+LA6-IF(KI6>0,KH6/PB_Ratio_Heat_input_vs_output,0)-KR6)/El_boiler_eff)))", "LS" : "=Grid_import_max_ud-LR6", "LT" : "=MIN(El_boiler_cap_ud,MAX(0,(LO6+LA6-KR6-IF(KI6>0,KH6/PB_Ratio_Heat_input_vs_output,0))/El_boiler_eff))", "LU" : "=MAX(0,El_boiler_cap_ud-LT6)", "LV" : "=MAX(0,1-LN6/(Overall_harmonious_var_max_cons+Overall_fix_cons)*MethSynt_harmonious_max_perc)*MethSynt_RawMeth_nom_prod_ud", "LW" : "=MAX(0,1-LN6/(Overall_harmonious_var_max_cons+Overall_fix_cons)*CCU_harmonious_max_perc)*CCU_CO2_nom_prod_ud", "LX" : "=MAX(0,1-LN6/(Overall_harmonious_var_max_cons+Overall_fix_cons)*EY_harmonious_max_perc)*EY_Hydrogen_nom_prod", "LY" : "=MIN(BESS_chrg_max_cons,LP6)", "LZ" : "=MIN(Grid_export_max_ud,LP6)",  "MB" : "=VLOOKUP($BO6,DailyCalc_1$A$3:$BI$367,COLUMN(DailyCalc_1BI$3))", "MC" : "=IF($BM6>0,0,IF(C_overall_var_max_cons*MB6+C_overall_fix_stby_cons+$BK6+IF($BM7=0,0,C_overall_stup_cons)+MAX(0,C_overall_var_heat_max_cons*MB6+C_overall_heat_fix_stby_cons+IF($BM7=0,0,C_overall_heat_stup_cons)-$BQ6)/El_boiler_eff<$BP6-PB_stby_aux_cons,0,C_overall_var_max_cons*MB6+C_overall_fix_stby_cons+IF($BM7=0,0,C_overall_stup_cons)))", "MD" : "=IF(AND(MC7>0,MC6=0,MC5>0),MC5,MC6)", "ME" : "=IF(MD6=0,0,$BK6+((MIN(PB_nom_net_cap,MAX(PB_net_min_cap,(1+TES_aux_cons_perc)*(MD6+$BK6-$BP6)))+PB_nom_net_cap*PB_nom_var_aux_cons_perc_net*POLY(MIN(PB_nom_net_cap,MAX(PB_net_min_cap,(1+TES_aux_cons_perc)*(MD6+$BK6-$BP6)))/PB_nom_net_cap,PB_n2g_var_aux_el_Coeff)+PB_fix_aux_el)/(PB_gross_min_eff+(PB_nom_gross_eff-PB_gross_min_eff)/(PB_nom_net_cap-PB_net_min_cap)*(MIN(PB_nom_net_cap,MAX(0,MD6+$BK6-$BP6))-PB_net_min_cap))+MAX(0,C_overall_var_heat_max_cons*MB6+C_overall_heat_fix_stby_cons-$BQ6)*PB_Ratio_Heat_input_vs_output)*TES_aux_cons_perc+IF(AND(MD6=0,MD7>0),MAX(0,IF(COUNTIF(MD1:MD6,\"0\")=PB_warm_start_duration,PB_warm_start_heat_req,PB_hot_start_heat_req)-$BQ6)*TES_aux_cons_perc,0))", "MF" : "=IF(MD6=0,0,MAX(PB_net_min_cap,MIN(PB_nom_net_cap,MD6+ME6-$BP6)))", "MG" : "=IF(MF6=0,0,MF6+PB_nom_net_cap*PB_nom_var_aux_cons_perc_net*POLY(MF6/PB_nom_net_cap,PB_n2g_var_aux_el_Coeff)+PB_fix_aux_el)", "MH" : "=IF(AND(MG6=0,MG7>0),IF(COUNTIF(MG1:MG6,\"0\")=PB_warm_start_duration,PB_warm_start_heat_req,PB_hot_start_heat_req),0)", "MI" : "=IF(MG6=0,0,MG6/PB_nom_gross_eff/POLY(MG6/PB_nom_gross_cap_ud,el_Coeff))", "MJ" : "=IF(MI6=0,0,MAX(0,PB_Ratio_Heat_input_vs_output*(MIN(C_overall_var_heat_max_cons*MB6+C_overall_heat_fix_stby_cons+IF($BM7=0,0,C_overall_heat_stup_cons),(MF6-ME6+$BP6)/(C_overall_var_max_cons*MB6+C_overall_fix_stby_cons+IF($BM7=0,0,C_overall_stup_cons))*(C_overall_var_heat_max_cons*MB6+C_overall_heat_fix_stby_cons+IF($BM7=0,0,C_overall_heat_stup_cons)))-$BQ6-MAX(0,MF6-MD6-ME6)*El_boiler_eff)))", "MK" : "=IF(MIN(SUMIF($BO$5:$BO$8763,\"=\"&$BO6,$AY$5:$AY$8763)*Heater_eff*(1+1/Ratio_CSP_vs_Heater),TES_thermal_cap)<SUMIF($BO$5:$BO$8763,\"=\"&$BO6,MH$5:MH$8763)+SUMIF($BO$5:$BO$8763,\"=\"&$BO6,MI$5:MI$8763)+SUMIF($BO$5:$BO$8763,\"=\"&$BO6,MJ$5:MJ$8763),0,SUMIF($BO$5:$BO$8763,\"=\"&$BO6,MH$5:MH$8763)+SUMIF($BO$5:$BO$8763,\"=\"&$BO6,MI$5:MI$8763)+SUMIF($BO$5:$BO$8763,\"=\"&$BO6,MJ$5:MJ$8763))", "ML" : "=IF(MK6=0,0,MAX(0,SUMIF($BO$5:$BO$8763,\"=\"&$BO6,$AY$5:$AY$8763)*Heater_eff*(1+1/Ratio_CSP_vs_Heater)-MK6))", "MM" : "=IF(OR(AND(ML6>0,$AY6>0,$AY5=0),AND(ML6>0,$AY7=0,$AY6>0)),$AY6,0)", "MN" : "=MAX(0,ML6-SUMIF($BO$5:$BO$8763,\"=\"&$BO6,MM$5:MM$8763)*Heater_eff*(1+1/Ratio_CSP_vs_Heater))", "MO" : "=IF(ML6=0,0,$AY6-(ML6-MN6)/(SUMIF($BO$5:$BO$8763,\"=\"&$BO6,MM$5:MM$8763)*Heater_eff*(1+1/Ratio_CSP_vs_Heater))*MM6)", "MP" : "=IF(OR(MO6=0,MN6=0),0,MAX(($AW6-MO6)/(MN6/(1+1/Ratio_CSP_vs_Heater)/Heater_eff/COUNTIFS($BO$5:$BO$8763,\"=\"&$BO6,MO$5:MO$8763,\">0\")),($J6-MO6*Heater_eff/Ratio_CSP_vs_Heater)/(MN6/(1+Ratio_CSP_vs_Heater)/COUNTIFS($BO$5:$BO$8763,\"=\"&$BO6,MO$5:MO$8763,\">0\")))/SUMIF($BO$5:$BO$8763,\"=\"&$BO6,MO$5:MO$8763)*MO6)", "MQ" : "=IF(MK6=0,0,MO6-IF(MN6=0,0,MN6/(1+1/Ratio_CSP_vs_Heater)/Heater_eff/SUMIF($BO$5:$BO$8763,\"=\"&$BO6,MP$5:MP$8763)*MP6))", "MR" : "=MIN($J6,MQ6*Heater_eff/Ratio_CSP_vs_Heater)", "MS" : "=MAX(0,$L6-MQ6)", "MT" : "=MAX(0,$J6-MR6)", "MU" : "=IF($J6>0,$J6*CSP_var_aux_nom_perc,CSP_nonsolar_aux_cons)+$M6+(MQ6*Heater_eff+MR6)*TES_aux_cons_perc+IF(OR(MG6=0,AND(MG6>0,MK6=0)),PB_stby_aux_cons+MH6*TES_aux_cons_perc,(MH6+MI6+MJ6)*TES_aux_cons_perc)", "MV" : "=MAX(0,-($L6+IF(MK6>0,MF6,0)-MQ6-MU6))",  "MX" : "=IF(MIN(Overall_harmonious_var_max_cons+Overall_fix_cons,MS6+Grid_import_max_ud*Grid_import_yes_no_PB_strategy-(MU6-MV6),MIN(MT6+El_boiler_cap_ud*El_boiler_eff,(MS6+Grid_import_max_ud*Grid_import_yes_no_PB_strategy-(MU6-MV6))/(Overall_harmonious_var_max_cons+Overall_fix_cons+(MU6-MV6)+MAX(0,(Overall_harmonious_var_heat_max_cons+Overall_heat_fix_cons-MT6))/El_boiler_eff)*(Overall_harmonious_var_heat_max_cons+Overall_heat_fix_cons))/(Overall_harmonious_var_heat_max_cons+Overall_heat_fix_cons)*(Overall_harmonious_var_max_cons+Overall_fix_cons))<Overall_harmonious_var_min_cons+Overall_fix_cons,0,Overall_harmonious_var_min_cons+Overall_fix_cons)", "MY" : "=IF(AND(MX6>0,MX5=0,OR(MX6=0,MX7=0)),0,MX6)", "MZ" : "=MY6/(Overall_harmonious_var_max_cons+Overall_fix_cons)*(Overall_harmonious_var_heat_max_cons+Overall_heat_fix_cons)", "NA" : "=IF(AND(MY5<=0,MY6>0),NA5+1,IF(AND(MS6>0,$BO6<>$BO5,SUM(MY6:MY8)=0),NA5+1,NA5))", "NB" : "=IF(OR(MY6>0,MK6=0),0,MIN((MF6+MS6+(MT6+MJ6/PB_Ratio_Heat_input_vs_output)/El_boiler_eff-(MU6-MV6))/(C_overall_var_max_cons*MB6+C_overall_fix_stby_cons+IF(MY7=0,0,C_overall_stup_cons)+(C_overall_var_heat_max_cons*MB6+C_overall_heat_fix_stby_cons+IF(MZ7=0,0,C_overall_heat_stup_cons))/El_boiler_eff)*(C_overall_var_max_cons*MB6+C_overall_fix_stby_cons+IF(MY7=0,0,C_overall_stup_cons)),C_overall_var_max_cons*MB6+C_overall_fix_stby_cons+IF(MY7=0,0,C_overall_stup_cons)))", "NC" : "=IF(NB6=0,0,MIN((MF6+MS6+(MT6+MJ6/PB_Ratio_Heat_input_vs_output)/El_boiler_eff-(MU6-MV6))/(C_overall_var_max_cons*MB6+C_overall_fix_stby_cons+IF(MY7=0,0,C_overall_stup_cons)+(C_overall_var_heat_max_cons*MB6+C_overall_heat_fix_stby_cons+IF(MZ7=0,0,C_overall_heat_stup_cons))/El_boiler_eff)*(C_overall_var_heat_max_cons*MB6+C_overall_heat_fix_stby_cons+IF(MZ7=0,0,C_overall_heat_stup_cons)),C_overall_var_heat_max_cons*MB6+C_overall_heat_fix_stby_cons+IF(MZ7=0,0,C_overall_heat_stup_cons)))", "ND" : "=MAX(0,IF(MK6>0,MF6,0)+MS6-(MU6-MV6)-MY6-NB6-MAX(0,(MZ6+NC6-IF(MK6>0,MJ6/PB_Ratio_Heat_input_vs_output,0)-MT6)/El_boiler_eff))", "NE" : "=MAX(0,MT6+IF(MK6=0,0,MJ6/PB_Ratio_Heat_input_vs_output)-MZ6-NC6)", "NF" : "=MAX(0,-(IF(MK6>0,MF6,0)+MS6-(MU6-MV6)-MY6-NB6-MAX(0,(MZ6+NC6-IF(MK6>0,MJ6/PB_Ratio_Heat_input_vs_output,0)-MT6)/El_boiler_eff)))", "NG" : "=Grid_import_max_ud-NF6", "NH" : "=MIN(El_boiler_cap_ud,MAX(0,(MZ6+NC6-MT6-IF(MK6>0,MJ6/PB_Ratio_Heat_input_vs_output,0))/El_boiler_eff))", "NI" : "=MAX(0,El_boiler_cap_ud-NH6)", "NJ" : "=MAX(0,1-MY6/(Overall_harmonious_var_max_cons+Overall_fix_cons)*MethSynt_harmonious_max_perc)*MethSynt_RawMeth_nom_prod_ud", "NK" : "=MAX(0,1-MY6/(Overall_harmonious_var_max_cons+Overall_fix_cons)*CCU_harmonious_max_perc)*CCU_CO2_nom_prod_ud", "NL" : "=MAX(0,1-MY6/(Overall_harmonious_var_max_cons+Overall_fix_cons)*EY_harmonious_max_perc)*EY_Hydrogen_nom_prod", "NM" : "=MIN(BESS_chrg_max_cons,ND6)", "NN" : "=MIN(Grid_export_max_ud,ND6)", "NO" : "=IF(MIN(Overall_harmonious_var_max_cons+Overall_fix_cons,MS6+Grid_import_max_ud*Grid_import_yes_no_PB_strategy-(MU6-MV6),MIN(MT6+El_boiler_cap_ud*El_boiler_eff,(MS6+Grid_import_max_ud*Grid_import_yes_no_PB_strategy-(MU6-MV6))/(Overall_harmonious_var_max_cons+Overall_fix_cons+(MU6-MV6)+MAX(0,(Overall_harmonious_var_heat_max_cons+Overall_heat_fix_cons-MT6))/El_boiler_eff)*(Overall_harmonious_var_heat_max_cons+Overall_heat_fix_cons))/(Overall_harmonious_var_heat_max_cons+Overall_heat_fix_cons)*(Overall_harmonious_var_max_cons+Overall_fix_cons))<Overall_harmonious_var_min_cons+Overall_fix_cons,0,MIN(Overall_harmonious_var_max_cons+Overall_fix_cons,MS6+Grid_import_max_ud*Grid_import_yes_no_PB_strategy-(MU6-MV6),MIN(MT6+El_boiler_cap_ud*El_boiler_eff,(MS6+Grid_import_max_ud*Grid_import_yes_no_PB_strategy-(MU6-MV6))/(Overall_harmonious_var_max_cons+Overall_fix_cons+(MU6-MV6)+MAX(0,(Overall_harmonious_var_heat_max_cons+Overall_heat_fix_cons-MT6))/El_boiler_eff)*(Overall_harmonious_var_heat_max_cons+Overall_heat_fix_cons))/(Overall_harmonious_var_heat_max_cons+Overall_heat_fix_cons)*(Overall_harmonious_var_max_cons+Overall_fix_cons)))", "NP" : "=IF(AND(NO6>0,NO5=0,OR(NO6=0,NO7=0)),0,NO6)", "NQ" : "=NP6/(Overall_harmonious_var_max_cons+Overall_fix_cons)*(Overall_harmonious_var_heat_max_cons+Overall_heat_fix_cons)", "NR" : "=MAX(0,IF(MK6>0,MF6,0)+MS6-(MU6-MV6)-NP6-NB6-MAX(0,(NQ6+NC6-IF(MK6>0,MJ6/PB_Ratio_Heat_input_vs_output,0)-MT6)/El_boiler_eff))", "NS" : "=MAX(0,MT6+IF(MK6=0,0,MJ6/PB_Ratio_Heat_input_vs_output)-NQ6-NC6)", "NT" : "=MAX(0,-(IF(MK6>0,MF6,0)+MS6-(MU6-MV6)-NP6-NB6-MAX(0,(NQ6+NC6-IF(MK6>0,MJ6/PB_Ratio_Heat_input_vs_output,0)-MT6)/El_boiler_eff)))", "NU" : "=Grid_import_max_ud-NT6", "NV" : "=MIN(El_boiler_cap_ud,MAX(0,(NQ6+NC6-MT6-IF(MK6>0,MJ6/PB_Ratio_Heat_input_vs_output,0))/El_boiler_eff))", "NW" : "=MAX(0,El_boiler_cap_ud-NV6)", "NX" : "=MAX(0,1-NP6/(Overall_harmonious_var_max_cons+Overall_fix_cons)*MethSynt_harmonious_max_perc)*MethSynt_RawMeth_nom_prod_ud", "NY" : "=MAX(0,1-NP6/(Overall_harmonious_var_max_cons+Overall_fix_cons)*CCU_harmonious_max_perc)*CCU_CO2_nom_prod_ud", "NZ" : "=MAX(0,1-NP6/(Overall_harmonious_var_max_cons+Overall_fix_cons)*EY_harmonious_max_perc)*EY_Hydrogen_nom_prod", "OA" : "=MIN(BESS_chrg_max_cons,NR6)", "OB" : "=MIN(Grid_export_max_ud,NR6)",  "OD" : "=IF($BM6>0,0,IF(D_overall_var_min_cons+D_overall_fix_stby_cons+$BK6+IF($BM7=0,0,D_overall_stup_cons)+MAX(0,D_overall_var_heat_min_cons+D_overall_heat_fix_stby_cons+IF($BM7=0,0,D_overall_heat_stup_cons)-$BQ6)/El_boiler_eff<$BP6-PB_stby_aux_cons,0,D_overall_var_min_cons+D_overall_fix_stby_cons+IF($BM7=0,0,D_overall_stup_cons)))", "OE" : "=IF(AND(OD7>0,OD6=0,OD5>0),OD5,OD6)", "OF" : "=IF(OE6=0,0,$BK6+((MIN(PB_nom_net_cap,MAX(PB_net_min_cap,(1+TES_aux_cons_perc)*(OE6+$BK6-$BP6)))+PB_nom_net_cap*PB_nom_var_aux_cons_perc_net*POLY(MIN(PB_nom_net_cap,MAX(PB_net_min_cap,(1+TES_aux_cons_perc)*(OE6+$BK6-$BP6)))/PB_nom_net_cap,PB_n2g_var_aux_el_Coeff)+PB_fix_aux_el)/(PB_gross_min_eff+(PB_nom_gross_eff-PB_gross_min_eff)/(PB_nom_net_cap-PB_net_min_cap)*(MIN(PB_nom_net_cap,MAX(0,OE6+$BK6-$BP6))-PB_net_min_cap))+MAX(0,D_overall_var_heat_min_cons+D_overall_heat_fix_stby_cons-$BQ6)*PB_Ratio_Heat_input_vs_output)*TES_aux_cons_perc+IF(AND(OE6=0,OE7>0),MAX(0,IF(COUNTIF(OE1:OE6,\"0\")=PB_warm_start_duration,PB_warm_start_heat_req,PB_hot_start_heat_req)-$BQ6)*TES_aux_cons_perc,0))", "OG" : "=IF(OE6=0,0,MAX(PB_net_min_cap,MIN(PB_nom_net_cap,OE6+OF6-$BP6)))", "OH" : "=IF(OG6=0,0,OG6+PB_nom_net_cap*PB_nom_var_aux_cons_perc_net*POLY(OG6/PB_nom_net_cap,PB_n2g_var_aux_el_Coeff)+PB_fix_aux_el)", "OI" : "=IF(AND(OH6=0,OH7>0),IF(COUNTIF(OH1:OH6,\"0\")=PB_warm_start_duration,PB_warm_start_heat_req,PB_hot_start_heat_req),0)", "OJ" : "=IF(OH6=0,0,OH6/PB_nom_gross_eff/POLY(OH6/PB_nom_gross_cap_ud,el_Coeff))", "OK" : "=IF(OJ6=0,0,MAX(0,PB_Ratio_Heat_input_vs_output*(MIN(D_overall_var_heat_min_cons+D_overall_heat_fix_stby_cons+IF($BM7=0,0,D_overall_heat_stup_cons),(OG6-OF6+$BP6)/(D_overall_var_min_cons+D_overall_fix_stby_cons+IF($BM7=0,0,D_overall_stup_cons))*(D_overall_var_heat_min_cons+D_overall_heat_fix_stby_cons+IF($BM7=0,0,D_overall_heat_stup_cons)))-$BQ6-MAX(0,OG6-OE6-OF6)*El_boiler_eff)))", "OL" : "=IF(MIN(SUMIF($BO$5:$BO$8763,\"=\"&$BO6,$AY$5:$AY$8763)*Heater_eff*(1+1/Ratio_CSP_vs_Heater),TES_thermal_cap)<SUMIF($BO$5:$BO$8763,\"=\"&$BO6,OI$5:OI$8763)+SUMIF($BO$5:$BO$8763,\"=\"&$BO6,OJ$5:OJ$8763)+SUMIF($BO$5:$BO$8763,\"=\"&$BO6,OK$5:OK$8763),0,SUMIF($BO$5:$BO$8763,\"=\"&$BO6,OI$5:OI$8763)+SUMIF($BO$5:$BO$8763,\"=\"&$BO6,OJ$5:OJ$8763)+SUMIF($BO$5:$BO$8763,\"=\"&$BO6,OK$5:OK$8763))", "OM" : "=IF(OL6=0,0,MAX(0,SUMIF($BO$5:$BO$8763,\"=\"&$BO6,$AY$5:$AY$8763)*Heater_eff*(1+1/Ratio_CSP_vs_Heater)-OL6))", "ON" : "=IF(OR(AND(OM6>0,$AY6>0,$AY5=0),AND(OM6>0,$AY7=0,$AY6>0)),$AY6,0)", "OO" : "=MAX(0,OM6-SUMIF($BO$5:$BO$8763,\"=\"&$BO6,ON$5:ON$8763)*Heater_eff*(1+1/Ratio_CSP_vs_Heater))", "OP" : "=IF(OM6=0,0,$AY6-(OM6-OO6)/(SUMIF($BO$5:$BO$8763,\"=\"&$BO6,ON$5:ON$8763)*Heater_eff*(1+1/Ratio_CSP_vs_Heater))*ON6)", "OQ" : "=IF(OR(OP6=0,OO6=0),0,MAX(($AW6-OP6)/(OO6/(1+1/Ratio_CSP_vs_Heater)/Heater_eff/COUNTIFS($BO$5:$BO$8763,\"=\"&$BO6,OP$5:OP$8763,\">0\")),($J6-OP6*Heater_eff/Ratio_CSP_vs_Heater)/(OO6/(1+Ratio_CSP_vs_Heater)/COUNTIFS($BO$5:$BO$8763,\"=\"&$BO6,OP$5:OP$8763,\">0\")))/SUMIF($BO$5:$BO$8763,\"=\"&$BO6,OP$5:OP$8763)*OP6)", "OR" : "=IF(OL6=0,0,OP6-IF(OO6=0,0,OO6/(1+1/Ratio_CSP_vs_Heater)/Heater_eff/SUMIF($BO$5:$BO$8763,\"=\"&$BO6,OQ$5:OQ$8763)*OQ6))", "OS" : "=MIN($J6,OR6*Heater_eff/Ratio_CSP_vs_Heater)", "OT" : "=MAX(0,$L6-OR6)", "OU" : "=MAX(0,$J6-OS6)", "OV" : "=IF($J6>0,$J6*CSP_var_aux_nom_perc,CSP_nonsolar_aux_cons)+$M6+(OR6*Heater_eff+OS6)*TES_aux_cons_perc+IF(OR(OH6=0,AND(OH6>0,OL6=0)),PB_stby_aux_cons+OI6*TES_aux_cons_perc,(OI6+OJ6+OK6)*TES_aux_cons_perc)", "OW" : "=MAX(0,-($L6+IF(OL6>0,OG6,0)-OR6-OV6))",  "OY" : "=IF(MIN(Overall_harmonious_var_max_cons+Overall_fix_cons,OT6+Grid_import_max_ud*Grid_import_yes_no_PB_strategy-(OV6-OW6),MIN(OU6+El_boiler_cap_ud*El_boiler_eff,(OT6+Grid_import_max_ud*Grid_import_yes_no_PB_strategy-(OV6-OW6))/(Overall_harmonious_var_max_cons+Overall_fix_cons+(OV6-OW6)+MAX(0,(Overall_harmonious_var_heat_max_cons+Overall_heat_fix_cons-OU6))/El_boiler_eff)*(Overall_harmonious_var_heat_max_cons+Overall_heat_fix_cons))/(Overall_harmonious_var_heat_max_cons+Overall_heat_fix_cons)*(Overall_harmonious_var_max_cons+Overall_fix_cons))<Overall_harmonious_var_min_cons+Overall_fix_cons,0,Overall_harmonious_var_min_cons+Overall_fix_cons)", "OZ" : "=IF(AND(OY6>0,OY5=0,OR(OY6=0,OY7=0)),0,OY6)", "PA" : "=OZ6/(Overall_harmonious_var_max_cons+Overall_fix_cons)*(Overall_harmonious_var_heat_max_cons+Overall_heat_fix_cons)", "PB" : "=IF(AND(OZ5<=0,OZ6>0),PB5+1,IF(AND(OT6>0,$BO6<>$BO5,SUM(OZ6:OZ8)=0),PB5+1,PB5))", "PC" : "=IF(OR(OZ6>0,OL6=0),0,MIN((OG6+OT6+(OU6+OK6/PB_Ratio_Heat_input_vs_output)/El_boiler_eff-(OV6-OW6))/(D_overall_var_min_cons+D_overall_fix_stby_cons+IF(OZ7=0,0,D_overall_stup_cons)+(D_overall_var_heat_min_cons+D_overall_heat_fix_stby_cons+IF(PA7=0,0,D_overall_heat_stup_cons))/El_boiler_eff)*(D_overall_var_min_cons+D_overall_fix_stby_cons+IF(OZ7=0,0,D_overall_stup_cons)),D_overall_var_min_cons+D_overall_fix_stby_cons+IF(OZ7=0,0,D_overall_stup_cons)))", "PD" : "=IF(PC6=0,0,MIN((OG6+OT6+(OU6+OK6/PB_Ratio_Heat_input_vs_output)/El_boiler_eff-(OV6-OW6))/(D_overall_var_min_cons+D_overall_fix_stby_cons+IF(OZ7=0,0,D_overall_stup_cons)+(D_overall_var_heat_min_cons+D_overall_heat_fix_stby_cons+IF(PA7=0,0,D_overall_heat_stup_cons))/El_boiler_eff)*(D_overall_var_heat_min_cons+D_overall_heat_fix_stby_cons+IF(PA7=0,0,D_overall_heat_stup_cons)),D_overall_var_heat_min_cons+D_overall_heat_fix_stby_cons+IF(PA7=0,0,D_overall_heat_stup_cons)))", "PE" : "=MAX(0,IF(OL6>0,OG6,0)+OT6-(OV6-OW6)-OZ6-PC6-MAX(0,(PA6+PD6-IF(OL6>0,OK6/PB_Ratio_Heat_input_vs_output,0)-OU6)/El_boiler_eff))", "PF" : "=MAX(0,OU6+IF(OL6=0,0,OK6/PB_Ratio_Heat_input_vs_output)-PA6-PD6)", "PG" : "=MAX(0,-(IF(OL6>0,OG6,0)+OT6-(OV6-OW6)-OZ6-PC6-MAX(0,(PA6+PD6-IF(OL6>0,OK6/PB_Ratio_Heat_input_vs_output,0)-OU6)/El_boiler_eff)))", "PH" : "=Grid_import_max_ud-PG6", "PI" : "=MIN(El_boiler_cap_ud,MAX(0,(PA6+PD6-OU6-IF(OL6>0,OK6/PB_Ratio_Heat_input_vs_output,0))/El_boiler_eff))", "PJ" : "=MAX(0,El_boiler_cap_ud-PI6)", "PK" : "=MAX(0,1-OZ6/(Overall_harmonious_var_max_cons+Overall_fix_cons)*MethSynt_harmonious_max_perc)*MethSynt_RawMeth_nom_prod_ud", "PL" : "=MAX(0,1-OZ6/(Overall_harmonious_var_max_cons+Overall_fix_cons)*CCU_harmonious_max_perc)*CCU_CO2_nom_prod_ud", "PM" : "=MAX(0,1-OZ6/(Overall_harmonious_var_max_cons+Overall_fix_cons)*EY_harmonious_max_perc)*EY_Hydrogen_nom_prod", "PN" : "=MIN(BESS_chrg_max_cons,PE6)", "PO" : "=MIN(Grid_export_max_ud,PE6)", "PP" : "=IF(MIN(Overall_harmonious_var_max_cons+Overall_fix_cons,OT6+Grid_import_max_ud*Grid_import_yes_no_PB_strategy-(OV6-OW6),MIN(OU6+El_boiler_cap_ud*El_boiler_eff,(OT6+Grid_import_max_ud*Grid_import_yes_no_PB_strategy-(OV6-OW6))/(Overall_harmonious_var_max_cons+Overall_fix_cons+(OV6-OW6)+MAX(0,(Overall_harmonious_var_heat_max_cons+Overall_heat_fix_cons-OU6))/El_boiler_eff)*(Overall_harmonious_var_heat_max_cons+Overall_heat_fix_cons))/(Overall_harmonious_var_heat_max_cons+Overall_heat_fix_cons)*(Overall_harmonious_var_max_cons+Overall_fix_cons))<Overall_harmonious_var_min_cons+Overall_fix_cons,0,MIN(Overall_harmonious_var_max_cons+Overall_fix_cons,OT6+Grid_import_max_ud*Grid_import_yes_no_PB_strategy-(OV6-OW6),MIN(OU6+El_boiler_cap_ud*El_boiler_eff,(OT6+Grid_import_max_ud*Grid_import_yes_no_PB_strategy-(OV6-OW6))/(Overall_harmonious_var_max_cons+Overall_fix_cons+(OV6-OW6)+MAX(0,(Overall_harmonious_var_heat_max_cons+Overall_heat_fix_cons-OU6))/El_boiler_eff)*(Overall_harmonious_var_heat_max_cons+Overall_heat_fix_cons))/(Overall_harmonious_var_heat_max_cons+Overall_heat_fix_cons)*(Overall_harmonious_var_max_cons+Overall_fix_cons)))", "PQ" : "=IF(AND(PP6>0,PP5=0,OR(PP6=0,PP7=0)),0,PP6)", "PR" : "=PQ6/(Overall_harmonious_var_max_cons+Overall_fix_cons)*(Overall_harmonious_var_heat_max_cons+Overall_heat_fix_cons)", "PS" : "=MAX(0,IF(OL6>0,OG6,0)+OT6-(OV6-OW6)-PQ6-PC6-MAX(0,(PR6+PD6-IF(OL6>0,OK6/PB_Ratio_Heat_input_vs_output,0)-OU6)/El_boiler_eff))", "PT" : "=MAX(0,OU6+IF(OL6=0,0,OK6/PB_Ratio_Heat_input_vs_output)-PR6-PD6)", "PU" : "=MAX(0,-(IF(OL6>0,OG6,0)+OT6-(OV6-OW6)-PQ6-PC6-MAX(0,(PR6+PD6-IF(OL6>0,OK6/PB_Ratio_Heat_input_vs_output,0)-OU6)/El_boiler_eff)))", "PV" : "=Grid_import_max_ud-PU6", "PW" : "=MIN(El_boiler_cap_ud,MAX(0,(PR6+PD6-OU6-IF(OL6>0,OK6/PB_Ratio_Heat_input_vs_output,0))/El_boiler_eff))", "PX" : "=MAX(0,El_boiler_cap_ud-PW6)", "PY" : "=MAX(0,1-PQ6/(Overall_harmonious_var_max_cons+Overall_fix_cons)*MethSynt_harmonious_max_perc)*MethSynt_RawMeth_nom_prod_ud", "PZ" : "=MAX(0,1-PQ6/(Overall_harmonious_var_max_cons+Overall_fix_cons)*CCU_harmonious_max_perc)*CCU_CO2_nom_prod_ud", "QA" : "=MAX(0,1-PQ6/(Overall_harmonious_var_max_cons+Overall_fix_cons)*EY_harmonious_max_perc)*EY_Hydrogen_nom_prod", "QB" : "=MIN(BESS_chrg_max_cons,PS6)", "QC" : "=MIN(Grid_export_max_ud,PS6)",  "QE" : "=VLOOKUP($BO6,DailyCalc_1$A$3:$CC$367,COLUMN(DailyCalc_1CC$3))", "QF" : "=IF($BM6>0,0,IF(D_overall_var_max_cons*QE6+D_overall_fix_stby_cons+$BK6+IF($BM7=0,0,D_overall_stup_cons)+MAX(0,D_overall_var_heat_max_cons*QE6+D_overall_heat_fix_stby_cons+IF($BM7=0,0,D_overall_heat_stup_cons)-$BQ6)/El_boiler_eff<$BP6-PB_stby_aux_cons,0,D_overall_var_max_cons*QE6+D_overall_fix_stby_cons+IF($BM7=0,0,D_overall_stup_cons)))", "QG" : "=IF(AND(QF7>0,QF6=0,QF5>0),QF5,QF6)", "QH" : "=IF(QG6=0,0,$BK6+((MIN(PB_nom_net_cap,MAX(PB_net_min_cap,(1+TES_aux_cons_perc)*(QG6+$BK6-$BP6)))+PB_nom_net_cap*PB_nom_var_aux_cons_perc_net*POLY(MIN(PB_nom_net_cap,MAX(PB_net_min_cap,(1+TES_aux_cons_perc)*(QG6+$BK6-$BP6)))/PB_nom_net_cap,PB_n2g_var_aux_el_Coeff)+PB_fix_aux_el)/(PB_gross_min_eff+(PB_nom_gross_eff-PB_gross_min_eff)/(PB_nom_net_cap-PB_net_min_cap)*(MIN(PB_nom_net_cap,MAX(0,QG6+$BK6-$BP6))-PB_net_min_cap))+MAX(0,D_overall_var_heat_max_cons*QE6+D_overall_heat_fix_stby_cons-$BQ6)*PB_Ratio_Heat_input_vs_output)*TES_aux_cons_perc+IF(AND(QG6=0,QG7>0),MAX(0,IF(COUNTIF(QG1:QG6,\"0\")=PB_warm_start_duration,PB_warm_start_heat_req,PB_hot_start_heat_req)-$BQ6)*TES_aux_cons_perc,0))", "QI" : "=IF(QG6=0,0,MAX(PB_net_min_cap,MIN(PB_nom_net_cap,QG6+QH6-$BP6)))", "QJ" : "=IF(QI6=0,0,QI6+PB_nom_net_cap*PB_nom_var_aux_cons_perc_net*POLY(QI6/PB_nom_net_cap,PB_n2g_var_aux_el_Coeff)+PB_fix_aux_el)", "QK" : "=IF(AND(QJ6=0,QJ7>0),IF(COUNTIF(QJ1:QJ6,\"0\")=PB_warm_start_duration,PB_warm_start_heat_req,PB_hot_start_heat_req),0)", "QL" : "=IF(QJ6=0,0,QJ6/PB_nom_gross_eff/POLY(QJ6/PB_nom_gross_cap_ud,el_Coeff))", "QM" : "=IF(QL6=0,0,MAX(0,PB_Ratio_Heat_input_vs_output*(MIN(D_overall_var_heat_max_cons*QE6+D_overall_heat_fix_stby_cons+IF($BM7=0,0,D_overall_heat_stup_cons),(QI6-QH6+$BP6)/(D_overall_var_max_cons*QE6+D_overall_fix_stby_cons+IF($BM7=0,0,D_overall_stup_cons))*(D_overall_var_heat_max_cons*QE6+D_overall_heat_fix_stby_cons+IF($BM7=0,0,D_overall_heat_stup_cons)))-$BQ6-MAX(0,QI6-QG6-QH6)*El_boiler_eff)))", "QN" : "=IF(MIN(SUMIF($BO$5:$BO$8763,\"=\"&$BO6,$AY$5:$AY$8763)*Heater_eff*(1+1/Ratio_CSP_vs_Heater),TES_thermal_cap)<SUMIF($BO$5:$BO$8763,\"=\"&$BO6,QK$5:QK$8763)+SUMIF($BO$5:$BO$8763,\"=\"&$BO6,QL$5:QL$8763)+SUMIF($BO$5:$BO$8763,\"=\"&$BO6,QM$5:QM$8763),0,SUMIF($BO$5:$BO$8763,\"=\"&$BO6,QK$5:QK$8763)+SUMIF($BO$5:$BO$8763,\"=\"&$BO6,QL$5:QL$8763)+SUMIF($BO$5:$BO$8763,\"=\"&$BO6,QM$5:QM$8763))", "QO" : "=IF(QN6=0,0,MAX(0,SUMIF($BO$5:$BO$8763,\"=\"&$BO6,$AY$5:$AY$8763)*Heater_eff*(1+1/Ratio_CSP_vs_Heater)-QN6))", "QP" : "=IF(OR(AND(QO6>0,$AY6>0,$AY5=0),AND(QO6>0,$AY7=0,$AY6>0)),$AY6,0)", "QQ" : "=MAX(0,QO6-SUMIF($BO$5:$BO$8763,\"=\"&$BO6,QP$5:QP$8763)*Heater_eff*(1+1/Ratio_CSP_vs_Heater))", "QR" : "=IF(QO6=0,0,$AY6-(QO6-QQ6)/(SUMIF($BO$5:$BO$8763,\"=\"&$BO6,QP$5:QP$8763)*Heater_eff*(1+1/Ratio_CSP_vs_Heater))*QP6)", "QS" : "=IF(OR(QR6=0,QQ6=0),0,MAX(($AW6-QR6)/(QQ6/(1+1/Ratio_CSP_vs_Heater)/Heater_eff/COUNTIFS($BO$5:$BO$8763,\"=\"&$BO6,QR$5:QR$8763,\">0\")),($J6-QR6*Heater_eff/Ratio_CSP_vs_Heater)/(QQ6/(1+Ratio_CSP_vs_Heater)/COUNTIFS($BO$5:$BO$8763,\"=\"&$BO6,QR$5:QR$8763,\">0\")))/SUMIF($BO$5:$BO$8763,\"=\"&$BO6,QR$5:QR$8763)*QR6)", "QT" : "=IF(QN6=0,0,QR6-IF(QQ6=0,0,QQ6/(1+1/Ratio_CSP_vs_Heater)/Heater_eff/SUMIF($BO$5:$BO$8763,\"=\"&$BO6,QS$5:QS$8763)*QS6))", "QU" : "=MIN($J6,QT6*Heater_eff/Ratio_CSP_vs_Heater)", "QV" : "=MAX(0,$L6-QT6)", "QW" : "=MAX(0,$J6-QU6)", "QX" : "=IF($J6>0,$J6*CSP_var_aux_nom_perc,CSP_nonsolar_aux_cons)+$M6+(QT6*Heater_eff+QU6)*TES_aux_cons_perc+IF(OR(QJ6=0,AND(QJ6>0,QN6=0)),PB_stby_aux_cons+QK6*TES_aux_cons_perc,(QK6+QL6+QM6)*TES_aux_cons_perc)", "QY" : "=MAX(0,-($L6+IF(QN6>0,QI6,0)-QT6-QX6))",  "RA" : "=IF(MIN(Overall_harmonious_var_max_cons+Overall_fix_cons,QV6+Grid_import_max_ud*Grid_import_yes_no_PB_strategy-(QX6-QY6),MIN(QW6+El_boiler_cap_ud*El_boiler_eff,(QV6+Grid_import_max_ud*Grid_import_yes_no_PB_strategy-(QX6-QY6))/(Overall_harmonious_var_max_cons+Overall_fix_cons+(QX6-QY6)+MAX(0,(Overall_harmonious_var_heat_max_cons+Overall_heat_fix_cons-QW6))/El_boiler_eff)*(Overall_harmonious_var_heat_max_cons+Overall_heat_fix_cons))/(Overall_harmonious_var_heat_max_cons+Overall_heat_fix_cons)*(Overall_harmonious_var_max_cons+Overall_fix_cons))<Overall_harmonious_var_min_cons+Overall_fix_cons,0,Overall_harmonious_var_min_cons+Overall_fix_cons)", "RB" : "=IF(AND(RA6>0,RA5=0,OR(RA6=0,RA7=0)),0,RA6)", "RC" : "=RB6/(Overall_harmonious_var_max_cons+Overall_fix_cons)*(Overall_harmonious_var_heat_max_cons+Overall_heat_fix_cons)", "RD" : "=IF(AND(RB5<=0,RB6>0),RD5+1,IF(AND(QV6>0,$BO6<>$BO5,SUM(RB6:RB8)=0),RD5+1,RD5))", "RE" : "=IF(OR(RB6>0,QN6=0),0,MIN((QI6+QV6+(QW6+QM6/PB_Ratio_Heat_input_vs_output)/El_boiler_eff-(QX6-QY6))/(D_overall_var_max_cons*QE6+D_overall_fix_stby_cons+IF(RB7=0,0,D_overall_stup_cons)+(D_overall_var_heat_max_cons*QE6+D_overall_heat_fix_stby_cons+IF(RC7=0,0,D_overall_heat_stup_cons))/El_boiler_eff)*(D_overall_var_max_cons*QE6+D_overall_fix_stby_cons+IF(RB7=0,0,D_overall_stup_cons)),D_overall_var_max_cons*QE6+D_overall_fix_stby_cons+IF(RB7=0,0,D_overall_stup_cons)))", "RF" : "=IF(RE6=0,0,MIN((QI6+QV6+(QW6+QM6/PB_Ratio_Heat_input_vs_output)/El_boiler_eff-(QX6-QY6))/(D_overall_var_max_cons*QE6+D_overall_fix_stby_cons+IF(RB7=0,0,D_overall_stup_cons)+(D_overall_var_heat_max_cons*QE6+D_overall_heat_fix_stby_cons+IF(RC7=0,0,D_overall_heat_stup_cons))/El_boiler_eff)*(D_overall_var_heat_max_cons*QE6+D_overall_heat_fix_stby_cons+IF(RC7=0,0,D_overall_heat_stup_cons)),D_overall_var_heat_max_cons*QE6+D_overall_heat_fix_stby_cons+IF(RC7=0,0,D_overall_heat_stup_cons)))", "RG" : "=MAX(0,IF(QN6>0,QI6,0)+QV6-(QX6-QY6)-RB6-RE6-MAX(0,(RC6+RF6-IF(QN6>0,QM6/PB_Ratio_Heat_input_vs_output,0)-QW6)/El_boiler_eff))", "RH" : "=MAX(0,QW6+IF(QN6=0,0,QM6/PB_Ratio_Heat_input_vs_output)-RC6-RF6)", "RI" : "=MAX(0,-(IF(QN6>0,QI6,0)+QV6-(QX6-QY6)-RB6-RE6-MAX(0,(RC6+RF6-IF(QN6>0,QM6/PB_Ratio_Heat_input_vs_output,0)-QW6)/El_boiler_eff)))", "RJ" : "=Grid_import_max_ud-RI6", "RK" : "=MIN(El_boiler_cap_ud,MAX(0,(RC6+RF6-QW6-IF(QN6>0,QM6/PB_Ratio_Heat_input_vs_output,0))/El_boiler_eff))", "RL" : "=MAX(0,El_boiler_cap_ud-RK6)", "RM" : "=MAX(0,1-RB6/(Overall_harmonious_var_max_cons+Overall_fix_cons)*MethSynt_harmonious_max_perc)*MethSynt_RawMeth_nom_prod_ud", "RN" : "=MAX(0,1-RB6/(Overall_harmonious_var_max_cons+Overall_fix_cons)*CCU_harmonious_max_perc)*CCU_CO2_nom_prod_ud", "RO" : "=MAX(0,1-RB6/(Overall_harmonious_var_max_cons+Overall_fix_cons)*EY_harmonious_max_perc)*EY_Hydrogen_nom_prod", "RP" : "=MIN(BESS_chrg_max_cons,RG6)", "RQ" : "=MIN(Grid_export_max_ud,RG6)", "RR" : "=IF(MIN(Overall_harmonious_var_max_cons+Overall_fix_cons,QV6+Grid_import_max_ud*Grid_import_yes_no_PB_strategy-(QX6-QY6),MIN(QW6+El_boiler_cap_ud*El_boiler_eff,(QV6+Grid_import_max_ud*Grid_import_yes_no_PB_strategy-(QX6-QY6))/(Overall_harmonious_var_max_cons+Overall_fix_cons+(QX6-QY6)+MAX(0,(Overall_harmonious_var_heat_max_cons+Overall_heat_fix_cons-QW6))/El_boiler_eff)*(Overall_harmonious_var_heat_max_cons+Overall_heat_fix_cons))/(Overall_harmonious_var_heat_max_cons+Overall_heat_fix_cons)*(Overall_harmonious_var_max_cons+Overall_fix_cons))<Overall_harmonious_var_min_cons+Overall_fix_cons,0,MIN(Overall_harmonious_var_max_cons+Overall_fix_cons,QV6+Grid_import_max_ud*Grid_import_yes_no_PB_strategy-(QX6-QY6),MIN(QW6+El_boiler_cap_ud*El_boiler_eff,(QV6+Grid_import_max_ud*Grid_import_yes_no_PB_strategy-(QX6-QY6))/(Overall_harmonious_var_max_cons+Overall_fix_cons+(QX6-QY6)+MAX(0,(Overall_harmonious_var_heat_max_cons+Overall_heat_fix_cons-QW6))/El_boiler_eff)*(Overall_harmonious_var_heat_max_cons+Overall_heat_fix_cons))/(Overall_harmonious_var_heat_max_cons+Overall_heat_fix_cons)*(Overall_harmonious_var_max_cons+Overall_fix_cons)))", "RS" : "=IF(AND(RR6>0,RR5=0,OR(RR6=0,RR7=0)),0,RR6)", "RT" : "=RS6/(Overall_harmonious_var_max_cons+Overall_fix_cons)*(Overall_harmonious_var_heat_max_cons+Overall_heat_fix_cons)", "RU" : "=MAX(0,IF(QN6>0,QI6,0)+QV6-(QX6-QY6)-RS6-RE6-MAX(0,(RT6+RF6-IF(QN6>0,QM6/PB_Ratio_Heat_input_vs_output,0)-QW6)/El_boiler_eff))", "RV" : "=MAX(0,QW6+IF(QN6=0,0,QM6/PB_Ratio_Heat_input_vs_output)-RT6-RF6)", "RW" : "=MAX(0,-(IF(QN6>0,QI6,0)+QV6-(QX6-QY6)-RS6-RE6-MAX(0,(RT6+RF6-IF(QN6>0,QM6/PB_Ratio_Heat_input_vs_output,0)-QW6)/El_boiler_eff)))", "RX" : "=Grid_import_max_ud-RW6", "RY" : "=MIN(El_boiler_cap_ud,MAX(0,(RT6+RF6-QW6-IF(QN6>0,QM6/PB_Ratio_Heat_input_vs_output,0))/El_boiler_eff))", "RZ" : "=MAX(0,El_boiler_cap_ud-RY6)", "SA" : "=MAX(0,1-RS6/(Overall_harmonious_var_max_cons+Overall_fix_cons)*MethSynt_harmonious_max_perc)*MethSynt_RawMeth_nom_prod_ud", "SB" : "=MAX(0,1-RS6/(Overall_harmonious_var_max_cons+Overall_fix_cons)*CCU_harmonious_max_perc)*CCU_CO2_nom_prod_ud", "SC" : "=MAX(0,1-RS6/(Overall_harmonious_var_max_cons+Overall_fix_cons)*EY_harmonious_max_perc)*EY_Hydrogen_nom_prod", "SD" : "=MIN(BESS_chrg_max_cons,RU6)", "SE" : "=MIN(Grid_export_max_ud,RU6)"
]

let formulasDaily1: [String: String] = [
"A" : "=A5+1",  "C" : "=COUNTIFS(Calculation$CS$5:$CS$8763,\"=\"&$A6,Calculation$CQ$5:$CQ$8763,\"<=0\")", "D" : "=COUNTIFS(Calculation$CS$5:$CS$8763,\"=\"&$A6,Calculation$CQ$5:$CQ$8763,\">0\")", "E" : "=A_RawMeth_min_cons*$C6", "F" : "=A_RawMeth_max_cons*$C6", "G" : "=A_CO2_min_cons*$C6", "H" : "=A_CO2_max_cons*$C6", "I" : "=A_Hydrogen_min_cons*$C6", "J" : "=A_Hydrogen_max_cons*$C6", "K" : "=(I6+E6/(MethSynt_CO2_nom_cons+MethSynt_Hydrogen_nom_cons)*MethSynt_Hydrogen_nom_cons)/EY_Hydrogen_nom_prod*EY_var_gross_nom_cons+D6*EY_fix_cons+(G6+E6/(MethSynt_CO2_nom_cons+MethSynt_Hydrogen_nom_cons)*MethSynt_CO2_nom_cons)/CCU_CO2_nom_prod_ud*CCU_var_nom_cons+D6*CCU_fix_cons+E6/MethSynt_RawMeth_nom_prod_ud*MethSynt_var_nom_cons+D6*MethSynt_fix_cons", "L" : "=(J6+F6/(MethSynt_CO2_nom_cons+MethSynt_Hydrogen_nom_cons)*MethSynt_Hydrogen_nom_cons)/EY_Hydrogen_nom_prod*EY_var_gross_nom_cons+D6*EY_fix_cons+(H6+F6/(MethSynt_CO2_nom_cons+MethSynt_Hydrogen_nom_cons)*MethSynt_CO2_nom_cons)/CCU_CO2_nom_prod_ud*CCU_var_nom_cons+D6*CCU_fix_cons+F6/MethSynt_RawMeth_nom_prod_ud*MethSynt_var_nom_cons+D6*MethSynt_fix_cons", "M" : "=(I6+E6/(MethSynt_CO2_nom_cons+MethSynt_Hydrogen_nom_cons)*MethSynt_Hydrogen_nom_cons)/EY_Hydrogen_nom_prod*EY_var_heat_nom_cons+D6*EY_heat_fix_cons+(G6+E6/(MethSynt_CO2_nom_cons+MethSynt_Hydrogen_nom_cons)*MethSynt_CO2_nom_cons)/CCU_CO2_nom_prod_ud*CCU_var_heat_nom_cons+D6*CCU_fix_heat_cons-E6/MethSynt_RawMeth_nom_prod_ud*MethSynt_var_heat_nom_prod-D6*MethSynt_heat_fix_prod", "N" : "=(J6+F6/(MethSynt_CO2_nom_cons+MethSynt_Hydrogen_nom_cons)*MethSynt_Hydrogen_nom_cons)/EY_Hydrogen_nom_prod*EY_var_heat_nom_cons+D6*EY_heat_fix_cons+(H6+F6/(MethSynt_CO2_nom_cons+MethSynt_Hydrogen_nom_cons)*MethSynt_CO2_nom_cons)/CCU_CO2_nom_prod_ud*CCU_var_heat_nom_cons+D6*CCU_fix_heat_cons-F6/MethSynt_RawMeth_nom_prod_ud*MethSynt_var_heat_nom_prod-D6*MethSynt_heat_fix_prod", "O" : "=1-E6/RawMeth_storage_cap_ud", "P" : "=1-F6/RawMeth_storage_cap_ud", "Q" : "=1-G6/CO2_storage_cap_ud", "R" : "=1-H6/CO2_storage_cap_ud", "S" : "=1-I6/Hydrogen_storage_cap_ud", "T" : "=1-J6/Hydrogen_storage_cap_ud", "U" : "=MIN(IF(O6<=0,0,IF(P6>=0,1,1/(O6-P6)*O6)),IF(Q6<=0,0,IF(R6>=0,1,1/(Q6-R6)*Q6)),IF(S6<=0,0,IF(T6>=0,1,1/(S6-T6)*S6)))*(A_equiv_harmonious_max_perc-A_equiv_harmonious_min_perc)+A_equiv_harmonious_min_perc",  "W" : "=COUNTIFS(Calculation$CS$5:$CS$8763,\"=\"&$A6,Calculation$CQ$5:$CQ$8763,\"<=0\")", "X" : "=COUNTIFS(Calculation$CS$5:$CS$8763,\"=\"&$A6,Calculation$CQ$5:$CQ$8763,\">0\")", "Y" : "=B_RawMeth_min_cons*W6", "Z" : "=B_RawMeth_max_cons*W6", "AA" : "=B_CO2_min_cons*W6", "AB" : "=B_CO2_max_cons*W6", "AC" : "=B_Hydrogen_min_cons*W6", "AD" : "=B_Hydrogen_max_cons*W6", "AE" : "=(AC6+Y6/(MethSynt_CO2_nom_cons+MethSynt_Hydrogen_nom_cons)*MethSynt_Hydrogen_nom_cons)/EY_Hydrogen_nom_prod*EY_var_gross_nom_cons+X6*EY_fix_cons+(AA6+Y6/(MethSynt_CO2_nom_cons+MethSynt_Hydrogen_nom_cons)*MethSynt_CO2_nom_cons)/CCU_CO2_nom_prod_ud*CCU_var_nom_cons+X6*CCU_fix_cons+Y6/MethSynt_RawMeth_nom_prod_ud*MethSynt_var_nom_cons+X6*MethSynt_fix_cons", "AF" : "=(AD6+Z6/(MethSynt_CO2_nom_cons+MethSynt_Hydrogen_nom_cons)*MethSynt_Hydrogen_nom_cons)/EY_Hydrogen_nom_prod*EY_var_gross_nom_cons+X6*EY_fix_cons+(AB6+Z6/(MethSynt_CO2_nom_cons+MethSynt_Hydrogen_nom_cons)*MethSynt_CO2_nom_cons)/CCU_CO2_nom_prod_ud*CCU_var_nom_cons+X6*CCU_fix_cons+Z6/MethSynt_RawMeth_nom_prod_ud*MethSynt_var_nom_cons+X6*MethSynt_fix_cons", "AG" : "=(AC6+Y6/(MethSynt_CO2_nom_cons+MethSynt_Hydrogen_nom_cons)*MethSynt_Hydrogen_nom_cons)/EY_Hydrogen_nom_prod*EY_var_heat_nom_cons+X6*EY_heat_fix_cons+(AA6+Y6/(MethSynt_CO2_nom_cons+MethSynt_Hydrogen_nom_cons)*MethSynt_CO2_nom_cons)/CCU_CO2_nom_prod_ud*CCU_var_heat_nom_cons+X6*CCU_fix_heat_cons-Y6/MethSynt_RawMeth_nom_prod_ud*MethSynt_var_heat_nom_prod-X6*MethSynt_heat_fix_prod", "AH" : "=(AD6+Z6/(MethSynt_CO2_nom_cons+MethSynt_Hydrogen_nom_cons)*MethSynt_Hydrogen_nom_cons)/EY_Hydrogen_nom_prod*EY_var_heat_nom_cons+X6*EY_heat_fix_cons+(AB6+Z6/(MethSynt_CO2_nom_cons+MethSynt_Hydrogen_nom_cons)*MethSynt_CO2_nom_cons)/CCU_CO2_nom_prod_ud*CCU_var_heat_nom_cons+X6*CCU_fix_heat_cons-Z6/MethSynt_RawMeth_nom_prod_ud*MethSynt_var_heat_nom_prod-X6*MethSynt_heat_fix_prod", "AI" : "=1-Y6/RawMeth_storage_cap_ud", "AJ" : "=1-Z6/RawMeth_storage_cap_ud", "AK" : "=1-AA6/CO2_storage_cap_ud", "AL" : "=1-AB6/CO2_storage_cap_ud", "AM" : "=1-AC6/Hydrogen_storage_cap_ud", "AN" : "=1-AD6/Hydrogen_storage_cap_ud", "AO" : "=MIN(IF(AI6<=0,0,IF(AJ6>=0,1,1/(AI6-AJ6)*AI6)),IF(AK6<=0,0,IF(AL6>=0,1,1/(AK6-AL6)*AK6)),IF(AM6<=0,0,IF(AN6>=0,1,1/(AM6-AN6)*AM6)))*(B_equiv_harmonious_max_perc-B_equiv_harmonious_min_perc)+B_equiv_harmonious_min_perc",  "AQ" : "=COUNTIFS(Calculation$CS$5:$CS$8763,\"=\"&$A6,Calculation$CQ$5:$CQ$8763,\"<=0\")", "AR" : "=COUNTIFS(Calculation$CS$5:$CS$8763,\"=\"&$A6,Calculation$CQ$5:$CQ$8763,\">0\")", "AS" : "=C_RawMeth_min_cons*AQ6", "AT" : "=C_RawMeth_max_cons*AQ6", "AU" : "=C_CO2_min_cons*AQ6", "AV" : "=C_CO2_max_cons*AQ6", "AW" : "=C_Hydrogen_min_cons*AQ6", "AX" : "=C_Hydrogen_max_cons*AQ6", "AY" : "=(AW6+AS6/(MethSynt_CO2_nom_cons+MethSynt_Hydrogen_nom_cons)*MethSynt_Hydrogen_nom_cons)/EY_Hydrogen_nom_prod*EY_var_gross_nom_cons+AR6*EY_fix_cons+(AU6+AS6/(MethSynt_CO2_nom_cons+MethSynt_Hydrogen_nom_cons)*MethSynt_CO2_nom_cons)/CCU_CO2_nom_prod_ud*CCU_var_nom_cons+AR6*CCU_fix_cons+AS6/MethSynt_RawMeth_nom_prod_ud*MethSynt_var_nom_cons+AR6*MethSynt_fix_cons", "AZ" : "=(AX6+AT6/(MethSynt_CO2_nom_cons+MethSynt_Hydrogen_nom_cons)*MethSynt_Hydrogen_nom_cons)/EY_Hydrogen_nom_prod*EY_var_gross_nom_cons+AR6*EY_fix_cons+(AV6+AT6/(MethSynt_CO2_nom_cons+MethSynt_Hydrogen_nom_cons)*MethSynt_CO2_nom_cons)/CCU_CO2_nom_prod_ud*CCU_var_nom_cons+AR6*CCU_fix_cons+AT6/MethSynt_RawMeth_nom_prod_ud*MethSynt_var_nom_cons+AR6*MethSynt_fix_cons", "BA" : "=(AW6+AS6/(MethSynt_CO2_nom_cons+MethSynt_Hydrogen_nom_cons)*MethSynt_Hydrogen_nom_cons)/EY_Hydrogen_nom_prod*EY_var_heat_nom_cons+AR6*EY_heat_fix_cons+(AU6+AS6/(MethSynt_CO2_nom_cons+MethSynt_Hydrogen_nom_cons)*MethSynt_CO2_nom_cons)/CCU_CO2_nom_prod_ud*CCU_var_heat_nom_cons+AR6*CCU_fix_heat_cons-AS6/MethSynt_RawMeth_nom_prod_ud*MethSynt_var_heat_nom_prod-AR6*MethSynt_heat_fix_prod", "BB" : "=(AX6+AT6/(MethSynt_CO2_nom_cons+MethSynt_Hydrogen_nom_cons)*MethSynt_Hydrogen_nom_cons)/EY_Hydrogen_nom_prod*EY_var_heat_nom_cons+AR6*EY_heat_fix_cons+(AV6+AT6/(MethSynt_CO2_nom_cons+MethSynt_Hydrogen_nom_cons)*MethSynt_CO2_nom_cons)/CCU_CO2_nom_prod_ud*CCU_var_heat_nom_cons+AR6*CCU_fix_heat_cons-AT6/MethSynt_RawMeth_nom_prod_ud*MethSynt_var_heat_nom_prod-AR6*MethSynt_heat_fix_prod", "BC" : "=1-AS6/RawMeth_storage_cap_ud", "BD" : "=1-AT6/RawMeth_storage_cap_ud", "BE" : "=1-AU6/CO2_storage_cap_ud", "BF" : "=1-AV6/CO2_storage_cap_ud", "BG" : "=1-AW6/Hydrogen_storage_cap_ud", "BH" : "=1-AX6/Hydrogen_storage_cap_ud", "BI" : "=MIN(IF(BC6<=0,0,IF(BD6>=0,1,1/(BC6-BD6)*BC6)),IF(BE6<=0,0,IF(BF6>=0,1,1/(BE6-BF6)*BE6)),IF(BG6<=0,0,IF(BH6>=0,1,1/(BG6-BH6)*BG6)))*(C_equiv_harmonious_max_perc-C_equiv_harmonious_min_perc)+C_equiv_harmonious_min_perc",  "BK" : "=COUNTIFS(Calculation$CS$5:$CS$8763,\"=\"&$A6,Calculation$CQ$5:$CQ$8763,\"<=0\")", "BL" : "=COUNTIFS(Calculation$CS$5:$CS$8763,\"=\"&$A6,Calculation$CQ$5:$CQ$8763,\">0\")", "BM" : "=D_RawMeth_min_cons*BK6", "BN" : "=D_RawMeth_max_cons*BK6", "BO" : "=D_CO2_min_cons*BK6", "BP" : "=D_CO2_max_cons*BK6", "BQ" : "=D_Hydrogen_min_cons*BK6", "BR" : "=D_Hydrogen_max_cons*BK6", "BS" : "=(BQ6+BM6/(MethSynt_CO2_nom_cons+MethSynt_Hydrogen_nom_cons)*MethSynt_Hydrogen_nom_cons)/EY_Hydrogen_nom_prod*EY_var_gross_nom_cons+BL6*EY_fix_cons+(BO6+BM6/(MethSynt_CO2_nom_cons+MethSynt_Hydrogen_nom_cons)*MethSynt_CO2_nom_cons)/CCU_CO2_nom_prod_ud*CCU_var_nom_cons+BL6*CCU_fix_cons+BM6/MethSynt_RawMeth_nom_prod_ud*MethSynt_var_nom_cons+BL6*MethSynt_fix_cons", "BT" : "=(BR6+BN6/(MethSynt_CO2_nom_cons+MethSynt_Hydrogen_nom_cons)*MethSynt_Hydrogen_nom_cons)/EY_Hydrogen_nom_prod*EY_var_gross_nom_cons+BL6*EY_fix_cons+(BP6+BN6/(MethSynt_CO2_nom_cons+MethSynt_Hydrogen_nom_cons)*MethSynt_CO2_nom_cons)/CCU_CO2_nom_prod_ud*CCU_var_nom_cons+BL6*CCU_fix_cons+BN6/MethSynt_RawMeth_nom_prod_ud*MethSynt_var_nom_cons+BL6*MethSynt_fix_cons", "BU" : "=(BQ6+BM6/(MethSynt_CO2_nom_cons+MethSynt_Hydrogen_nom_cons)*MethSynt_Hydrogen_nom_cons)/EY_Hydrogen_nom_prod*EY_var_heat_nom_cons+BL6*EY_heat_fix_cons+(BO6+BM6/(MethSynt_CO2_nom_cons+MethSynt_Hydrogen_nom_cons)*MethSynt_CO2_nom_cons)/CCU_CO2_nom_prod_ud*CCU_var_heat_nom_cons+BL6*CCU_fix_heat_cons-BM6/MethSynt_RawMeth_nom_prod_ud*MethSynt_var_heat_nom_prod-BL6*MethSynt_heat_fix_prod", "BV" : "=(BR6+BN6/(MethSynt_CO2_nom_cons+MethSynt_Hydrogen_nom_cons)*MethSynt_Hydrogen_nom_cons)/EY_Hydrogen_nom_prod*EY_var_heat_nom_cons+BL6*EY_heat_fix_cons+(BP6+BN6/(MethSynt_CO2_nom_cons+MethSynt_Hydrogen_nom_cons)*MethSynt_CO2_nom_cons)/CCU_CO2_nom_prod_ud*CCU_var_heat_nom_cons+BL6*CCU_fix_heat_cons-BN6/MethSynt_RawMeth_nom_prod_ud*MethSynt_var_heat_nom_prod-BL6*MethSynt_heat_fix_prod", "BW" : "=1-BM6/RawMeth_storage_cap_ud", "BX" : "=1-BN6/RawMeth_storage_cap_ud", "BY" : "=1-BO6/CO2_storage_cap_ud", "BZ" : "=1-BP6/CO2_storage_cap_ud", "CA" : "=1-BQ6/Hydrogen_storage_cap_ud", "CB" : "=1-BR6/Hydrogen_storage_cap_ud", "CC" : "=MIN(IF(BW6<=0,0,IF(BX6>=0,1,1/(BW6-BX6)*BW6)),IF(BY6<=0,0,IF(BZ6>=0,1,1/(BY6-BZ6)*BY6)),IF(CA6<=0,0,IF(CB6>=0,1,1/(CA6-CB6)*CA6)))*(D_equiv_harmonious_max_perc-D_equiv_harmonious_min_perc)+D_equiv_harmonious_min_perc",  "CE" : "=SUMIFS(Calculation$L$5:$L$8763,Calculation$CS$5:$CS$8763,\"=\"&$A6,Calculation$CQ$5:$CQ$8763,\">0\")+SUMIFS(Calculation$BX$5:$BX$8763,Calculation$CC$5:$CC$8763,\">0\",Calculation$CS$5:$CS$8763,\"=\"&$A6,Calculation$CQ$5:$CQ$8763,\">0\")-SUMIFS(Calculation$CI$5:$CI$8763,Calculation$CS$5:$CS$8763,\"=\"&$A6,Calculation$CQ$5:$CQ$8763,\">0\")", "CF" : "=SUMIFS(Calculation$L$5:$L$8763,Calculation$CS$5:$CS$8763,\"=\"&$A6,Calculation$CQ$5:$CQ$8763,\"=0\")+SUMIFS(Calculation$BX$5:$BX$8763,Calculation$CC$5:$CC$8763,\">0\",Calculation$CS$5:$CS$8763,\"=\"&$A6,Calculation$CQ$5:$CQ$8763,\"=0\")-SUMIFS(Calculation$CI$5:$CI$8763,Calculation$CS$5:$CS$8763,\"=\"&$A6,Calculation$CQ$5:$CQ$8763,\"=0\")", "CG" : "=SUMIFS(Calculation$J$5:$J$8763,Calculation$CS$5:$CS$8763,\"=\"&$A6,Calculation$CQ$5:$CQ$8763,\">0\")+SUMIFS(Calculation$CB$5:$CB$8763,Calculation$CC$5:$CC$8763,\">0\",Calculation$CS$5:$CS$8763,\"=\"&$A6,Calculation$CQ$5:$CQ$8763,\">0\")/PB_Ratio_Heat_input_vs_output-SUMIFS(Calculation$CJ$5:$CJ$8763,Calculation$CS$5:$CS$8763,\"=\"&$A6,Calculation$CQ$5:$CQ$8763,\">0\")", "CH" : "=SUMIFS(Calculation$J$5:$J$8763,Calculation$CS$5:$CS$8763,\"=\"&$A6,Calculation$CQ$5:$CQ$8763,\"=0\")+SUMIFS(Calculation$CB$5:$CB$8763,Calculation$CC$5:$CC$8763,\">0\",Calculation$CS$5:$CS$8763,\"=\"&$A6,Calculation$CQ$5:$CQ$8763,\"=0\")/PB_Ratio_Heat_input_vs_output-SUMIFS(Calculation$CJ$5:$CJ$8763,Calculation$CS$5:$CS$8763,\"=\"&$A6,Calculation$CQ$5:$CQ$8763,\"=0\")", "CI" : "=SUMIF(Calculation$CS$5:$CS$8763,\"=\"&$A6,Calculation$CQ$5:$CQ$8763)+SUMIFS(Calculation$CT$5:$CT$8763,Calculation$CS$5:$CS$8763,\"=\"&$A6,Calculation$CQ$5:$CQ$8763,\">0\")", "CJ" : "=SUMIF(Calculation$CS$5:$CS$8763,\"=\"&$A6,Calculation$DH$5:$DH$8763)+SUMIFS(Calculation$CT$5:$CT$8763,Calculation$CS$5:$CS$8763,\"=\"&$A6,Calculation$DH$5:$DH$8763,\">0\")", "CK" : "=SUMIFS(Calculation$CT$5:$CT$8763,Calculation$CS$5:$CS$8763,\"=\"&$A6,Calculation$CQ$5:$CQ$8763,\"=0\")", "CL" : "=SUMIF(Calculation$CS$5:$CS$8763,\"=\"&$A6,Calculation$CR$5:$CR$8763)+SUMIFS(Calculation$CU$5:$CU$8763,Calculation$CS$5:$CS$8763,\"=\"&$A6,Calculation$CQ$5:$CQ$8763,\">0\")", "CM" : "=SUMIF(Calculation$CS$5:$CS$8763,\"=\"&$A6,Calculation$DI$5:$DI$8763)+SUMIFS(Calculation$CU$5:$CU$8763,Calculation$CS$5:$CS$8763,\"=\"&$A6,Calculation$DH$5:$DH$8763,\">0\")", "CN" : "=SUMIFS(Calculation$CU$5:$CU$8763,Calculation$CS$5:$CS$8763,\"=\"&$A6,Calculation$CQ$5:$CQ$8763,\"=0\")", "CO" : "=SUMIFS(Calculation$CZ$5:$CZ$8763,Calculation$CS$5:$CS$8763,\"=\"&$A6,Calculation$CQ$5:$CQ$8763,\">0\")", "CP" : "=SUMIFS(Calculation$DN$5:$DN$8763,Calculation$CS$5:$CS$8763,\"=\"&$A6,Calculation$DH$5:$DH$8763,\">0\")", "CQ" : "=SUMIF(Calculation$CS$5:$CS$8763,\"=\"&$A6,Calculation$CZ$5:$CZ$8763)-CO6", "CR" : "=SUMIFS(Calculation$CM$5:$CM$8763,Calculation$CS$5:$CS$8763,\"=\"&$A6,Calculation$CQ$5:$CQ$8763,\">0\")", "CS" : "=SUMIF(Calculation$CS$5:$CS$8763,\"=\"&$A6,Calculation$CM$5:$CM$8763)-CR6", "CT" : "=SUMIFS(Calculation$CN$5:$CN$8763,Calculation$CS$5:$CS$8763,\"=\"&$A6,Calculation$CQ$5:$CQ$8763,\">0\")", "CU" : "=SUMIF(Calculation$CS$5:$CS$8763,\"=\"&$A6,Calculation$CN$5:$CN$8763)-CT6", "CV" : "=SUMIFS(Calculation$CV$5:$CV$8763,Calculation$CS$5:$CS$8763,\"=\"&$A6,Calculation$CQ$5:$CQ$8763,\">0\")", "CW" : "=SUMIFS(Calculation$DJ$5:$DJ$8763,Calculation$CS$5:$CS$8763,\"=\"&$A6,Calculation$DH$5:$DH$8763,\">0\")", "CX" : "=SUMIF(Calculation$CS$5:$CS$8763,\"=\"&$A6,Calculation$CV$5:$CV$8763)-CV6", "CY" : "=SUMIFS(Calculation$CW$5:$CW$8763,Calculation$CS$5:$CS$8763,\"=\"&$A6,Calculation$CQ$5:$CQ$8763,\">0\")", "CZ" : "=SUMIFS(Calculation$DK$5:$DK$8763,Calculation$CS$5:$CS$8763,\"=\"&$A6,Calculation$DH$5:$DH$8763,\">0\")", "DA" : "=SUMIF(Calculation$CS$5:$CS$8763,\"=\"&$A6,Calculation$CW$5:$CW$8763)-CY6", "DB" : "=MIN(SUMIFS(Calculation$DE$5:$DE$8763,Calculation$CS$5:$CS$8763,\"=\"&$A6,Calculation$CQ$5:$CQ$8763,\">0\"),BESS_cap_ud/BESS_chrg_eff)", "DC" : "=MIN(SUMIFS(Calculation$DS$5:$DS$8763,Calculation$CS$5:$CS$8763,\"=\"&$A6,Calculation$DH$5:$DH$8763,\">0\"),BESS_cap_ud/BESS_chrg_eff)", "DD" : "=MIN(SUMIFS(Calculation$DE$5:$DE$8763,Calculation$CS$5:$CS$8763,\"=\"&$A6,Calculation$CQ$5:$CQ$8763,\"=0\"),BESS_cap_ud/BESS_chrg_eff)", "DE" : "=SUMIFS(Calculation$DF$5:$DF$8763,Calculation$CS$5:$CS$8763,\"=\"&$A6,Calculation$CQ$5:$CQ$8763,\">0\")", "DF" : "=SUMIFS(Calculation$DT$5:$DT$8763,Calculation$CS$5:$CS$8763,\"=\"&$A6,Calculation$DH$5:$DH$8763,\">0\")", "DG" : "=SUMIF(Calculation$CS$5:$CS$8763,\"=\"&$A6,Calculation$DF$5:$DF$8763)-DE6", "DH" : "=SUMIFS(Calculation$DA$5:$DA$8763,Calculation$CS$5:$CS$8763,\"=\"&$A6,Calculation$CQ$5:$CQ$8763,\">0\")", "DI" : "=SUMIFS(Calculation$DO$5:$DO$8763,Calculation$CS$5:$CS$8763,\"=\"&$A6,Calculation$DH$5:$DH$8763,\">0\")", "DJ" : "=SUMIF(Calculation$CS$5:$CS$8763,\"=\"&$A6,Calculation$DA$5:$DA$8763)-DH6", "DK" : "=SUMIFS(Calculation$DB$5:$DB$8763,Calculation$CS$5:$CS$8763,\"=\"&$A6,Calculation$CQ$5:$CQ$8763,\">0\")", "DL" : "=SUMIFS(Calculation$DP$5:$DP$8763,Calculation$CS$5:$CS$8763,\"=\"&$A6,Calculation$DH$5:$DH$8763,\">0\")", "DM" : "=SUMIF(Calculation$CS$5:$CS$8763,\"=\"&$A6,Calculation$DB$5:$DB$8763)-DK6", "DN" : "=SUMIFS(Calculation$DC$5:$DC$8763,Calculation$CS$5:$CS$8763,\"=\"&$A6,Calculation$CQ$5:$CQ$8763,\">0\")", "DO" : "=SUMIFS(Calculation$DQ$5:$DQ$8763,Calculation$CS$5:$CS$8763,\"=\"&$A6,Calculation$DH$5:$DH$8763,\">0\")", "DP" : "=SUMIF(Calculation$CS$5:$CS$8763,\"=\"&$A6,Calculation$DC$5:$DC$8763)-DN6", "DQ" : "=SUMIFS(Calculation$DD$5:$DD$8763,Calculation$CS$5:$CS$8763,\"=\"&$A6,Calculation$CQ$5:$CQ$8763,\">0\")", "DR" : "=SUMIFS(Calculation$DR$5:$DR$8763,Calculation$CS$5:$CS$8763,\"=\"&$A6,Calculation$DH$5:$DH$8763,\">0\")", "DS" : "=SUMIF(Calculation$CS$5:$CS$8763,\"=\"&$A6,Calculation$DD$5:$DD$8763)-DQ6",  "DU" : "=SUMIFS(Calculation$L$5:$L$8763,Calculation$EU$5:$EU$8763,\"=\"&$A6,Calculation$ES$5:$ES$8763,\">0\")+SUMIFS(Calculation$DZ$5:$DZ$8763,Calculation$EE$5:$EE$8763,\">0\",Calculation$EU$5:$EU$8763,\"=\"&$A6,Calculation$ES$5:$ES$8763,\">0\")-SUMIFS(Calculation$EK$5:$EK$8763,Calculation$EU$5:$EU$8763,\"=\"&$A6,Calculation$ES$5:$ES$8763,\">0\")", "DV" : "=SUMIFS(Calculation$L$5:$L$8763,Calculation$EU$5:$EU$8763,\"=\"&$A6,Calculation$ES$5:$ES$8763,\"=0\")+SUMIFS(Calculation$DZ$5:$DZ$8763,Calculation$EE$5:$EE$8763,\">0\",Calculation$EU$5:$EU$8763,\"=\"&$A6,Calculation$ES$5:$ES$8763,\"=0\")-SUMIFS(Calculation$EK$5:$EK$8763,Calculation$EU$5:$EU$8763,\"=\"&$A6,Calculation$ES$5:$ES$8763,\"=0\")", "DW" : "=SUMIFS(Calculation$J$5:$J$8763,Calculation$EU$5:$EU$8763,\"=\"&$A6,Calculation$ES$5:$ES$8763,\">0\")+SUMIFS(Calculation$ED$5:$ED$8763,Calculation$EE$5:$EE$8763,\">0\",Calculation$EU$5:$EU$8763,\"=\"&$A6,Calculation$ES$5:$ES$8763,\">0\")/PB_Ratio_Heat_input_vs_output-SUMIFS(Calculation$EL$5:$EL$8763,Calculation$EU$5:$EU$8763,\"=\"&$A6,Calculation$ES$5:$ES$8763,\">0\")", "DX" : "=SUMIFS(Calculation$J$5:$J$8763,Calculation$EU$5:$EU$8763,\"=\"&$A6,Calculation$ES$5:$ES$8763,\"=0\")+SUMIFS(Calculation$ED$5:$ED$8763,Calculation$EE$5:$EE$8763,\">0\",Calculation$EU$5:$EU$8763,\"=\"&$A6,Calculation$ES$5:$ES$8763,\"=0\")/PB_Ratio_Heat_input_vs_output-SUMIFS(Calculation$EL$5:$EL$8763,Calculation$EU$5:$EU$8763,\"=\"&$A6,Calculation$ES$5:$ES$8763,\"=0\")", "DY" : "=SUMIF(Calculation$EU$5:$EU$8763,\"=\"&$A6,Calculation$ES$5:$ES$8763)+SUMIFS(Calculation$EV$5:$EV$8763,Calculation$EU$5:$EU$8763,\"=\"&$A6,Calculation$ES$5:$ES$8763,\">0\")", "DZ" : "=SUMIF(Calculation$EU$5:$EU$8763,\"=\"&$A6,Calculation$FJ$5:$FJ$8763)+SUMIFS(Calculation$EV$5:$EV$8763,Calculation$EU$5:$EU$8763,\"=\"&$A6,Calculation$FJ$5:$FJ$8763,\">0\")", "EA" : "=SUMIFS(Calculation$EV$5:$EV$8763,Calculation$EU$5:$EU$8763,\"=\"&$A6,Calculation$ES$5:$ES$8763,\"=0\")", "EB" : "=SUMIF(Calculation$EU$5:$EU$8763,\"=\"&$A6,Calculation$ET$5:$ET$8763)+SUMIFS(Calculation$EW$5:$EW$8763,Calculation$EU$5:$EU$8763,\"=\"&$A6,Calculation$ES$5:$ES$8763,\">0\")", "EC" : "=SUMIF(Calculation$EU$5:$EU$8763,\"=\"&$A6,Calculation$FK$5:$FK$8763)+SUMIFS(Calculation$EW$5:$EW$8763,Calculation$EU$5:$EU$8763,\"=\"&$A6,Calculation$FJ$5:$FJ$8763,\">0\")", "ED" : "=SUMIFS(Calculation$EW$5:$EW$8763,Calculation$EU$5:$EU$8763,\"=\"&$A6,Calculation$ES$5:$ES$8763,\"=0\")", "EE" : "=SUMIFS(Calculation$FB$5:$FB$8763,Calculation$EU$5:$EU$8763,\"=\"&$A6,Calculation$ES$5:$ES$8763,\">0\")", "EF" : "=SUMIFS(Calculation$FP$5:$FP$8763,Calculation$EU$5:$EU$8763,\"=\"&$A6,Calculation$FJ$5:$FJ$8763,\">0\")", "EG" : "=SUMIF(Calculation$EU$5:$EU$8763,\"=\"&$A6,Calculation$FB$5:$FB$8763)-EE6", "EH" : "=SUMIFS(Calculation$EO$5:$EO$8763,Calculation$EU$5:$EU$8763,\"=\"&$A6,Calculation$ES$5:$ES$8763,\">0\")", "EI" : "=SUMIF(Calculation$EU$5:$EU$8763,\"=\"&$A6,Calculation$EO$5:$EO$8763)-EH6", "EJ" : "=SUMIFS(Calculation$EP$5:$EP$8763,Calculation$EU$5:$EU$8763,\"=\"&$A6,Calculation$ES$5:$ES$8763,\">0\")", "EK" : "=SUMIF(Calculation$EU$5:$EU$8763,\"=\"&$A6,Calculation$EP$5:$EP$8763)-EJ6", "EL" : "=SUMIFS(Calculation$EX$5:$EX$8763,Calculation$EU$5:$EU$8763,\"=\"&$A6,Calculation$ES$5:$ES$8763,\">0\")", "EM" : "=SUMIFS(Calculation$FL$5:$FL$8763,Calculation$EU$5:$EU$8763,\"=\"&$A6,Calculation$FJ$5:$FJ$8763,\">0\")", "EN" : "=SUMIF(Calculation$EU$5:$EU$8763,\"=\"&$A6,Calculation$EX$5:$EX$8763)-EL6", "EO" : "=SUMIFS(Calculation$EY$5:$EY$8763,Calculation$EU$5:$EU$8763,\"=\"&$A6,Calculation$ES$5:$ES$8763,\">0\")", "EP" : "=SUMIFS(Calculation$FM$5:$FM$8763,Calculation$EU$5:$EU$8763,\"=\"&$A6,Calculation$FJ$5:$FJ$8763,\">0\")", "EQ" : "=SUMIF(Calculation$EU$5:$EU$8763,\"=\"&$A6,Calculation$EY$5:$EY$8763)-EO6", "ER" : "=MIN(SUMIFS(Calculation$FG$5:$FG$8763,Calculation$EU$5:$EU$8763,\"=\"&$A6,Calculation$ES$5:$ES$8763,\">0\"),BESS_cap_ud/BESS_chrg_eff)", "ES" : "=MIN(SUMIFS(Calculation$FU$5:$FU$8763,Calculation$EU$5:$EU$8763,\"=\"&$A6,Calculation$FJ$5:$FJ$8763,\">0\"),BESS_cap_ud/BESS_chrg_eff)", "ET" : "=MIN(SUMIFS(Calculation$FG$5:$FG$8763,Calculation$EU$5:$EU$8763,\"=\"&$A6,Calculation$ES$5:$ES$8763,\"=0\"),BESS_cap_ud/BESS_chrg_eff)", "EU" : "=SUMIFS(Calculation$FH$5:$FH$8763,Calculation$EU$5:$EU$8763,\"=\"&$A6,Calculation$ES$5:$ES$8763,\">0\")", "EV" : "=SUMIFS(Calculation$FV$5:$FV$8763,Calculation$EU$5:$EU$8763,\"=\"&$A6,Calculation$FJ$5:$FJ$8763,\">0\")", "EW" : "=SUMIF(Calculation$EU$5:$EU$8763,\"=\"&$A6,Calculation$FH$5:$FH$8763)-EU6", "EX" : "=SUMIFS(Calculation$FC$5:$FC$8763,Calculation$EU$5:$EU$8763,\"=\"&$A6,Calculation$ES$5:$ES$8763,\">0\")", "EY" : "=SUMIFS(Calculation$FQ$5:$FQ$8763,Calculation$EU$5:$EU$8763,\"=\"&$A6,Calculation$FJ$5:$FJ$8763,\">0\")", "EZ" : "=SUMIF(Calculation$EU$5:$EU$8763,\"=\"&$A6,Calculation$FC$5:$FC$8763)-EX6", "FA" : "=SUMIFS(Calculation$FD$5:$FD$8763,Calculation$EU$5:$EU$8763,\"=\"&$A6,Calculation$ES$5:$ES$8763,\">0\")", "FB" : "=SUMIFS(Calculation$FR$5:$FR$8763,Calculation$EU$5:$EU$8763,\"=\"&$A6,Calculation$FJ$5:$FJ$8763,\">0\")", "FC" : "=SUMIF(Calculation$EU$5:$EU$8763,\"=\"&$A6,Calculation$FD$5:$FD$8763)-FA6", "FD" : "=SUMIFS(Calculation$FE$5:$FE$8763,Calculation$EU$5:$EU$8763,\"=\"&$A6,Calculation$ES$5:$ES$8763,\">0\")", "FE" : "=SUMIFS(Calculation$FS$5:$FS$8763,Calculation$EU$5:$EU$8763,\"=\"&$A6,Calculation$FJ$5:$FJ$8763,\">0\")", "FF" : "=SUMIF(Calculation$EU$5:$EU$8763,\"=\"&$A6,Calculation$FE$5:$FE$8763)-FD6", "FG" : "=SUMIFS(Calculation$FF$5:$FF$8763,Calculation$EU$5:$EU$8763,\"=\"&$A6,Calculation$ES$5:$ES$8763,\">0\")", "FH" : "=SUMIFS(Calculation$FT$5:$FT$8763,Calculation$EU$5:$EU$8763,\"=\"&$A6,Calculation$FJ$5:$FJ$8763,\">0\")", "FI" : "=SUMIF(Calculation$EU$5:$EU$8763,\"=\"&$A6,Calculation$FF$5:$FF$8763)-FG6",  "FK" : "=CV6-$K6-MAX(0,$M6-CY6)/El_boiler_eff-CU6/BESS_chrg_eff", "FL" : "=EL6-($K6+($L6-$K6)/(A_equiv_harmonious_max_perc-A_equiv_harmonious_min_perc)*($U6-A_equiv_harmonious_min_perc))-MAX(0,($M6+($N6-$M6)/(A_equiv_harmonious_max_perc-A_equiv_harmonious_min_perc)*($U6-A_equiv_harmonious_min_perc))-EO6)/El_boiler_eff-EK6/BESS_chrg_eff", "FM" : "=CW6-$K6-MAX(0,$M6-CZ6)/El_boiler_eff-CU6/BESS_chrg_eff", "FN" : "=CY6+MAX(0,CV6-$K6-CU6/BESS_chrg_eff)*El_boiler_eff-$M6", "FO" : "=EO6+MAX(0,EL6-($K6+($L6-$K6)/(A_equiv_harmonious_max_perc-A_equiv_harmonious_min_perc)*($U6-A_equiv_harmonious_min_perc))-EK6/BESS_chrg_eff)*El_boiler_eff-($M6+($N6-$M6)/(A_equiv_harmonious_max_perc-A_equiv_harmonious_min_perc)*($U6-A_equiv_harmonious_min_perc))", "FP" : "=CZ6+MAX(0,CW6-$K6-CU6/BESS_chrg_eff)*El_boiler_eff-$M6", "FQ" : "=DH6-($M6-CY6)/El_boiler_eff", "FR" : "=EX6-(($M6+($N6-$M6)/(A_equiv_harmonious_max_perc-A_equiv_harmonious_min_perc)*($U6-A_equiv_harmonious_min_perc))-EO6)/El_boiler_eff", "FS" : "=DI6-($M6-CZ6)/El_boiler_eff", "FT" : "=DB6-CU6/BESS_chrg_eff", "FU" : "=ER6-EK6/BESS_chrg_eff", "FV" : "=DC6-CU6/BESS_chrg_eff", "FW" : "=DK6-$E6", "FX" : "=FA6-($E6+($F6-$E6)/(A_equiv_harmonious_max_perc-A_equiv_harmonious_min_perc)*($U6-A_equiv_harmonious_min_perc))", "FY" : "=DL6-$E6", "FZ" : "=DN6-$G6", "GA" : "=FD6-($G6+($H6-$G6)/(A_equiv_harmonious_max_perc-A_equiv_harmonious_min_perc)*($U6-A_equiv_harmonious_min_perc))", "GB" : "=DO6-$G6", "GC" : "=DQ6-$I6", "GD" : "=FG6-($I6+($J6-$I6)/(A_equiv_harmonious_max_perc-A_equiv_harmonious_min_perc)*($U6-A_equiv_harmonious_min_perc))", "GE" : "=DR6-$I6",  "GG" : "=IF(OR(FK6<0,FN6<0,FQ6<0,FT6<0,FW6<0,FZ6<0,GC6<0),0,MIN(1,Overall_harmonious_min_perc+MIN(IFERROR(FK6/(FK6-FM6),1),IFERROR(FN6/(FN6-FP6),1),IFERROR(FQ6/(FQ6-FS6),1),IFERROR(FT6/(FT6-FV6),1),IFERROR(FW6/(FW6-FY6),1),IFERROR(FZ6/(FZ6-GB6),1),IFERROR(GC6/(GC6-GE6),1))*(Overall_harmonious_max_perc-Overall_harmonious_min_perc)))", "GH" : "=IF(GG6=0,0,ROUND((CV6+(CW6-CV6)/(Overall_harmonious_max_perc-Overall_harmonious_min_perc)*(GG6-Overall_harmonious_min_perc))-$K6-MAX(0,$M6-(CY6+(CZ6-CY6)/(Overall_harmonious_max_perc-Overall_harmonious_min_perc)*(GG6-Overall_harmonious_min_perc)))/El_boiler_eff-CU6/BESS_chrg_eff,5))", "GI" : "=IF(GG6=0,0,(EL6+(EM6-EL6)/(Overall_harmonious_max_perc-Overall_harmonious_min_perc)*(GG6-Overall_harmonious_min_perc))-($K6+($L6-$K6)/(A_equiv_harmonious_max_perc-A_equiv_harmonious_min_perc)*($U6-A_equiv_harmonious_min_perc))-MAX(0,($M6+($N6-$M6)/(A_equiv_harmonious_max_perc-A_equiv_harmonious_min_perc)*($U6-A_equiv_harmonious_min_perc))-(EO6+(EP6-EO6)/(Overall_harmonious_max_perc-Overall_harmonious_min_perc)*(GG6-Overall_harmonious_min_perc)))/El_boiler_eff-EK6/BESS_chrg_eff)", "GJ" : "=IF(GG6=0,0,ROUND((CY6+(CZ6-CY6)/(Overall_harmonious_max_perc-Overall_harmonious_min_perc)*(GG6-Overall_harmonious_min_perc))+MAX(0,(CV6+(CW6-CV6)/(Overall_harmonious_max_perc-Overall_harmonious_min_perc)*(GG6-Overall_harmonious_min_perc))-$K6-CU6/BESS_chrg_eff)*El_boiler_eff-$M6,5))", "GK" : "=IF(GG6=0,0,(EO6+(EP6-EO6)/(Overall_harmonious_max_perc-Overall_harmonious_min_perc)*(GG6-Overall_harmonious_min_perc))+MAX(0,(EL6+(EM6-EL6)/(Overall_harmonious_max_perc-Overall_harmonious_min_perc)*(GG6-Overall_harmonious_min_perc))-($K6+($L6-$K6)/(A_equiv_harmonious_max_perc-A_equiv_harmonious_min_perc)*($U6-A_equiv_harmonious_min_perc))-EK6/BESS_chrg_eff)*El_boiler_eff-($M6+($N6-$M6)/(A_equiv_harmonious_max_perc-A_equiv_harmonious_min_perc)*($U6-A_equiv_harmonious_min_perc)))", "GL" : "=IF(GG6=0,0,ROUND((DH6+(DI6-DH6)/(Overall_harmonious_max_perc-Overall_harmonious_min_perc)*(GG6-Overall_harmonious_min_perc))-($M6-(CY6+(CZ6-CY6)/(Overall_harmonious_max_perc-Overall_harmonious_min_perc)*(GG6-Overall_harmonious_min_perc)))/El_boiler_eff,5))", "GM" : "=IF(GG6=0,0,(EX6+(EY6-EX6)/(Overall_harmonious_max_perc-Overall_harmonious_min_perc)*(GG6-Overall_harmonious_min_perc))-(($M6+($N6-$M6)/(A_equiv_harmonious_max_perc-A_equiv_harmonious_min_perc)*($U6-A_equiv_harmonious_min_perc))-(EO6+(EP6-EO6)/(Overall_harmonious_max_perc-Overall_harmonious_min_perc)*(GG6-Overall_harmonious_min_perc)))/El_boiler_eff)", "GN" : "=IF(GG6=0,0,ROUND((DB6+(DC6-DB6)/(Overall_harmonious_max_perc-Overall_harmonious_min_perc)*(GG6-Overall_harmonious_min_perc))-CU6/BESS_chrg_eff,5))", "GO" : "=IF(GG6=0,0,(ER6+(ES6-ER6)/(Overall_harmonious_max_perc-Overall_harmonious_min_perc)*(GG6-Overall_harmonious_min_perc))-EK6/BESS_chrg_eff)", "GP" : "=IF(GG6=0,0,ROUND((DK6+(DL6-DK6)/(Overall_harmonious_max_perc-Overall_harmonious_min_perc)*(GG6-Overall_harmonious_min_perc))-$E6,5))", "GQ" : "=IF(GG6=0,0,DK6+(DL6-DK6)/(Overall_harmonious_max_perc-Overall_harmonious_min_perc)*(GG6-Overall_harmonious_min_perc)-($E6+($F6-$E6)/(A_equiv_harmonious_max_perc-A_equiv_harmonious_min_perc)*($U6-A_equiv_harmonious_min_perc)))", "GR" : "=IF(GG6=0,0,ROUND((DN6+(DO6-DN6)/(Overall_harmonious_max_perc-Overall_harmonious_min_perc)*(GG6-Overall_harmonious_min_perc))-$G6,5))", "GS" : "=IF(GG6=0,0,DN6+(DO6-DN6)/(Overall_harmonious_max_perc-Overall_harmonious_min_perc)*(GG6-Overall_harmonious_min_perc)-($G6+($H6-$G6)/(A_equiv_harmonious_max_perc-A_equiv_harmonious_min_perc)*($U6-A_equiv_harmonious_min_perc)))", "GT" : "=IF(GG6=0,0,ROUND((DQ6+(DR6-DQ6)/(Overall_harmonious_max_perc-Overall_harmonious_min_perc)*(GG6-Overall_harmonious_min_perc))-$I6,5))", "GU" : "=IF(GG6=0,0,DQ6+(DR6-DQ6)/(Overall_harmonious_max_perc-Overall_harmonious_min_perc)*(GG6-Overall_harmonious_min_perc)-($I6+($J6-$I6)/(A_equiv_harmonious_max_perc-A_equiv_harmonious_min_perc)*($U6-A_equiv_harmonious_min_perc)))", "GV" : "=IF(OR(GG6=0,GH6<0,GJ6<0,GL6<0,GN6<0,GP6<0,GR6<0,GT6<0),0,MIN(1,A_equiv_harmonious_min_perc+MIN(IF(GI6>=0,1,GH6/(GH6-GI6)),IF(GK6>=0,1,GJ6/(GJ6-GK6)),IF(GM6>=0,1,GL6/(GL6-GM6)),IF(GO6>=0,1,GN6/(GN6-GO6)),IF(GQ6>=0,1,GP6/(GP6-GQ6)),IF(GS6>=0,1,GR6/(GR6-GS6)),IF(GU6>=0,1,GT6/(GT6-GU6)))*(A_equiv_harmonious_max_perc*$U6-A_equiv_harmonious_min_perc)))",  "GX" : "=IF(OR(FK6<0,FN6<0,FQ6<0,FT6<0,FW6<0,FZ6<0,GC6<0),0,MIN(1,A_equiv_harmonious_min_perc+MIN(IF(FL6>=0,1,FK6/(FK6-FL6)),IF(FO6>=0,1,FN6/(FN6-FO6)),IF(FR6>=0,1,FQ6/(FQ6-FR6)),IF(FU6>=0,1,FT6/(FT6-FU6)),IF(FX6>=0,1,FW6/(FW6-FX6)),IF(GA6>=0,1,FZ6/(FZ6-GA6)),IF(GD6>=0,1,GC6/(GC6-GD6)))*(A_equiv_harmonious_max_perc*$U6-A_equiv_harmonious_min_perc)))", "GY" : "=IF(GX6=0,0,ROUND((CV6+(EL6-CV6)/(A_equiv_harmonious_max_perc*$U6-A_equiv_harmonious_min_perc)*(GX6-A_equiv_harmonious_min_perc))-($K6+($L6-$K6)/(A_equiv_harmonious_max_perc-A_equiv_harmonious_min_perc)*(GX6-A_equiv_harmonious_min_perc))-MAX(0,($M6+($N6-$M6)/(A_equiv_harmonious_max_perc-A_equiv_harmonious_min_perc)*(GX6-A_equiv_harmonious_min_perc))-(CY6+(EO6-CY6)/(A_equiv_harmonious_max_perc*$U6-A_equiv_harmonious_min_perc)*(GX6-A_equiv_harmonious_min_perc)))/El_boiler_eff-(CU6+(EK6-CU6)/(A_equiv_harmonious_max_perc*$U6-A_equiv_harmonious_min_perc)*(GX6-A_equiv_harmonious_min_perc))/BESS_chrg_eff,5))", "GZ" : "=IF(GX6=0,0,(CW6+(EM6-CW6)/(A_equiv_harmonious_max_perc*$U6-A_equiv_harmonious_min_perc)*(GX6-A_equiv_harmonious_min_perc))-($K6+($L6-$K6)/(A_equiv_harmonious_max_perc-A_equiv_harmonious_min_perc)*(GX6-A_equiv_harmonious_min_perc))-(MAX(0,($M6+($N6-$M6)/(A_equiv_harmonious_max_perc-A_equiv_harmonious_min_perc)*(GX6-A_equiv_harmonious_min_perc))-(CZ6+(EP6-CZ6)/(A_equiv_harmonious_max_perc*$U6-A_equiv_harmonious_min_perc)*(GX6-A_equiv_harmonious_min_perc)))/El_boiler_eff)-((CU6+(EK6-CU6)/(A_equiv_harmonious_max_perc*$U6-A_equiv_harmonious_min_perc)*(GX6-A_equiv_harmonious_min_perc))/BESS_chrg_eff))", "HA" : "=IF(GX6=0,0,ROUND((CY6+(EO6-CY6)/(A_equiv_harmonious_max_perc*$U6-A_equiv_harmonious_min_perc)*(GX6-A_equiv_harmonious_min_perc))+(MAX(0,(CV6+(EL6-CV6)/(A_equiv_harmonious_max_perc*$U6-A_equiv_harmonious_min_perc)*(GX6-A_equiv_harmonious_min_perc))-($K6+($L6-$K6)/(A_equiv_harmonious_max_perc-A_equiv_harmonious_min_perc)*(GX6-A_equiv_harmonious_min_perc))-((CU6+(EK6-CU6)/(A_equiv_harmonious_max_perc*$U6-A_equiv_harmonious_min_perc)*(GX6-A_equiv_harmonious_min_perc))/BESS_chrg_eff)))*El_boiler_eff-($M6+($N6-$M6)/(A_equiv_harmonious_max_perc-A_equiv_harmonious_min_perc)*(GX6-A_equiv_harmonious_min_perc)),5))", "HB" : "=IF(GX6=0,0,(CZ6+(EP6-CZ6)/(A_equiv_harmonious_max_perc*$U6-A_equiv_harmonious_min_perc)*(GX6-A_equiv_harmonious_min_perc))+(MAX(0,(CW6+(EM6-CW6)/(A_equiv_harmonious_max_perc*$U6-A_equiv_harmonious_min_perc)*(GX6-A_equiv_harmonious_min_perc))-($K6+($L6-$K6)/(A_equiv_harmonious_max_perc-A_equiv_harmonious_min_perc)*(GX6-A_equiv_harmonious_min_perc))-((CU6+(EK6-CU6)/(A_equiv_harmonious_max_perc*$U6-A_equiv_harmonious_min_perc)*(GX6-A_equiv_harmonious_min_perc))/BESS_chrg_eff)))*El_boiler_eff-($M6+($N6-$M6)/(A_equiv_harmonious_max_perc-A_equiv_harmonious_min_perc)*(GX6-A_equiv_harmonious_min_perc)))", "HC" : "=IF(GX6=0,0,ROUND((DH6+(EX6-DH6)/(A_equiv_harmonious_max_perc*$U6-A_equiv_harmonious_min_perc)*(GX6-A_equiv_harmonious_min_perc))-(($M6+($N6-$M6)/(A_equiv_harmonious_max_perc-A_equiv_harmonious_min_perc)*($GX6-A_equiv_harmonious_min_perc))-(CY6+(EO6-CY6)/(A_equiv_harmonious_max_perc*$U6-A_equiv_harmonious_min_perc)*(GX6-A_equiv_harmonious_min_perc)))/El_boiler_eff,5))", "HD" : "=IF(GX6=0,0,(DI6+(EY6-DI6)/(A_equiv_harmonious_max_perc*$U6-A_equiv_harmonious_min_perc)*(GX6-A_equiv_harmonious_min_perc))-(($M6+($N6-$M6)/(A_equiv_harmonious_max_perc-A_equiv_harmonious_min_perc)*($GX6-A_equiv_harmonious_min_perc))-(CZ6+(EP6-CZ6)/(A_equiv_harmonious_max_perc*$U6-A_equiv_harmonious_min_perc)*(GX6-A_equiv_harmonious_min_perc)))/El_boiler_eff)", "HE" : "=IF(GX6=0,0,ROUND((DB6+(ER6-DB6)/(A_equiv_harmonious_max_perc*$U6-A_equiv_harmonious_min_perc)*(GX6-A_equiv_harmonious_min_perc))-(CU6+(EK6-CU6)/(A_equiv_harmonious_max_perc*$U6-A_equiv_harmonious_min_perc)*(GX6-A_equiv_harmonious_min_perc))/BESS_chrg_eff,5))", "HF" : "=IF(GX6=0,0,(DC6+(ES6-DC6)/(A_equiv_harmonious_max_perc*$U6-A_equiv_harmonious_min_perc)*(GX6-A_equiv_harmonious_min_perc))-(CU6+(EK6-CU6)/(A_equiv_harmonious_max_perc*$U6-A_equiv_harmonious_min_perc)*(GX6-A_equiv_harmonious_min_perc))/BESS_chrg_eff)", "HG" : "=IF(GX6=0,0,(DK6+(FA6-DK6)/(A_equiv_harmonious_max_perc*$U6-A_equiv_harmonious_min_perc)*(GX6-A_equiv_harmonious_min_perc))-($E6+($F6-$E6)/(A_equiv_harmonious_max_perc-A_equiv_harmonious_min_perc)*(GX6-A_equiv_harmonious_min_perc)))", "HH" : "=IF(GX6=0,0,(DL6+(FB6-DL6)/(A_equiv_harmonious_max_perc*$U6-A_equiv_harmonious_min_perc)*(GX6-A_equiv_harmonious_min_perc))-($E6+($F6-$E6)/(A_equiv_harmonious_max_perc-A_equiv_harmonious_min_perc)*(GX6-A_equiv_harmonious_min_perc)))", "HI" : "=IF(GX6=0,0,(DN6+(FD6-DN6)/(A_equiv_harmonious_max_perc*$U6-A_equiv_harmonious_min_perc)*(GX6-A_equiv_harmonious_min_perc))-($G6+($H6-$G6)/(A_equiv_harmonious_max_perc-A_equiv_harmonious_min_perc)*(GX6-A_equiv_harmonious_min_perc)))", "HJ" : "=IF(GX6=0,0,(DO6+(FE6-DO6)/(A_equiv_harmonious_max_perc*$U6-A_equiv_harmonious_min_perc)*(GX6-A_equiv_harmonious_min_perc))-($G6+($H6-$G6)/(A_equiv_harmonious_max_perc-A_equiv_harmonious_min_perc)*(GX6-A_equiv_harmonious_min_perc)))", "HK" : "=IF(GX6=0,0,(DQ6+(FG6-DQ6)/(A_equiv_harmonious_max_perc*$U6-A_equiv_harmonious_min_perc)*(GX6-A_equiv_harmonious_min_perc))-($I6+($J6-$I6)/(A_equiv_harmonious_max_perc-A_equiv_harmonious_min_perc)*(GX6-A_equiv_harmonious_min_perc)))", "HL" : "=IF(GX6=0,0,(DR6+(FH6-DR6)/(A_equiv_harmonious_max_perc*$U6-A_equiv_harmonious_min_perc)*(GX6-A_equiv_harmonious_min_perc))-($I6+($J6-$I6)/(A_equiv_harmonious_max_perc-A_equiv_harmonious_min_perc)*(GX6-A_equiv_harmonious_min_perc)))", "HM" : "=IF(GX6<=0,0,MIN(1,Overall_harmonious_min_perc+MIN(IF(GZ6>=0,1,GY6/(GY6-GZ6)),IF(HB6>=0,1,HA6/(HA6-HB6)),IF(HD6>=0,1,HC6/(HC6-HD6)),IF(HF6>=0,1,HE6/(HE6-HF6)),IF(HH6>=0,1,HG6/(HG6-HH6)),IF(HJ6>=0,1,HI6/(HI6-HJ6)),IF(HL6>=0,1,HK6/(HK6-HL6)))*(Overall_harmonious_max_perc-Overall_harmonious_min_perc)))",  "HO" : "=IF(OR(GG6=0,GV6=0),0,(CI6+(DY6-CI6)/(A_equiv_harmonious_max_perc*$U6-A_equiv_harmonious_min_perc)*(GV6-A_equiv_harmonious_min_perc))+((CJ6+(DZ6-CJ6)/(A_equiv_harmonious_max_perc*$U6-A_equiv_harmonious_min_perc)*(GV6-A_equiv_harmonious_min_perc))-(CI6+(DY6-CI6)/(A_equiv_harmonious_max_perc*$U6-A_equiv_harmonious_min_perc)*(GV6-A_equiv_harmonious_min_perc)))/(Overall_harmonious_max_perc-Overall_harmonious_min_perc)*(GG6-Overall_harmonious_min_perc))", "HP" : "=IF(OR(GG6=0,GV6=0),0,($K6+($L6-$K6)/(A_equiv_harmonious_max_perc-A_equiv_harmonious_min_perc)*(GV6-A_equiv_harmonious_min_perc)))", "HQ" : "=IF(OR(GG6=0,GV6=0),0,CR6+(EH6-CR6)/(A_equiv_harmonious_max_perc*$U6-A_equiv_harmonious_min_perc)*(GV6-A_equiv_harmonious_min_perc))", "HR" : "=IF(OR(GG6=0,GV6=0),0,MIN(((DB6+(ER6-DB6)/(A_equiv_harmonious_max_perc*$U6-A_equiv_harmonious_min_perc)*(GV6-A_equiv_harmonious_min_perc))+((DC6+(ES6-DC6)/(A_equiv_harmonious_max_perc*$U6-A_equiv_harmonious_min_perc)*(GV6-A_equiv_harmonious_min_perc))-(DB6+(ER6-DB6)/(A_equiv_harmonious_max_perc*$U6-A_equiv_harmonious_min_perc)*(GV6-A_equiv_harmonious_min_perc)))/(Overall_harmonious_max_perc-Overall_harmonious_min_perc)*(GG6-Overall_harmonious_min_perc)),(CU6+(EK6-CU6)/(A_equiv_harmonious_max_perc*$U6-A_equiv_harmonious_min_perc)*(GV6-A_equiv_harmonious_min_perc))/BESS_chrg_eff))", "HS" : "=IF(OR(GG6=0,GV6=0),0,(CO6+(EE6-CO6)/(A_equiv_harmonious_max_perc*$U6-A_equiv_harmonious_min_perc)*(GV6-A_equiv_harmonious_min_perc))+((CP6+(EF6-CP6)/(A_equiv_harmonious_max_perc*$U6-A_equiv_harmonious_min_perc)*(GV6-A_equiv_harmonious_min_perc))-(CO6+(EE6-CO6)/(A_equiv_harmonious_max_perc*$U6-A_equiv_harmonious_min_perc)*(GV6-A_equiv_harmonious_min_perc)))/(Overall_harmonious_max_perc-Overall_harmonious_min_perc)*(GG6-Overall_harmonious_min_perc))", "HT" : "=IA6/El_boiler_eff", "HU" : "=IF(OR(GG6=0,GV6=0),0,CE6+(DU6-CE6)/(A_equiv_harmonious_max_perc*$U6-A_equiv_harmonious_min_perc)*(GV6-A_equiv_harmonious_min_perc))", "HV" : "=IF(OR(GG6=0,GV6=0),0,MIN($D6*Grid_import_max_ud,MAX(0,-(SUM(HU6:HU6)-SUM(HO6:HT6)))))", "HW" : "=SUM(HU6:HV6)-SUM(HO6:HT6)", "HX" : "=IF(OR(GG6=0,GV6=0),0,(CL6+(EB6-CL6)/(A_equiv_harmonious_max_perc*$U6-A_equiv_harmonious_min_perc)*(GV6-A_equiv_harmonious_min_perc))+((CM6+(EC6-CM6)/(A_equiv_harmonious_max_perc*$U6-A_equiv_harmonious_min_perc)*(GV6-A_equiv_harmonious_min_perc))-(CL6+(EB6-CL6)/(A_equiv_harmonious_max_perc*$U6-A_equiv_harmonious_min_perc)*(GV6-A_equiv_harmonious_min_perc)))/(Overall_harmonious_max_perc-Overall_harmonious_min_perc)*(GG6-Overall_harmonious_min_perc))", "HY" : "=IF(OR(GG6=0,GV6=0),0,($M6+($N6-$M6)/(A_equiv_harmonious_max_perc-A_equiv_harmonious_min_perc)*(GV6-A_equiv_harmonious_min_perc)))", "HZ" : "=IF(OR(GG6=0,GV6=0),0,HS6*El_boiler_eff)", "IA" : "=IF(OR(GG6=0,GV6=0),0,MAX(0,HY6-((CY6+(EO6-CY6)/(A_equiv_harmonious_max_perc*$U6-A_equiv_harmonious_min_perc)*(GV6-A_equiv_harmonious_min_perc))+((CZ6+(EP6-CZ6)/(A_equiv_harmonious_max_perc*$U6-A_equiv_harmonious_min_perc)*(GV6-A_equiv_harmonious_min_perc))-(CY6+(EO6-CY6)/(A_equiv_harmonious_max_perc*$U6-A_equiv_harmonious_min_perc)*(GV6-A_equiv_harmonious_min_perc)))/(Overall_harmonious_max_perc-Overall_harmonious_min_perc)*(GG6-Overall_harmonious_min_perc))))", "IB" : "=IF(OR(GG6=0,GV6=0),0,CG6+(DW6-CG6)/(A_equiv_harmonious_max_perc*$U6-A_equiv_harmonious_min_perc)*(GV6-A_equiv_harmonious_min_perc))", "IC" : "=SUM(HZ6:IB6)-SUM(HX6:HY6)", "ID" : "=IF(OR(GG6=0,GV6=0),0,CK6+(EA6-CK6)/(A_equiv_harmonious_max_perc*$U6-A_equiv_harmonious_min_perc)*(GV6-A_equiv_harmonious_min_perc))", "IE" : "=IF(OR(GG6=0,GV6=0),0,CS6+(EI6-CS6)/(A_equiv_harmonious_max_perc*$U6-A_equiv_harmonious_min_perc)*(GV6-A_equiv_harmonious_min_perc))", "IF" : "=IF(OR(GG6=0,GV6=0),0,CQ6+(EG6-CQ6)/(A_equiv_harmonious_max_perc*$U6-A_equiv_harmonious_min_perc)*(GV6-A_equiv_harmonious_min_perc))", "IG" : "=HR6*BESS_chrg_eff", "IH" : "=IF(OR(GG6=0,GV6=0),0,CF6+(DV6-CF6)/(A_equiv_harmonious_max_perc*$U6-A_equiv_harmonious_min_perc)*(GV6-A_equiv_harmonious_min_perc))", "II" : "=IF(OR(GG6=0,GV6=0),0,MIN($C6*Grid_import_max_ud,MAX(0,-(SUM(IG6:IH6)-SUM(ID6:IF6)))))", "IJ" : "=SUM(IG6:II6)-SUM(ID6:IF6)", "IK" : "=IF(OR(GG6=0,GV6=0),0,CN6+(ED6-CN6)/(A_equiv_harmonious_max_perc*$U6-A_equiv_harmonious_min_perc)*(GV6-A_equiv_harmonious_min_perc))", "IL" : "=IF(OR(GG6=0,GV6=0),0,IF6*El_boiler_eff)", "IM" : "=IF(OR(GG6=0,GV6=0),0,CH6+(DX6-CH6)/(A_equiv_harmonious_max_perc*$U6-A_equiv_harmonious_min_perc)*(GV6-A_equiv_harmonious_min_perc))", "IN" : "=SUM(IL6:IM6)-SUM(IK6:IK6)", "IO" : "=IF(HO6<=0,0,HO6/(Overall_harmonious_var_max_cons+Overall_fix_cons)*MethDist_harmonious_max_perc*MethDist_Meth_nom_prod_ud)+IF(ID6<=0,0,ID6/(A_overall_var_max_cons+A_overall_fix_stby_cons)*A_MethDist_max_perc*MethDist_Meth_nom_prod_ud)", "IP" : "=MIN(HW6,IF(OR(GG6=0,GV6=0),0,(DE6+(EU6-DE6)/(A_equiv_harmonious_max_perc*$U6-A_equiv_harmonious_min_perc)*(GV6-A_equiv_harmonious_min_perc))+((DF6+(EV6-DF6)/(A_equiv_harmonious_max_perc*$U6-A_equiv_harmonious_min_perc)*(GV6-A_equiv_harmonious_min_perc))-(DE6+(EU6-DE6)/(A_equiv_harmonious_max_perc*$U6-A_equiv_harmonious_min_perc)*(GV6-A_equiv_harmonious_min_perc)))/(Overall_harmonious_max_perc-Overall_harmonious_min_perc)*(GG6-Overall_harmonious_min_perc)))+MIN(IJ6,IF(OR(GG6=0,GV6=0),0,DG6+(EW6-DG6)/(A_equiv_harmonious_max_perc*$U6-A_equiv_harmonious_min_perc)*(GV6-A_equiv_harmonious_min_perc)))", "IQ" : "=II6+HV6", "IR" : "=MAX(0,-HW6)+MAX(0,-IC6)+MAX(0,-IJ6)+MAX(0,-IN6)",  "IT" : "=IF(OR(HM6=0,GX6=0),0,(CI6+(DY6-CI6)/(A_equiv_harmonious_max_perc*$U6-A_equiv_harmonious_min_perc)*(GX6-A_equiv_harmonious_min_perc))+((CJ6+(DZ6-CJ6)/(A_equiv_harmonious_max_perc*$U6-A_equiv_harmonious_min_perc)*(GX6-A_equiv_harmonious_min_perc))-(CI6+(DY6-$CI6)/(A_equiv_harmonious_max_perc*$U6-A_equiv_harmonious_min_perc)*(GX6-A_equiv_harmonious_min_perc)))/(Overall_harmonious_max_perc-Overall_harmonious_min_perc)*(HM6-Overall_harmonious_min_perc))", "IU" : "=IF(OR(HM6=0,GX6=0),0,($K6+($L6-$K6)/(A_equiv_harmonious_max_perc-A_equiv_harmonious_min_perc)*(GX6-A_equiv_harmonious_min_perc)))", "IV" : "=IF(OR(HM6=0,GX6=0),0,CR6+(EH6-CR6)/(A_equiv_harmonious_max_perc*$U6-A_equiv_harmonious_min_perc)*(GX6-A_equiv_harmonious_min_perc))", "IW" : "=IF(OR(HM6=0,GX6=0),0,MIN(((DB6+(ER6-DB6)/(A_equiv_harmonious_max_perc*$U6-A_equiv_harmonious_min_perc)*(GX6-A_equiv_harmonious_min_perc))+((DC6+(ES6-DC6)/(A_equiv_harmonious_max_perc*$U6-A_equiv_harmonious_min_perc)*(GX6-A_equiv_harmonious_min_perc))-(DB6+(ER6-DB6)/(A_equiv_harmonious_max_perc*$U6-A_equiv_harmonious_min_perc)*(GX6-A_equiv_harmonious_min_perc)))/(Overall_harmonious_max_perc-Overall_harmonious_min_perc)*(HM6-Overall_harmonious_min_perc)),(CU6+(EK6-CU6)/(A_equiv_harmonious_max_perc*$U6-A_equiv_harmonious_min_perc)*(GX6-A_equiv_harmonious_min_perc))/BESS_chrg_eff))", "IX" : "=IF(OR(HM6=0,GX6=0),0,(CO6+(EE6-CO6)/(A_equiv_harmonious_max_perc*$U6-A_equiv_harmonious_min_perc)*(GX6-A_equiv_harmonious_min_perc))+((CP6+(EF6-CP6)/(A_equiv_harmonious_max_perc*$U6-A_equiv_harmonious_min_perc)*(GX6-A_equiv_harmonious_min_perc))-(CO6+(EE6-CO6)/(A_equiv_harmonious_max_perc*$U6-A_equiv_harmonious_min_perc)*(GX6-A_equiv_harmonious_min_perc)))/(Overall_harmonious_max_perc-Overall_harmonious_min_perc)*(HM6-Overall_harmonious_min_perc))", "IY" : "=JF6/El_boiler_eff", "IZ" : "=IF(OR(HM6=0,GX6=0),0,CE6+(DU6-CE6)/(A_equiv_harmonious_max_perc*$U6-A_equiv_harmonious_min_perc)*(GX6-A_equiv_harmonious_min_perc))", "JA" : "=IF(OR(GX6=0,HM6=0),0,MIN($D6*Grid_import_max_ud,MAX(0,-(SUM(IZ6:IZ6)-SUM(IT6:IY6)))))", "JB" : "=SUM(IZ6:JA6)-SUM(IT6:IY6)", "JC" : "=IF(OR(HM6=0,GX6=0),0,(CL6+(EB6-CL6)/(A_equiv_harmonious_max_perc*$U6-A_equiv_harmonious_min_perc)*(GX6-A_equiv_harmonious_min_perc))+((CM6+(EC6-CM6)/(A_equiv_harmonious_max_perc*$U6-A_equiv_harmonious_min_perc)*(GX6-A_equiv_harmonious_min_perc))-(CL6+(EB6-CL6)/(A_equiv_harmonious_max_perc*$U6-A_equiv_harmonious_min_perc)*(GX6-A_equiv_harmonious_min_perc)))/(Overall_harmonious_max_perc-Overall_harmonious_min_perc)*(HM6-Overall_harmonious_min_perc))", "JD" : "=IF(OR(HM6=0,GX6=0),0,($M6+($N6-$M6)/(A_equiv_harmonious_max_perc-A_equiv_harmonious_min_perc)*(GX6-A_equiv_harmonious_min_perc)))", "JE" : "=IF(OR(HM6=0,GX6=0),0,IX6*El_boiler_eff)", "JF" : "=IF(OR(HM6=0,GX6=0),0,MAX(0,JD6-((CY6+(EO6-CY6)/(A_equiv_harmonious_max_perc*$U6-A_equiv_harmonious_min_perc)*(GX6-A_equiv_harmonious_min_perc))+((CZ6+(EP6-CZ6)/(A_equiv_harmonious_max_perc*$U6-A_equiv_harmonious_min_perc)*(GX6-A_equiv_harmonious_min_perc))-(CY6+(EO6-CY6)/(A_equiv_harmonious_max_perc*$U6-A_equiv_harmonious_min_perc)*(GX6-A_equiv_harmonious_min_perc)))/(Overall_harmonious_max_perc-Overall_harmonious_min_perc)*(HM6-Overall_harmonious_min_perc))))", "JG" : "=IF(OR(HM6=0,GX6=0),0,CG6+(DW6-CG6)/(A_equiv_harmonious_max_perc*$U6-A_equiv_harmonious_min_perc)*(GX6-A_equiv_harmonious_min_perc))", "JH" : "=SUM(JE6:JG6)-SUM(JC6:JD6)", "JI" : "=IF(OR(HM6=0,GX6=0),0,CK6+(EA6-CK6)/(A_equiv_harmonious_max_perc*$U6-A_equiv_harmonious_min_perc)*(GX6-A_equiv_harmonious_min_perc))", "JJ" : "=IF(OR(HM6=0,GX6=0),0,CS6+(EI6-CS6)/(A_equiv_harmonious_max_perc*$U6-A_equiv_harmonious_min_perc)*(GX6-A_equiv_harmonious_min_perc))", "JK" : "=IF(OR(HM6=0,GX6=0),0,CQ6+(EG6-CQ6)/(A_equiv_harmonious_max_perc*$U6-A_equiv_harmonious_min_perc)*(GX6-A_equiv_harmonious_min_perc))", "JL" : "=IW6*BESS_chrg_eff", "JM" : "=IF(OR(HM6=0,GX6=0),0,CF6+(DV6-CF6)/(A_equiv_harmonious_max_perc*$U6-A_equiv_harmonious_min_perc)*(GX6-A_equiv_harmonious_min_perc))", "JN" : "=IF(OR(HM6=0,GX6=0),0,MIN($C6*Grid_import_max_ud,MAX(0,-(SUM(JL6:JM6)-SUM(JI6:JK6)))))", "JO" : "=SUM(JL6:JN6)-SUM(JI6:JK6)", "JP" : "=IF(OR(HM6=0,GX6=0),0,CN6+(ED6-CN6)/(A_equiv_harmonious_max_perc*$U6-A_equiv_harmonious_min_perc)*(GX6-A_equiv_harmonious_min_perc))", "JQ" : "=IF(OR(HM6=0,GX6=0),0,JK6*El_boiler_eff)", "JR" : "=IF(OR(HM6=0,GX6=0),0,CH6+(DX6-CH6)/(A_equiv_harmonious_max_perc*$U6-A_equiv_harmonious_min_perc)*(GX6-A_equiv_harmonious_min_perc))", "JS" : "=SUM(JQ6:JR6)-SUM(JP6:JP6)", "JT" : "=IF(IT6<=0,0,IT6/(Overall_harmonious_var_max_cons+Overall_fix_cons)*MethDist_harmonious_max_perc*MethDist_Meth_nom_prod_ud)+IF(JI6<=0,0,JI6/(A_overall_var_max_cons+A_overall_fix_stby_cons)*A_MethDist_max_perc*MethDist_Meth_nom_prod_ud)", "JU" : "=MIN(JB6,IF(OR(HM6=0,GX6=0),0,(DE6+(EU6-DE6)/(A_equiv_harmonious_max_perc*$U6-A_equiv_harmonious_min_perc)*(GX6-A_equiv_harmonious_min_perc))+((DF6+(EV6-DF6)/(A_equiv_harmonious_max_perc*$U6-A_equiv_harmonious_min_perc)*(GX6-A_equiv_harmonious_min_perc))-(DE6+(EU6-DE6)/(A_equiv_harmonious_max_perc*$U6-A_equiv_harmonious_min_perc)*(GX6-A_equiv_harmonious_min_perc)))/(Overall_harmonious_max_perc-Overall_harmonious_min_perc)*(HM6-Overall_harmonious_min_perc)))+MIN(JO6,IF(OR(HM6=0,GX6=0),0,DG6+(EW6-DG6)/(A_equiv_harmonious_max_perc*$U6-A_equiv_harmonious_min_perc)*(GX6-A_equiv_harmonious_min_perc)))", "JV" : "=JN6+JA6", "JW" : "=MAX(0,-JB6)+MAX(0,-JH6)+MAX(0,-JO6)+MAX(0,-JS6)",  "JY" : "=SUMIFS(Calculation$L$5:$L$8763,Calculation$GV$5:$GV$8763,\"=\"&$A6,Calculation$GT$5:$GT$8763,\">0\")+SUMIFS(Calculation$GA$5:$GA$8763,Calculation$GF$5:$GF$8763,\">0\",Calculation$GV$5:$GV$8763,\"=\"&$A6,Calculation$GT$5:$GT$8763,\">0\")-SUMIFS(Calculation$GL$5:$GL$8763,Calculation$GV$5:$GV$8763,\"=\"&$A6,Calculation$GT$5:$GT$8763,\">0\")", "JZ" : "=SUMIFS(Calculation$L$5:$L$8763,Calculation$GV$5:$GV$8763,\"=\"&$A6,Calculation$GT$5:$GT$8763,\"=0\")+SUMIFS(Calculation$GA$5:$GA$8763,Calculation$GF$5:$GF$8763,\">0\",Calculation$GV$5:$GV$8763,\"=\"&$A6,Calculation$GT$5:$GT$8763,\"=0\")-SUMIFS(Calculation$GL$5:$GL$8763,Calculation$GV$5:$GV$8763,\"=\"&$A6,Calculation$GT$5:$GT$8763,\"=0\")", "KA" : "=SUMIFS(Calculation$J$5:$J$8763,Calculation$GV$5:$GV$8763,\"=\"&$A6,Calculation$GT$5:$GT$8763,\">0\")+SUMIFS(Calculation$GE$5:$GE$8763,Calculation$GF$5:$GF$8763,\">0\",Calculation$GV$5:$GV$8763,\"=\"&$A6,Calculation$GT$5:$GT$8763,\">0\")/PB_Ratio_Heat_input_vs_output-SUMIFS(Calculation$GM$5:$GM$8763,Calculation$GV$5:$GV$8763,\"=\"&$A6,Calculation$GT$5:$GT$8763,\">0\")", "KB" : "=SUMIFS(Calculation$J$5:$J$8763,Calculation$GV$5:$GV$8763,\"=\"&$A6,Calculation$GT$5:$GT$8763,\"=0\")+SUMIFS(Calculation$GE$5:$GE$8763,Calculation$GF$5:$GF$8763,\">0\",Calculation$GV$5:$GV$8763,\"=\"&$A6,Calculation$GT$5:$GT$8763,\"=0\")/PB_Ratio_Heat_input_vs_output-SUMIFS(Calculation$GM$5:$GM$8763,Calculation$GV$5:$GV$8763,\"=\"&$A6,Calculation$GT$5:$GT$8763,\"=0\")", "KC" : "=SUMIF(Calculation$GV$5:$GV$8763,\"=\"&$A6,Calculation$GT$5:$GT$8763)+SUMIFS(Calculation$GW$5:$GW$8763,Calculation$GV$5:$GV$8763,\"=\"&$A6,Calculation$GT$5:$GT$8763,\">0\")", "KD" : "=SUMIF(Calculation$GV$5:$GV$8763,\"=\"&$A6,Calculation$HK$5:$HK$8763)+SUMIFS(Calculation$GW$5:$GW$8763,Calculation$GV$5:$GV$8763,\"=\"&$A6,Calculation$HK$5:$HK$8763,\">0\")", "KE" : "=SUMIFS(Calculation$GW$5:$GW$8763,Calculation$GV$5:$GV$8763,\"=\"&$A6,Calculation$GT$5:$GT$8763,\"=0\")", "KF" : "=SUMIF(Calculation$GV$5:$GV$8763,\"=\"&$A6,Calculation$GU$5:$GU$8763)+SUMIFS(Calculation$GX$5:$GX$8763,Calculation$GV$5:$GV$8763,\"=\"&$A6,Calculation$GT$5:$GT$8763,\">0\")", "KG" : "=SUMIF(Calculation$GV$5:$GV$8763,\"=\"&$A6,Calculation$HL$5:$HL$8763)+SUMIFS(Calculation$GX$5:$GX$8763,Calculation$GV$5:$GV$8763,\"=\"&$A6,Calculation$HK$5:$HK$8763,\">0\")", "KH" : "=SUMIFS(Calculation$GX$5:$GX$8763,Calculation$GV$5:$GV$8763,\"=\"&$A6,Calculation$GT$5:$GT$8763,\"=0\")", "KI" : "=SUMIFS(Calculation$HC$5:$HC$8763,Calculation$GV$5:$GV$8763,\"=\"&$A6,Calculation$GT$5:$GT$8763,\">0\")", "KJ" : "=SUMIFS(Calculation$HQ$5:$HQ$8763,Calculation$GV$5:$GV$8763,\"=\"&$A6,Calculation$HK$5:$HK$8763,\">0\")", "KK" : "=SUMIF(Calculation$GV$5:$GV$8763,\"=\"&$A6,Calculation$HC$5:$HC$8763)-KI6", "KL" : "=SUMIFS(Calculation$GP$5:$GP$8763,Calculation$GV$5:$GV$8763,\"=\"&$A6,Calculation$GT$5:$GT$8763,\">0\")", "KM" : "=SUMIF(Calculation$GV$5:$GV$8763,\"=\"&$A6,Calculation$GP$5:$GP$8763)-KL6", "KN" : "=SUMIFS(Calculation$GQ$5:$GQ$8763,Calculation$GV$5:$GV$8763,\"=\"&$A6,Calculation$GT$5:$GT$8763,\">0\")", "KO" : "=SUMIF(Calculation$GV$5:$GV$8763,\"=\"&$A6,Calculation$GQ$5:$GQ$8763)-KN6", "KP" : "=SUMIFS(Calculation$GY$5:$GY$8763,Calculation$GV$5:$GV$8763,\"=\"&$A6,Calculation$GT$5:$GT$8763,\">0\")", "KQ" : "=SUMIFS(Calculation$HM$5:$HM$8763,Calculation$GV$5:$GV$8763,\"=\"&$A6,Calculation$HK$5:$HK$8763,\">0\")", "KR" : "=SUMIF(Calculation$GV$5:$GV$8763,\"=\"&$A6,Calculation$GY$5:$GY$8763)-KP6", "KS" : "=SUMIFS(Calculation$GZ$5:$GZ$8763,Calculation$GV$5:$GV$8763,\"=\"&$A6,Calculation$GT$5:$GT$8763,\">0\")", "KT" : "=SUMIFS(Calculation$HN$5:$HN$8763,Calculation$GV$5:$GV$8763,\"=\"&$A6,Calculation$HK$5:$HK$8763,\">0\")", "KU" : "=SUMIF(Calculation$GV$5:$GV$8763,\"=\"&$A6,Calculation$GZ$5:$GZ$8763)-KS6", "KV" : "=MIN(SUMIFS(Calculation$HH$5:$HH$8763,Calculation$GV$5:$GV$8763,\"=\"&$A6,Calculation$GT$5:$GT$8763,\">0\"),BESS_cap_ud/BESS_chrg_eff)", "KW" : "=MIN(SUMIFS(Calculation$HV$5:$HV$8763,Calculation$GV$5:$GV$8763,\"=\"&$A6,Calculation$HK$5:$HK$8763,\">0\"),BESS_cap_ud/BESS_chrg_eff)", "KX" : "=MIN(SUMIFS(Calculation$HH$5:$HH$8763,Calculation$GV$5:$GV$8763,\"=\"&$A6,Calculation$GT$5:$GT$8763,\"=0\"),BESS_cap_ud/BESS_chrg_eff)", "KY" : "=SUMIFS(Calculation$HI$5:$HI$8763,Calculation$GV$5:$GV$8763,\"=\"&$A6,Calculation$GT$5:$GT$8763,\">0\")", "KZ" : "=SUMIFS(Calculation$HW$5:$HW$8763,Calculation$GV$5:$GV$8763,\"=\"&$A6,Calculation$HK$5:$HK$8763,\">0\")", "LA" : "=SUMIF(Calculation$GV$5:$GV$8763,\"=\"&$A6,Calculation$HI$5:$HI$8763)-KY6", "LB" : "=SUMIFS(Calculation$HD$5:$HD$8763,Calculation$GV$5:$GV$8763,\"=\"&$A6,Calculation$GT$5:$GT$8763,\">0\")", "LC" : "=SUMIFS(Calculation$HR$5:$HR$8763,Calculation$GV$5:$GV$8763,\"=\"&$A6,Calculation$HK$5:$HK$8763,\">0\")", "LD" : "=SUMIF(Calculation$GV$5:$GV$8763,\"=\"&$A6,Calculation$HD$5:$HD$8763)-LB6", "LE" : "=SUMIFS(Calculation$HE$5:$HE$8763,Calculation$GV$5:$GV$8763,\"=\"&$A6,Calculation$GT$5:$GT$8763,\">0\")", "LF" : "=SUMIFS(Calculation$HS$5:$HS$8763,Calculation$GV$5:$GV$8763,\"=\"&$A6,Calculation$HK$5:$HK$8763,\">0\")", "LG" : "=SUMIF(Calculation$GV$5:$GV$8763,\"=\"&$A6,Calculation$HE$5:$HE$8763)-LE6", "LH" : "=SUMIFS(Calculation$HF$5:$HF$8763,Calculation$GV$5:$GV$8763,\"=\"&$A6,Calculation$GT$5:$GT$8763,\">0\")", "LI" : "=SUMIFS(Calculation$HT$5:$HT$8763,Calculation$GV$5:$GV$8763,\"=\"&$A6,Calculation$HK$5:$HK$8763,\">0\")", "LJ" : "=SUMIF(Calculation$GV$5:$GV$8763,\"=\"&$A6,Calculation$HF$5:$HF$8763)-LH6", "LK" : "=SUMIFS(Calculation$HG$5:$HG$8763,Calculation$GV$5:$GV$8763,\"=\"&$A6,Calculation$GT$5:$GT$8763,\">0\")", "LL" : "=SUMIFS(Calculation$HU$5:$HU$8763,Calculation$GV$5:$GV$8763,\"=\"&$A6,Calculation$HK$5:$HK$8763,\">0\")", "LM" : "=SUMIF(Calculation$GV$5:$GV$8763,\"=\"&$A6,Calculation$HG$5:$HG$8763)-LK6",  "LO" : "=SUMIFS(Calculation$L$5:$L$8763,Calculation$IX$5:$IX$8763,\"=\"&$A6,Calculation$IV$5:$IV$8763,\">0\")+SUMIFS(Calculation$IC$5:$IC$8763,Calculation$IH$5:$IH$8763,\">0\",Calculation$IX$5:$IX$8763,\"=\"&$A6,Calculation$IV$5:$IV$8763,\">0\")-SUMIFS(Calculation$IN$5:$IN$8763,Calculation$IX$5:$IX$8763,\"=\"&$A6,Calculation$IV$5:$IV$8763,\">0\")", "LP" : "=SUMIFS(Calculation$L$5:$L$8763,Calculation$IX$5:$IX$8763,\"=\"&$A6,Calculation$IV$5:$IV$8763,\"=0\")+SUMIFS(Calculation$IC$5:$IC$8763,Calculation$IH$5:$IH$8763,\">0\",Calculation$IX$5:$IX$8763,\"=\"&$A6,Calculation$IV$5:$IV$8763,\"=0\")-SUMIFS(Calculation$IN$5:$IN$8763,Calculation$IX$5:$IX$8763,\"=\"&$A6,Calculation$IV$5:$IV$8763,\"=0\")", "LQ" : "=SUMIFS(Calculation$J$5:$J$8763,Calculation$IX$5:$IX$8763,\"=\"&$A6,Calculation$IV$5:$IV$8763,\">0\")+SUMIFS(Calculation$IG$5:$IG$8763,Calculation$IH$5:$IH$8763,\">0\",Calculation$IX$5:$IX$8763,\"=\"&$A6,Calculation$IV$5:$IV$8763,\">0\")/PB_Ratio_Heat_input_vs_output-SUMIFS(Calculation$IO$5:$IO$8763,Calculation$IX$5:$IX$8763,\"=\"&$A6,Calculation$IV$5:$IV$8763,\">0\")", "LR" : "=SUMIFS(Calculation$J$5:$J$8763,Calculation$IX$5:$IX$8763,\"=\"&$A6,Calculation$IV$5:$IV$8763,\"=0\")+SUMIFS(Calculation$IG$5:$IG$8763,Calculation$IH$5:$IH$8763,\">0\",Calculation$IX$5:$IX$8763,\"=\"&$A6,Calculation$IV$5:$IV$8763,\"=0\")/PB_Ratio_Heat_input_vs_output-SUMIFS(Calculation$IO$5:$IO$8763,Calculation$IX$5:$IX$8763,\"=\"&$A6,Calculation$IV$5:$IV$8763,\"=0\")", "LS" : "=SUMIF(Calculation$IX$5:$IX$8763,\"=\"&$A6,Calculation$IV$5:$IV$8763)+SUMIFS(Calculation$IY$5:$IY$8763,Calculation$IX$5:$IX$8763,\"=\"&$A6,Calculation$IV$5:$IV$8763,\">0\")", "LT" : "=SUMIF(Calculation$IX$5:$IX$8763,\"=\"&$A6,Calculation$JM$5:$JM$8763)+SUMIFS(Calculation$IY$5:$IY$8763,Calculation$IX$5:$IX$8763,\"=\"&$A6,Calculation$JM$5:$JM$8763,\">0\")", "LU" : "=SUMIFS(Calculation$IY$5:$IY$8763,Calculation$IX$5:$IX$8763,\"=\"&$A6,Calculation$IV$5:$IV$8763,\"=0\")", "LV" : "=SUMIF(Calculation$IX$5:$IX$8763,\"=\"&$A6,Calculation$IW$5:$IW$8763)+SUMIFS(Calculation$IZ$5:$IZ$8763,Calculation$IX$5:$IX$8763,\"=\"&$A6,Calculation$IV$5:$IV$8763,\">0\")", "LW" : "=SUMIF(Calculation$IX$5:$IX$8763,\"=\"&$A6,Calculation$JN$5:$JN$8763)+SUMIFS(Calculation$IZ$5:$IZ$8763,Calculation$IX$5:$IX$8763,\"=\"&$A6,Calculation$JM$5:$JM$8763,\">0\")", "LX" : "=SUMIFS(Calculation$IZ$5:$IZ$8763,Calculation$IX$5:$IX$8763,\"=\"&$A6,Calculation$IV$5:$IV$8763,\"=0\")", "LY" : "=SUMIFS(Calculation$JE$5:$JE$8763,Calculation$IX$5:$IX$8763,\"=\"&$A6,Calculation$IV$5:$IV$8763,\">0\")", "LZ" : "=SUMIFS(Calculation$JS$5:$JS$8763,Calculation$IX$5:$IX$8763,\"=\"&$A6,Calculation$JM$5:$JM$8763,\">0\")", "MA" : "=SUMIF(Calculation$IX$5:$IX$8763,\"=\"&$A6,Calculation$JE$5:$JE$8763)-LY6", "MB" : "=SUMIFS(Calculation$IR$5:$IR$8763,Calculation$IX$5:$IX$8763,\"=\"&$A6,Calculation$IV$5:$IV$8763,\">0\")", "MC" : "=SUMIF(Calculation$IX$5:$IX$8763,\"=\"&$A6,Calculation$IR$5:$IR$8763)-MB6", "MD" : "=SUMIFS(Calculation$IS$5:$IS$8763,Calculation$IX$5:$IX$8763,\"=\"&$A6,Calculation$IV$5:$IV$8763,\">0\")", "ME" : "=SUMIF(Calculation$IX$5:$IX$8763,\"=\"&$A6,Calculation$IS$5:$IS$8763)-MD6", "MF" : "=SUMIFS(Calculation$JA$5:$JA$8763,Calculation$IX$5:$IX$8763,\"=\"&$A6,Calculation$IV$5:$IV$8763,\">0\")", "MG" : "=SUMIFS(Calculation$JO$5:$JO$8763,Calculation$IX$5:$IX$8763,\"=\"&$A6,Calculation$JM$5:$JM$8763,\">0\")", "MH" : "=SUMIF(Calculation$IX$5:$IX$8763,\"=\"&$A6,Calculation$JA$5:$JA$8763)-MF6", "MI" : "=SUMIFS(Calculation$JB$5:$JB$8763,Calculation$IX$5:$IX$8763,\"=\"&$A6,Calculation$IV$5:$IV$8763,\">0\")", "MJ" : "=SUMIFS(Calculation$JP$5:$JP$8763,Calculation$IX$5:$IX$8763,\"=\"&$A6,Calculation$JM$5:$JM$8763,\">0\")", "MK" : "=SUMIF(Calculation$IX$5:$IX$8763,\"=\"&$A6,Calculation$JB$5:$JB$8763)-MI6", "ML" : "=MIN(SUMIFS(Calculation$JJ$5:$JJ$8763,Calculation$IX$5:$IX$8763,\"=\"&$A6,Calculation$IV$5:$IV$8763,\">0\"),BESS_cap_ud/BESS_chrg_eff)", "MM" : "=MIN(SUMIFS(Calculation$JX$5:$JX$8763,Calculation$IX$5:$IX$8763,\"=\"&$A6,Calculation$JM$5:$JM$8763,\">0\"),BESS_cap_ud/BESS_chrg_eff)", "MN" : "=MIN(SUMIFS(Calculation$JJ$5:$JJ$8763,Calculation$IX$5:$IX$8763,\"=\"&$A6,Calculation$IV$5:$IV$8763,\"=0\"),BESS_cap_ud/BESS_chrg_eff)", "MO" : "=SUMIFS(Calculation$JK$5:$JK$8763,Calculation$IX$5:$IX$8763,\"=\"&$A6,Calculation$IV$5:$IV$8763,\">0\")", "MP" : "=SUMIFS(Calculation$JY$5:$JY$8763,Calculation$IX$5:$IX$8763,\"=\"&$A6,Calculation$JM$5:$JM$8763,\">0\")", "MQ" : "=SUMIF(Calculation$IX$5:$IX$8763,\"=\"&$A6,Calculation$JK$5:$JK$8763)-MO6", "MR" : "=SUMIFS(Calculation$JF$5:$JF$8763,Calculation$IX$5:$IX$8763,\"=\"&$A6,Calculation$IV$5:$IV$8763,\">0\")", "MS" : "=SUMIFS(Calculation$JT$5:$JT$8763,Calculation$IX$5:$IX$8763,\"=\"&$A6,Calculation$JM$5:$JM$8763,\">0\")", "MT" : "=SUMIF(Calculation$IX$5:$IX$8763,\"=\"&$A6,Calculation$JF$5:$JF$8763)-MR6", "MU" : "=SUMIFS(Calculation$JG$5:$JG$8763,Calculation$IX$5:$IX$8763,\"=\"&$A6,Calculation$IV$5:$IV$8763,\">0\")", "MV" : "=SUMIFS(Calculation$JU$5:$JU$8763,Calculation$IX$5:$IX$8763,\"=\"&$A6,Calculation$JM$5:$JM$8763,\">0\")", "MW" : "=SUMIF(Calculation$IX$5:$IX$8763,\"=\"&$A6,Calculation$JG$5:$JG$8763)-MU6", "MX" : "=SUMIFS(Calculation$JH$5:$JH$8763,Calculation$IX$5:$IX$8763,\"=\"&$A6,Calculation$IV$5:$IV$8763,\">0\")", "MY" : "=SUMIFS(Calculation$JV$5:$JV$8763,Calculation$IX$5:$IX$8763,\"=\"&$A6,Calculation$JM$5:$JM$8763,\">0\")", "MZ" : "=SUMIF(Calculation$IX$5:$IX$8763,\"=\"&$A6,Calculation$JH$5:$JH$8763)-MX6", "NA" : "=SUMIFS(Calculation$JI$5:$JI$8763,Calculation$IX$5:$IX$8763,\"=\"&$A6,Calculation$IV$5:$IV$8763,\">0\")", "NB" : "=SUMIFS(Calculation$JW$5:$JW$8763,Calculation$IX$5:$IX$8763,\"=\"&$A6,Calculation$JM$5:$JM$8763,\">0\")", "NC" : "=SUMIF(Calculation$IX$5:$IX$8763,\"=\"&$A6,Calculation$JI$5:$JI$8763)-NA6",  "NE" : "=KP6-$AE6-MAX(0,$AG6-KS6)/El_boiler_eff-KO6/BESS_chrg_eff", "NF" : "=MF6-($AE6+($AF6-$AE6)/(B_equiv_harmonious_max_perc-B_equiv_harmonious_min_perc)*($AO6-B_equiv_harmonious_min_perc))-MAX(0,($AG6+($AH6-$AG6)/(B_equiv_harmonious_max_perc-B_equiv_harmonious_min_perc)*($AO6-B_equiv_harmonious_min_perc))-MI6)/El_boiler_eff-ME6/BESS_chrg_eff", "NG" : "=KQ6-$AE6-MAX(0,$AG6-KT6)/El_boiler_eff-KO6/BESS_chrg_eff", "NH" : "=KS6+MAX(0,KP6-$AE6-KO6/BESS_chrg_eff)*El_boiler_eff-$AG6", "NI" : "=MI6+MAX(0,MF6-($AE6+($AF6-$AE6)/(B_equiv_harmonious_max_perc-B_equiv_harmonious_min_perc)*($AO6-B_equiv_harmonious_min_perc))-ME6/BESS_chrg_eff)*El_boiler_eff-($AG6+($AH6-$AG6)/(B_equiv_harmonious_max_perc-B_equiv_harmonious_min_perc)*($AO6-B_equiv_harmonious_min_perc))", "NJ" : "=KT6+MAX(0,KQ6-$AE6-KO6/BESS_chrg_eff)*El_boiler_eff-$AG6", "NK" : "=LB6-($AG6-KS6)/El_boiler_eff", "NL" : "=MR6-(($AG6+($AH6-$AG6)/(B_equiv_harmonious_max_perc-B_equiv_harmonious_min_perc)*($AO6-B_equiv_harmonious_min_perc))-MI6)/El_boiler_eff", "NM" : "=LC6-($AG6-KT6)/El_boiler_eff", "NN" : "=KV6-KO6/BESS_chrg_eff", "NO" : "=ML6-ME6/BESS_chrg_eff", "NP" : "=KW6-KO6/BESS_chrg_eff", "NQ" : "=LE6-$Y6", "NR" : "=MU6-($Y6+($Z6-$Y6)/(B_equiv_harmonious_max_perc-B_equiv_harmonious_min_perc)*($AO6-B_equiv_harmonious_min_perc))", "NS" : "=LF6-$Y6", "NT" : "=LH6-$AA6", "NU" : "=MX6-($AA6+($AB6-$AA6)/(B_equiv_harmonious_max_perc-B_equiv_harmonious_min_perc)*($AO6-B_equiv_harmonious_min_perc))", "NV" : "=LI6-$AA6", "NW" : "=LK6-$AC6", "NX" : "=NA6-($AC6+($AD6-$AC6)/(B_equiv_harmonious_max_perc-B_equiv_harmonious_min_perc)*($AO6-B_equiv_harmonious_min_perc))", "NY" : "=LL6-$AC6",  "OA" : "=IF(OR(NE6<0,NH6<0,NK6<0,NN6<0,NQ6<0,NT6<0,NW6<0),0,MIN(1,Overall_harmonious_min_perc+MIN(IFERROR(NE6/(NE6-NG6),1),IFERROR(NH6/(NH6-NJ6),1),IFERROR(NK6/(NK6-NM6),1),IFERROR(NN6/(NN6-NP6),1),IFERROR(NQ6/(NQ6-NS6),1),IFERROR(NT6/(NT6-NV6),1),IFERROR(NW6/(NW6-NY6),1))*(Overall_harmonious_max_perc-Overall_harmonious_min_perc)))", "OB" : "=IF(OA6=0,0,ROUND((KP6+(KQ6-KP6)/(Overall_harmonious_max_perc-Overall_harmonious_min_perc)*(OA6-Overall_harmonious_min_perc))-$AE6-MAX(0,$AG6-(KS6+(KT6-KS6)/(Overall_harmonious_max_perc-Overall_harmonious_min_perc)*(OA6-Overall_harmonious_min_perc)))/El_boiler_eff-KO6/BESS_chrg_eff,5))", "OC" : "=IF(OA6=0,0,(MF6+(MG6-MF6)/(Overall_harmonious_max_perc-Overall_harmonious_min_perc)*(OA6-Overall_harmonious_min_perc))-($AE6+($AF6-$AE6)/(B_equiv_harmonious_max_perc-B_equiv_harmonious_min_perc)*($AO6-B_equiv_harmonious_min_perc))-MAX(0,($AG6+($AH6-$AG6)/(B_equiv_harmonious_max_perc-B_equiv_harmonious_min_perc)*($AO6-B_equiv_harmonious_min_perc))-(MI6+(MJ6-MI6)/(Overall_harmonious_max_perc-Overall_harmonious_min_perc)*(OA6-Overall_harmonious_min_perc)))/El_boiler_eff-ME6/BESS_chrg_eff)", "OD" : "=IF(OA6=0,0,ROUND((KS6+(KT6-KS6)/(Overall_harmonious_max_perc-Overall_harmonious_min_perc)*(OA6-Overall_harmonious_min_perc))+MAX(0,(KP6+(KQ6-KP6)/(Overall_harmonious_max_perc-Overall_harmonious_min_perc)*(OA6-Overall_harmonious_min_perc))-$AE6-KO6/BESS_chrg_eff)*El_boiler_eff-$AG6,5))", "OE" : "=IF(OA6=0,0,(MI6+(MJ6-MI6)/(Overall_harmonious_max_perc-Overall_harmonious_min_perc)*(OA6-Overall_harmonious_min_perc))+MAX(0,(MF6+(MG6-MF6)/(Overall_harmonious_max_perc-Overall_harmonious_min_perc)*(OA6-Overall_harmonious_min_perc))-($AE6+($AF6-$AE6)/(B_equiv_harmonious_max_perc-B_equiv_harmonious_min_perc)*($AO6-B_equiv_harmonious_min_perc))-ME6/BESS_chrg_eff)*El_boiler_eff-($AG6+($AH6-$AG6)/(B_equiv_harmonious_max_perc-B_equiv_harmonious_min_perc)*($AO6-B_equiv_harmonious_min_perc)))", "OF" : "=IF(OA6=0,0,ROUND((LB6+(LC6-LB6)/(Overall_harmonious_max_perc-Overall_harmonious_min_perc)*(OA6-Overall_harmonious_min_perc))-($AG6-(KS6+(KT6-KS6)/(Overall_harmonious_max_perc-Overall_harmonious_min_perc)*(OA6-Overall_harmonious_min_perc)))/El_boiler_eff,5))", "OG" : "=IF(OA6=0,0,(MR6+(MS6-MR6)/(Overall_harmonious_max_perc-Overall_harmonious_min_perc)*(OA6-Overall_harmonious_min_perc))-(($AG6+($AH6-$AG6)/(B_equiv_harmonious_max_perc-B_equiv_harmonious_min_perc)*($AO6-B_equiv_harmonious_min_perc))-(MI6+(MJ6-MI6)/(Overall_harmonious_max_perc-Overall_harmonious_min_perc)*(OA6-Overall_harmonious_min_perc)))/El_boiler_eff)", "OH" : "=IF(OA6=0,0,ROUND((KV6+(KW6-KV6)/(Overall_harmonious_max_perc-Overall_harmonious_min_perc)*(OA6-Overall_harmonious_min_perc))-KO6/BESS_chrg_eff,5))", "OI" : "=IF(OA6=0,0,(ML6+(MM6-ML6)/(Overall_harmonious_max_perc-Overall_harmonious_min_perc)*(OA6-Overall_harmonious_min_perc))-ME6/BESS_chrg_eff)", "OJ" : "=IF(OA6=0,0,ROUND((LE6+(LF6-LE6)/(Overall_harmonious_max_perc-Overall_harmonious_min_perc)*(OA6-Overall_harmonious_min_perc))-$Y6,5))", "OK" : "=IF(OA6=0,0,LE6+(LF6-LE6)/(Overall_harmonious_max_perc-Overall_harmonious_min_perc)*(OA6-Overall_harmonious_min_perc)-($Y6+($Z6-$Y6)/(B_equiv_harmonious_max_perc-B_equiv_harmonious_min_perc)*($AO6-B_equiv_harmonious_min_perc)))", "OL" : "=IF(OA6=0,0,ROUND((LH6+(LI6-LH6)/(Overall_harmonious_max_perc-Overall_harmonious_min_perc)*(OA6-Overall_harmonious_min_perc))-$AA6,5))", "OM" : "=IF(OA6=0,0,LH6+(LI6-LH6)/(Overall_harmonious_max_perc-Overall_harmonious_min_perc)*(OA6-Overall_harmonious_min_perc)-($AA6+($AB6-$AA6)/(B_equiv_harmonious_max_perc-B_equiv_harmonious_min_perc)*($AO6-B_equiv_harmonious_min_perc)))", "ON" : "=IF(OA6=0,0,ROUND((LK6+(LL6-LK6)/(Overall_harmonious_max_perc-Overall_harmonious_min_perc)*(OA6-Overall_harmonious_min_perc))-$AC6,5))", "OO" : "=IF(OA6=0,0,LK6+(LL6-LK6)/(Overall_harmonious_max_perc-Overall_harmonious_min_perc)*(OA6-Overall_harmonious_min_perc)-($AC6+($AD6-$AC6)/(B_equiv_harmonious_max_perc-B_equiv_harmonious_min_perc)*($AO6-B_equiv_harmonious_min_perc)))", "OP" : "=IF(OR(OA6=0,OB6<0,OD6<0,OF6<0,OH6<0,OJ6<0,OL6<0,ON6<0),0,MIN(1,B_equiv_harmonious_min_perc+MIN(IF(OC6>=0,1,OB6/(OB6-OC6)),IF(OE6>=0,1,OD6/(OD6-OE6)),IF(OG6>=0,1,OF6/(OF6-OG6)),IF(OI6>=0,1,OH6/(OH6-OI6)),IF(OK6>=0,1,OJ6/(OJ6-OK6)),IF(OM6>=0,1,OL6/(OL6-OM6)),IF(OO6>=0,1,ON6/(ON6-OO6)))*(B_equiv_harmonious_max_perc*$AO6-B_equiv_harmonious_min_perc)))",  "OR" : "=IF(OR(NE6<0,NH6<0,NK6<0,NN6<0,NQ6<0,NT6<0,NW6<0),0,MIN(1,B_equiv_harmonious_min_perc+MIN(IF(NF6>=0,1,NE6/(NE6-NF6)),IF(NI6>=0,1,NH6/(NH6-NI6)),IF(NL6>=0,1,NK6/(NK6-NL6)),IF(NO6>=0,1,NN6/(NN6-NO6)),IF(NR6>=0,1,NQ6/(NQ6-NR6)),IF(NU6>=0,1,NT6/(NT6-NU6)),IF(NX6>=0,1,NW6/(NW6-NX6)))*(B_equiv_harmonious_max_perc*$AO6-B_equiv_harmonious_min_perc)))", "OS" : "=IF(OR6=0,0,ROUND((KP6+(MF6-KP6)/(B_equiv_harmonious_max_perc*$AO6-B_equiv_harmonious_min_perc)*(OR6-B_equiv_harmonious_min_perc))-($AE6+($AF6-$AE6)/(B_equiv_harmonious_max_perc-B_equiv_harmonious_min_perc)*(OR6-B_equiv_harmonious_min_perc))-MAX(0,($AG6+($AH6-$AG6)/(B_equiv_harmonious_max_perc-B_equiv_harmonious_min_perc)*(OR6-B_equiv_harmonious_min_perc))-(KS6+(MI6-KS6)/(B_equiv_harmonious_max_perc*$AO6-B_equiv_harmonious_min_perc)*(OR6-B_equiv_harmonious_min_perc)))/El_boiler_eff-(KO6+(ME6-KO6)/(B_equiv_harmonious_max_perc*$AO6-B_equiv_harmonious_min_perc)*(OR6-B_equiv_harmonious_min_perc))/BESS_chrg_eff,5))", "OT" : "=IF(OR6=0,0,(KQ6+(MG6-KQ6)/(B_equiv_harmonious_max_perc*$AO6-B_equiv_harmonious_min_perc)*(OR6-B_equiv_harmonious_min_perc))-($AE6+($AF6-$AE6)/(B_equiv_harmonious_max_perc-B_equiv_harmonious_min_perc)*(OR6-B_equiv_harmonious_min_perc))-(MAX(0,($AG6+($AH6-$AG6)/(B_equiv_harmonious_max_perc-B_equiv_harmonious_min_perc)*(OR6-B_equiv_harmonious_min_perc))-(KT6+(MJ6-KT6)/(B_equiv_harmonious_max_perc*$AO6-B_equiv_harmonious_min_perc)*(OR6-B_equiv_harmonious_min_perc)))/El_boiler_eff)-((KO6+(ME6-KO6)/(B_equiv_harmonious_max_perc*$AO6-B_equiv_harmonious_min_perc)*(OR6-B_equiv_harmonious_min_perc))/BESS_chrg_eff))", "OU" : "=IF(OR6=0,0,ROUND((KS6+(MI6-KS6)/(B_equiv_harmonious_max_perc*$AO6-B_equiv_harmonious_min_perc)*(OR6-B_equiv_harmonious_min_perc))+(MAX(0,(KP6+(MF6-KP6)/(B_equiv_harmonious_max_perc*$AO6-B_equiv_harmonious_min_perc)*(OR6-B_equiv_harmonious_min_perc))-($AE6+($AF6-$AE6)/(B_equiv_harmonious_max_perc-B_equiv_harmonious_min_perc)*(OR6-B_equiv_harmonious_min_perc))-((KO6+(ME6-KO6)/(B_equiv_harmonious_max_perc*$AO6-B_equiv_harmonious_min_perc)*(OR6-B_equiv_harmonious_min_perc))/BESS_chrg_eff)))*El_boiler_eff-($AG6+($AH6-$AG6)/(B_equiv_harmonious_max_perc-B_equiv_harmonious_min_perc)*(OR6-B_equiv_harmonious_min_perc)),5))", "OV" : "=IF(OR6=0,0,(KT6+(MJ6-KT6)/(B_equiv_harmonious_max_perc*$AO6-B_equiv_harmonious_min_perc)*(OR6-B_equiv_harmonious_min_perc))+(MAX(0,(KQ6+(MG6-KQ6)/(B_equiv_harmonious_max_perc*$AO6-B_equiv_harmonious_min_perc)*(OR6-B_equiv_harmonious_min_perc))-($AE6+($AF6-$AE6)/(B_equiv_harmonious_max_perc-B_equiv_harmonious_min_perc)*(OR6-B_equiv_harmonious_min_perc))-((KO6+(ME6-KO6)/(B_equiv_harmonious_max_perc*$AO6-B_equiv_harmonious_min_perc)*(OR6-B_equiv_harmonious_min_perc))/BESS_chrg_eff)))*El_boiler_eff-($AG6+($AH6-$AG6)/(B_equiv_harmonious_max_perc-B_equiv_harmonious_min_perc)*(OR6-B_equiv_harmonious_min_perc)))", "OW" : "=IF(OR6=0,0,ROUND((LB6+(MR6-LB6)/(B_equiv_harmonious_max_perc*$AO6-B_equiv_harmonious_min_perc)*(OR6-B_equiv_harmonious_min_perc))-(($AG6+($AH6-$AG6)/(B_equiv_harmonious_max_perc-B_equiv_harmonious_min_perc)*($GX6-B_equiv_harmonious_min_perc))-(KS6+(MI6-KS6)/(B_equiv_harmonious_max_perc*$AO6-B_equiv_harmonious_min_perc)*(OR6-B_equiv_harmonious_min_perc)))/El_boiler_eff,5))", "OX" : "=IF(OR6=0,0,(LC6+(MS6-LC6)/(B_equiv_harmonious_max_perc*$AO6-B_equiv_harmonious_min_perc)*(OR6-B_equiv_harmonious_min_perc))-(($AG6+($AH6-$AG6)/(B_equiv_harmonious_max_perc-B_equiv_harmonious_min_perc)*($GX6-B_equiv_harmonious_min_perc))-(KT6+(MJ6-KT6)/(B_equiv_harmonious_max_perc*$AO6-B_equiv_harmonious_min_perc)*(OR6-B_equiv_harmonious_min_perc)))/El_boiler_eff)", "OY" : "=IF(OR6=0,0,ROUND((KV6+(ML6-KV6)/(B_equiv_harmonious_max_perc*$AO6-B_equiv_harmonious_min_perc)*(OR6-B_equiv_harmonious_min_perc))-(KO6+(ME6-KO6)/(B_equiv_harmonious_max_perc*$AO6-B_equiv_harmonious_min_perc)*(OR6-B_equiv_harmonious_min_perc))/BESS_chrg_eff,5))", "OZ" : "=IF(OR6=0,0,(KW6+(MM6-KW6)/(B_equiv_harmonious_max_perc*$AO6-B_equiv_harmonious_min_perc)*(OR6-B_equiv_harmonious_min_perc))-(KO6+(ME6-KO6)/(B_equiv_harmonious_max_perc*$AO6-B_equiv_harmonious_min_perc)*(OR6-B_equiv_harmonious_min_perc))/BESS_chrg_eff)", "PA" : "=IF(OR6=0,0,(LE6+(MU6-LE6)/(B_equiv_harmonious_max_perc*$AO6-B_equiv_harmonious_min_perc)*(OR6-B_equiv_harmonious_min_perc))-($Y6+($Z6-$Y6)/(B_equiv_harmonious_max_perc-B_equiv_harmonious_min_perc)*(OR6-B_equiv_harmonious_min_perc)))", "PB" : "=IF(OR6=0,0,(LF6+(MV6-LF6)/(B_equiv_harmonious_max_perc*$AO6-B_equiv_harmonious_min_perc)*(OR6-B_equiv_harmonious_min_perc))-($Y6+($Z6-$Y6)/(B_equiv_harmonious_max_perc-B_equiv_harmonious_min_perc)*(OR6-B_equiv_harmonious_min_perc)))", "PC" : "=IF(OR6=0,0,(LH6+(MX6-LH6)/(B_equiv_harmonious_max_perc*$AO6-B_equiv_harmonious_min_perc)*(OR6-B_equiv_harmonious_min_perc))-($AA6+($AB6-$AA6)/(B_equiv_harmonious_max_perc-B_equiv_harmonious_min_perc)*(OR6-B_equiv_harmonious_min_perc)))", "PD" : "=IF(OR6=0,0,(LI6+(MY6-LI6)/(B_equiv_harmonious_max_perc*$AO6-B_equiv_harmonious_min_perc)*(OR6-B_equiv_harmonious_min_perc))-($AA6+($AB6-$AA6)/(B_equiv_harmonious_max_perc-B_equiv_harmonious_min_perc)*(OR6-B_equiv_harmonious_min_perc)))", "PE" : "=IF(OR6=0,0,(LK6+(NA6-LK6)/(B_equiv_harmonious_max_perc*$AO6-B_equiv_harmonious_min_perc)*(OR6-B_equiv_harmonious_min_perc))-($AC6+($AD6-$AC6)/(B_equiv_harmonious_max_perc-B_equiv_harmonious_min_perc)*(OR6-B_equiv_harmonious_min_perc)))", "PF" : "=IF(OR6=0,0,(LL6+(NB6-LL6)/(B_equiv_harmonious_max_perc*$AO6-B_equiv_harmonious_min_perc)*(OR6-B_equiv_harmonious_min_perc))-($AC6+($AD6-$AC6)/(B_equiv_harmonious_max_perc-B_equiv_harmonious_min_perc)*(OR6-B_equiv_harmonious_min_perc)))", "PG" : "=IF(OR6<=0,0,MIN(1,Overall_harmonious_min_perc+MIN(IF(OT6>=0,1,OS6/(OS6-OT6)),IF(OV6>=0,1,OU6/(OU6-OV6)),IF(OX6>=0,1,OW6/(OW6-OX6)),IF(OZ6>=0,1,OY6/(OY6-OZ6)),IF(PB6>=0,1,PA6/(PA6-PB6)),IF(PD6>=0,1,PC6/(PC6-PD6)),IF(PF6>=0,1,PE6/(PE6-PF6)))*(Overall_harmonious_max_perc-Overall_harmonious_min_perc)))",  "PI" : "=IF(OR(OA6=0,OP6=0),0,(KC6+(LS6-KC6)/(B_equiv_harmonious_max_perc*$AO6-B_equiv_harmonious_min_perc)*(OP6-B_equiv_harmonious_min_perc))+((KD6+(LT6-KD6)/(B_equiv_harmonious_max_perc*$AO6-B_equiv_harmonious_min_perc)*(OP6-B_equiv_harmonious_min_perc))-(KC6+(LS6-KC6)/(B_equiv_harmonious_max_perc*$AO6-B_equiv_harmonious_min_perc)*(OP6-B_equiv_harmonious_min_perc)))/(Overall_harmonious_max_perc-Overall_harmonious_min_perc)*(OA6-Overall_harmonious_min_perc))", "PJ" : "=IF(OR(OA6=0,OP6=0),0,($AE6+($AF6-$AE6)/(B_equiv_harmonious_max_perc-B_equiv_harmonious_min_perc)*(OP6-B_equiv_harmonious_min_perc)))", "PK" : "=IF(OR(OA6=0,OP6=0),0,KL6+(MB6-KL6)/(B_equiv_harmonious_max_perc*$AO6-B_equiv_harmonious_min_perc)*(OP6-B_equiv_harmonious_min_perc))", "PL" : "=IF(OR(OA6=0,OP6=0),0,MIN(((KV6+(ML6-KV6)/(B_equiv_harmonious_max_perc*$AO6-B_equiv_harmonious_min_perc)*(OP6-B_equiv_harmonious_min_perc))+((KW6+(MM6-KW6)/(B_equiv_harmonious_max_perc*$AO6-B_equiv_harmonious_min_perc)*(OP6-B_equiv_harmonious_min_perc))-(KV6+(ML6-KV6)/(B_equiv_harmonious_max_perc*$AO6-B_equiv_harmonious_min_perc)*(OP6-B_equiv_harmonious_min_perc)))/(Overall_harmonious_max_perc-Overall_harmonious_min_perc)*(OA6-Overall_harmonious_min_perc)),(KO6+(ME6-KO6)/(B_equiv_harmonious_max_perc*$AO6-B_equiv_harmonious_min_perc)*(OP6-B_equiv_harmonious_min_perc))/BESS_chrg_eff))", "PM" : "=IF(OR(OA6=0,OP6=0),0,(KI6+(LY6-KI6)/(B_equiv_harmonious_max_perc*$AO6-B_equiv_harmonious_min_perc)*(OP6-B_equiv_harmonious_min_perc))+((KJ6+(LZ6-KJ6)/(B_equiv_harmonious_max_perc*$AO6-B_equiv_harmonious_min_perc)*(OP6-B_equiv_harmonious_min_perc))-(KI6+(LY6-KI6)/(B_equiv_harmonious_max_perc*$AO6-B_equiv_harmonious_min_perc)*(OP6-B_equiv_harmonious_min_perc)))/(Overall_harmonious_max_perc-Overall_harmonious_min_perc)*(OA6-Overall_harmonious_min_perc))", "PN" : "=PU6/El_boiler_eff", "PO" : "=IF(OR(OA6=0,OP6=0),0,JY6+(LO6-JY6)/(B_equiv_harmonious_max_perc*$AO6-B_equiv_harmonious_min_perc)*(OP6-B_equiv_harmonious_min_perc))", "PP" : "=IF(OR(OA6=0,OP6=0),0,MIN($X6*Grid_import_max_ud,MAX(0,-(SUM(PO6:PO6)-SUM(PI6:PN6)))))", "PQ" : "=SUM(PO6:PP6)-SUM(PI6:PN6)", "PR" : "=IF(OR(OA6=0,OP6=0),0,(KF6+(LV6-KF6)/(B_equiv_harmonious_max_perc*$AO6-B_equiv_harmonious_min_perc)*(OP6-B_equiv_harmonious_min_perc))+((KG6+(LW6-KG6)/(B_equiv_harmonious_max_perc*$AO6-B_equiv_harmonious_min_perc)*(OP6-B_equiv_harmonious_min_perc))-(KF6+(LV6-KF6)/(B_equiv_harmonious_max_perc*$AO6-B_equiv_harmonious_min_perc)*(OP6-B_equiv_harmonious_min_perc)))/(Overall_harmonious_max_perc-Overall_harmonious_min_perc)*(OA6-Overall_harmonious_min_perc))", "PS" : "=IF(OR(OA6=0,OP6=0),0,($AG6+($AH6-$AG6)/(B_equiv_harmonious_max_perc-B_equiv_harmonious_min_perc)*(OP6-B_equiv_harmonious_min_perc)))", "PT" : "=IF(OR(OA6=0,OP6=0),0,PM6*El_boiler_eff)", "PU" : "=IF(OR(OA6=0,OP6=0),0,MAX(0,PS6-((KS6+(MI6-KS6)/(B_equiv_harmonious_max_perc*$AO6-B_equiv_harmonious_min_perc)*(OP6-B_equiv_harmonious_min_perc))+((KT6+(MJ6-KT6)/(B_equiv_harmonious_max_perc*$AO6-B_equiv_harmonious_min_perc)*(OP6-B_equiv_harmonious_min_perc))-(KS6+(MI6-KS6)/(B_equiv_harmonious_max_perc*$AO6-B_equiv_harmonious_min_perc)*(OP6-B_equiv_harmonious_min_perc)))/(Overall_harmonious_max_perc-Overall_harmonious_min_perc)*(OA6-Overall_harmonious_min_perc))))", "PV" : "=IF(OR(OA6=0,OP6=0),0,KA6+(LQ6-KA6)/(B_equiv_harmonious_max_perc*$AO6-B_equiv_harmonious_min_perc)*(OP6-B_equiv_harmonious_min_perc))", "PW" : "=SUM(PT6:PV6)-SUM(PR6:PS6)", "PX" : "=IF(OR(OA6=0,OP6=0),0,KE6+(LU6-KE6)/(B_equiv_harmonious_max_perc*$AO6-B_equiv_harmonious_min_perc)*(OP6-B_equiv_harmonious_min_perc))", "PY" : "=IF(OR(OA6=0,OP6=0),0,KM6+(MC6-KM6)/(B_equiv_harmonious_max_perc*$AO6-B_equiv_harmonious_min_perc)*(OP6-B_equiv_harmonious_min_perc))", "PZ" : "=IF(OR(OA6=0,OP6=0),0,KK6+(MA6-KK6)/(B_equiv_harmonious_max_perc*$AO6-B_equiv_harmonious_min_perc)*(OP6-B_equiv_harmonious_min_perc))", "QA" : "=PL6*BESS_chrg_eff", "QB" : "=IF(OR(OA6=0,OP6=0),0,JZ6+(LP6-JZ6)/(B_equiv_harmonious_max_perc*$AO6-B_equiv_harmonious_min_perc)*(OP6-B_equiv_harmonious_min_perc))", "QC" : "=IF(OR(OA6=0,OP6=0),0,MIN($W6*Grid_import_max_ud,MAX(0,-(SUM(QA6:QB6)-SUM(PX6:PZ6)))))", "QD" : "=SUM(QA6:QC6)-SUM(PX6:PZ6)", "QE" : "=IF(OR(OA6=0,OP6=0),0,KH6+(LX6-KH6)/(B_equiv_harmonious_max_perc*$AO6-B_equiv_harmonious_min_perc)*(OP6-B_equiv_harmonious_min_perc))", "QF" : "=IF(OR(OA6=0,OP6=0),0,PZ6*El_boiler_eff)", "QG" : "=IF(OR(OA6=0,OP6=0),0,KB6+(LR6-KB6)/(B_equiv_harmonious_max_perc*$AO6-B_equiv_harmonious_min_perc)*(OP6-B_equiv_harmonious_min_perc))", "QH" : "=SUM(QF6:QG6)-SUM(QE6:QE6)", "QI" : "=IF(PI6<=0,0,PI6/(Overall_harmonious_var_max_cons+Overall_fix_cons)*MethDist_harmonious_max_perc*MethDist_Meth_nom_prod_ud)+IF(PX6<=0,0,PX6/(B_overall_var_max_cons+B_overall_fix_stby_cons)*B_MethDist_max_perc*MethDist_Meth_nom_prod_ud)", "QJ" : "=MIN(PQ6,IF(OR(OA6=0,OP6=0),0,(KY6+(MO6-KY6)/(B_equiv_harmonious_max_perc*$AO6-B_equiv_harmonious_min_perc)*(OP6-B_equiv_harmonious_min_perc))+((KZ6+(MP6-KZ6)/(B_equiv_harmonious_max_perc*$AO6-B_equiv_harmonious_min_perc)*(OP6-B_equiv_harmonious_min_perc))-(KY6+(MO6-KY6)/(B_equiv_harmonious_max_perc*$AO6-B_equiv_harmonious_min_perc)*(OP6-B_equiv_harmonious_min_perc)))/(Overall_harmonious_max_perc-Overall_harmonious_min_perc)*(OA6-Overall_harmonious_min_perc)))+MIN(QD6,IF(OR(OA6=0,OP6=0),0,LA6+(MQ6-LA6)/(B_equiv_harmonious_max_perc*$AO6-B_equiv_harmonious_min_perc)*(OP6-B_equiv_harmonious_min_perc)))", "QK" : "=QC6+PP6", "QL" : "=MAX(0,-PQ6)+MAX(0,-PW6)+MAX(0,-QD6)+MAX(0,-QH6)",  "QN" : "=IF(OR(PG6=0,OR6=0),0,(KC6+(LS6-KC6)/(B_equiv_harmonious_max_perc*$AO6-B_equiv_harmonious_min_perc)*(OR6-B_equiv_harmonious_min_perc))+((KD6+(LT6-KD6)/(B_equiv_harmonious_max_perc*$AO6-B_equiv_harmonious_min_perc)*(OR6-B_equiv_harmonious_min_perc))-(KC6+(LS6-$CI6)/(B_equiv_harmonious_max_perc*$AO6-B_equiv_harmonious_min_perc)*(OR6-B_equiv_harmonious_min_perc)))/(Overall_harmonious_max_perc-Overall_harmonious_min_perc)*(PG6-Overall_harmonious_min_perc))", "QO" : "=IF(OR(PG6=0,OR6=0),0,($AE6+($AF6-$AE6)/(B_equiv_harmonious_max_perc-B_equiv_harmonious_min_perc)*(OR6-B_equiv_harmonious_min_perc)))", "QP" : "=IF(OR(PG6=0,OR6=0),0,KL6+(MB6-KL6)/(B_equiv_harmonious_max_perc*$AO6-B_equiv_harmonious_min_perc)*(OR6-B_equiv_harmonious_min_perc))", "QQ" : "=IF(OR(PG6=0,OR6=0),0,MIN(((KV6+(ML6-KV6)/(B_equiv_harmonious_max_perc*$AO6-B_equiv_harmonious_min_perc)*(OR6-B_equiv_harmonious_min_perc))+((KW6+(MM6-KW6)/(B_equiv_harmonious_max_perc*$AO6-B_equiv_harmonious_min_perc)*(OR6-B_equiv_harmonious_min_perc))-(KV6+(ML6-KV6)/(B_equiv_harmonious_max_perc*$AO6-B_equiv_harmonious_min_perc)*(OR6-B_equiv_harmonious_min_perc)))/(Overall_harmonious_max_perc-Overall_harmonious_min_perc)*(PG6-Overall_harmonious_min_perc)),(KO6+(ME6-KO6)/(B_equiv_harmonious_max_perc*$AO6-B_equiv_harmonious_min_perc)*(OR6-B_equiv_harmonious_min_perc))/BESS_chrg_eff))", "QR" : "=IF(OR(PG6=0,OR6=0),0,(KI6+(LY6-KI6)/(B_equiv_harmonious_max_perc*$AO6-B_equiv_harmonious_min_perc)*(OR6-B_equiv_harmonious_min_perc))+((KJ6+(LZ6-KJ6)/(B_equiv_harmonious_max_perc*$AO6-B_equiv_harmonious_min_perc)*(OR6-B_equiv_harmonious_min_perc))-(KI6+(LY6-KI6)/(B_equiv_harmonious_max_perc*$AO6-B_equiv_harmonious_min_perc)*(OR6-B_equiv_harmonious_min_perc)))/(Overall_harmonious_max_perc-Overall_harmonious_min_perc)*(PG6-Overall_harmonious_min_perc))", "QS" : "=QZ6/El_boiler_eff", "QT" : "=IF(OR(PG6=0,OR6=0),0,JY6+(LO6-JY6)/(B_equiv_harmonious_max_perc*$AO6-B_equiv_harmonious_min_perc)*(OR6-B_equiv_harmonious_min_perc))", "QU" : "=IF(OR(OR6=0,PG6=0),0,MIN($D6*Grid_import_max_ud,MAX(0,-(SUM(QT6:QT6)-SUM(QN6:QS6)))))", "QV" : "=SUM(QT6:QU6)-SUM(QN6:QS6)", "QW" : "=IF(OR(PG6=0,OR6=0),0,(KF6+(LV6-KF6)/(B_equiv_harmonious_max_perc*$AO6-B_equiv_harmonious_min_perc)*(OR6-B_equiv_harmonious_min_perc))+((KG6+(LW6-KG6)/(B_equiv_harmonious_max_perc*$AO6-B_equiv_harmonious_min_perc)*(OR6-B_equiv_harmonious_min_perc))-(KF6+(LV6-KF6)/(B_equiv_harmonious_max_perc*$AO6-B_equiv_harmonious_min_perc)*(OR6-B_equiv_harmonious_min_perc)))/(Overall_harmonious_max_perc-Overall_harmonious_min_perc)*(PG6-Overall_harmonious_min_perc))", "QX" : "=IF(OR(PG6=0,OR6=0),0,($AG6+($AH6-$AG6)/(B_equiv_harmonious_max_perc-B_equiv_harmonious_min_perc)*(OR6-B_equiv_harmonious_min_perc)))", "QY" : "=IF(OR(PG6=0,OR6=0),0,QR6*El_boiler_eff)", "QZ" : "=IF(OR(PG6=0,OR6=0),0,MAX(0,QX6-((KS6+(MI6-KS6)/(B_equiv_harmonious_max_perc*$AO6-B_equiv_harmonious_min_perc)*(OR6-B_equiv_harmonious_min_perc))+((KT6+(MJ6-KT6)/(B_equiv_harmonious_max_perc*$AO6-B_equiv_harmonious_min_perc)*(OR6-B_equiv_harmonious_min_perc))-(KS6+(MI6-KS6)/(B_equiv_harmonious_max_perc*$AO6-B_equiv_harmonious_min_perc)*(OR6-B_equiv_harmonious_min_perc)))/(Overall_harmonious_max_perc-Overall_harmonious_min_perc)*(PG6-Overall_harmonious_min_perc))))", "RA" : "=IF(OR(PG6=0,OR6=0),0,KA6+(LQ6-KA6)/(B_equiv_harmonious_max_perc*$AO6-B_equiv_harmonious_min_perc)*(OR6-B_equiv_harmonious_min_perc))", "RB" : "=SUM(QY6:RA6)-SUM(QW6:QX6)", "RC" : "=IF(OR(PG6=0,OR6=0),0,KE6+(LU6-KE6)/(B_equiv_harmonious_max_perc*$AO6-B_equiv_harmonious_min_perc)*(OR6-B_equiv_harmonious_min_perc))", "RD" : "=IF(OR(PG6=0,OR6=0),0,KM6+(MC6-KM6)/(B_equiv_harmonious_max_perc*$AO6-B_equiv_harmonious_min_perc)*(OR6-B_equiv_harmonious_min_perc))", "RE" : "=IF(OR(PG6=0,OR6=0),0,KK6+(MA6-KK6)/(B_equiv_harmonious_max_perc*$AO6-B_equiv_harmonious_min_perc)*(OR6-B_equiv_harmonious_min_perc))", "RF" : "=QQ6*BESS_chrg_eff", "RG" : "=IF(OR(PG6=0,OR6=0),0,JZ6+(LP6-JZ6)/(B_equiv_harmonious_max_perc*$AO6-B_equiv_harmonious_min_perc)*(OR6-B_equiv_harmonious_min_perc))", "RH" : "=IF(OR(PG6=0,OR6=0),0,MIN($C6*Grid_import_max_ud,MAX(0,-(SUM(RF6:RG6)-SUM(RC6:RE6)))))", "RI" : "=SUM(RF6:RH6)-SUM(RC6:RE6)", "RJ" : "=IF(OR(PG6=0,OR6=0),0,KH6+(LX6-KH6)/(B_equiv_harmonious_max_perc*$AO6-B_equiv_harmonious_min_perc)*(OR6-B_equiv_harmonious_min_perc))", "RK" : "=IF(OR(PG6=0,OR6=0),0,RE6*El_boiler_eff)", "RL" : "=IF(OR(PG6=0,OR6=0),0,KB6+(LR6-KB6)/(B_equiv_harmonious_max_perc*$AO6-B_equiv_harmonious_min_perc)*(OR6-B_equiv_harmonious_min_perc))", "RM" : "=SUM(RK6:RL6)-SUM(RJ6:RJ6)", "RN" : "=IF(QN6<=0,0,QN6/(Overall_harmonious_var_max_cons+Overall_fix_cons)*MethDist_harmonious_max_perc*MethDist_Meth_nom_prod_ud)+IF(RC6<=0,0,RC6/(B_overall_var_max_cons+B_overall_fix_stby_cons)*B_MethDist_max_perc*MethDist_Meth_nom_prod_ud)", "RO" : "=MIN(QV6,IF(OR(PG6=0,OR6=0),0,(KY6+(MO6-KY6)/(B_equiv_harmonious_max_perc*$AO6-B_equiv_harmonious_min_perc)*(OR6-B_equiv_harmonious_min_perc))+((KZ6+(MP6-KZ6)/(B_equiv_harmonious_max_perc*$AO6-B_equiv_harmonious_min_perc)*(OR6-B_equiv_harmonious_min_perc))-(KY6+(MO6-KY6)/(B_equiv_harmonious_max_perc*$AO6-B_equiv_harmonious_min_perc)*(OR6-B_equiv_harmonious_min_perc)))/(Overall_harmonious_max_perc-Overall_harmonious_min_perc)*(PG6-Overall_harmonious_min_perc)))+MIN(RI6,IF(OR(PG6=0,OR6=0),0,LA6+(MQ6-LA6)/(B_equiv_harmonious_max_perc*$AO6-B_equiv_harmonious_min_perc)*(OR6-B_equiv_harmonious_min_perc)))", "RP" : "=RH6+QU6", "RQ" : "=MAX(0,-QV6)+MAX(0,-RB6)+MAX(0,-RI6)+MAX(0,-RM6)",  "RS" : "=SUMIFS(Calculation$L$5:$L$8763,Calculation$KY$5:$KY$8763,\"=\"&$A6,Calculation$KW$5:$KW$8763,\">0\")+SUMIFS(Calculation$KD$5:$KD$8763,Calculation$KI$5:$KI$8763,\">0\",Calculation$KY$5:$KY$8763,\"=\"&$A6,Calculation$KW$5:$KW$8763,\">0\")-SUMIFS(Calculation$KO$5:$KO$8763,Calculation$KY$5:$KY$8763,\"=\"&$A6,Calculation$KW$5:$KW$8763,\">0\")", "RT" : "=SUMIFS(Calculation$L$5:$L$8763,Calculation$KY$5:$KY$8763,\"=\"&$A6,Calculation$KW$5:$KW$8763,\"=0\")+SUMIFS(Calculation$KD$5:$KD$8763,Calculation$KI$5:$KI$8763,\">0\",Calculation$KY$5:$KY$8763,\"=\"&$A6,Calculation$KW$5:$KW$8763,\"=0\")-SUMIFS(Calculation$KO$5:$KO$8763,Calculation$KY$5:$KY$8763,\"=\"&$A6,Calculation$KW$5:$KW$8763,\"=0\")", "RU" : "=SUMIFS(Calculation$J$5:$J$8763,Calculation$KY$5:$KY$8763,\"=\"&$A6,Calculation$KW$5:$KW$8763,\">0\")+SUMIFS(Calculation$KH$5:$KH$8763,Calculation$KI$5:$KI$8763,\">0\",Calculation$KY$5:$KY$8763,\"=\"&$A6,Calculation$KW$5:$KW$8763,\">0\")/PB_Ratio_Heat_input_vs_output-SUMIFS(Calculation$KP$5:$KP$8763,Calculation$KY$5:$KY$8763,\"=\"&$A6,Calculation$KW$5:$KW$8763,\">0\")", "RV" : "=SUMIFS(Calculation$J$5:$J$8763,Calculation$KY$5:$KY$8763,\"=\"&$A6,Calculation$KW$5:$KW$8763,\"=0\")+SUMIFS(Calculation$KH$5:$KH$8763,Calculation$KI$5:$KI$8763,\">0\",Calculation$KY$5:$KY$8763,\"=\"&$A6,Calculation$KW$5:$KW$8763,\"=0\")/PB_Ratio_Heat_input_vs_output-SUMIFS(Calculation$KP$5:$KP$8763,Calculation$KY$5:$KY$8763,\"=\"&$A6,Calculation$KW$5:$KW$8763,\"=0\")", "RW" : "=SUMIF(Calculation$KY$5:$KY$8763,\"=\"&$A6,Calculation$KW$5:$KW$8763)+SUMIFS(Calculation$KZ$5:$KZ$8763,Calculation$KY$5:$KY$8763,\"=\"&$A6,Calculation$KW$5:$KW$8763,\">0\")", "RX" : "=SUMIF(Calculation$KY$5:$KY$8763,\"=\"&$A6,Calculation$LN$5:$LN$8763)+SUMIFS(Calculation$KZ$5:$KZ$8763,Calculation$KY$5:$KY$8763,\"=\"&$A6,Calculation$LN$5:$LN$8763,\">0\")", "RY" : "=SUMIFS(Calculation$KZ$5:$KZ$8763,Calculation$KY$5:$KY$8763,\"=\"&$A6,Calculation$KW$5:$KW$8763,\"=0\")", "RZ" : "=SUMIF(Calculation$KY$5:$KY$8763,\"=\"&$A6,Calculation$KX$5:$KX$8763)+SUMIFS(Calculation$LA$5:$LA$8763,Calculation$KY$5:$KY$8763,\"=\"&$A6,Calculation$KW$5:$KW$8763,\">0\")", "SA" : "=SUMIF(Calculation$KY$5:$KY$8763,\"=\"&$A6,Calculation$LO$5:$LO$8763)+SUMIFS(Calculation$LA$5:$LA$8763,Calculation$KY$5:$KY$8763,\"=\"&$A6,Calculation$LN$5:$LN$8763,\">0\")", "SB" : "=SUMIFS(Calculation$LA$5:$LA$8763,Calculation$KY$5:$KY$8763,\"=\"&$A6,Calculation$KW$5:$KW$8763,\"=0\")", "SC" : "=SUMIFS(Calculation$LF$5:$LF$8763,Calculation$KY$5:$KY$8763,\"=\"&$A6,Calculation$KW$5:$KW$8763,\">0\")", "SD" : "=SUMIFS(Calculation$LT$5:$LT$8763,Calculation$KY$5:$KY$8763,\"=\"&$A6,Calculation$LN$5:$LN$8763,\">0\")", "SE" : "=SUMIF(Calculation$KY$5:$KY$8763,\"=\"&$A6,Calculation$LF$5:$LF$8763)-SC6", "SF" : "=SUMIFS(Calculation$KS$5:$KS$8763,Calculation$KY$5:$KY$8763,\"=\"&$A6,Calculation$KW$5:$KW$8763,\">0\")", "SG" : "=SUMIF(Calculation$KY$5:$KY$8763,\"=\"&$A6,Calculation$KS$5:$KS$8763)-SF6", "SH" : "=SUMIFS(Calculation$KT$5:$KT$8763,Calculation$KY$5:$KY$8763,\"=\"&$A6,Calculation$KW$5:$KW$8763,\">0\")", "SI" : "=SUMIF(Calculation$KY$5:$KY$8763,\"=\"&$A6,Calculation$KT$5:$KT$8763)-SH6", "SJ" : "=SUMIFS(Calculation$LB$5:$LB$8763,Calculation$KY$5:$KY$8763,\"=\"&$A6,Calculation$KW$5:$KW$8763,\">0\")", "SK" : "=SUMIFS(Calculation$LP$5:$LP$8763,Calculation$KY$5:$KY$8763,\"=\"&$A6,Calculation$LN$5:$LN$8763,\">0\")", "SL" : "=SUMIF(Calculation$KY$5:$KY$8763,\"=\"&$A6,Calculation$LB$5:$LB$8763)-SJ6", "SM" : "=SUMIFS(Calculation$LC$5:$LC$8763,Calculation$KY$5:$KY$8763,\"=\"&$A6,Calculation$KW$5:$KW$8763,\">0\")", "SN" : "=SUMIFS(Calculation$LQ$5:$LQ$8763,Calculation$KY$5:$KY$8763,\"=\"&$A6,Calculation$LN$5:$LN$8763,\">0\")", "SO" : "=SUMIF(Calculation$KY$5:$KY$8763,\"=\"&$A6,Calculation$LC$5:$LC$8763)-SM6", "SP" : "=MIN(SUMIFS(Calculation$LK$5:$LK$8763,Calculation$KY$5:$KY$8763,\"=\"&$A6,Calculation$KW$5:$KW$8763,\">0\"),BESS_cap_ud/BESS_chrg_eff)", "SQ" : "=MIN(SUMIFS(Calculation$LY$5:$LY$8763,Calculation$KY$5:$KY$8763,\"=\"&$A6,Calculation$LN$5:$LN$8763,\">0\"),BESS_cap_ud/BESS_chrg_eff)", "SR" : "=MIN(SUMIFS(Calculation$LK$5:$LK$8763,Calculation$KY$5:$KY$8763,\"=\"&$A6,Calculation$KW$5:$KW$8763,\"=0\"),BESS_cap_ud/BESS_chrg_eff)", "SS" : "=SUMIFS(Calculation$LL$5:$LL$8763,Calculation$KY$5:$KY$8763,\"=\"&$A6,Calculation$KW$5:$KW$8763,\">0\")", "ST" : "=SUMIFS(Calculation$LZ$5:$LZ$8763,Calculation$KY$5:$KY$8763,\"=\"&$A6,Calculation$LN$5:$LN$8763,\">0\")", "SU" : "=SUMIF(Calculation$KY$5:$KY$8763,\"=\"&$A6,Calculation$LL$5:$LL$8763)-SS6", "SV" : "=SUMIFS(Calculation$LG$5:$LG$8763,Calculation$KY$5:$KY$8763,\"=\"&$A6,Calculation$KW$5:$KW$8763,\">0\")", "SW" : "=SUMIFS(Calculation$LU$5:$LU$8763,Calculation$KY$5:$KY$8763,\"=\"&$A6,Calculation$LN$5:$LN$8763,\">0\")", "SX" : "=SUMIF(Calculation$KY$5:$KY$8763,\"=\"&$A6,Calculation$LG$5:$LG$8763)-SV6", "SY" : "=SUMIFS(Calculation$LH$5:$LH$8763,Calculation$KY$5:$KY$8763,\"=\"&$A6,Calculation$KW$5:$KW$8763,\">0\")", "SZ" : "=SUMIFS(Calculation$LV$5:$LV$8763,Calculation$KY$5:$KY$8763,\"=\"&$A6,Calculation$LN$5:$LN$8763,\">0\")", "TA" : "=SUMIF(Calculation$KY$5:$KY$8763,\"=\"&$A6,Calculation$LH$5:$LH$8763)-SY6", "TB" : "=SUMIFS(Calculation$LI$5:$LI$8763,Calculation$KY$5:$KY$8763,\"=\"&$A6,Calculation$KW$5:$KW$8763,\">0\")", "TC" : "=SUMIFS(Calculation$LW$5:$LW$8763,Calculation$KY$5:$KY$8763,\"=\"&$A6,Calculation$LN$5:$LN$8763,\">0\")", "TD" : "=SUMIF(Calculation$KY$5:$KY$8763,\"=\"&$A6,Calculation$LI$5:$LI$8763)-TB6", "TE" : "=SUMIFS(Calculation$LJ$5:$LJ$8763,Calculation$KY$5:$KY$8763,\"=\"&$A6,Calculation$KW$5:$KW$8763,\">0\")", "TF" : "=SUMIFS(Calculation$LX$5:$LX$8763,Calculation$KY$5:$KY$8763,\"=\"&$A6,Calculation$LN$5:$LN$8763,\">0\")", "TG" : "=SUMIF(Calculation$KY$5:$KY$8763,\"=\"&$A6,Calculation$LJ$5:$LJ$8763)-TE6",  "TI" : "=SUMIFS(Calculation$L$5:$L$8763,Calculation$NA$5:$NA$8763,\"=\"&$A6,Calculation$MY$5:$MY$8763,\">0\")+SUMIFS(Calculation$MF$5:$MF$8763,Calculation$MK$5:$MK$8763,\">0\",Calculation$NA$5:$NA$8763,\"=\"&$A6,Calculation$MY$5:$MY$8763,\">0\")-SUMIFS(Calculation$MQ$5:$MQ$8763,Calculation$NA$5:$NA$8763,\"=\"&$A6,Calculation$MY$5:$MY$8763,\">0\")", "TJ" : "=SUMIFS(Calculation$L$5:$L$8763,Calculation$NA$5:$NA$8763,\"=\"&$A6,Calculation$MY$5:$MY$8763,\"=0\")+SUMIFS(Calculation$MF$5:$MF$8763,Calculation$MK$5:$MK$8763,\">0\",Calculation$NA$5:$NA$8763,\"=\"&$A6,Calculation$MY$5:$MY$8763,\"=0\")-SUMIFS(Calculation$MQ$5:$MQ$8763,Calculation$NA$5:$NA$8763,\"=\"&$A6,Calculation$MY$5:$MY$8763,\"=0\")", "TK" : "=SUMIFS(Calculation$J$5:$J$8763,Calculation$NA$5:$NA$8763,\"=\"&$A6,Calculation$MY$5:$MY$8763,\">0\")+SUMIFS(Calculation$MJ$5:$MJ$8763,Calculation$MK$5:$MK$8763,\">0\",Calculation$NA$5:$NA$8763,\"=\"&$A6,Calculation$MY$5:$MY$8763,\">0\")/PB_Ratio_Heat_input_vs_output-SUMIFS(Calculation$MR$5:$MR$8763,Calculation$NA$5:$NA$8763,\"=\"&$A6,Calculation$MY$5:$MY$8763,\">0\")", "TL" : "=SUMIFS(Calculation$J$5:$J$8763,Calculation$NA$5:$NA$8763,\"=\"&$A6,Calculation$MY$5:$MY$8763,\"=0\")+SUMIFS(Calculation$MJ$5:$MJ$8763,Calculation$MK$5:$MK$8763,\">0\",Calculation$NA$5:$NA$8763,\"=\"&$A6,Calculation$MY$5:$MY$8763,\"=0\")/PB_Ratio_Heat_input_vs_output-SUMIFS(Calculation$MR$5:$MR$8763,Calculation$NA$5:$NA$8763,\"=\"&$A6,Calculation$MY$5:$MY$8763,\"=0\")", "TM" : "=SUMIF(Calculation$NA$5:$NA$8763,\"=\"&$A6,Calculation$MY$5:$MY$8763)+SUMIFS(Calculation$NB$5:$NB$8763,Calculation$NA$5:$NA$8763,\"=\"&$A6,Calculation$MY$5:$MY$8763,\">0\")", "TN" : "=SUMIF(Calculation$NA$5:$NA$8763,\"=\"&$A6,Calculation$NP$5:$NP$8763)+SUMIFS(Calculation$NB$5:$NB$8763,Calculation$NA$5:$NA$8763,\"=\"&$A6,Calculation$NP$5:$NP$8763,\">0\")", "TO" : "=SUMIFS(Calculation$NB$5:$NB$8763,Calculation$NA$5:$NA$8763,\"=\"&$A6,Calculation$MY$5:$MY$8763,\"=0\")", "TP" : "=SUMIF(Calculation$NA$5:$NA$8763,\"=\"&$A6,Calculation$MZ$5:$MZ$8763)+SUMIFS(Calculation$NC$5:$NC$8763,Calculation$NA$5:$NA$8763,\"=\"&$A6,Calculation$MY$5:$MY$8763,\">0\")", "TQ" : "=SUMIF(Calculation$NA$5:$NA$8763,\"=\"&$A6,Calculation$NQ$5:$NQ$8763)+SUMIFS(Calculation$NC$5:$NC$8763,Calculation$NA$5:$NA$8763,\"=\"&$A6,Calculation$NP$5:$NP$8763,\">0\")", "TR" : "=SUMIFS(Calculation$NC$5:$NC$8763,Calculation$NA$5:$NA$8763,\"=\"&$A6,Calculation$MY$5:$MY$8763,\"=0\")", "TS" : "=SUMIFS(Calculation$NH$5:$NH$8763,Calculation$NA$5:$NA$8763,\"=\"&$A6,Calculation$MY$5:$MY$8763,\">0\")", "TT" : "=SUMIFS(Calculation$NV$5:$NV$8763,Calculation$NA$5:$NA$8763,\"=\"&$A6,Calculation$NP$5:$NP$8763,\">0\")", "TU" : "=SUMIF(Calculation$NA$5:$NA$8763,\"=\"&$A6,Calculation$NH$5:$NH$8763)-TS6", "TV" : "=SUMIFS(Calculation$MU$5:$MU$8763,Calculation$NA$5:$NA$8763,\"=\"&$A6,Calculation$MY$5:$MY$8763,\">0\")", "TW" : "=SUMIF(Calculation$NA$5:$NA$8763,\"=\"&$A6,Calculation$MU$5:$MU$8763)-TV6", "TX" : "=SUMIFS(Calculation$MV$5:$MV$8763,Calculation$NA$5:$NA$8763,\"=\"&$A6,Calculation$MY$5:$MY$8763,\">0\")", "TY" : "=SUMIF(Calculation$NA$5:$NA$8763,\"=\"&$A6,Calculation$MV$5:$MV$8763)-TX6", "TZ" : "=SUMIFS(Calculation$ND$5:$ND$8763,Calculation$NA$5:$NA$8763,\"=\"&$A6,Calculation$MY$5:$MY$8763,\">0\")", "UA" : "=SUMIFS(Calculation$NR$5:$NR$8763,Calculation$NA$5:$NA$8763,\"=\"&$A6,Calculation$NP$5:$NP$8763,\">0\")", "UB" : "=SUMIF(Calculation$NA$5:$NA$8763,\"=\"&$A6,Calculation$ND$5:$ND$8763)-TZ6", "UC" : "=SUMIFS(Calculation$NE$5:$NE$8763,Calculation$NA$5:$NA$8763,\"=\"&$A6,Calculation$MY$5:$MY$8763,\">0\")", "UD" : "=SUMIFS(Calculation$NS$5:$NS$8763,Calculation$NA$5:$NA$8763,\"=\"&$A6,Calculation$NP$5:$NP$8763,\">0\")", "UE" : "=SUMIF(Calculation$NA$5:$NA$8763,\"=\"&$A6,Calculation$NE$5:$NE$8763)-UC6", "UF" : "=MIN(SUMIFS(Calculation$NM$5:$NM$8763,Calculation$NA$5:$NA$8763,\"=\"&$A6,Calculation$MY$5:$MY$8763,\">0\"),BESS_cap_ud/BESS_chrg_eff)", "UG" : "=MIN(SUMIFS(Calculation$OA$5:$OA$8763,Calculation$NA$5:$NA$8763,\"=\"&$A6,Calculation$NP$5:$NP$8763,\">0\"),BESS_cap_ud/BESS_chrg_eff)", "UH" : "=MIN(SUMIFS(Calculation$NM$5:$NM$8763,Calculation$NA$5:$NA$8763,\"=\"&$A6,Calculation$MY$5:$MY$8763,\"=0\"),BESS_cap_ud/BESS_chrg_eff)", "UI" : "=SUMIFS(Calculation$NN$5:$NN$8763,Calculation$NA$5:$NA$8763,\"=\"&$A6,Calculation$MY$5:$MY$8763,\">0\")", "UJ" : "=SUMIFS(Calculation$OB$5:$OB$8763,Calculation$NA$5:$NA$8763,\"=\"&$A6,Calculation$NP$5:$NP$8763,\">0\")", "UK" : "=SUMIF(Calculation$NA$5:$NA$8763,\"=\"&$A6,Calculation$NN$5:$NN$8763)-UI6", "UL" : "=SUMIFS(Calculation$NI$5:$NI$8763,Calculation$NA$5:$NA$8763,\"=\"&$A6,Calculation$MY$5:$MY$8763,\">0\")", "UM" : "=SUMIFS(Calculation$NW$5:$NW$8763,Calculation$NA$5:$NA$8763,\"=\"&$A6,Calculation$NP$5:$NP$8763,\">0\")", "UN" : "=SUMIF(Calculation$NA$5:$NA$8763,\"=\"&$A6,Calculation$NI$5:$NI$8763)-UL6", "UO" : "=SUMIFS(Calculation$NJ$5:$NJ$8763,Calculation$NA$5:$NA$8763,\"=\"&$A6,Calculation$MY$5:$MY$8763,\">0\")", "UP" : "=SUMIFS(Calculation$NX$5:$NX$8763,Calculation$NA$5:$NA$8763,\"=\"&$A6,Calculation$NP$5:$NP$8763,\">0\")", "UQ" : "=SUMIF(Calculation$NA$5:$NA$8763,\"=\"&$A6,Calculation$NJ$5:$NJ$8763)-UO6", "UR" : "=SUMIFS(Calculation$NK$5:$NK$8763,Calculation$NA$5:$NA$8763,\"=\"&$A6,Calculation$MY$5:$MY$8763,\">0\")", "US" : "=SUMIFS(Calculation$NY$5:$NY$8763,Calculation$NA$5:$NA$8763,\"=\"&$A6,Calculation$NP$5:$NP$8763,\">0\")", "UT" : "=SUMIF(Calculation$NA$5:$NA$8763,\"=\"&$A6,Calculation$NK$5:$NK$8763)-UR6", "UU" : "=SUMIFS(Calculation$NL$5:$NL$8763,Calculation$NA$5:$NA$8763,\"=\"&$A6,Calculation$MY$5:$MY$8763,\">0\")", "UV" : "=SUMIFS(Calculation$NZ$5:$NZ$8763,Calculation$NA$5:$NA$8763,\"=\"&$A6,Calculation$NP$5:$NP$8763,\">0\")", "UW" : "=SUMIF(Calculation$NA$5:$NA$8763,\"=\"&$A6,Calculation$NL$5:$NL$8763)-UU6",  "UY" : "=SJ6-$AY6-MAX(0,$BA6-SM6)/El_boiler_eff-SI6/BESS_chrg_eff", "UZ" : "=TZ6-($AY6+($AZ6-$AY6)/(C_equiv_harmonious_max_perc-C_equiv_harmonious_min_perc)*($BI6-C_equiv_harmonious_min_perc))-MAX(0,($BA6+($BB6-$BA6)/(C_equiv_harmonious_max_perc-C_equiv_harmonious_min_perc)*($BI6-C_equiv_harmonious_min_perc))-UC6)/El_boiler_eff-TY6/BESS_chrg_eff", "VA" : "=SK6-$AY6-MAX(0,$BA6-SN6)/El_boiler_eff-SI6/BESS_chrg_eff", "VB" : "=SM6+MAX(0,SJ6-$AY6-SI6/BESS_chrg_eff)*El_boiler_eff-$BA6", "VC" : "=UC6+MAX(0,TZ6-($AY6+($AZ6-$AY6)/(C_equiv_harmonious_max_perc-C_equiv_harmonious_min_perc)*($BI6-C_equiv_harmonious_min_perc))-TY6/BESS_chrg_eff)*El_boiler_eff-($BA6+($BB6-$BA6)/(C_equiv_harmonious_max_perc-C_equiv_harmonious_min_perc)*($BI6-C_equiv_harmonious_min_perc))", "VD" : "=SN6+MAX(0,SK6-$AY6-SI6/BESS_chrg_eff)*El_boiler_eff-$BA6", "VE" : "=SV6-($BA6-SM6)/El_boiler_eff", "VF" : "=UL6-(($BA6+($BB6-$BA6)/(C_equiv_harmonious_max_perc-C_equiv_harmonious_min_perc)*($BI6-C_equiv_harmonious_min_perc))-UC6)/El_boiler_eff", "VG" : "=SW6-($BA6-SN6)/El_boiler_eff", "VH" : "=SP6-SI6/BESS_chrg_eff", "VI" : "=UF6-TY6/BESS_chrg_eff", "VJ" : "=SQ6-SI6/BESS_chrg_eff", "VK" : "=SY6-$AS6", "VL" : "=UO6-($AS6+($AT6-$AS6)/(C_equiv_harmonious_max_perc-C_equiv_harmonious_min_perc)*($BI6-C_equiv_harmonious_min_perc))", "VM" : "=SZ6-$AS6", "VN" : "=TB6-$AU6", "VO" : "=UR6-($AU6+($AV6-$AU6)/(C_equiv_harmonious_max_perc-C_equiv_harmonious_min_perc)*($BI6-C_equiv_harmonious_min_perc))", "VP" : "=TC6-$AU6", "VQ" : "=TE6-$AW6", "VR" : "=UU6-($AW6+($AX6-$AW6)/(C_equiv_harmonious_max_perc-C_equiv_harmonious_min_perc)*($BI6-C_equiv_harmonious_min_perc))", "VS" : "=TF6-$AW6",  "VU" : "=IF(OR(UY6<0,VB6<0,VE6<0,VH6<0,VK6<0,VN6<0,VQ6<0),0,MIN(1,Overall_harmonious_min_perc+MIN(IFERROR(UY6/(UY6-VA6),1),IFERROR(VB6/(VB6-VD6),1),IFERROR(VE6/(VE6-VG6),1),IFERROR(VH6/(VH6-VJ6),1),IFERROR(VK6/(VK6-VM6),1),IFERROR(VN6/(VN6-VP6),1),IFERROR(VQ6/(VQ6-VS6),1))*(Overall_harmonious_max_perc-Overall_harmonious_min_perc)))", "VV" : "=IF(VU6=0,0,ROUND((SJ6+(SK6-SJ6)/(Overall_harmonious_max_perc-Overall_harmonious_min_perc)*(VU6-Overall_harmonious_min_perc))-$AY6-MAX(0,$BA6-(SM6+(SN6-SM6)/(Overall_harmonious_max_perc-Overall_harmonious_min_perc)*(VU6-Overall_harmonious_min_perc)))/El_boiler_eff-SI6/BESS_chrg_eff,5))", "VW" : "=IF(VU6=0,0,(TZ6+(UA6-TZ6)/(Overall_harmonious_max_perc-Overall_harmonious_min_perc)*(VU6-Overall_harmonious_min_perc))-($AY6+($AZ6-$AY6)/(C_equiv_harmonious_max_perc-C_equiv_harmonious_min_perc)*($BI6-C_equiv_harmonious_min_perc))-MAX(0,($BA6+($BB6-$BA6)/(C_equiv_harmonious_max_perc-C_equiv_harmonious_min_perc)*($BI6-C_equiv_harmonious_min_perc))-(UC6+(UD6-UC6)/(Overall_harmonious_max_perc-Overall_harmonious_min_perc)*(VU6-Overall_harmonious_min_perc)))/El_boiler_eff-TY6/BESS_chrg_eff)", "VX" : "=IF(VU6=0,0,ROUND((SM6+(SN6-SM6)/(Overall_harmonious_max_perc-Overall_harmonious_min_perc)*(VU6-Overall_harmonious_min_perc))+MAX(0,(SJ6+(SK6-SJ6)/(Overall_harmonious_max_perc-Overall_harmonious_min_perc)*(VU6-Overall_harmonious_min_perc))-$AY6-SI6/BESS_chrg_eff)*El_boiler_eff-$BA6,5))", "VY" : "=IF(VU6=0,0,(UC6+(UD6-UC6)/(Overall_harmonious_max_perc-Overall_harmonious_min_perc)*(VU6-Overall_harmonious_min_perc))+MAX(0,(TZ6+(UA6-TZ6)/(Overall_harmonious_max_perc-Overall_harmonious_min_perc)*(VU6-Overall_harmonious_min_perc))-($AY6+($AZ6-$AY6)/(C_equiv_harmonious_max_perc-C_equiv_harmonious_min_perc)*($BI6-C_equiv_harmonious_min_perc))-TY6/BESS_chrg_eff)*El_boiler_eff-($BA6+($BB6-$BA6)/(C_equiv_harmonious_max_perc-C_equiv_harmonious_min_perc)*($BI6-C_equiv_harmonious_min_perc)))", "VZ" : "=IF(VU6=0,0,ROUND((SV6+(SW6-SV6)/(Overall_harmonious_max_perc-Overall_harmonious_min_perc)*(VU6-Overall_harmonious_min_perc))-($BA6-(SM6+(SN6-SM6)/(Overall_harmonious_max_perc-Overall_harmonious_min_perc)*(VU6-Overall_harmonious_min_perc)))/El_boiler_eff,5))", "WA" : "=IF(VU6=0,0,(UL6+(UM6-UL6)/(Overall_harmonious_max_perc-Overall_harmonious_min_perc)*(VU6-Overall_harmonious_min_perc))-(($BA6+($BB6-$BA6)/(C_equiv_harmonious_max_perc-C_equiv_harmonious_min_perc)*($BI6-C_equiv_harmonious_min_perc))-(UC6+(UD6-UC6)/(Overall_harmonious_max_perc-Overall_harmonious_min_perc)*(VU6-Overall_harmonious_min_perc)))/El_boiler_eff)", "WB" : "=IF(VU6=0,0,ROUND((SP6+(SQ6-SP6)/(Overall_harmonious_max_perc-Overall_harmonious_min_perc)*(VU6-Overall_harmonious_min_perc))-SI6/BESS_chrg_eff,5))", "WC" : "=IF(VU6=0,0,(UF6+(UG6-UF6)/(Overall_harmonious_max_perc-Overall_harmonious_min_perc)*(VU6-Overall_harmonious_min_perc))-TY6/BESS_chrg_eff)", "WD" : "=IF(VU6=0,0,ROUND((SY6+(SZ6-SY6)/(Overall_harmonious_max_perc-Overall_harmonious_min_perc)*(VU6-Overall_harmonious_min_perc))-$AS6,5))", "WE" : "=IF(VU6=0,0,SY6+(SZ6-SY6)/(Overall_harmonious_max_perc-Overall_harmonious_min_perc)*(VU6-Overall_harmonious_min_perc)-($AS6+($AT6-$AS6)/(C_equiv_harmonious_max_perc-C_equiv_harmonious_min_perc)*($BI6-C_equiv_harmonious_min_perc)))", "WF" : "=IF(VU6=0,0,ROUND((TB6+(TC6-TB6)/(Overall_harmonious_max_perc-Overall_harmonious_min_perc)*(VU6-Overall_harmonious_min_perc))-$AU6,5))", "WG" : "=IF(VU6=0,0,TB6+(TC6-TB6)/(Overall_harmonious_max_perc-Overall_harmonious_min_perc)*(VU6-Overall_harmonious_min_perc)-($AU6+($AV6-$AU6)/(C_equiv_harmonious_max_perc-C_equiv_harmonious_min_perc)*($BI6-C_equiv_harmonious_min_perc)))", "WH" : "=IF(VU6=0,0,ROUND((TE6+(TF6-TE6)/(Overall_harmonious_max_perc-Overall_harmonious_min_perc)*(VU6-Overall_harmonious_min_perc))-$AW6,5))", "WI" : "=IF(VU6=0,0,TE6+(TF6-TE6)/(Overall_harmonious_max_perc-Overall_harmonious_min_perc)*(VU6-Overall_harmonious_min_perc)-($AW6+($AX6-$AW6)/(C_equiv_harmonious_max_perc-C_equiv_harmonious_min_perc)*($BI6-C_equiv_harmonious_min_perc)))", "WJ" : "=IF(OR(VU6=0,VV6<0,VX6<0,VZ6<0,WB6<0,WD6<0,WF6<0,WH6<0),0,MIN(1,C_equiv_harmonious_min_perc+MIN(IF(VW6>=0,1,VV6/(VV6-VW6)),IF(VY6>=0,1,VX6/(VX6-VY6)),IF(WA6>=0,1,VZ6/(VZ6-WA6)),IF(WC6>=0,1,WB6/(WB6-WC6)),IF(WE6>=0,1,WD6/(WD6-WE6)),IF(WG6>=0,1,WF6/(WF6-WG6)),IF(WI6>=0,1,WH6/(WH6-WI6)))*(C_equiv_harmonious_max_perc*$BI6-C_equiv_harmonious_min_perc)))",  "WL" : "=IF(OR(UY6<0,VB6<0,VE6<0,VH6<0,VK6<0,VN6<0,VQ6<0),0,MIN(1,C_equiv_harmonious_min_perc+MIN(IF(UZ6>=0,1,UY6/(UY6-UZ6)),IF(VC6>=0,1,VB6/(VB6-VC6)),IF(VF6>=0,1,VE6/(VE6-VF6)),IF(VI6>=0,1,VH6/(VH6-VI6)),IF(VL6>=0,1,VK6/(VK6-VL6)),IF(VO6>=0,1,VN6/(VN6-VO6)),IF(VR6>=0,1,VQ6/(VQ6-VR6)))*(C_equiv_harmonious_max_perc*$BI6-C_equiv_harmonious_min_perc)))", "WM" : "=IF(WL6=0,0,ROUND((SJ6+(TZ6-SJ6)/(C_equiv_harmonious_max_perc*$BI6-C_equiv_harmonious_min_perc)*(WL6-C_equiv_harmonious_min_perc))-($AY6+($AZ6-$AY6)/(C_equiv_harmonious_max_perc-C_equiv_harmonious_min_perc)*(WL6-C_equiv_harmonious_min_perc))-MAX(0,($BA6+($BB6-$BA6)/(C_equiv_harmonious_max_perc-C_equiv_harmonious_min_perc)*(WL6-C_equiv_harmonious_min_perc))-(SM6+(UC6-SM6)/(C_equiv_harmonious_max_perc*$BI6-C_equiv_harmonious_min_perc)*(WL6-C_equiv_harmonious_min_perc)))/El_boiler_eff-(SI6+(TY6-SI6)/(C_equiv_harmonious_max_perc*$BI6-C_equiv_harmonious_min_perc)*(WL6-C_equiv_harmonious_min_perc))/BESS_chrg_eff,5))", "WN" : "=IF(WL6=0,0,(SK6+(UA6-SK6)/(C_equiv_harmonious_max_perc*$BI6-C_equiv_harmonious_min_perc)*(WL6-C_equiv_harmonious_min_perc))-($AY6+($AZ6-$AY6)/(C_equiv_harmonious_max_perc-C_equiv_harmonious_min_perc)*(WL6-C_equiv_harmonious_min_perc))-(MAX(0,($BA6+($BB6-$BA6)/(C_equiv_harmonious_max_perc-C_equiv_harmonious_min_perc)*(WL6-C_equiv_harmonious_min_perc))-(SN6+(UD6-SN6)/(C_equiv_harmonious_max_perc*$BI6-C_equiv_harmonious_min_perc)*(WL6-C_equiv_harmonious_min_perc)))/El_boiler_eff)-((SI6+(TY6-SI6)/(C_equiv_harmonious_max_perc*$BI6-C_equiv_harmonious_min_perc)*(WL6-C_equiv_harmonious_min_perc))/BESS_chrg_eff))", "WO" : "=IF(WL6=0,0,ROUND((SM6+(UC6-SM6)/(C_equiv_harmonious_max_perc*$BI6-C_equiv_harmonious_min_perc)*(WL6-C_equiv_harmonious_min_perc))+(MAX(0,(SJ6+(TZ6-SJ6)/(C_equiv_harmonious_max_perc*$BI6-C_equiv_harmonious_min_perc)*(WL6-C_equiv_harmonious_min_perc))-($AY6+($AZ6-$AY6)/(C_equiv_harmonious_max_perc-C_equiv_harmonious_min_perc)*(WL6-C_equiv_harmonious_min_perc))-((SI6+(TY6-SI6)/(C_equiv_harmonious_max_perc*$BI6-C_equiv_harmonious_min_perc)*(WL6-C_equiv_harmonious_min_perc))/BESS_chrg_eff)))*El_boiler_eff-($BA6+($BB6-$BA6)/(C_equiv_harmonious_max_perc-C_equiv_harmonious_min_perc)*(WL6-C_equiv_harmonious_min_perc)),5))", "WP" : "=IF(WL6=0,0,(SN6+(UD6-SN6)/(C_equiv_harmonious_max_perc*$BI6-C_equiv_harmonious_min_perc)*(WL6-C_equiv_harmonious_min_perc))+(MAX(0,(SK6+(UA6-SK6)/(C_equiv_harmonious_max_perc*$BI6-C_equiv_harmonious_min_perc)*(WL6-C_equiv_harmonious_min_perc))-($AY6+($AZ6-$AY6)/(C_equiv_harmonious_max_perc-C_equiv_harmonious_min_perc)*(WL6-C_equiv_harmonious_min_perc))-((SI6+(TY6-SI6)/(C_equiv_harmonious_max_perc*$BI6-C_equiv_harmonious_min_perc)*(WL6-C_equiv_harmonious_min_perc))/BESS_chrg_eff)))*El_boiler_eff-($BA6+($BB6-$BA6)/(C_equiv_harmonious_max_perc-C_equiv_harmonious_min_perc)*(WL6-C_equiv_harmonious_min_perc)))", "WQ" : "=IF(WL6=0,0,ROUND((SV6+(UL6-SV6)/(C_equiv_harmonious_max_perc*$BI6-C_equiv_harmonious_min_perc)*(WL6-C_equiv_harmonious_min_perc))-(($BA6+($BB6-$BA6)/(C_equiv_harmonious_max_perc-C_equiv_harmonious_min_perc)*($GX6-C_equiv_harmonious_min_perc))-(SM6+(UC6-SM6)/(C_equiv_harmonious_max_perc*$BI6-C_equiv_harmonious_min_perc)*(WL6-C_equiv_harmonious_min_perc)))/El_boiler_eff,5))", "WR" : "=IF(WL6=0,0,(SW6+(UM6-SW6)/(C_equiv_harmonious_max_perc*$BI6-C_equiv_harmonious_min_perc)*(WL6-C_equiv_harmonious_min_perc))-(($BA6+($BB6-$BA6)/(C_equiv_harmonious_max_perc-C_equiv_harmonious_min_perc)*($GX6-C_equiv_harmonious_min_perc))-(SN6+(UD6-SN6)/(C_equiv_harmonious_max_perc*$BI6-C_equiv_harmonious_min_perc)*(WL6-C_equiv_harmonious_min_perc)))/El_boiler_eff)", "WS" : "=IF(WL6=0,0,ROUND((SP6+(UF6-SP6)/(C_equiv_harmonious_max_perc*$BI6-C_equiv_harmonious_min_perc)*(WL6-C_equiv_harmonious_min_perc))-(SI6+(TY6-SI6)/(C_equiv_harmonious_max_perc*$BI6-C_equiv_harmonious_min_perc)*(WL6-C_equiv_harmonious_min_perc))/BESS_chrg_eff,5))", "WT" : "=IF(WL6=0,0,(SQ6+(UG6-SQ6)/(C_equiv_harmonious_max_perc*$BI6-C_equiv_harmonious_min_perc)*(WL6-C_equiv_harmonious_min_perc))-(SI6+(TY6-SI6)/(C_equiv_harmonious_max_perc*$BI6-C_equiv_harmonious_min_perc)*(WL6-C_equiv_harmonious_min_perc))/BESS_chrg_eff)", "WU" : "=IF(WL6=0,0,(SY6+(UO6-SY6)/(C_equiv_harmonious_max_perc*$BI6-C_equiv_harmonious_min_perc)*(WL6-C_equiv_harmonious_min_perc))-($AS6+($AT6-$AS6)/(C_equiv_harmonious_max_perc-C_equiv_harmonious_min_perc)*(WL6-C_equiv_harmonious_min_perc)))", "WV" : "=IF(WL6=0,0,(SZ6+(UP6-SZ6)/(C_equiv_harmonious_max_perc*$BI6-C_equiv_harmonious_min_perc)*(WL6-C_equiv_harmonious_min_perc))-($AS6+($AT6-$AS6)/(C_equiv_harmonious_max_perc-C_equiv_harmonious_min_perc)*(WL6-C_equiv_harmonious_min_perc)))", "WW" : "=IF(WL6=0,0,(TB6+(UR6-TB6)/(C_equiv_harmonious_max_perc*$BI6-C_equiv_harmonious_min_perc)*(WL6-C_equiv_harmonious_min_perc))-($AU6+($AV6-$AU6)/(C_equiv_harmonious_max_perc-C_equiv_harmonious_min_perc)*(WL6-C_equiv_harmonious_min_perc)))", "WX" : "=IF(WL6=0,0,(TC6+(US6-TC6)/(C_equiv_harmonious_max_perc*$BI6-C_equiv_harmonious_min_perc)*(WL6-C_equiv_harmonious_min_perc))-($AU6+($AV6-$AU6)/(C_equiv_harmonious_max_perc-C_equiv_harmonious_min_perc)*(WL6-C_equiv_harmonious_min_perc)))", "WY" : "=IF(WL6=0,0,(TE6+(UU6-TE6)/(C_equiv_harmonious_max_perc*$BI6-C_equiv_harmonious_min_perc)*(WL6-C_equiv_harmonious_min_perc))-($AW6+($AX6-$AW6)/(C_equiv_harmonious_max_perc-C_equiv_harmonious_min_perc)*(WL6-C_equiv_harmonious_min_perc)))", "WZ" : "=IF(WL6=0,0,(TF6+(UV6-TF6)/(C_equiv_harmonious_max_perc*$BI6-C_equiv_harmonious_min_perc)*(WL6-C_equiv_harmonious_min_perc))-($AW6+($AX6-$AW6)/(C_equiv_harmonious_max_perc-C_equiv_harmonious_min_perc)*(WL6-C_equiv_harmonious_min_perc)))", "XA" : "=IF(WL6<=0,0,MIN(1,Overall_harmonious_min_perc+MIN(IF(WN6>=0,1,WM6/(WM6-WN6)),IF(WP6>=0,1,WO6/(WO6-WP6)),IF(WR6>=0,1,WQ6/(WQ6-WR6)),IF(WT6>=0,1,WS6/(WS6-WT6)),IF(WV6>=0,1,WU6/(WU6-WV6)),IF(WX6>=0,1,WW6/(WW6-WX6)),IF(WZ6>=0,1,WY6/(WY6-WZ6)))*(Overall_harmonious_max_perc-Overall_harmonious_min_perc)))",  "XC" : "=IF(OR(VU6=0,WJ6=0),0,(RW6+(TM6-RW6)/(C_equiv_harmonious_max_perc*$BI6-C_equiv_harmonious_min_perc)*(WJ6-C_equiv_harmonious_min_perc))+((RX6+(TN6-RX6)/(C_equiv_harmonious_max_perc*$BI6-C_equiv_harmonious_min_perc)*(WJ6-C_equiv_harmonious_min_perc))-(RW6+(TM6-RW6)/(C_equiv_harmonious_max_perc*$BI6-C_equiv_harmonious_min_perc)*(WJ6-C_equiv_harmonious_min_perc)))/(Overall_harmonious_max_perc-Overall_harmonious_min_perc)*(VU6-Overall_harmonious_min_perc))", "XD" : "=IF(OR(VU6=0,WJ6=0),0,($AY6+($AZ6-$AY6)/(C_equiv_harmonious_max_perc-C_equiv_harmonious_min_perc)*(WJ6-C_equiv_harmonious_min_perc)))", "XE" : "=IF(OR(VU6=0,WJ6=0),0,SF6+(TV6-SF6)/(C_equiv_harmonious_max_perc*$BI6-C_equiv_harmonious_min_perc)*(WJ6-C_equiv_harmonious_min_perc))", "XF" : "=IF(OR(VU6=0,WJ6=0),0,MIN(((SP6+(UF6-SP6)/(C_equiv_harmonious_max_perc*$BI6-C_equiv_harmonious_min_perc)*(WJ6-C_equiv_harmonious_min_perc))+((SQ6+(UG6-SQ6)/(C_equiv_harmonious_max_perc*$BI6-C_equiv_harmonious_min_perc)*(WJ6-C_equiv_harmonious_min_perc))-(SP6+(UF6-SP6)/(C_equiv_harmonious_max_perc*$BI6-C_equiv_harmonious_min_perc)*(WJ6-C_equiv_harmonious_min_perc)))/(Overall_harmonious_max_perc-Overall_harmonious_min_perc)*(VU6-Overall_harmonious_min_perc)),(SI6+(TY6-SI6)/(C_equiv_harmonious_max_perc*$BI6-C_equiv_harmonious_min_perc)*(WJ6-C_equiv_harmonious_min_perc))/BESS_chrg_eff))", "XG" : "=IF(OR(VU6=0,WJ6=0),0,(SC6+(TS6-SC6)/(C_equiv_harmonious_max_perc*$BI6-C_equiv_harmonious_min_perc)*(WJ6-C_equiv_harmonious_min_perc))+((SD6+(TT6-SD6)/(C_equiv_harmonious_max_perc*$BI6-C_equiv_harmonious_min_perc)*(WJ6-C_equiv_harmonious_min_perc))-(SC6+(TS6-SC6)/(C_equiv_harmonious_max_perc*$BI6-C_equiv_harmonious_min_perc)*(WJ6-C_equiv_harmonious_min_perc)))/(Overall_harmonious_max_perc-Overall_harmonious_min_perc)*(VU6-Overall_harmonious_min_perc))", "XH" : "=XO6/El_boiler_eff", "XI" : "=IF(OR(VU6=0,WJ6=0),0,RS6+(TI6-RS6)/(C_equiv_harmonious_max_perc*$BI6-C_equiv_harmonious_min_perc)*(WJ6-C_equiv_harmonious_min_perc))", "XJ" : "=IF(OR(VU6=0,WJ6=0),0,MIN($AR6*Grid_import_max_ud,MAX(0,-(SUM(XI6:XI6)-SUM(XC6:XH6)))))", "XK" : "=SUM(XI6:XJ6)-SUM(XC6:XH6)", "XL" : "=IF(OR(VU6=0,WJ6=0),0,(RZ6+(TP6-RZ6)/(C_equiv_harmonious_max_perc*$BI6-C_equiv_harmonious_min_perc)*(WJ6-C_equiv_harmonious_min_perc))+((SA6+(TQ6-SA6)/(C_equiv_harmonious_max_perc*$BI6-C_equiv_harmonious_min_perc)*(WJ6-C_equiv_harmonious_min_perc))-(RZ6+(TP6-RZ6)/(C_equiv_harmonious_max_perc*$BI6-C_equiv_harmonious_min_perc)*(WJ6-C_equiv_harmonious_min_perc)))/(Overall_harmonious_max_perc-Overall_harmonious_min_perc)*(VU6-Overall_harmonious_min_perc))", "XM" : "=IF(OR(VU6=0,WJ6=0),0,($BA6+($BB6-$BA6)/(C_equiv_harmonious_max_perc-C_equiv_harmonious_min_perc)*(WJ6-C_equiv_harmonious_min_perc)))", "XN" : "=IF(OR(VU6=0,WJ6=0),0,XG6*El_boiler_eff)", "XO" : "=IF(OR(VU6=0,WJ6=0),0,MAX(0,XM6-((SM6+(UC6-SM6)/(C_equiv_harmonious_max_perc*$BI6-C_equiv_harmonious_min_perc)*(WJ6-C_equiv_harmonious_min_perc))+((SN6+(UD6-SN6)/(C_equiv_harmonious_max_perc*$BI6-C_equiv_harmonious_min_perc)*(WJ6-C_equiv_harmonious_min_perc))-(SM6+(UC6-SM6)/(C_equiv_harmonious_max_perc*$BI6-C_equiv_harmonious_min_perc)*(WJ6-C_equiv_harmonious_min_perc)))/(Overall_harmonious_max_perc-Overall_harmonious_min_perc)*(VU6-Overall_harmonious_min_perc))))", "XP" : "=IF(OR(VU6=0,WJ6=0),0,RU6+(TK6-RU6)/(C_equiv_harmonious_max_perc*$BI6-C_equiv_harmonious_min_perc)*(WJ6-C_equiv_harmonious_min_perc))", "XQ" : "=SUM(XN6:XP6)-SUM(XL6:XM6)", "XR" : "=IF(OR(VU6=0,WJ6=0),0,RY6+(TO6-RY6)/(C_equiv_harmonious_max_perc*$BI6-C_equiv_harmonious_min_perc)*(WJ6-C_equiv_harmonious_min_perc))", "XS" : "=IF(OR(VU6=0,WJ6=0),0,SG6+(TW6-SG6)/(C_equiv_harmonious_max_perc*$BI6-C_equiv_harmonious_min_perc)*(WJ6-C_equiv_harmonious_min_perc))", "XT" : "=IF(OR(VU6=0,WJ6=0),0,SE6+(TU6-SE6)/(C_equiv_harmonious_max_perc*$BI6-C_equiv_harmonious_min_perc)*(WJ6-C_equiv_harmonious_min_perc))", "XU" : "=XF6*BESS_chrg_eff", "XV" : "=IF(OR(VU6=0,WJ6=0),0,RT6+(TJ6-RT6)/(C_equiv_harmonious_max_perc*$BI6-C_equiv_harmonious_min_perc)*(WJ6-C_equiv_harmonious_min_perc))", "XW" : "=IF(OR(VU6=0,WJ6=0),0,MIN($AQ6*Grid_import_max_ud,MAX(0,-(SUM(XU6:XV6)-SUM(XR6:XT6)))))", "XX" : "=SUM(XU6:XW6)-SUM(XR6:XT6)", "XY" : "=IF(OR(VU6=0,WJ6=0),0,SB6+(TR6-SB6)/(C_equiv_harmonious_max_perc*$BI6-C_equiv_harmonious_min_perc)*(WJ6-C_equiv_harmonious_min_perc))", "XZ" : "=IF(OR(VU6=0,WJ6=0),0,XT6*El_boiler_eff)", "YA" : "=IF(OR(VU6=0,WJ6=0),0,RV6+(TL6-RV6)/(C_equiv_harmonious_max_perc*$BI6-C_equiv_harmonious_min_perc)*(WJ6-C_equiv_harmonious_min_perc))", "YB" : "=SUM(XZ6:YA6)-SUM(XY6:XY6)", "YC" : "=IF(XC6<=0,0,XC6/(Overall_harmonious_var_max_cons+Overall_fix_cons)*MethDist_harmonious_max_perc*MethDist_Meth_nom_prod_ud)+IF(XR6<=0,0,XR6/(C_overall_var_max_cons+C_overall_fix_stby_cons)*C_MethDist_max_perc*MethDist_Meth_nom_prod_ud)", "YD" : "=MIN(XK6,IF(OR(VU6=0,WJ6=0),0,(SS6+(UI6-SS6)/(C_equiv_harmonious_max_perc*$BI6-C_equiv_harmonious_min_perc)*(WJ6-C_equiv_harmonious_min_perc))+((ST6+(UJ6-ST6)/(C_equiv_harmonious_max_perc*$BI6-C_equiv_harmonious_min_perc)*(WJ6-C_equiv_harmonious_min_perc))-(SS6+(UI6-SS6)/(C_equiv_harmonious_max_perc*$BI6-C_equiv_harmonious_min_perc)*(WJ6-C_equiv_harmonious_min_perc)))/(Overall_harmonious_max_perc-Overall_harmonious_min_perc)*(VU6-Overall_harmonious_min_perc)))+MIN(XX6,IF(OR(VU6=0,WJ6=0),0,SU6+(UK6-SU6)/(C_equiv_harmonious_max_perc*$BI6-C_equiv_harmonious_min_perc)*(WJ6-C_equiv_harmonious_min_perc)))", "YE" : "=XW6+XJ6", "YF" : "=MAX(0,-XK6)+MAX(0,-XQ6)+MAX(0,-XX6)+MAX(0,-YB6)",  "YH" : "=IF(OR(XA6=0,WL6=0),0,(RW6+(TM6-RW6)/(C_equiv_harmonious_max_perc*$BI6-C_equiv_harmonious_min_perc)*(WL6-C_equiv_harmonious_min_perc))+((RX6+(TN6-RX6)/(C_equiv_harmonious_max_perc*$BI6-C_equiv_harmonious_min_perc)*(WL6-C_equiv_harmonious_min_perc))-(RW6+(TM6-$CI6)/(C_equiv_harmonious_max_perc*$BI6-C_equiv_harmonious_min_perc)*(WL6-C_equiv_harmonious_min_perc)))/(Overall_harmonious_max_perc-Overall_harmonious_min_perc)*(XA6-Overall_harmonious_min_perc))", "YI" : "=IF(OR(XA6=0,WL6=0),0,($AY6+($AZ6-$AY6)/(C_equiv_harmonious_max_perc-C_equiv_harmonious_min_perc)*(WL6-C_equiv_harmonious_min_perc)))", "YJ" : "=IF(OR(XA6=0,WL6=0),0,SF6+(TV6-SF6)/(C_equiv_harmonious_max_perc*$BI6-C_equiv_harmonious_min_perc)*(WL6-C_equiv_harmonious_min_perc))", "YK" : "=IF(OR(XA6=0,WL6=0),0,MIN(((SP6+(UF6-SP6)/(C_equiv_harmonious_max_perc*$BI6-C_equiv_harmonious_min_perc)*(WL6-C_equiv_harmonious_min_perc))+((SQ6+(UG6-SQ6)/(C_equiv_harmonious_max_perc*$BI6-C_equiv_harmonious_min_perc)*(WL6-C_equiv_harmonious_min_perc))-(SP6+(UF6-SP6)/(C_equiv_harmonious_max_perc*$BI6-C_equiv_harmonious_min_perc)*(WL6-C_equiv_harmonious_min_perc)))/(Overall_harmonious_max_perc-Overall_harmonious_min_perc)*(XA6-Overall_harmonious_min_perc)),(SI6+(TY6-SI6)/(C_equiv_harmonious_max_perc*$BI6-C_equiv_harmonious_min_perc)*(WL6-C_equiv_harmonious_min_perc))/BESS_chrg_eff))", "YL" : "=IF(OR(XA6=0,WL6=0),0,(SC6+(TS6-SC6)/(C_equiv_harmonious_max_perc*$BI6-C_equiv_harmonious_min_perc)*(WL6-C_equiv_harmonious_min_perc))+((SD6+(TT6-SD6)/(C_equiv_harmonious_max_perc*$BI6-C_equiv_harmonious_min_perc)*(WL6-C_equiv_harmonious_min_perc))-(SC6+(TS6-SC6)/(C_equiv_harmonious_max_perc*$BI6-C_equiv_harmonious_min_perc)*(WL6-C_equiv_harmonious_min_perc)))/(Overall_harmonious_max_perc-Overall_harmonious_min_perc)*(XA6-Overall_harmonious_min_perc))", "YM" : "=YT6/El_boiler_eff", "YN" : "=IF(OR(XA6=0,WL6=0),0,RS6+(TI6-RS6)/(C_equiv_harmonious_max_perc*$BI6-C_equiv_harmonious_min_perc)*(WL6-C_equiv_harmonious_min_perc))", "YO" : "=IF(OR(WL6=0,XA6=0),0,MIN($D6*Grid_import_max_ud,MAX(0,-(SUM(YN6:YN6)-SUM(YH6:YM6)))))", "YP" : "=SUM(YN6:YO6)-SUM(YH6:YM6)", "YQ" : "=IF(OR(XA6=0,WL6=0),0,(RZ6+(TP6-RZ6)/(C_equiv_harmonious_max_perc*$BI6-C_equiv_harmonious_min_perc)*(WL6-C_equiv_harmonious_min_perc))+((SA6+(TQ6-SA6)/(C_equiv_harmonious_max_perc*$BI6-C_equiv_harmonious_min_perc)*(WL6-C_equiv_harmonious_min_perc))-(RZ6+(TP6-RZ6)/(C_equiv_harmonious_max_perc*$BI6-C_equiv_harmonious_min_perc)*(WL6-C_equiv_harmonious_min_perc)))/(Overall_harmonious_max_perc-Overall_harmonious_min_perc)*(XA6-Overall_harmonious_min_perc))", "YR" : "=IF(OR(XA6=0,WL6=0),0,($BA6+($BB6-$BA6)/(C_equiv_harmonious_max_perc-C_equiv_harmonious_min_perc)*(WL6-C_equiv_harmonious_min_perc)))", "YS" : "=IF(OR(XA6=0,WL6=0),0,YL6*El_boiler_eff)", "YT" : "=IF(OR(XA6=0,WL6=0),0,MAX(0,YR6-((SM6+(UC6-SM6)/(C_equiv_harmonious_max_perc*$BI6-C_equiv_harmonious_min_perc)*(WL6-C_equiv_harmonious_min_perc))+((SN6+(UD6-SN6)/(C_equiv_harmonious_max_perc*$BI6-C_equiv_harmonious_min_perc)*(WL6-C_equiv_harmonious_min_perc))-(SM6+(UC6-SM6)/(C_equiv_harmonious_max_perc*$BI6-C_equiv_harmonious_min_perc)*(WL6-C_equiv_harmonious_min_perc)))/(Overall_harmonious_max_perc-Overall_harmonious_min_perc)*(XA6-Overall_harmonious_min_perc))))", "YU" : "=IF(OR(XA6=0,WL6=0),0,RU6+(TK6-RU6)/(C_equiv_harmonious_max_perc*$BI6-C_equiv_harmonious_min_perc)*(WL6-C_equiv_harmonious_min_perc))", "YV" : "=SUM(YS6:YU6)-SUM(YQ6:YR6)", "YW" : "=IF(OR(XA6=0,WL6=0),0,RY6+(TO6-RY6)/(C_equiv_harmonious_max_perc*$BI6-C_equiv_harmonious_min_perc)*(WL6-C_equiv_harmonious_min_perc))", "YX" : "=IF(OR(XA6=0,WL6=0),0,SG6+(TW6-SG6)/(C_equiv_harmonious_max_perc*$BI6-C_equiv_harmonious_min_perc)*(WL6-C_equiv_harmonious_min_perc))", "YY" : "=IF(OR(XA6=0,WL6=0),0,SE6+(TU6-SE6)/(C_equiv_harmonious_max_perc*$BI6-C_equiv_harmonious_min_perc)*(WL6-C_equiv_harmonious_min_perc))", "YZ" : "=YK6*BESS_chrg_eff", "ZA" : "=IF(OR(XA6=0,WL6=0),0,RT6+(TJ6-RT6)/(C_equiv_harmonious_max_perc*$BI6-C_equiv_harmonious_min_perc)*(WL6-C_equiv_harmonious_min_perc))", "ZB" : "=IF(OR(XA6=0,WL6=0),0,MIN($C6*Grid_import_max_ud,MAX(0,-(SUM(YZ6:ZA6)-SUM(YW6:YY6)))))", "ZC" : "=SUM(YZ6:ZB6)-SUM(YW6:YY6)", "ZD" : "=IF(OR(XA6=0,WL6=0),0,SB6+(TR6-SB6)/(C_equiv_harmonious_max_perc*$BI6-C_equiv_harmonious_min_perc)*(WL6-C_equiv_harmonious_min_perc))", "ZE" : "=IF(OR(XA6=0,WL6=0),0,YY6*El_boiler_eff)", "ZF" : "=IF(OR(XA6=0,WL6=0),0,RV6+(TL6-RV6)/(C_equiv_harmonious_max_perc*$BI6-C_equiv_harmonious_min_perc)*(WL6-C_equiv_harmonious_min_perc))", "ZG" : "=SUM(ZE6:ZF6)-SUM(ZD6:ZD6)", "ZH" : "=IF(YH6<=0,0,YH6/(Overall_harmonious_var_max_cons+Overall_fix_cons)*MethDist_harmonious_max_perc*MethDist_Meth_nom_prod_ud)+IF(YW6<=0,0,YW6/(C_overall_var_max_cons+C_overall_fix_stby_cons)*C_MethDist_max_perc*MethDist_Meth_nom_prod_ud)", "ZI" : "=MIN(YP6,IF(OR(XA6=0,WL6=0),0,(SS6+(UI6-SS6)/(C_equiv_harmonious_max_perc*$BI6-C_equiv_harmonious_min_perc)*(WL6-C_equiv_harmonious_min_perc))+((ST6+(UJ6-ST6)/(C_equiv_harmonious_max_perc*$BI6-C_equiv_harmonious_min_perc)*(WL6-C_equiv_harmonious_min_perc))-(SS6+(UI6-SS6)/(C_equiv_harmonious_max_perc*$BI6-C_equiv_harmonious_min_perc)*(WL6-C_equiv_harmonious_min_perc)))/(Overall_harmonious_max_perc-Overall_harmonious_min_perc)*(XA6-Overall_harmonious_min_perc)))+MIN(ZC6,IF(OR(XA6=0,WL6=0),0,SU6+(UK6-SU6)/(C_equiv_harmonious_max_perc*$BI6-C_equiv_harmonious_min_perc)*(WL6-C_equiv_harmonious_min_perc)))", "ZJ" : "=ZB6+YO6", "ZK" : "=MAX(0,-YP6)+MAX(0,-YV6)+MAX(0,-ZC6)+MAX(0,-ZG6)",  "ZM" : "=SUMIFS(Calculation$L$5:$L$8763,Calculation$PB$5:$PB$8763,\"=\"&$A6,Calculation$OZ$5:$OZ$8763,\">0\")+SUMIFS(Calculation$OG$5:$OG$8763,Calculation$OL$5:$OL$8763,\">0\",Calculation$PB$5:$PB$8763,\"=\"&$A6,Calculation$OZ$5:$OZ$8763,\">0\")-SUMIFS(Calculation$OR$5:$OR$8763,Calculation$PB$5:$PB$8763,\"=\"&$A6,Calculation$OZ$5:$OZ$8763,\">0\")", "ZN" : "=SUMIFS(Calculation$L$5:$L$8763,Calculation$PB$5:$PB$8763,\"=\"&$A6,Calculation$OZ$5:$OZ$8763,\"=0\")+SUMIFS(Calculation$OG$5:$OG$8763,Calculation$OL$5:$OL$8763,\">0\",Calculation$PB$5:$PB$8763,\"=\"&$A6,Calculation$OZ$5:$OZ$8763,\"=0\")-SUMIFS(Calculation$OR$5:$OR$8763,Calculation$PB$5:$PB$8763,\"=\"&$A6,Calculation$OZ$5:$OZ$8763,\"=0\")", "ZO" : "=SUMIFS(Calculation$J$5:$J$8763,Calculation$PB$5:$PB$8763,\"=\"&$A6,Calculation$OZ$5:$OZ$8763,\">0\")+SUMIFS(Calculation$OK$5:$OK$8763,Calculation$OL$5:$OL$8763,\">0\",Calculation$PB$5:$PB$8763,\"=\"&$A6,Calculation$OZ$5:$OZ$8763,\">0\")/PB_Ratio_Heat_input_vs_output-SUMIFS(Calculation$OS$5:$OS$8763,Calculation$PB$5:$PB$8763,\"=\"&$A6,Calculation$OZ$5:$OZ$8763,\">0\")", "ZP" : "=SUMIFS(Calculation$J$5:$J$8763,Calculation$PB$5:$PB$8763,\"=\"&$A6,Calculation$OZ$5:$OZ$8763,\"=0\")+SUMIFS(Calculation$OK$5:$OK$8763,Calculation$OL$5:$OL$8763,\">0\",Calculation$PB$5:$PB$8763,\"=\"&$A6,Calculation$OZ$5:$OZ$8763,\"=0\")/PB_Ratio_Heat_input_vs_output-SUMIFS(Calculation$OS$5:$OS$8763,Calculation$PB$5:$PB$8763,\"=\"&$A6,Calculation$OZ$5:$OZ$8763,\"=0\")", "ZQ" : "=SUMIF(Calculation$PB$5:$PB$8763,\"=\"&$A6,Calculation$OZ$5:$OZ$8763)+SUMIFS(Calculation$PC$5:$PC$8763,Calculation$PB$5:$PB$8763,\"=\"&$A6,Calculation$OZ$5:$OZ$8763,\">0\")", "ZR" : "=SUMIF(Calculation$PB$5:$PB$8763,\"=\"&$A6,Calculation$PQ$5:$PQ$8763)+SUMIFS(Calculation$PC$5:$PC$8763,Calculation$PB$5:$PB$8763,\"=\"&$A6,Calculation$PQ$5:$PQ$8763,\">0\")", "ZS" : "=SUMIFS(Calculation$PC$5:$PC$8763,Calculation$PB$5:$PB$8763,\"=\"&$A6,Calculation$OZ$5:$OZ$8763,\"=0\")", "ZT" : "=SUMIF(Calculation$PB$5:$PB$8763,\"=\"&$A6,Calculation$PA$5:$PA$8763)+SUMIFS(Calculation$PD$5:$PD$8763,Calculation$PB$5:$PB$8763,\"=\"&$A6,Calculation$OZ$5:$OZ$8763,\">0\")", "ZU" : "=SUMIF(Calculation$PB$5:$PB$8763,\"=\"&$A6,Calculation$PR$5:$PR$8763)+SUMIFS(Calculation$PD$5:$PD$8763,Calculation$PB$5:$PB$8763,\"=\"&$A6,Calculation$PQ$5:$PQ$8763,\">0\")", "ZV" : "=SUMIFS(Calculation$PD$5:$PD$8763,Calculation$PB$5:$PB$8763,\"=\"&$A6,Calculation$OZ$5:$OZ$8763,\"=0\")", "ZW" : "=SUMIFS(Calculation$PI$5:$PI$8763,Calculation$PB$5:$PB$8763,\"=\"&$A6,Calculation$OZ$5:$OZ$8763,\">0\")", "ZX" : "=SUMIFS(Calculation$PW$5:$PW$8763,Calculation$PB$5:$PB$8763,\"=\"&$A6,Calculation$PQ$5:$PQ$8763,\">0\")", "ZY" : "=SUMIF(Calculation$PB$5:$PB$8763,\"=\"&$A6,Calculation$PI$5:$PI$8763)-ZW6", "ZZ" : "=SUMIFS(Calculation$OV$5:$OV$8763,Calculation$PB$5:$PB$8763,\"=\"&$A6,Calculation$OZ$5:$OZ$8763,\">0\")", "AAA" : "=SUMIF(Calculation$PB$5:$PB$8763,\"=\"&$A6,Calculation$OV$5:$OV$8763)-ZZ6", "AAB" : "=SUMIFS(Calculation$OW$5:$OW$8763,Calculation$PB$5:$PB$8763,\"=\"&$A6,Calculation$OZ$5:$OZ$8763,\">0\")", "AAC" : "=SUMIF(Calculation$PB$5:$PB$8763,\"=\"&$A6,Calculation$OW$5:$OW$8763)-AAB6", "AAD" : "=SUMIFS(Calculation$PE$5:$PE$8763,Calculation$PB$5:$PB$8763,\"=\"&$A6,Calculation$OZ$5:$OZ$8763,\">0\")", "AAE" : "=SUMIFS(Calculation$PS$5:$PS$8763,Calculation$PB$5:$PB$8763,\"=\"&$A6,Calculation$PQ$5:$PQ$8763,\">0\")", "AAF" : "=SUMIF(Calculation$PB$5:$PB$8763,\"=\"&$A6,Calculation$PE$5:$PE$8763)-AAD6", "AAG" : "=SUMIFS(Calculation$PF$5:$PF$8763,Calculation$PB$5:$PB$8763,\"=\"&$A6,Calculation$OZ$5:$OZ$8763,\">0\")", "AAH" : "=SUMIFS(Calculation$PT$5:$PT$8763,Calculation$PB$5:$PB$8763,\"=\"&$A6,Calculation$PQ$5:$PQ$8763,\">0\")", "AAI" : "=SUMIF(Calculation$PB$5:$PB$8763,\"=\"&$A6,Calculation$PF$5:$PF$8763)-AAG6", "AAJ" : "=MIN(SUMIFS(Calculation$PN$5:$PN$8763,Calculation$PB$5:$PB$8763,\"=\"&$A6,Calculation$OZ$5:$OZ$8763,\">0\"),BESS_cap_ud/BESS_chrg_eff)", "AAK" : "=MIN(SUMIFS(Calculation$QB$5:$QB$8763,Calculation$PB$5:$PB$8763,\"=\"&$A6,Calculation$PQ$5:$PQ$8763,\">0\"),BESS_cap_ud/BESS_chrg_eff)", "AAL" : "=MIN(SUMIFS(Calculation$PN$5:$PN$8763,Calculation$PB$5:$PB$8763,\"=\"&$A6,Calculation$OZ$5:$OZ$8763,\"=0\"),BESS_cap_ud/BESS_chrg_eff)", "AAM" : "=SUMIFS(Calculation$PO$5:$PO$8763,Calculation$PB$5:$PB$8763,\"=\"&$A6,Calculation$OZ$5:$OZ$8763,\">0\")", "AAN" : "=SUMIFS(Calculation$QC$5:$QC$8763,Calculation$PB$5:$PB$8763,\"=\"&$A6,Calculation$PQ$5:$PQ$8763,\">0\")", "AAO" : "=SUMIF(Calculation$PB$5:$PB$8763,\"=\"&$A6,Calculation$PO$5:$PO$8763)-AAM6", "AAP" : "=SUMIFS(Calculation$PJ$5:$PJ$8763,Calculation$PB$5:$PB$8763,\"=\"&$A6,Calculation$OZ$5:$OZ$8763,\">0\")", "AAQ" : "=SUMIFS(Calculation$PX$5:$PX$8763,Calculation$PB$5:$PB$8763,\"=\"&$A6,Calculation$PQ$5:$PQ$8763,\">0\")", "AAR" : "=SUMIF(Calculation$PB$5:$PB$8763,\"=\"&$A6,Calculation$PJ$5:$PJ$8763)-AAP6", "AAS" : "=SUMIFS(Calculation$PK$5:$PK$8763,Calculation$PB$5:$PB$8763,\"=\"&$A6,Calculation$OZ$5:$OZ$8763,\">0\")", "AAT" : "=SUMIFS(Calculation$PY$5:$PY$8763,Calculation$PB$5:$PB$8763,\"=\"&$A6,Calculation$PQ$5:$PQ$8763,\">0\")", "AAU" : "=SUMIF(Calculation$PB$5:$PB$8763,\"=\"&$A6,Calculation$PK$5:$PK$8763)-AAS6", "AAV" : "=SUMIFS(Calculation$PL$5:$PL$8763,Calculation$PB$5:$PB$8763,\"=\"&$A6,Calculation$OZ$5:$OZ$8763,\">0\")", "AAW" : "=SUMIFS(Calculation$PZ$5:$PZ$8763,Calculation$PB$5:$PB$8763,\"=\"&$A6,Calculation$PQ$5:$PQ$8763,\">0\")", "AAX" : "=SUMIF(Calculation$PB$5:$PB$8763,\"=\"&$A6,Calculation$PL$5:$PL$8763)-AAV6", "AAY" : "=SUMIFS(Calculation$PM$5:$PM$8763,Calculation$PB$5:$PB$8763,\"=\"&$A6,Calculation$OZ$5:$OZ$8763,\">0\")", "AAZ" : "=SUMIFS(Calculation$QA$5:$QA$8763,Calculation$PB$5:$PB$8763,\"=\"&$A6,Calculation$PQ$5:$PQ$8763,\">0\")", "ABA" : "=SUMIF(Calculation$PB$5:$PB$8763,\"=\"&$A6,Calculation$PM$5:$PM$8763)-AAY6",  "ABC" : "=SUMIFS(Calculation$L$5:$L$8763,Calculation$RD$5:$RD$8763,\"=\"&$A6,Calculation$RB$5:$RB$8763,\">0\")+SUMIFS(Calculation$QI$5:$QI$8763,Calculation$QN$5:$QN$8763,\">0\",Calculation$RD$5:$RD$8763,\"=\"&$A6,Calculation$RB$5:$RB$8763,\">0\")-SUMIFS(Calculation$QT$5:$QT$8763,Calculation$RD$5:$RD$8763,\"=\"&$A6,Calculation$RB$5:$RB$8763,\">0\")", "ABD" : "=SUMIFS(Calculation$L$5:$L$8763,Calculation$RD$5:$RD$8763,\"=\"&$A6,Calculation$RB$5:$RB$8763,\"=0\")+SUMIFS(Calculation$QI$5:$QI$8763,Calculation$QN$5:$QN$8763,\">0\",Calculation$RD$5:$RD$8763,\"=\"&$A6,Calculation$RB$5:$RB$8763,\"=0\")-SUMIFS(Calculation$QT$5:$QT$8763,Calculation$RD$5:$RD$8763,\"=\"&$A6,Calculation$RB$5:$RB$8763,\"=0\")", "ABE" : "=SUMIFS(Calculation$J$5:$J$8763,Calculation$RD$5:$RD$8763,\"=\"&$A6,Calculation$RB$5:$RB$8763,\">0\")+SUMIFS(Calculation$QM$5:$QM$8763,Calculation$QN$5:$QN$8763,\">0\",Calculation$RD$5:$RD$8763,\"=\"&$A6,Calculation$RB$5:$RB$8763,\">0\")/PB_Ratio_Heat_input_vs_output-SUMIFS(Calculation$QU$5:$QU$8763,Calculation$RD$5:$RD$8763,\"=\"&$A6,Calculation$RB$5:$RB$8763,\">0\")", "ABF" : "=SUMIFS(Calculation$J$5:$J$8763,Calculation$RD$5:$RD$8763,\"=\"&$A6,Calculation$RB$5:$RB$8763,\"=0\")+SUMIFS(Calculation$QM$5:$QM$8763,Calculation$QN$5:$QN$8763,\">0\",Calculation$RD$5:$RD$8763,\"=\"&$A6,Calculation$RB$5:$RB$8763,\"=0\")/PB_Ratio_Heat_input_vs_output-SUMIFS(Calculation$QU$5:$QU$8763,Calculation$RD$5:$RD$8763,\"=\"&$A6,Calculation$RB$5:$RB$8763,\"=0\")", "ABG" : "=SUMIF(Calculation$RD$5:$RD$8763,\"=\"&$A6,Calculation$RB$5:$RB$8763)+SUMIFS(Calculation$RE$5:$RE$8763,Calculation$RD$5:$RD$8763,\"=\"&$A6,Calculation$RB$5:$RB$8763,\">0\")", "ABH" : "=SUMIF(Calculation$RD$5:$RD$8763,\"=\"&$A6,Calculation$RS$5:$RS$8763)+SUMIFS(Calculation$RE$5:$RE$8763,Calculation$RD$5:$RD$8763,\"=\"&$A6,Calculation$RS$5:$RS$8763,\">0\")", "ABI" : "=SUMIFS(Calculation$RE$5:$RE$8763,Calculation$RD$5:$RD$8763,\"=\"&$A6,Calculation$RB$5:$RB$8763,\"=0\")", "ABJ" : "=SUMIF(Calculation$RD$5:$RD$8763,\"=\"&$A6,Calculation$RC$5:$RC$8763)+SUMIFS(Calculation$RF$5:$RF$8763,Calculation$RD$5:$RD$8763,\"=\"&$A6,Calculation$RB$5:$RB$8763,\">0\")", "ABK" : "=SUMIF(Calculation$RD$5:$RD$8763,\"=\"&$A6,Calculation$RT$5:$RT$8763)+SUMIFS(Calculation$RF$5:$RF$8763,Calculation$RD$5:$RD$8763,\"=\"&$A6,Calculation$RS$5:$RS$8763,\">0\")", "ABL" : "=SUMIFS(Calculation$RF$5:$RF$8763,Calculation$RD$5:$RD$8763,\"=\"&$A6,Calculation$RB$5:$RB$8763,\"=0\")", "ABM" : "=SUMIFS(Calculation$RK$5:$RK$8763,Calculation$RD$5:$RD$8763,\"=\"&$A6,Calculation$RB$5:$RB$8763,\">0\")", "ABN" : "=SUMIFS(Calculation$RY$5:$RY$8763,Calculation$RD$5:$RD$8763,\"=\"&$A6,Calculation$RS$5:$RS$8763,\">0\")", "ABO" : "=SUMIF(Calculation$RD$5:$RD$8763,\"=\"&$A6,Calculation$RK$5:$RK$8763)-ABM6", "ABP" : "=SUMIFS(Calculation$QX$5:$QX$8763,Calculation$RD$5:$RD$8763,\"=\"&$A6,Calculation$RB$5:$RB$8763,\">0\")", "ABQ" : "=SUMIF(Calculation$RD$5:$RD$8763,\"=\"&$A6,Calculation$QX$5:$QX$8763)-ABP6", "ABR" : "=SUMIFS(Calculation$QY$5:$QY$8763,Calculation$RD$5:$RD$8763,\"=\"&$A6,Calculation$RB$5:$RB$8763,\">0\")", "ABS" : "=SUMIF(Calculation$RD$5:$RD$8763,\"=\"&$A6,Calculation$QY$5:$QY$8763)-ABR6", "ABT" : "=SUMIFS(Calculation$RG$5:$RG$8763,Calculation$RD$5:$RD$8763,\"=\"&$A6,Calculation$RB$5:$RB$8763,\">0\")", "ABU" : "=SUMIFS(Calculation$RU$5:$RU$8763,Calculation$RD$5:$RD$8763,\"=\"&$A6,Calculation$RS$5:$RS$8763,\">0\")", "ABV" : "=SUMIF(Calculation$RD$5:$RD$8763,\"=\"&$A6,Calculation$RG$5:$RG$8763)-ABT6", "ABW" : "=SUMIFS(Calculation$RH$5:$RH$8763,Calculation$RD$5:$RD$8763,\"=\"&$A6,Calculation$RB$5:$RB$8763,\">0\")", "ABX" : "=SUMIFS(Calculation$RV$5:$RV$8763,Calculation$RD$5:$RD$8763,\"=\"&$A6,Calculation$RS$5:$RS$8763,\">0\")", "ABY" : "=SUMIF(Calculation$RD$5:$RD$8763,\"=\"&$A6,Calculation$RH$5:$RH$8763)-ABW6", "ABZ" : "=MIN(SUMIFS(Calculation$RP$5:$RP$8763,Calculation$RD$5:$RD$8763,\"=\"&$A6,Calculation$RB$5:$RB$8763,\">0\"),BESS_cap_ud/BESS_chrg_eff)", "ACA" : "=MIN(SUMIFS(Calculation$SD$5:$SD$8763,Calculation$RD$5:$RD$8763,\"=\"&$A6,Calculation$RS$5:$RS$8763,\">0\"),BESS_cap_ud/BESS_chrg_eff)", "ACB" : "=MIN(SUMIFS(Calculation$RP$5:$RP$8763,Calculation$RD$5:$RD$8763,\"=\"&$A6,Calculation$RB$5:$RB$8763,\"=0\"),BESS_cap_ud/BESS_chrg_eff)", "ACC" : "=SUMIFS(Calculation$RQ$5:$RQ$8763,Calculation$RD$5:$RD$8763,\"=\"&$A6,Calculation$RB$5:$RB$8763,\">0\")", "ACD" : "=SUMIFS(Calculation$SE$5:$SE$8763,Calculation$RD$5:$RD$8763,\"=\"&$A6,Calculation$RS$5:$RS$8763,\">0\")", "ACE" : "=SUMIF(Calculation$RD$5:$RD$8763,\"=\"&$A6,Calculation$RQ$5:$RQ$8763)-ACC6", "ACF" : "=SUMIFS(Calculation$RL$5:$RL$8763,Calculation$RD$5:$RD$8763,\"=\"&$A6,Calculation$RB$5:$RB$8763,\">0\")", "ACG" : "=SUMIFS(Calculation$RZ$5:$RZ$8763,Calculation$RD$5:$RD$8763,\"=\"&$A6,Calculation$RS$5:$RS$8763,\">0\")", "ACH" : "=SUMIF(Calculation$RD$5:$RD$8763,\"=\"&$A6,Calculation$RL$5:$RL$8763)-ACF6", "ACI" : "=SUMIFS(Calculation$RM$5:$RM$8763,Calculation$RD$5:$RD$8763,\"=\"&$A6,Calculation$RB$5:$RB$8763,\">0\")", "ACJ" : "=SUMIFS(Calculation$SA$5:$SA$8763,Calculation$RD$5:$RD$8763,\"=\"&$A6,Calculation$RS$5:$RS$8763,\">0\")", "ACK" : "=SUMIF(Calculation$RD$5:$RD$8763,\"=\"&$A6,Calculation$RM$5:$RM$8763)-ACI6", "ACL" : "=SUMIFS(Calculation$RN$5:$RN$8763,Calculation$RD$5:$RD$8763,\"=\"&$A6,Calculation$RB$5:$RB$8763,\">0\")", "ACM" : "=SUMIFS(Calculation$SB$5:$SB$8763,Calculation$RD$5:$RD$8763,\"=\"&$A6,Calculation$RS$5:$RS$8763,\">0\")", "ACN" : "=SUMIF(Calculation$RD$5:$RD$8763,\"=\"&$A6,Calculation$RN$5:$RN$8763)-ACL6", "ACO" : "=SUMIFS(Calculation$RO$5:$RO$8763,Calculation$RD$5:$RD$8763,\"=\"&$A6,Calculation$RB$5:$RB$8763,\">0\")", "ACP" : "=SUMIFS(Calculation$SC$5:$SC$8763,Calculation$RD$5:$RD$8763,\"=\"&$A6,Calculation$RS$5:$RS$8763,\">0\")", "ACQ" : "=SUMIF(Calculation$RD$5:$RD$8763,\"=\"&$A6,Calculation$RO$5:$RO$8763)-ACO6",  "ACS" : "=AAD6-$BS6-MAX(0,$BU6-AAG6)/El_boiler_eff-AAC6/BESS_chrg_eff", "ACT" : "=ABT6-($BS6+($BT6-$BS6)/(D_equiv_harmonious_max_perc-D_equiv_harmonious_min_perc)*($CC6-D_equiv_harmonious_min_perc))-MAX(0,($BU6+($BV6-$BU6)/(D_equiv_harmonious_max_perc-D_equiv_harmonious_min_perc)*($CC6-D_equiv_harmonious_min_perc))-ABW6)/El_boiler_eff-ABS6/BESS_chrg_eff", "ACU" : "=AAE6-$BS6-MAX(0,$BU6-AAH6)/El_boiler_eff-AAC6/BESS_chrg_eff", "ACV" : "=AAG6+MAX(0,AAD6-$BS6-AAC6/BESS_chrg_eff)*El_boiler_eff-$BU6", "ACW" : "=ABW6+MAX(0,ABT6-($BS6+($BT6-$BS6)/(D_equiv_harmonious_max_perc-D_equiv_harmonious_min_perc)*($CC6-D_equiv_harmonious_min_perc))-ABS6/BESS_chrg_eff)*El_boiler_eff-($BU6+($BV6-$BU6)/(D_equiv_harmonious_max_perc-D_equiv_harmonious_min_perc)*($CC6-D_equiv_harmonious_min_perc))", "ACX" : "=AAH6+MAX(0,AAE6-$BS6-AAC6/BESS_chrg_eff)*El_boiler_eff-$BU6", "ACY" : "=AAP6-($BU6-AAG6)/El_boiler_eff", "ACZ" : "=ACF6-(($BU6+($BV6-$BU6)/(D_equiv_harmonious_max_perc-D_equiv_harmonious_min_perc)*($CC6-D_equiv_harmonious_min_perc))-ABW6)/El_boiler_eff", "ADA" : "=AAQ6-($BU6-AAH6)/El_boiler_eff", "ADB" : "=AAJ6-AAC6/BESS_chrg_eff", "ADC" : "=ABZ6-ABS6/BESS_chrg_eff", "ADD" : "=AAK6-AAC6/BESS_chrg_eff", "ADE" : "=AAS6-$BM6", "ADF" : "=ACI6-($BM6+($BN6-$BM6)/(D_equiv_harmonious_max_perc-D_equiv_harmonious_min_perc)*($CC6-D_equiv_harmonious_min_perc))", "ADG" : "=AAT6-$BM6", "ADH" : "=AAV6-$BO6", "ADI" : "=ACL6-($BO6+($BP6-$BO6)/(D_equiv_harmonious_max_perc-D_equiv_harmonious_min_perc)*($CC6-D_equiv_harmonious_min_perc))", "ADJ" : "=AAW6-$BO6", "ADK" : "=AAY6-$BQ6", "ADL" : "=ACO6-($BQ6+($BR6-$BQ6)/(D_equiv_harmonious_max_perc-D_equiv_harmonious_min_perc)*($CC6-D_equiv_harmonious_min_perc))", "ADM" : "=AAZ6-$BQ6",  "ADO" : "=IF(OR(ACS6<0,ACV6<0,ACY6<0,ADB6<0,ADE6<0,ADH6<0,ADK6<0),0,MIN(1,Overall_harmonious_min_perc+MIN(IFERROR(ACS6/(ACS6-ACU6),1),IFERROR(ACV6/(ACV6-ACX6),1),IFERROR(ACY6/(ACY6-ADA6),1),IFERROR(ADB6/(ADB6-ADD6),1),IFERROR(ADE6/(ADE6-ADG6),1),IFERROR(ADH6/(ADH6-ADJ6),1),IFERROR(ADK6/(ADK6-ADM6),1))*(Overall_harmonious_max_perc-Overall_harmonious_min_perc)))", "ADP" : "=IF(ADO6=0,0,ROUND((AAD6+(AAE6-AAD6)/(Overall_harmonious_max_perc-Overall_harmonious_min_perc)*(ADO6-Overall_harmonious_min_perc))-$BS6-MAX(0,$BU6-(AAG6+(AAH6-AAG6)/(Overall_harmonious_max_perc-Overall_harmonious_min_perc)*(ADO6-Overall_harmonious_min_perc)))/El_boiler_eff-AAC6/BESS_chrg_eff,5))", "ADQ" : "=IF(ADO6=0,0,(ABT6+(ABU6-ABT6)/(Overall_harmonious_max_perc-Overall_harmonious_min_perc)*(ADO6-Overall_harmonious_min_perc))-($BS6+($BT6-$BS6)/(D_equiv_harmonious_max_perc-D_equiv_harmonious_min_perc)*($CC6-D_equiv_harmonious_min_perc))-MAX(0,($BU6+($BV6-$BU6)/(D_equiv_harmonious_max_perc-D_equiv_harmonious_min_perc)*($CC6-D_equiv_harmonious_min_perc))-(ABW6+(ABX6-ABW6)/(Overall_harmonious_max_perc-Overall_harmonious_min_perc)*(ADO6-Overall_harmonious_min_perc)))/El_boiler_eff-ABS6/BESS_chrg_eff)", "ADR" : "=IF(ADO6=0,0,ROUND((AAG6+(AAH6-AAG6)/(Overall_harmonious_max_perc-Overall_harmonious_min_perc)*(ADO6-Overall_harmonious_min_perc))+MAX(0,(AAD6+(AAE6-AAD6)/(Overall_harmonious_max_perc-Overall_harmonious_min_perc)*(ADO6-Overall_harmonious_min_perc))-$BS6-AAC6/BESS_chrg_eff)*El_boiler_eff-$BU6,5))", "ADS" : "=IF(ADO6=0,0,(ABW6+(ABX6-ABW6)/(Overall_harmonious_max_perc-Overall_harmonious_min_perc)*(ADO6-Overall_harmonious_min_perc))+MAX(0,(ABT6+(ABU6-ABT6)/(Overall_harmonious_max_perc-Overall_harmonious_min_perc)*(ADO6-Overall_harmonious_min_perc))-($BS6+($BT6-$BS6)/(D_equiv_harmonious_max_perc-D_equiv_harmonious_min_perc)*($CC6-D_equiv_harmonious_min_perc))-ABS6/BESS_chrg_eff)*El_boiler_eff-($BU6+($BV6-$BU6)/(D_equiv_harmonious_max_perc-D_equiv_harmonious_min_perc)*($CC6-D_equiv_harmonious_min_perc)))", "ADT" : "=IF(ADO6=0,0,ROUND((AAP6+(AAQ6-AAP6)/(Overall_harmonious_max_perc-Overall_harmonious_min_perc)*(ADO6-Overall_harmonious_min_perc))-($BU6-(AAG6+(AAH6-AAG6)/(Overall_harmonious_max_perc-Overall_harmonious_min_perc)*(ADO6-Overall_harmonious_min_perc)))/El_boiler_eff,5))", "ADU" : "=IF(ADO6=0,0,(ACF6+(ACG6-ACF6)/(Overall_harmonious_max_perc-Overall_harmonious_min_perc)*(ADO6-Overall_harmonious_min_perc))-(($BU6+($BV6-$BU6)/(D_equiv_harmonious_max_perc-D_equiv_harmonious_min_perc)*($CC6-D_equiv_harmonious_min_perc))-(ABW6+(ABX6-ABW6)/(Overall_harmonious_max_perc-Overall_harmonious_min_perc)*(ADO6-Overall_harmonious_min_perc)))/El_boiler_eff)", "ADV" : "=IF(ADO6=0,0,ROUND((AAJ6+(AAK6-AAJ6)/(Overall_harmonious_max_perc-Overall_harmonious_min_perc)*(ADO6-Overall_harmonious_min_perc))-AAC6/BESS_chrg_eff,5))", "ADW" : "=IF(ADO6=0,0,(ABZ6+(ACA6-ABZ6)/(Overall_harmonious_max_perc-Overall_harmonious_min_perc)*(ADO6-Overall_harmonious_min_perc))-ABS6/BESS_chrg_eff)", "ADX" : "=IF(ADO6=0,0,ROUND((AAS6+(AAT6-AAS6)/(Overall_harmonious_max_perc-Overall_harmonious_min_perc)*(ADO6-Overall_harmonious_min_perc))-$BM6,5))", "ADY" : "=IF(ADO6=0,0,AAS6+(AAT6-AAS6)/(Overall_harmonious_max_perc-Overall_harmonious_min_perc)*(ADO6-Overall_harmonious_min_perc)-($BM6+($BN6-$BM6)/(D_equiv_harmonious_max_perc-D_equiv_harmonious_min_perc)*($CC6-D_equiv_harmonious_min_perc)))", "ADZ" : "=IF(ADO6=0,0,ROUND((AAV6+(AAW6-AAV6)/(Overall_harmonious_max_perc-Overall_harmonious_min_perc)*(ADO6-Overall_harmonious_min_perc))-$BO6,5))", "AEA" : "=IF(ADO6=0,0,AAV6+(AAW6-AAV6)/(Overall_harmonious_max_perc-Overall_harmonious_min_perc)*(ADO6-Overall_harmonious_min_perc)-($BO6+($BP6-$BO6)/(D_equiv_harmonious_max_perc-D_equiv_harmonious_min_perc)*($CC6-D_equiv_harmonious_min_perc)))", "AEB" : "=IF(ADO6=0,0,ROUND((AAY6+(AAZ6-AAY6)/(Overall_harmonious_max_perc-Overall_harmonious_min_perc)*(ADO6-Overall_harmonious_min_perc))-$BQ6,5))", "AEC" : "=IF(ADO6=0,0,AAY6+(AAZ6-AAY6)/(Overall_harmonious_max_perc-Overall_harmonious_min_perc)*(ADO6-Overall_harmonious_min_perc)-($BQ6+($BR6-$BQ6)/(D_equiv_harmonious_max_perc-D_equiv_harmonious_min_perc)*($CC6-D_equiv_harmonious_min_perc)))", "AED" : "=IF(OR(ADO6=0,ADP6<0,ADR6<0,ADT6<0,ADV6<0,ADX6<0,ADZ6<0,AEB6<0),0,MIN(1,D_equiv_harmonious_min_perc+MIN(IF(ADQ6>=0,1,ADP6/(ADP6-ADQ6)),IF(ADS6>=0,1,ADR6/(ADR6-ADS6)),IF(ADU6>=0,1,ADT6/(ADT6-ADU6)),IF(ADW6>=0,1,ADV6/(ADV6-ADW6)),IF(ADY6>=0,1,ADX6/(ADX6-ADY6)),IF(AEA6>=0,1,ADZ6/(ADZ6-AEA6)),IF(AEC6>=0,1,AEB6/(AEB6-AEC6)))*(D_equiv_harmonious_max_perc*$CC6-D_equiv_harmonious_min_perc)))",  "AEF" : "=IF(OR(ACS6<0,ACV6<0,ACY6<0,ADB6<0,ADE6<0,ADH6<0,ADK6<0),0,MIN(1,D_equiv_harmonious_min_perc+MIN(IF(ACT6>=0,1,ACS6/(ACS6-ACT6)),IF(ACW6>=0,1,ACV6/(ACV6-ACW6)),IF(ACZ6>=0,1,ACY6/(ACY6-ACZ6)),IF(ADC6>=0,1,ADB6/(ADB6-ADC6)),IF(ADF6>=0,1,ADE6/(ADE6-ADF6)),IF(ADI6>=0,1,ADH6/(ADH6-ADI6)),IF(ADL6>=0,1,ADK6/(ADK6-ADL6)))*(D_equiv_harmonious_max_perc*$CC6-D_equiv_harmonious_min_perc)))", "AEG" : "=IF(AEF6=0,0,ROUND((AAD6+(ABT6-AAD6)/(D_equiv_harmonious_max_perc*$CC6-D_equiv_harmonious_min_perc)*(AEF6-D_equiv_harmonious_min_perc))-($BS6+($BT6-$BS6)/(D_equiv_harmonious_max_perc-D_equiv_harmonious_min_perc)*(AEF6-D_equiv_harmonious_min_perc))-MAX(0,($BU6+($BV6-$BU6)/(D_equiv_harmonious_max_perc-D_equiv_harmonious_min_perc)*(AEF6-D_equiv_harmonious_min_perc))-(AAG6+(ABW6-AAG6)/(D_equiv_harmonious_max_perc*$CC6-D_equiv_harmonious_min_perc)*(AEF6-D_equiv_harmonious_min_perc)))/El_boiler_eff-(AAC6+(ABS6-AAC6)/(D_equiv_harmonious_max_perc*$CC6-D_equiv_harmonious_min_perc)*(AEF6-D_equiv_harmonious_min_perc))/BESS_chrg_eff,5))", "AEH" : "=IF(AEF6=0,0,(AAE6+(ABU6-AAE6)/(D_equiv_harmonious_max_perc*$CC6-D_equiv_harmonious_min_perc)*(AEF6-D_equiv_harmonious_min_perc))-($BS6+($BT6-$BS6)/(D_equiv_harmonious_max_perc-D_equiv_harmonious_min_perc)*(AEF6-D_equiv_harmonious_min_perc))-(MAX(0,($BU6+($BV6-$BU6)/(D_equiv_harmonious_max_perc-D_equiv_harmonious_min_perc)*(AEF6-D_equiv_harmonious_min_perc))-(AAH6+(ABX6-AAH6)/(D_equiv_harmonious_max_perc*$CC6-D_equiv_harmonious_min_perc)*(AEF6-D_equiv_harmonious_min_perc)))/El_boiler_eff)-((AAC6+(ABS6-AAC6)/(D_equiv_harmonious_max_perc*$CC6-D_equiv_harmonious_min_perc)*(AEF6-D_equiv_harmonious_min_perc))/BESS_chrg_eff))", "AEI" : "=IF(AEF6=0,0,ROUND((AAG6+(ABW6-AAG6)/(D_equiv_harmonious_max_perc*$CC6-D_equiv_harmonious_min_perc)*(AEF6-D_equiv_harmonious_min_perc))+(MAX(0,(AAD6+(ABT6-AAD6)/(D_equiv_harmonious_max_perc*$CC6-D_equiv_harmonious_min_perc)*(AEF6-D_equiv_harmonious_min_perc))-($BS6+($BT6-$BS6)/(D_equiv_harmonious_max_perc-D_equiv_harmonious_min_perc)*(AEF6-D_equiv_harmonious_min_perc))-((AAC6+(ABS6-AAC6)/(D_equiv_harmonious_max_perc*$CC6-D_equiv_harmonious_min_perc)*(AEF6-D_equiv_harmonious_min_perc))/BESS_chrg_eff)))*El_boiler_eff-($BU6+($BV6-$BU6)/(D_equiv_harmonious_max_perc-D_equiv_harmonious_min_perc)*(AEF6-D_equiv_harmonious_min_perc)),5))", "AEJ" : "=IF(AEF6=0,0,(AAH6+(ABX6-AAH6)/(D_equiv_harmonious_max_perc*$CC6-D_equiv_harmonious_min_perc)*(AEF6-D_equiv_harmonious_min_perc))+(MAX(0,(AAE6+(ABU6-AAE6)/(D_equiv_harmonious_max_perc*$CC6-D_equiv_harmonious_min_perc)*(AEF6-D_equiv_harmonious_min_perc))-($BS6+($BT6-$BS6)/(D_equiv_harmonious_max_perc-D_equiv_harmonious_min_perc)*(AEF6-D_equiv_harmonious_min_perc))-((AAC6+(ABS6-AAC6)/(D_equiv_harmonious_max_perc*$CC6-D_equiv_harmonious_min_perc)*(AEF6-D_equiv_harmonious_min_perc))/BESS_chrg_eff)))*El_boiler_eff-($BU6+($BV6-$BU6)/(D_equiv_harmonious_max_perc-D_equiv_harmonious_min_perc)*(AEF6-D_equiv_harmonious_min_perc)))", "AEK" : "=IF(AEF6=0,0,ROUND((AAP6+(ACF6-AAP6)/(D_equiv_harmonious_max_perc*$CC6-D_equiv_harmonious_min_perc)*(AEF6-D_equiv_harmonious_min_perc))-(($BU6+($BV6-$BU6)/(D_equiv_harmonious_max_perc-D_equiv_harmonious_min_perc)*($GX6-D_equiv_harmonious_min_perc))-(AAG6+(ABW6-AAG6)/(D_equiv_harmonious_max_perc*$CC6-D_equiv_harmonious_min_perc)*(AEF6-D_equiv_harmonious_min_perc)))/El_boiler_eff,5))", "AEL" : "=IF(AEF6=0,0,(AAQ6+(ACG6-AAQ6)/(D_equiv_harmonious_max_perc*$CC6-D_equiv_harmonious_min_perc)*(AEF6-D_equiv_harmonious_min_perc))-(($BU6+($BV6-$BU6)/(D_equiv_harmonious_max_perc-D_equiv_harmonious_min_perc)*($GX6-D_equiv_harmonious_min_perc))-(AAH6+(ABX6-AAH6)/(D_equiv_harmonious_max_perc*$CC6-D_equiv_harmonious_min_perc)*(AEF6-D_equiv_harmonious_min_perc)))/El_boiler_eff)", "AEM" : "=IF(AEF6=0,0,ROUND((AAJ6+(ABZ6-AAJ6)/(D_equiv_harmonious_max_perc*$CC6-D_equiv_harmonious_min_perc)*(AEF6-D_equiv_harmonious_min_perc))-(AAC6+(ABS6-AAC6)/(D_equiv_harmonious_max_perc*$CC6-D_equiv_harmonious_min_perc)*(AEF6-D_equiv_harmonious_min_perc))/BESS_chrg_eff,5))", "AEN" : "=IF(AEF6=0,0,(AAK6+(ACA6-AAK6)/(D_equiv_harmonious_max_perc*$CC6-D_equiv_harmonious_min_perc)*(AEF6-D_equiv_harmonious_min_perc))-(AAC6+(ABS6-AAC6)/(D_equiv_harmonious_max_perc*$CC6-D_equiv_harmonious_min_perc)*(AEF6-D_equiv_harmonious_min_perc))/BESS_chrg_eff)", "AEO" : "=IF(AEF6=0,0,(AAS6+(ACI6-AAS6)/(D_equiv_harmonious_max_perc*$CC6-D_equiv_harmonious_min_perc)*(AEF6-D_equiv_harmonious_min_perc))-($BM6+($BN6-$BM6)/(D_equiv_harmonious_max_perc-D_equiv_harmonious_min_perc)*(AEF6-D_equiv_harmonious_min_perc)))", "AEP" : "=IF(AEF6=0,0,(AAT6+(ACJ6-AAT6)/(D_equiv_harmonious_max_perc*$CC6-D_equiv_harmonious_min_perc)*(AEF6-D_equiv_harmonious_min_perc))-($BM6+($BN6-$BM6)/(D_equiv_harmonious_max_perc-D_equiv_harmonious_min_perc)*(AEF6-D_equiv_harmonious_min_perc)))", "AEQ" : "=IF(AEF6=0,0,(AAV6+(ACL6-AAV6)/(D_equiv_harmonious_max_perc*$CC6-D_equiv_harmonious_min_perc)*(AEF6-D_equiv_harmonious_min_perc))-($BO6+($BP6-$BO6)/(D_equiv_harmonious_max_perc-D_equiv_harmonious_min_perc)*(AEF6-D_equiv_harmonious_min_perc)))", "AER" : "=IF(AEF6=0,0,(AAW6+(ACM6-AAW6)/(D_equiv_harmonious_max_perc*$CC6-D_equiv_harmonious_min_perc)*(AEF6-D_equiv_harmonious_min_perc))-($BO6+($BP6-$BO6)/(D_equiv_harmonious_max_perc-D_equiv_harmonious_min_perc)*(AEF6-D_equiv_harmonious_min_perc)))", "AES" : "=IF(AEF6=0,0,(AAY6+(ACO6-AAY6)/(D_equiv_harmonious_max_perc*$CC6-D_equiv_harmonious_min_perc)*(AEF6-D_equiv_harmonious_min_perc))-($BQ6+($BR6-$BQ6)/(D_equiv_harmonious_max_perc-D_equiv_harmonious_min_perc)*(AEF6-D_equiv_harmonious_min_perc)))", "AET" : "=IF(AEF6=0,0,(AAZ6+(ACP6-AAZ6)/(D_equiv_harmonious_max_perc*$CC6-D_equiv_harmonious_min_perc)*(AEF6-D_equiv_harmonious_min_perc))-($BQ6+($BR6-$BQ6)/(D_equiv_harmonious_max_perc-D_equiv_harmonious_min_perc)*(AEF6-D_equiv_harmonious_min_perc)))", "AEU" : "=IF(AEF6<=0,0,MIN(1,Overall_harmonious_min_perc+MIN(IF(AEH6>=0,1,AEG6/(AEG6-AEH6)),IF(AEJ6>=0,1,AEI6/(AEI6-AEJ6)),IF(AEL6>=0,1,AEK6/(AEK6-AEL6)),IF(AEN6>=0,1,AEM6/(AEM6-AEN6)),IF(AEP6>=0,1,AEO6/(AEO6-AEP6)),IF(AER6>=0,1,AEQ6/(AEQ6-AER6)),IF(AET6>=0,1,AES6/(AES6-AET6)))*(Overall_harmonious_max_perc-Overall_harmonious_min_perc)))",  "AEW" : "=IF(OR(ADO6=0,AED6=0),0,(ZQ6+(ABG6-ZQ6)/(D_equiv_harmonious_max_perc*$CC6-D_equiv_harmonious_min_perc)*(AED6-D_equiv_harmonious_min_perc))+((ZR6+(ABH6-ZR6)/(D_equiv_harmonious_max_perc*$CC6-D_equiv_harmonious_min_perc)*(AED6-D_equiv_harmonious_min_perc))-(ZQ6+(ABG6-ZQ6)/(D_equiv_harmonious_max_perc*$CC6-D_equiv_harmonious_min_perc)*(AED6-D_equiv_harmonious_min_perc)))/(Overall_harmonious_max_perc-Overall_harmonious_min_perc)*(ADO6-Overall_harmonious_min_perc))", "AEX" : "=IF(OR(ADO6=0,AED6=0),0,($BS6+($BT6-$BS6)/(D_equiv_harmonious_max_perc-D_equiv_harmonious_min_perc)*(AED6-D_equiv_harmonious_min_perc)))", "AEY" : "=IF(OR(ADO6=0,AED6=0),0,ZZ6+(ABP6-ZZ6)/(D_equiv_harmonious_max_perc*$CC6-D_equiv_harmonious_min_perc)*(AED6-D_equiv_harmonious_min_perc))", "AEZ" : "=IF(OR(ADO6=0,AED6=0),0,MIN(((AAJ6+(ABZ6-AAJ6)/(D_equiv_harmonious_max_perc*$CC6-D_equiv_harmonious_min_perc)*(AED6-D_equiv_harmonious_min_perc))+((AAK6+(ACA6-AAK6)/(D_equiv_harmonious_max_perc*$CC6-D_equiv_harmonious_min_perc)*(AED6-D_equiv_harmonious_min_perc))-(AAJ6+(ABZ6-AAJ6)/(D_equiv_harmonious_max_perc*$CC6-D_equiv_harmonious_min_perc)*(AED6-D_equiv_harmonious_min_perc)))/(Overall_harmonious_max_perc-Overall_harmonious_min_perc)*(ADO6-Overall_harmonious_min_perc)),(AAC6+(ABS6-AAC6)/(D_equiv_harmonious_max_perc*$CC6-D_equiv_harmonious_min_perc)*(AED6-D_equiv_harmonious_min_perc))/BESS_chrg_eff))", "AFA" : "=IF(OR(ADO6=0,AED6=0),0,(ZW6+(ABM6-ZW6)/(D_equiv_harmonious_max_perc*$CC6-D_equiv_harmonious_min_perc)*(AED6-D_equiv_harmonious_min_perc))+((ZX6+(ABN6-ZX6)/(D_equiv_harmonious_max_perc*$CC6-D_equiv_harmonious_min_perc)*(AED6-D_equiv_harmonious_min_perc))-(ZW6+(ABM6-ZW6)/(D_equiv_harmonious_max_perc*$CC6-D_equiv_harmonious_min_perc)*(AED6-D_equiv_harmonious_min_perc)))/(Overall_harmonious_max_perc-Overall_harmonious_min_perc)*(ADO6-Overall_harmonious_min_perc))", "AFB" : "=AFI6/El_boiler_eff", "AFC" : "=IF(OR(ADO6=0,AED6=0),0,ZM6+(ABC6-ZM6)/(D_equiv_harmonious_max_perc*$CC6-D_equiv_harmonious_min_perc)*(AED6-D_equiv_harmonious_min_perc))", "AFD" : "=IF(OR(ADO6=0,AED6=0),0,MIN($BL6*Grid_import_max_ud,MAX(0,-(SUM(AFC6:AFC6)-SUM(AEW6:AFB6)))))", "AFE" : "=SUM(AFC6:AFD6)-SUM(AEW6:AFB6)", "AFF" : "=IF(OR(ADO6=0,AED6=0),0,(ZT6+(ABJ6-ZT6)/(D_equiv_harmonious_max_perc*$CC6-D_equiv_harmonious_min_perc)*(AED6-D_equiv_harmonious_min_perc))+((ZU6+(ABK6-ZU6)/(D_equiv_harmonious_max_perc*$CC6-D_equiv_harmonious_min_perc)*(AED6-D_equiv_harmonious_min_perc))-(ZT6+(ABJ6-ZT6)/(D_equiv_harmonious_max_perc*$CC6-D_equiv_harmonious_min_perc)*(AED6-D_equiv_harmonious_min_perc)))/(Overall_harmonious_max_perc-Overall_harmonious_min_perc)*(ADO6-Overall_harmonious_min_perc))", "AFG" : "=IF(OR(ADO6=0,AED6=0),0,($BU6+($BV6-$BU6)/(D_equiv_harmonious_max_perc-D_equiv_harmonious_min_perc)*(AED6-D_equiv_harmonious_min_perc)))", "AFH" : "=IF(OR(ADO6=0,AED6=0),0,AFA6*El_boiler_eff)", "AFI" : "=IF(OR(ADO6=0,AED6=0),0,MAX(0,AFG6-((AAG6+(ABW6-AAG6)/(D_equiv_harmonious_max_perc*$CC6-D_equiv_harmonious_min_perc)*(AED6-D_equiv_harmonious_min_perc))+((AAH6+(ABX6-AAH6)/(D_equiv_harmonious_max_perc*$CC6-D_equiv_harmonious_min_perc)*(AED6-D_equiv_harmonious_min_perc))-(AAG6+(ABW6-AAG6)/(D_equiv_harmonious_max_perc*$CC6-D_equiv_harmonious_min_perc)*(AED6-D_equiv_harmonious_min_perc)))/(Overall_harmonious_max_perc-Overall_harmonious_min_perc)*(ADO6-Overall_harmonious_min_perc))))", "AFJ" : "=IF(OR(ADO6=0,AED6=0),0,ZO6+(ABE6-ZO6)/(D_equiv_harmonious_max_perc*$CC6-D_equiv_harmonious_min_perc)*(AED6-D_equiv_harmonious_min_perc))", "AFK" : "=SUM(AFH6:AFJ6)-SUM(AFF6:AFG6)", "AFL" : "=IF(OR(ADO6=0,AED6=0),0,ZS6+(ABI6-ZS6)/(D_equiv_harmonious_max_perc*$CC6-D_equiv_harmonious_min_perc)*(AED6-D_equiv_harmonious_min_perc))", "AFM" : "=IF(OR(ADO6=0,AED6=0),0,AAA6+(ABQ6-AAA6)/(D_equiv_harmonious_max_perc*$CC6-D_equiv_harmonious_min_perc)*(AED6-D_equiv_harmonious_min_perc))", "AFN" : "=IF(OR(ADO6=0,AED6=0),0,ZY6+(ABO6-ZY6)/(D_equiv_harmonious_max_perc*$CC6-D_equiv_harmonious_min_perc)*(AED6-D_equiv_harmonious_min_perc))", "AFO" : "=AEZ6*BESS_chrg_eff", "AFP" : "=IF(OR(ADO6=0,AED6=0),0,ZN6+(ABD6-ZN6)/(D_equiv_harmonious_max_perc*$CC6-D_equiv_harmonious_min_perc)*(AED6-D_equiv_harmonious_min_perc))", "AFQ" : "=IF(OR(ADO6=0,AED6=0),0,MIN($BK6*Grid_import_max_ud,MAX(0,-(SUM(AFO6:AFP6)-SUM(AFL6:AFN6)))))", "AFR" : "=SUM(AFO6:AFQ6)-SUM(AFL6:AFN6)", "AFS" : "=IF(OR(ADO6=0,AED6=0),0,ZV6+(ABL6-ZV6)/(D_equiv_harmonious_max_perc*$CC6-D_equiv_harmonious_min_perc)*(AED6-D_equiv_harmonious_min_perc))", "AFT" : "=IF(OR(ADO6=0,AED6=0),0,AFN6*El_boiler_eff)", "AFU" : "=IF(OR(ADO6=0,AED6=0),0,ZP6+(ABF6-ZP6)/(D_equiv_harmonious_max_perc*$CC6-D_equiv_harmonious_min_perc)*(AED6-D_equiv_harmonious_min_perc))", "AFV" : "=SUM(AFT6:AFU6)-SUM(AFS6:AFS6)", "AFW" : "=IF(AEW6<=0,0,AEW6/(Overall_harmonious_var_max_cons+Overall_fix_cons)*MethDist_harmonious_max_perc*MethDist_Meth_nom_prod_ud)+IF(AFL6<=0,0,AFL6/(D_overall_var_max_cons+D_overall_fix_stby_cons)*D_MethDist_max_perc*MethDist_Meth_nom_prod_ud)", "AFX" : "=MIN(AFE6,IF(OR(ADO6=0,AED6=0),0,(AAM6+(ACC6-AAM6)/(D_equiv_harmonious_max_perc*$CC6-D_equiv_harmonious_min_perc)*(AED6-D_equiv_harmonious_min_perc))+((AAN6+(ACD6-AAN6)/(D_equiv_harmonious_max_perc*$CC6-D_equiv_harmonious_min_perc)*(AED6-D_equiv_harmonious_min_perc))-(AAM6+(ACC6-AAM6)/(D_equiv_harmonious_max_perc*$CC6-D_equiv_harmonious_min_perc)*(AED6-D_equiv_harmonious_min_perc)))/(Overall_harmonious_max_perc-Overall_harmonious_min_perc)*(ADO6-Overall_harmonious_min_perc)))+MIN(AFR6,IF(OR(ADO6=0,AED6=0),0,AAO6+(ACE6-AAO6)/(D_equiv_harmonious_max_perc*$CC6-D_equiv_harmonious_min_perc)*(AED6-D_equiv_harmonious_min_perc)))", "AFY" : "=AFQ6+AFD6", "AFZ" : "=MAX(0,-AFE6)+MAX(0,-AFK6)+MAX(0,-AFR6)+MAX(0,-AFV6)",  "AGB" : "=IF(OR(AEU6=0,AEF6=0),0,(ZQ6+(ABG6-ZQ6)/(D_equiv_harmonious_max_perc*$CC6-D_equiv_harmonious_min_perc)*(AEF6-D_equiv_harmonious_min_perc))+((ZR6+(ABH6-ZR6)/(D_equiv_harmonious_max_perc*$CC6-D_equiv_harmonious_min_perc)*(AEF6-D_equiv_harmonious_min_perc))-(ZQ6+(ABG6-$CI6)/(D_equiv_harmonious_max_perc*$CC6-D_equiv_harmonious_min_perc)*(AEF6-D_equiv_harmonious_min_perc)))/(Overall_harmonious_max_perc-Overall_harmonious_min_perc)*(AEU6-Overall_harmonious_min_perc))", "AGC" : "=IF(OR(AEU6=0,AEF6=0),0,($BS6+($BT6-$BS6)/(D_equiv_harmonious_max_perc-D_equiv_harmonious_min_perc)*(AEF6-D_equiv_harmonious_min_perc)))", "AGD" : "=IF(OR(AEU6=0,AEF6=0),0,ZZ6+(ABP6-ZZ6)/(D_equiv_harmonious_max_perc*$CC6-D_equiv_harmonious_min_perc)*(AEF6-D_equiv_harmonious_min_perc))", "AGE" : "=IF(OR(AEU6=0,AEF6=0),0,MIN(((AAJ6+(ABZ6-AAJ6)/(D_equiv_harmonious_max_perc*$CC6-D_equiv_harmonious_min_perc)*(AEF6-D_equiv_harmonious_min_perc))+((AAK6+(ACA6-AAK6)/(D_equiv_harmonious_max_perc*$CC6-D_equiv_harmonious_min_perc)*(AEF6-D_equiv_harmonious_min_perc))-(AAJ6+(ABZ6-AAJ6)/(D_equiv_harmonious_max_perc*$CC6-D_equiv_harmonious_min_perc)*(AEF6-D_equiv_harmonious_min_perc)))/(Overall_harmonious_max_perc-Overall_harmonious_min_perc)*(AEU6-Overall_harmonious_min_perc)),(AAC6+(ABS6-AAC6)/(D_equiv_harmonious_max_perc*$CC6-D_equiv_harmonious_min_perc)*(AEF6-D_equiv_harmonious_min_perc))/BESS_chrg_eff))", "AGF" : "=IF(OR(AEU6=0,AEF6=0),0,(ZW6+(ABM6-ZW6)/(D_equiv_harmonious_max_perc*$CC6-D_equiv_harmonious_min_perc)*(AEF6-D_equiv_harmonious_min_perc))+((ZX6+(ABN6-ZX6)/(D_equiv_harmonious_max_perc*$CC6-D_equiv_harmonious_min_perc)*(AEF6-D_equiv_harmonious_min_perc))-(ZW6+(ABM6-ZW6)/(D_equiv_harmonious_max_perc*$CC6-D_equiv_harmonious_min_perc)*(AEF6-D_equiv_harmonious_min_perc)))/(Overall_harmonious_max_perc-Overall_harmonious_min_perc)*(AEU6-Overall_harmonious_min_perc))", "AGG" : "=AGN6/El_boiler_eff", "AGH" : "=IF(OR(AEU6=0,AEF6=0),0,ZM6+(ABC6-ZM6)/(D_equiv_harmonious_max_perc*$CC6-D_equiv_harmonious_min_perc)*(AEF6-D_equiv_harmonious_min_perc))", "AGI" : "=IF(OR(AEF6=0,AEU6=0),0,MIN($D6*Grid_import_max_ud,MAX(0,-(SUM(AGH6:AGH6)-SUM(AGB6:AGG6)))))", "AGJ" : "=SUM(AGH6:AGI6)-SUM(AGB6:AGG6)", "AGK" : "=IF(OR(AEU6=0,AEF6=0),0,(ZT6+(ABJ6-ZT6)/(D_equiv_harmonious_max_perc*$CC6-D_equiv_harmonious_min_perc)*(AEF6-D_equiv_harmonious_min_perc))+((ZU6+(ABK6-ZU6)/(D_equiv_harmonious_max_perc*$CC6-D_equiv_harmonious_min_perc)*(AEF6-D_equiv_harmonious_min_perc))-(ZT6+(ABJ6-ZT6)/(D_equiv_harmonious_max_perc*$CC6-D_equiv_harmonious_min_perc)*(AEF6-D_equiv_harmonious_min_perc)))/(Overall_harmonious_max_perc-Overall_harmonious_min_perc)*(AEU6-Overall_harmonious_min_perc))", "AGL" : "=IF(OR(AEU6=0,AEF6=0),0,($BU6+($BV6-$BU6)/(D_equiv_harmonious_max_perc-D_equiv_harmonious_min_perc)*(AEF6-D_equiv_harmonious_min_perc)))", "AGM" : "=IF(OR(AEU6=0,AEF6=0),0,AGF6*El_boiler_eff)", "AGN" : "=IF(OR(AEU6=0,AEF6=0),0,MAX(0,AGL6-((AAG6+(ABW6-AAG6)/(D_equiv_harmonious_max_perc*$CC6-D_equiv_harmonious_min_perc)*(AEF6-D_equiv_harmonious_min_perc))+((AAH6+(ABX6-AAH6)/(D_equiv_harmonious_max_perc*$CC6-D_equiv_harmonious_min_perc)*(AEF6-D_equiv_harmonious_min_perc))-(AAG6+(ABW6-AAG6)/(D_equiv_harmonious_max_perc*$CC6-D_equiv_harmonious_min_perc)*(AEF6-D_equiv_harmonious_min_perc)))/(Overall_harmonious_max_perc-Overall_harmonious_min_perc)*(AEU6-Overall_harmonious_min_perc))))", "AGO" : "=IF(OR(AEU6=0,AEF6=0),0,ZO6+(ABE6-ZO6)/(D_equiv_harmonious_max_perc*$CC6-D_equiv_harmonious_min_perc)*(AEF6-D_equiv_harmonious_min_perc))", "AGP" : "=SUM(AGM6:AGO6)-SUM(AGK6:AGL6)", "AGQ" : "=IF(OR(AEU6=0,AEF6=0),0,ZS6+(ABI6-ZS6)/(D_equiv_harmonious_max_perc*$CC6-D_equiv_harmonious_min_perc)*(AEF6-D_equiv_harmonious_min_perc))", "AGR" : "=IF(OR(AEU6=0,AEF6=0),0,AAA6+(ABQ6-AAA6)/(D_equiv_harmonious_max_perc*$CC6-D_equiv_harmonious_min_perc)*(AEF6-D_equiv_harmonious_min_perc))", "AGS" : "=IF(OR(AEU6=0,AEF6=0),0,ZY6+(ABO6-ZY6)/(D_equiv_harmonious_max_perc*$CC6-D_equiv_harmonious_min_perc)*(AEF6-D_equiv_harmonious_min_perc))", "AGT" : "=AGE6*BESS_chrg_eff", "AGU" : "=IF(OR(AEU6=0,AEF6=0),0,ZN6+(ABD6-ZN6)/(D_equiv_harmonious_max_perc*$CC6-D_equiv_harmonious_min_perc)*(AEF6-D_equiv_harmonious_min_perc))", "AGV" : "=IF(OR(AEU6=0,AEF6=0),0,MIN($C6*Grid_import_max_ud,MAX(0,-(SUM(AGT6:AGU6)-SUM(AGQ6:AGS6)))))", "AGW" : "=SUM(AGT6:AGV6)-SUM(AGQ6:AGS6)", "AGX" : "=IF(OR(AEU6=0,AEF6=0),0,ZV6+(ABL6-ZV6)/(D_equiv_harmonious_max_perc*$CC6-D_equiv_harmonious_min_perc)*(AEF6-D_equiv_harmonious_min_perc))", "AGY" : "=IF(OR(AEU6=0,AEF6=0),0,AGS6*El_boiler_eff)", "AGZ" : "=IF(OR(AEU6=0,AEF6=0),0,ZP6+(ABF6-ZP6)/(D_equiv_harmonious_max_perc*$CC6-D_equiv_harmonious_min_perc)*(AEF6-D_equiv_harmonious_min_perc))", "AHA" : "=SUM(AGY6:AGZ6)-SUM(AGX6:AGX6)", "AHB" : "=IF(AGB6<=0,0,AGB6/(Overall_harmonious_var_max_cons+Overall_fix_cons)*MethDist_harmonious_max_perc*MethDist_Meth_nom_prod_ud)+IF(AGQ6<=0,0,AGQ6/(D_overall_var_max_cons+D_overall_fix_stby_cons)*D_MethDist_max_perc*MethDist_Meth_nom_prod_ud)", "AHC" : "=MIN(AGJ6,IF(OR(AEU6=0,AEF6=0),0,(AAM6+(ACC6-AAM6)/(D_equiv_harmonious_max_perc*$CC6-D_equiv_harmonious_min_perc)*(AEF6-D_equiv_harmonious_min_perc))+((AAN6+(ACD6-AAN6)/(D_equiv_harmonious_max_perc*$CC6-D_equiv_harmonious_min_perc)*(AEF6-D_equiv_harmonious_min_perc))-(AAM6+(ACC6-AAM6)/(D_equiv_harmonious_max_perc*$CC6-D_equiv_harmonious_min_perc)*(AEF6-D_equiv_harmonious_min_perc)))/(Overall_harmonious_max_perc-Overall_harmonious_min_perc)*(AEU6-Overall_harmonious_min_perc)))+MIN(AGW6,IF(OR(AEU6=0,AEF6=0),0,AAO6+(ACE6-AAO6)/(D_equiv_harmonious_max_perc*$CC6-D_equiv_harmonious_min_perc)*(AEF6-D_equiv_harmonious_min_perc)))", "AHD" : "=AGV6+AGI6", "AHE" : "=MAX(0,-AGJ6)+MAX(0,-AGP6)+MAX(0,-AGW6)+MAX(0,-AHA6)",   "AHH" : "=IO6", "AHI" : "=MAX(0,IP6)*Specific_Cost$P$8-MAX(0,IQ6)*Specific_Cost$P$7", "AHJ" : "=IFERROR(((Specific_Cost$P$5*LEC_Calc$AZ$3+LEC_Calc$BA$3)/365-AHI6*1000)/AHH6,\"NA\")", "AHK" : "=IR6", "AHL" : "=JT6", "AHM" : "=MAX(0,JU6)*Specific_Cost$P$8-MAX(0,JV6)*Specific_Cost$P$7", "AHN" : "=IFERROR(((Specific_Cost$P$5*LEC_Calc$AZ$3+LEC_Calc$BA$3)/365-AHM6*1000)/AHL6,\"NA\")", "AHO" : "=JW6", "AHP" : "=QI6", "AHQ" : "=MAX(0,QJ6)*Specific_Cost$P$8-MAX(0,QK6)*Specific_Cost$P$7", "AHR" : "=IFERROR(((Specific_Cost$P$5*LEC_Calc$AZ$3+LEC_Calc$BA$3)/365-AHQ6*1000)/AHP6,\"NA\")", "AHS" : "=QL6", "AHT" : "=RN6", "AHU" : "=MAX(0,RO6)*Specific_Cost$P$8-MAX(0,RP6)*Specific_Cost$P$7", "AHV" : "=IFERROR(((Specific_Cost$P$5*LEC_Calc$AZ$3+LEC_Calc$BA$3)/365-AHU6*1000)/AHT6,\"NA\")", "AHW" : "=RQ6", "AHX" : "=YC6", "AHY" : "=MAX(0,YD6)*Specific_Cost$P$8-MAX(0,YE6)*Specific_Cost$P$7", "AHZ" : "=IFERROR(((Specific_Cost$P$5*LEC_Calc$AZ$3+LEC_Calc$BA$3)/365-AHY6*1000)/AHX6,\"NA\")", "AIA" : "=YF6", "AIB" : "=ZH6", "AIC" : "=MAX(0,ZI6)*Specific_Cost$P$8-MAX(0,ZJ6)*Specific_Cost$P$7", "AID" : "=IFERROR(((Specific_Cost$P$5*LEC_Calc$AZ$3+LEC_Calc$BA$3)/365-AIC6*1000)/AIB6,\"NA\")", "AIE" : "=ZK6", "AIF" : "=AFW6", "AIG" : "=MAX(0,AFX6)*Specific_Cost$P$8-MAX(0,AFY6)*Specific_Cost$P$7", "AIH" : "=IFERROR(((Specific_Cost$P$5*LEC_Calc$AZ$3+LEC_Calc$BA$3)/365-AIG6*1000)/AIF6,\"NA\")", "AII" : "=AFZ6", "AIJ" : "=AHB6", "AIK" : "=MAX(0,AHC6)*Specific_Cost$P$8-MAX(0,AHD6)*Specific_Cost$P$7", "AIL" : "=IFERROR(((Specific_Cost$P$5*LEC_Calc$AZ$3+LEC_Calc$BA$3)/365-AIK6*1000)/AIJ6,\"NA\")", "AIM" : "=AHE6", "AIN" : "=IF($AHJ6=MIN($AHJ6,$AHN6,$AHR6,$AHV6,$AHZ6,$AID6,$AIH6,$AIL6),\"1a day prio\",IF($AHN6=MIN($AHJ6,$AHN6,$AHR6,$AHV6,$AHZ6,$AID6,$AIH6,$AIL6),\"1a night prio\",IF($AHR6=MIN($AHJ6,$AHN6,$AHR6,$AHV6,$AHZ6,$AID6,$AIH6,$AIL6),\"1b day prio\",IF($AHV6=MIN($AHJ6,$AHN6,$AHR6,$AHV6,$AHZ6,$AID6,$AIH6,$AIL6),\"1b night prio\",IF($AHZ6=MIN($AHJ6,$AHN6,$AHR6,$AHV6,$AHZ6,$AID6,$AIH6,$AIL6),\"1c day prio\",IF($AID6=MIN($AHJ6,$AHN6,$AHR6,$AHV6,$AHZ6,$AID6,$AIH6,$AIL6),\"1c night prio\",IF($AIH6=MIN($AHJ6,$AHN6,$AHR6,$AHV6,$AHZ6,$AID6,$AIH6,$AIL6),\"1d day prio\",IF($AIL6=MIN($AHJ6,$AHN6,$AHR6,$AHV6,$AHZ6,$AID6,$AIH6,$AIL6),\"1d night prio\",\"NA\"))))))))", "AIO" : "=IF($AHJ6=MIN($AHJ6,$AHN6,$AHR6,$AHV6,$AHZ6,$AID6,$AIH6,$AIL6),AHH6,IF($AHN6=MIN($AHJ6,$AHN6,$AHR6,$AHV6,$AHZ6,$AID6,$AIH6,$AIL6),AHL6,IF($AHR6=MIN($AHJ6,$AHN6,$AHR6,$AHV6,$AHZ6,$AID6,$AIH6,$AIL6),AHP6,IF($AHV6=MIN($AHJ6,$AHN6,$AHR6,$AHV6,$AHZ6,$AID6,$AIH6,$AIL6),AHT6,IF($AHZ6=MIN($AHJ6,$AHN6,$AHR6,$AHV6,$AHZ6,$AID6,$AIH6,$AIL6),AHX6,IF($AID6=MIN($AHJ6,$AHN6,$AHR6,$AHV6,$AHZ6,$AID6,$AIH6,$AIL6),AIB6,IF($AIH6=MIN($AHJ6,$AHN6,$AHR6,$AHV6,$AHZ6,$AID6,$AIH6,$AIL6),AIF6,IF($AIL6=MIN($AHJ6,$AHN6,$AHR6,$AHV6,$AHZ6,$AID6,$AIH6,$AIL6),AIJ6,0))))))))", "AIP" : "=IF($AHJ6=MIN($AHJ6,$AHN6,$AHR6,$AHV6,$AHZ6,$AID6,$AIH6,$AIL6),AHI6,IF($AHN6=MIN($AHJ6,$AHN6,$AHR6,$AHV6,$AHZ6,$AID6,$AIH6,$AIL6),AHM6,IF($AHR6=MIN($AHJ6,$AHN6,$AHR6,$AHV6,$AHZ6,$AID6,$AIH6,$AIL6),AHQ6,IF($AHV6=MIN($AHJ6,$AHN6,$AHR6,$AHV6,$AHZ6,$AID6,$AIH6,$AIL6),AHU6,IF($AHZ6=MIN($AHJ6,$AHN6,$AHR6,$AHV6,$AHZ6,$AID6,$AIH6,$AIL6),AHY6,IF($AID6=MIN($AHJ6,$AHN6,$AHR6,$AHV6,$AHZ6,$AID6,$AIH6,$AIL6),AIC6,IF($AIH6=MIN($AHJ6,$AHN6,$AHR6,$AHV6,$AHZ6,$AID6,$AIH6,$AIL6),AIG6,IF($AIL6=MIN($AHJ6,$AHN6,$AHR6,$AHV6,$AHZ6,$AID6,$AIH6,$AIL6),AIK6,0))))))))", "AIQ" : "=IF($AHJ6=MIN($AHJ6,$AHN6,$AHR6,$AHV6,$AHZ6,$AID6,$AIH6,$AIL6),AHJ6,IF($AHN6=MIN($AHJ6,$AHN6,$AHR6,$AHV6,$AHZ6,$AID6,$AIH6,$AIL6),AHN6,IF($AHR6=MIN($AHJ6,$AHN6,$AHR6,$AHV6,$AHZ6,$AID6,$AIH6,$AIL6),AHR6,IF($AHV6=MIN($AHJ6,$AHN6,$AHR6,$AHV6,$AHZ6,$AID6,$AIH6,$AIL6),AHV6,IF($AHZ6=MIN($AHJ6,$AHN6,$AHR6,$AHV6,$AHZ6,$AID6,$AIH6,$AIL6),AHZ6,IF($AID6=MIN($AHJ6,$AHN6,$AHR6,$AHV6,$AHZ6,$AID6,$AIH6,$AIL6),AID6,IF($AIH6=MIN($AHJ6,$AHN6,$AHR6,$AHV6,$AHZ6,$AID6,$AIH6,$AIL6),AIH6,IF($AIL6=MIN($AHJ6,$AHN6,$AHR6,$AHV6,$AHZ6,$AID6,$AIH6,$AIL6),AIL6,0))))))))", "AIR" : "=IF($AHJ6=MIN($AHJ6,$AHN6,$AHR6,$AHV6,$AHZ6,$AID6,$AIH6,$AIL6),AHK6,IF($AHN6=MIN($AHJ6,$AHN6,$AHR6,$AHV6,$AHZ6,$AID6,$AIH6,$AIL6),AHO6,IF($AHR6=MIN($AHJ6,$AHN6,$AHR6,$AHV6,$AHZ6,$AID6,$AIH6,$AIL6),AHS6,IF($AHV6=MIN($AHJ6,$AHN6,$AHR6,$AHV6,$AHZ6,$AID6,$AIH6,$AIL6),AHW6,IF($AHZ6=MIN($AHJ6,$AHN6,$AHR6,$AHV6,$AHZ6,$AID6,$AIH6,$AIL6),AIA6,IF($AID6=MIN($AHJ6,$AHN6,$AHR6,$AHV6,$AHZ6,$AID6,$AIH6,$AIL6),AIE6,IF($AIH6=MIN($AHJ6,$AHN6,$AHR6,$AHV6,$AHZ6,$AID6,$AIH6,$AIL6),AII6,IF($AIL6=MIN($AHJ6,$AHN6,$AHR6,$AHV6,$AHZ6,$AID6,$AIH6,$AIL6),AIM6,0))))))))"
]

let formulasDaily2: [String: String] = [
"A" : "=A5+1", "B" : "=COUNTIFS(Calculation$U$5:$U$8763,\"=\"&$A6,Calculation$S$5:$S$8763,\"<=0\")", "C" : "=COUNTIFS(Calculation$U$5:$U$8763,\"=\"&$A6,Calculation$S$5:$S$8763,\">0\")",  "E" : "=(A_overall_var_min_cons+A_overall_fix_stby_cons)*$B6+A_overall_stup_cons", "F" : "=(A_overall_var_max_cons+A_overall_fix_stby_cons)*$B6+A_overall_stup_cons", "G" : "=(A_overall_var_heat_min_cons+A_overall_heat_fix_stby_cons)*$B6+A_overall_heat_stup_cons", "H" : "=(A_overall_var_heat_max_cons+A_overall_heat_fix_stby_cons)*$B6+A_overall_heat_stup_cons", "I" : "=A_RawMeth_min_cons*$B6", "J" : "=A_RawMeth_max_cons*$B6", "K" : "=A_CO2_min_cons*$B6", "L" : "=A_CO2_max_cons*$B6", "M" : "=A_Hydrogen_min_cons*$B6", "N" : "=A_Hydrogen_max_cons*$B6", "O" : "=(M6+I6/(MethSynt_CO2_nom_cons+MethSynt_Hydrogen_nom_cons)*MethSynt_Hydrogen_nom_cons)/EY_Hydrogen_nom_prod*EY_var_gross_nom_cons+$C6*EY_fix_cons+(K6+I6/(MethSynt_CO2_nom_cons+MethSynt_Hydrogen_nom_cons)*MethSynt_CO2_nom_cons)/CCU_CO2_nom_prod_ud*CCU_var_nom_cons+$C6*CCU_fix_cons+I6/MethSynt_RawMeth_nom_prod_ud*MethSynt_var_nom_cons+$C6*MethSynt_fix_cons", "P" : "=(N6+J6/(MethSynt_CO2_nom_cons+MethSynt_Hydrogen_nom_cons)*MethSynt_Hydrogen_nom_cons)/EY_Hydrogen_nom_prod*EY_var_gross_nom_cons+$C6*EY_fix_cons+(L6+J6/(MethSynt_CO2_nom_cons+MethSynt_Hydrogen_nom_cons)*MethSynt_CO2_nom_cons)/CCU_CO2_nom_prod_ud*CCU_var_nom_cons+$C6*CCU_fix_cons+J6/MethSynt_RawMeth_nom_prod_ud*MethSynt_var_nom_cons+$C6*MethSynt_fix_cons", "Q" : "=(M6+I6/(MethSynt_CO2_nom_cons+MethSynt_Hydrogen_nom_cons)*MethSynt_Hydrogen_nom_cons)/EY_Hydrogen_nom_prod*EY_var_heat_nom_cons+$C6*EY_heat_fix_cons+(K6+I6/(MethSynt_CO2_nom_cons+MethSynt_Hydrogen_nom_cons)*MethSynt_CO2_nom_cons)/CCU_CO2_nom_prod_ud*CCU_var_heat_nom_cons+$C6*CCU_fix_heat_cons-I6/MethSynt_RawMeth_nom_prod_ud*MethSynt_var_heat_nom_prod-$C6*MethSynt_heat_fix_prod", "R" : "=(N6+J6/(MethSynt_CO2_nom_cons+MethSynt_Hydrogen_nom_cons)*MethSynt_Hydrogen_nom_cons)/EY_Hydrogen_nom_prod*EY_var_heat_nom_cons+$C6*EY_heat_fix_cons+(L6+J6/(MethSynt_CO2_nom_cons+MethSynt_Hydrogen_nom_cons)*MethSynt_CO2_nom_cons)/CCU_CO2_nom_prod_ud*CCU_var_heat_nom_cons+$C6*CCU_fix_heat_cons-J6/MethSynt_RawMeth_nom_prod_ud*MethSynt_var_heat_nom_prod-$C6*MethSynt_heat_fix_prod", "S" : "=1-I6/RawMeth_storage_cap_ud", "T" : "=1-J6/RawMeth_storage_cap_ud", "U" : "=1-K6/CO2_storage_cap_ud", "V" : "=1-L6/CO2_storage_cap_ud", "W" : "=1-M6/Hydrogen_storage_cap_ud", "X" : "=1-N6/Hydrogen_storage_cap_ud", "Y" : "=MIN(IF(S6<=0,0,IF(T6>=0,1,1/(S6-T6)*S6)),IF(U6<=0,0,IF(V6>=0,1,1/(U6-V6)*U6)),IF(W6<=0,0,IF(X6>=0,1,1/(W6-X6)*W6)))*(A_equiv_harmonious_max_perc-A_equiv_harmonious_min_perc)+A_equiv_harmonious_min_perc",  "AA" : "=(B_overall_var_min_cons+B_overall_fix_stby_cons)*$B6+B_overall_stup_cons", "AB" : "=(B_overall_var_max_cons+B_overall_fix_stby_cons)*$B6+B_overall_stup_cons", "AC" : "=(B_overall_var_heat_min_cons+B_overall_heat_fix_stby_cons)*$B6+B_overall_heat_stup_cons", "AD" : "=(B_overall_var_heat_max_cons+B_overall_heat_fix_stby_cons)*$B6+B_overall_heat_stup_cons", "AE" : "=B_RawMeth_min_cons*$B6", "AF" : "=B_RawMeth_max_cons*$B6", "AG" : "=B_CO2_min_cons*$B6", "AH" : "=B_CO2_max_cons*$B6", "AI" : "=B_Hydrogen_min_cons*$B6", "AJ" : "=B_Hydrogen_max_cons*$B6", "AK" : "=(AI6+AE6/(MethSynt_CO2_nom_cons+MethSynt_Hydrogen_nom_cons)*MethSynt_Hydrogen_nom_cons)/EY_Hydrogen_nom_prod*EY_var_gross_nom_cons+$C6*EY_fix_cons+(AG6+AE6/(MethSynt_CO2_nom_cons+MethSynt_Hydrogen_nom_cons)*MethSynt_CO2_nom_cons)/CCU_CO2_nom_prod_ud*CCU_var_nom_cons+$C6*CCU_fix_cons+AE6/MethSynt_RawMeth_nom_prod_ud*MethSynt_var_nom_cons+$C6*MethSynt_fix_cons", "AL" : "=(AJ6+AF6/(MethSynt_CO2_nom_cons+MethSynt_Hydrogen_nom_cons)*MethSynt_Hydrogen_nom_cons)/EY_Hydrogen_nom_prod*EY_var_gross_nom_cons+$C6*EY_fix_cons+(AH6+AF6/(MethSynt_CO2_nom_cons+MethSynt_Hydrogen_nom_cons)*MethSynt_CO2_nom_cons)/CCU_CO2_nom_prod_ud*CCU_var_nom_cons+$C6*CCU_fix_cons+AF6/MethSynt_RawMeth_nom_prod_ud*MethSynt_var_nom_cons+$C6*MethSynt_fix_cons", "AM" : "=(AI6+AE6/(MethSynt_CO2_nom_cons+MethSynt_Hydrogen_nom_cons)*MethSynt_Hydrogen_nom_cons)/EY_Hydrogen_nom_prod*EY_var_heat_nom_cons+$C6*EY_heat_fix_cons+(AG6+AE6/(MethSynt_CO2_nom_cons+MethSynt_Hydrogen_nom_cons)*MethSynt_CO2_nom_cons)/CCU_CO2_nom_prod_ud*CCU_var_heat_nom_cons+$C6*CCU_fix_heat_cons-AE6/MethSynt_RawMeth_nom_prod_ud*MethSynt_var_heat_nom_prod-$C6*MethSynt_heat_fix_prod", "AN" : "=(AJ6+AF6/(MethSynt_CO2_nom_cons+MethSynt_Hydrogen_nom_cons)*MethSynt_Hydrogen_nom_cons)/EY_Hydrogen_nom_prod*EY_var_heat_nom_cons+$C6*EY_heat_fix_cons+(AH6+AF6/(MethSynt_CO2_nom_cons+MethSynt_Hydrogen_nom_cons)*MethSynt_CO2_nom_cons)/CCU_CO2_nom_prod_ud*CCU_var_heat_nom_cons+$C6*CCU_fix_heat_cons-AF6/MethSynt_RawMeth_nom_prod_ud*MethSynt_var_heat_nom_prod-$C6*MethSynt_heat_fix_prod", "AO" : "=1-AE6/RawMeth_storage_cap_ud", "AP" : "=1-AF6/RawMeth_storage_cap_ud", "AQ" : "=1-AG6/CO2_storage_cap_ud", "AR" : "=1-AH6/CO2_storage_cap_ud", "AS" : "=1-AI6/Hydrogen_storage_cap_ud", "AT" : "=1-AJ6/Hydrogen_storage_cap_ud", "AU" : "=MIN(IF(AO6<=0,0,IF(AP6>=0,1,1/(AO6-AP6)*AO6)),IF(AQ6<=0,0,IF(AR6>=0,1,1/(AQ6-AR6)*AQ6)),IF(AS6<=0,0,IF(AT6>=0,1,1/(AS6-AT6)*AS6)))*(B_equiv_harmonious_max_perc-B_equiv_harmonious_min_perc)+B_equiv_harmonious_min_perc",  "AW" : "=(C_overall_var_min_cons+C_overall_fix_stby_cons)*$B6+C_overall_stup_cons", "AX" : "=(C_overall_var_max_cons+C_overall_fix_stby_cons)*$B6+C_overall_stup_cons", "AY" : "=(C_overall_var_heat_min_cons+C_overall_heat_fix_stby_cons)*$B6+C_overall_heat_stup_cons", "AZ" : "=(C_overall_var_heat_max_cons+C_overall_heat_fix_stby_cons)*$B6+C_overall_heat_stup_cons", "BA" : "=C_RawMeth_min_cons*$B6", "BB" : "=C_RawMeth_max_cons*$B6", "BC" : "=C_CO2_min_cons*$B6", "BD" : "=C_CO2_max_cons*$B6", "BE" : "=C_Hydrogen_min_cons*$B6", "BF" : "=C_Hydrogen_max_cons*$B6", "BG" : "=(BE6+BA6/(MethSynt_CO2_nom_cons+MethSynt_Hydrogen_nom_cons)*MethSynt_Hydrogen_nom_cons)/EY_Hydrogen_nom_prod*EY_var_gross_nom_cons+$C6*EY_fix_cons+(BC6+BA6/(MethSynt_CO2_nom_cons+MethSynt_Hydrogen_nom_cons)*MethSynt_CO2_nom_cons)/CCU_CO2_nom_prod_ud*CCU_var_nom_cons+$C6*CCU_fix_cons+BA6/MethSynt_RawMeth_nom_prod_ud*MethSynt_var_nom_cons+$C6*MethSynt_fix_cons", "BH" : "=(BF6+BB6/(MethSynt_CO2_nom_cons+MethSynt_Hydrogen_nom_cons)*MethSynt_Hydrogen_nom_cons)/EY_Hydrogen_nom_prod*EY_var_gross_nom_cons+$C6*EY_fix_cons+(BD6+BB6/(MethSynt_CO2_nom_cons+MethSynt_Hydrogen_nom_cons)*MethSynt_CO2_nom_cons)/CCU_CO2_nom_prod_ud*CCU_var_nom_cons+$C6*CCU_fix_cons+BB6/MethSynt_RawMeth_nom_prod_ud*MethSynt_var_nom_cons+$C6*MethSynt_fix_cons", "BI" : "=(BE6+BA6/(MethSynt_CO2_nom_cons+MethSynt_Hydrogen_nom_cons)*MethSynt_Hydrogen_nom_cons)/EY_Hydrogen_nom_prod*EY_var_heat_nom_cons+$C6*EY_heat_fix_cons+(BC6+BA6/(MethSynt_CO2_nom_cons+MethSynt_Hydrogen_nom_cons)*MethSynt_CO2_nom_cons)/CCU_CO2_nom_prod_ud*CCU_var_heat_nom_cons+$C6*CCU_fix_heat_cons-BA6/MethSynt_RawMeth_nom_prod_ud*MethSynt_var_heat_nom_prod-$C6*MethSynt_heat_fix_prod", "BJ" : "=(BF6+BB6/(MethSynt_CO2_nom_cons+MethSynt_Hydrogen_nom_cons)*MethSynt_Hydrogen_nom_cons)/EY_Hydrogen_nom_prod*EY_var_heat_nom_cons+$C6*EY_heat_fix_cons+(BD6+BB6/(MethSynt_CO2_nom_cons+MethSynt_Hydrogen_nom_cons)*MethSynt_CO2_nom_cons)/CCU_CO2_nom_prod_ud*CCU_var_heat_nom_cons+$C6*CCU_fix_heat_cons-BB6/MethSynt_RawMeth_nom_prod_ud*MethSynt_var_heat_nom_prod-$C6*MethSynt_heat_fix_prod", "BK" : "=1-BA6/RawMeth_storage_cap_ud", "BL" : "=1-BB6/RawMeth_storage_cap_ud", "BM" : "=1-BC6/CO2_storage_cap_ud", "BN" : "=1-BD6/CO2_storage_cap_ud", "BO" : "=1-BE6/Hydrogen_storage_cap_ud", "BP" : "=1-BF6/Hydrogen_storage_cap_ud", "BQ" : "=MIN(IF(BK6<=0,0,IF(BL6>=0,1,1/(BK6-BL6)*BK6)),IF(BM6<=0,0,IF(BN6>=0,1,1/(BM6-BN6)*BM6)),IF(BO6<=0,0,IF(BP6>=0,1,1/(BO6-BP6)*BO6)))*(C_equiv_harmonious_max_perc-C_equiv_harmonious_min_perc)+C_equiv_harmonious_min_perc",  "BS" : "=(D_overall_var_min_cons+D_overall_fix_stby_cons)*$B6+D_overall_stup_cons", "BT" : "=(D_overall_var_max_cons+D_overall_fix_stby_cons)*$B6+D_overall_stup_cons", "BU" : "=(D_overall_var_heat_min_cons+D_overall_heat_fix_stby_cons)*$B6+D_overall_heat_stup_cons", "BV" : "=(D_overall_var_heat_max_cons+D_overall_heat_fix_stby_cons)*$B6+D_overall_heat_stup_cons", "BW" : "=D_RawMeth_min_cons*$B6", "BX" : "=D_RawMeth_max_cons*$B6", "BY" : "=D_CO2_min_cons*$B6", "BZ" : "=D_CO2_max_cons*$B6", "CA" : "=D_Hydrogen_min_cons*$B6", "CB" : "=D_Hydrogen_max_cons*$B6", "CC" : "=(CA6+BW6/(MethSynt_CO2_nom_cons+MethSynt_Hydrogen_nom_cons)*MethSynt_Hydrogen_nom_cons)/EY_Hydrogen_nom_prod*EY_var_gross_nom_cons+$C6*EY_fix_cons+(BY6+BW6/(MethSynt_CO2_nom_cons+MethSynt_Hydrogen_nom_cons)*MethSynt_CO2_nom_cons)/CCU_CO2_nom_prod_ud*CCU_var_nom_cons+$C6*CCU_fix_cons+BW6/MethSynt_RawMeth_nom_prod_ud*MethSynt_var_nom_cons+$C6*MethSynt_fix_cons", "CD" : "=(CB6+BX6/(MethSynt_CO2_nom_cons+MethSynt_Hydrogen_nom_cons)*MethSynt_Hydrogen_nom_cons)/EY_Hydrogen_nom_prod*EY_var_gross_nom_cons+$C6*EY_fix_cons+(BZ6+BX6/(MethSynt_CO2_nom_cons+MethSynt_Hydrogen_nom_cons)*MethSynt_CO2_nom_cons)/CCU_CO2_nom_prod_ud*CCU_var_nom_cons+$C6*CCU_fix_cons+BX6/MethSynt_RawMeth_nom_prod_ud*MethSynt_var_nom_cons+$C6*MethSynt_fix_cons", "CE" : "=(CA6+BW6/(MethSynt_CO2_nom_cons+MethSynt_Hydrogen_nom_cons)*MethSynt_Hydrogen_nom_cons)/EY_Hydrogen_nom_prod*EY_var_heat_nom_cons+$C6*EY_heat_fix_cons+(BY6+BW6/(MethSynt_CO2_nom_cons+MethSynt_Hydrogen_nom_cons)*MethSynt_CO2_nom_cons)/CCU_CO2_nom_prod_ud*CCU_var_heat_nom_cons+$C6*CCU_fix_heat_cons-BW6/MethSynt_RawMeth_nom_prod_ud*MethSynt_var_heat_nom_prod-$C6*MethSynt_heat_fix_prod", "CF" : "=(CB6+BX6/(MethSynt_CO2_nom_cons+MethSynt_Hydrogen_nom_cons)*MethSynt_Hydrogen_nom_cons)/EY_Hydrogen_nom_prod*EY_var_heat_nom_cons+$C6*EY_heat_fix_cons+(BZ6+BX6/(MethSynt_CO2_nom_cons+MethSynt_Hydrogen_nom_cons)*MethSynt_CO2_nom_cons)/CCU_CO2_nom_prod_ud*CCU_var_heat_nom_cons+$C6*CCU_fix_heat_cons-BX6/MethSynt_RawMeth_nom_prod_ud*MethSynt_var_heat_nom_prod-$C6*MethSynt_heat_fix_prod", "CG" : "=1-BW6/RawMeth_storage_cap_ud", "CH" : "=1-BX6/RawMeth_storage_cap_ud", "CI" : "=1-BY6/CO2_storage_cap_ud", "CJ" : "=1-BZ6/CO2_storage_cap_ud", "CK" : "=1-CA6/Hydrogen_storage_cap_ud", "CL" : "=1-CB6/Hydrogen_storage_cap_ud", "CM" : "=MIN(IF(CG6<=0,0,IF(CH6>=0,1,1/(CG6-CH6)*CG6)),IF(CI6<=0,0,IF(CJ6>=0,1,1/(CI6-CJ6)*CI6)),IF(CK6<=0,0,IF(CL6>=0,1,1/(CK6-CL6)*CK6)))*(D_equiv_harmonious_max_perc-D_equiv_harmonious_min_perc)+D_equiv_harmonious_min_perc",  "CO" : "=SUMIFS(Calculation$P$5:$P$8763,Calculation$U$5:$U$8763,\"=\"&$A6,Calculation$S$5:$S$8763,\">0\")", "CP" : "=SUMIF(Calculation$U$5:$U$8763,\"=\"&$A6,Calculation$P$5:$P$8763)-CO6", "CQ" : "=SUMIFS(Calculation$J$5:$J$8763,Calculation$U$5:$U$8763,\"=\"&$A6,Calculation$T$5:$T$8763,\">0\")", "CR" : "=SUMIF(Calculation$U$5:$U$8763,\"=\"&$A6,Calculation$J$5:$J$8763)-CQ6",  "CT" : "=SUMIF(Calculation$U$5:$U$8763,\"=\"&$A6,Calculation$S$5:$S$8763)", "CU" : "=SUMIF(Calculation$U$5:$U$8763,\"=\"&$A6,CalculationAH$5:AH$8763)", "CV" : "=SUMIF(Calculation$U$5:$U$8763,\"=\"&$A6,Calculation$T$5:$T$8763)", "CW" : "=SUMIF(Calculation$U$5:$U$8763,\"=\"&$A6,CalculationAI$5:AI$8763)", "CX" : "=SUMIFS(Calculation$AF$5:$AF$8763,Calculation$U$5:$U$8763,\"=\"&$A6,Calculation$S$5:$S$8763,\">0\")", "CY" : "=SUMIFS(Calculation$AT$5:$AT$8763,Calculation$U$5:$U$8763,\"=\"&$A6,Calculation$S$5:$S$8763,\">0\")", "CZ" : "=SUMIF(Calculation$U$5:$U$8763,\"=\"&$A6,Calculation$AF$5:$AF$8763)-CX6", "DA" : "=SUMIFS(Calculation$X$5:$X$8763,Calculation$U$5:$U$8763,\"=\"&$A6,Calculation$S$5:$S$8763,\">0\")", "DB" : "=SUMIFS(CalculationAL$5:AL$8763,Calculation$U$5:$U$8763,\"=\"&$A6,Calculation$AH$5:$AH$8763,\">0\")", "DC" : "=SUMIF(Calculation$U$5:$U$8763,\"=\"&$A6,Calculation$X$5:$X$8763)-DA6", "DD" : "=SUMIFS(Calculation$V$5:$V$8763,Calculation$U$5:$U$8763,\"=\"&$A6,Calculation$S$5:$S$8763,\">0\")", "DE" : "=SUMIFS(CalculationAJ$5:AJ$8763,Calculation$U$5:$U$8763,\"=\"&$A6,Calculation$AH$5:$AH$8763,\">0\")", "DF" : "=SUMIF(Calculation$U$5:$U$8763,\"=\"&$A6,Calculation$V$5:$V$8763)-DD6", "DG" : "=SUMIFS(Calculation$W$5:$W$8763,Calculation$U$5:$U$8763,\"=\"&$A6,Calculation$S$5:$S$8763,\">0\")", "DH" : "=SUMIFS(CalculationAK$5:AK$8763,Calculation$U$5:$U$8763,\"=\"&$A6,Calculation$AH$5:$AH$8763,\">0\")", "DI" : "=SUMIF(Calculation$U$5:$U$8763,\"=\"&$A6,Calculation$W$5:$W$8763)-DG6", "DJ" : "=SUMIFS(Calculation$Y$5:$Y$8763,Calculation$U$5:$U$8763,\"=\"&$A6,Calculation$S$5:$S$8763,\">0\")", "DK" : "=SUMIFS(Calculation$AM$5:$AM$8763,Calculation$U$5:$U$8763,\"=\"&$A6,Calculation$AH$5:$AH$8763,\">0\")", "DL" : "=SUMIF(Calculation$U$5:$U$8763,\"=\"&$A6,Calculation$Y$5:$Y$8763)-DJ6", "DM" : "=MIN(SUMIFS(Calculation$AE$5:$AE$8763,Calculation$U$5:$U$8763,\"=\"&$A6,Calculation$S$5:$S$8763,\">0\"),BESS_cap_ud/BESS_chrg_eff)", "DN" : "=MIN(SUMIFS(Calculation$AS$5:$AS$8763,Calculation$U$5:$U$8763,\"=\"&$A6,Calculation$AH$5:$AH$8763,\">0\"),BESS_cap_ud/BESS_chrg_eff)", "DO" : "=MIN(SUMIFS(Calculation$AE$5:$AE$8763,Calculation$U$5:$U$8763,\"=\"&$A6,Calculation$S$5:$S$8763,\"=0\"),BESS_cap_ud/BESS_chrg_eff)", "DP" : "=SUMIFS(Calculation$Z$5:$Z$8763,Calculation$U$5:$U$8763,\"=\"&$A6,Calculation$S$5:$S$8763,\">0\")", "DQ" : "=SUMIFS(Calculation$AN$5:$AN$8763,Calculation$U$5:$U$8763,\"=\"&$A6,Calculation$S$5:$S$8763,\">0\")", "DR" : "=SUMIFS(Calculation$AA$5:$AA$8763,Calculation$U$5:$U$8763,\"=\"&$A6,Calculation$S$5:$S$8763,\">0\")", "DS" : "=SUMIFS(CalculationAO$5:AO$8763,Calculation$U$5:$U$8763,\"=\"&$A6,Calculation$AH$5:$AH$8763,\">0\")", "DT" : "=SUMIF(Calculation$U$5:$U$8763,\"=\"&$A6,Calculation$AA$5:$AA$8763)-DR6", "DU" : "=SUMIFS(Calculation$AB$5:$AB$8763,Calculation$U$5:$U$8763,\"=\"&$A6,Calculation$S$5:$S$8763,\">0\")", "DV" : "=SUMIFS(CalculationAP$5:AP$8763,Calculation$U$5:$U$8763,\"=\"&$A6,Calculation$AH$5:$AH$8763,\">0\")", "DW" : "=SUMIF(Calculation$U$5:$U$8763,\"=\"&$A6,Calculation$AB$5:$AB$8763)-DU6", "DX" : "=SUMIFS(Calculation$AC$5:$AC$8763,Calculation$U$5:$U$8763,\"=\"&$A6,Calculation$S$5:$S$8763,\">0\")", "DY" : "=SUMIFS(CalculationAQ$5:AQ$8763,Calculation$U$5:$U$8763,\"=\"&$A6,Calculation$AH$5:$AH$8763,\">0\")", "DZ" : "=SUMIF(Calculation$U$5:$U$8763,\"=\"&$A6,Calculation$AC$5:$AC$8763)-DX6", "EA" : "=SUMIFS(Calculation$AD$5:$AD$8763,Calculation$U$5:$U$8763,\"=\"&$A6,Calculation$S$5:$S$8763,\">0\")", "EB" : "=SUMIFS(CalculationAR$5:AR$8763,Calculation$U$5:$U$8763,\"=\"&$A6,Calculation$AH$5:$AH$8763,\">0\")", "EC" : "=SUMIF(Calculation$U$5:$U$8763,\"=\"&$A6,Calculation$AD$5:$AD$8763)-EA6",  "EE" : "=$DD6+$DJ6-$O6-MIN($DM6,($DC6+$E6+$G6/El_boiler_eff)/BESS_chrg_eff)-MAX(0,$Q6-$DG6)/El_boiler_eff", "EF" : "=$DD6+$DJ6-($O6+($P6-$O6)/(A_equiv_harmonious_max_perc-A_equiv_harmonious_min_perc)*($Y6-A_equiv_harmonious_min_perc))-MIN($DM6,($DC6+($E6+($F6-$E6)/(A_equiv_harmonious_max_perc-A_equiv_harmonious_min_perc)*($Y6-A_equiv_harmonious_min_perc))+($G6+($H6-$G6)/(A_equiv_harmonious_max_perc-A_equiv_harmonious_min_perc)*($Y6-A_equiv_harmonious_min_perc))/El_boiler_eff)/BESS_chrg_eff)-MAX(0,($Q6+($R6-$Q6)/(A_equiv_harmonious_max_perc-A_equiv_harmonious_min_perc)*($Y6-A_equiv_harmonious_min_perc))-$DG6)/El_boiler_eff", "EG" : "=$DE6+$DK6-$O6-MIN($DN6,($DC6+$E6+$G6/El_boiler_eff)/BESS_chrg_eff)-MAX(0,$Q6-$DH6)/El_boiler_eff", "EH" : "=($DM6+$DO6)*BESS_chrg_eff+$DL6-$E6-$G6/El_boiler_eff", "EI" : "=($DM6+$DO6)*BESS_chrg_eff+$DL6-($E6+($F6-$E6)/(A_equiv_harmonious_max_perc-A_equiv_harmonious_min_perc)*($Y6-A_equiv_harmonious_min_perc))-($G6+($H6-$G6)/(A_equiv_harmonious_max_perc-A_equiv_harmonious_min_perc)*($Y6-A_equiv_harmonious_min_perc))/El_boiler_eff", "EJ" : "=($DN6+$DO6)*BESS_chrg_eff+$DL6-$E6-$G6/El_boiler_eff", "EK" : "=$DG6+($DD6+$DJ6-MIN($DM6,($DC6+$E6+$G6/El_boiler_eff)/BESS_chrg_eff)-$O6)*El_boiler_eff-$Q6", "EL" : "=$DG6+($DD6+$DJ6-MIN($DM6,($DC6+($E6+($F6-$E6)/(A_equiv_harmonious_max_perc-A_equiv_harmonious_min_perc)*($Y6-A_equiv_harmonious_min_perc))+($G6+($H6-$G6)/(A_equiv_harmonious_max_perc-A_equiv_harmonious_min_perc)*($Y6-A_equiv_harmonious_min_perc))/El_boiler_eff)/BESS_chrg_eff)-($O6+($P6-$O6)/(A_equiv_harmonious_max_perc-A_equiv_harmonious_min_perc)*($Y6-A_equiv_harmonious_min_perc)))*El_boiler_eff-($Q6+($R6-$Q6)/(A_equiv_harmonious_max_perc-A_equiv_harmonious_min_perc)*($Y6-A_equiv_harmonious_min_perc))", "EM" : "=$DH6+($DE6+$DK6-MIN($DN6,($DC6+$E6+$G6/El_boiler_eff)/BESS_chrg_eff)-$O6)*El_boiler_eff-$Q6", "EN" : "=$DI6+$DT6*El_boiler_eff-$G6", "EO" : "=$DI6+$DT6*El_boiler_eff-($G6+($H6-$G6)/(A_equiv_harmonious_max_perc-A_equiv_harmonious_min_perc)*($Y6-A_equiv_harmonious_min_perc))", "EP" : "=$DI6+$DT6*El_boiler_eff-$G6", "EQ" : "=$DR6-MAX(0,$Q6-$DG6)/El_boiler_eff", "ER" : "=$DR6-MAX(0,($Q6+($R6-$Q6)/(A_equiv_harmonious_max_perc-A_equiv_harmonious_min_perc)*($Y6-A_equiv_harmonious_min_perc))-$DG6)/El_boiler_eff", "ES" : "=$DS6-MAX(0,$Q6-$DH6)/El_boiler_eff", "ET" : "=$DT6-MAX(0,$G6-$DI6)/El_boiler_eff", "EU" : "=$DT6-MAX(0,($G6+($H6-$G6)/(A_equiv_harmonious_max_perc-A_equiv_harmonious_min_perc)*($Y6-A_equiv_harmonious_min_perc))-$DI6)/El_boiler_eff", "EV" : "=$DT6-MAX(0,$G6-$DI6)/El_boiler_eff", "EW" : "=$DU6-$I6", "EX" : "=$DU6-($I6+($J6-$I6)/(A_equiv_harmonious_max_perc-A_equiv_harmonious_min_perc)*($Y6-A_equiv_harmonious_min_perc))", "EY" : "=$DV6-$I6", "EZ" : "=$DX6-$K6", "FA" : "=$DX6-($K6+($L6-$K6)/(A_equiv_harmonious_max_perc-A_equiv_harmonious_min_perc)*($Y6-A_equiv_harmonious_min_perc))", "FB" : "=$DY6-$K6", "FC" : "=$EA6-$M6", "FD" : "=$EA6-($M6+($N6-$M6)/(A_equiv_harmonious_max_perc-A_equiv_harmonious_min_perc)*($Y6-A_equiv_harmonious_min_perc))", "FE" : "=$EB6-$M6",  "FG" : "=IF(OR(EE6<0,EH6<0,EK6<0,EN6<0,EQ6<0,ET6<0,EW6<0,EZ6<0,FC6<0),0,MIN(1,Overall_harmonious_min_perc+MIN(IFERROR(EE6/MAX(0,EE6-EG6),1),IFERROR(EH6/MAX(0,EH6-EJ6),1),IFERROR(EK6/MAX(0,EK6-EM6),1),IFERROR(EN6/MAX(0,EN6-EP6),1),IFERROR(EQ6/MAX(0,EQ6-ES6),1),IFERROR(ET6/MAX(0,ET6-EV6),1),IFERROR(EW6/MAX(0,EW6-EY6),1),IFERROR(EZ6/MAX(0,EZ6-FB6),1),IFERROR(FC6/MAX(0,FC6-FE6),1))*(Overall_harmonious_max_perc-Overall_harmonious_min_perc)))", "FH" : "=IF(FG6=0,0,ROUND(($DD6+($DE6-$DD6)/(Overall_harmonious_max_perc-Overall_harmonious_min_perc)*(FG6-Overall_harmonious_min_perc))+($DJ6+($DK6-$DJ6)/(Overall_harmonious_max_perc-Overall_harmonious_min_perc)*(FG6-Overall_harmonious_min_perc))-$O6-MIN($DM6+($DN6-$DM6)/(Overall_harmonious_max_perc-Overall_harmonious_min_perc)*(UM6-Overall_harmonious_min_perc),($DC6+$E6+$G6/El_boiler_eff)/BESS_chrg_eff)-MAX(0,$Q6-($DG6+($DH6-$DG6)/(Overall_harmonious_max_perc-Overall_harmonious_min_perc)*(FG6-Overall_harmonious_min_perc)))/El_boiler_eff,5))", "FI" : "=IF(FG6=0,0,ROUND(($DD6+($DE6-$DD6)/(Overall_harmonious_max_perc-Overall_harmonious_min_perc)*(FG6-Overall_harmonious_min_perc))+($DJ6+($DK6-$DJ6)/(Overall_harmonious_max_perc-Overall_harmonious_min_perc)*(FG6-Overall_harmonious_min_perc))-($O6+($P6-$O6)/(A_equiv_harmonious_max_perc-A_equiv_harmonious_min_perc)*($Y6-A_equiv_harmonious_min_perc))-MIN($DM6+($DN6-$DM6)/(Overall_harmonious_max_perc-Overall_harmonious_min_perc)*(UM6-Overall_harmonious_min_perc),($DC6+($E6+($F6-$E6)/(A_equiv_harmonious_max_perc-A_equiv_harmonious_min_perc)*($Y6-A_equiv_harmonious_min_perc))+($G6+($H6-$G6)/(A_equiv_harmonious_max_perc-A_equiv_harmonious_min_perc)*($Y6-A_equiv_harmonious_min_perc))/El_boiler_eff)/BESS_chrg_eff)-MAX(0,($Q6+($R6-$Q6)/(A_equiv_harmonious_max_perc-A_equiv_harmonious_min_perc)*($Y6-A_equiv_harmonious_min_perc))-($DG6+($DH6-$DG6)/(Overall_harmonious_max_perc-Overall_harmonious_min_perc)*(FG6-Overall_harmonious_min_perc)))/El_boiler_eff,5))", "FJ" : "=IF(FG6=0,0,ROUND((($DM6+($DN6-$DM6)/(Overall_harmonious_max_perc-Overall_harmonious_min_perc)*(FG6-Overall_harmonious_min_perc))+$DO6)*BESS_chrg_eff+$DL6-$E6-$G6/El_boiler_eff,5))", "FK" : "=IF(FG6=0,0,ROUND((($DM6+($DN6-$DM6)/(Overall_harmonious_max_perc-Overall_harmonious_min_perc)*(FG6-Overall_harmonious_min_perc))+$DO6)*BESS_chrg_eff+$DL6-($E6+($F6-$E6)/(A_equiv_harmonious_max_perc-A_equiv_harmonious_min_perc)*($Y6-A_equiv_harmonious_min_perc))-($G6+($H6-$G6)/(A_equiv_harmonious_max_perc-A_equiv_harmonious_min_perc)*($Y6-A_equiv_harmonious_min_perc))/El_boiler_eff,5))", "FL" : "=IF(FG6=0,0,ROUND(($DG6+($DH6-$DG6)/(Overall_harmonious_max_perc-Overall_harmonious_min_perc)*(FG6-Overall_harmonious_min_perc))+(($DD6+($DE6-$DD6)/(Overall_harmonious_max_perc-Overall_harmonious_min_perc)*(FG6-Overall_harmonious_min_perc))+($DJ6+($DK6-$DJ6)/(Overall_harmonious_max_perc-Overall_harmonious_min_perc)*(FG6-Overall_harmonious_min_perc))-MIN($DM6+($DN6-$DM6)/(Overall_harmonious_max_perc-Overall_harmonious_min_perc)*(UM6-Overall_harmonious_min_perc),($DC6+$E6+$G6/El_boiler_eff)/BESS_chrg_eff)-$O6)*El_boiler_eff-$Q6,5))", "FM" : "=IF(FG6=0,0,ROUND(($DG6+($DH6-$DG6)/(Overall_harmonious_max_perc-Overall_harmonious_min_perc)*(FG6-Overall_harmonious_min_perc))+(($DD6+($DE6-$DD6)/(Overall_harmonious_max_perc-Overall_harmonious_min_perc)*(FG6-Overall_harmonious_min_perc))+($DJ6+($DK6-$DJ6)/(Overall_harmonious_max_perc-Overall_harmonious_min_perc)*(FG6-Overall_harmonious_min_perc))-MIN($DM6+($DN6-$DM6)/(Overall_harmonious_max_perc-Overall_harmonious_min_perc)*(UM6-Overall_harmonious_min_perc),($DC6+($E6+($F6-$E6)/(A_equiv_harmonious_max_perc-A_equiv_harmonious_min_perc)*($Y6-A_equiv_harmonious_min_perc))+($G6+($H6-$G6)/(A_equiv_harmonious_max_perc-A_equiv_harmonious_min_perc)*($Y6-A_equiv_harmonious_min_perc))/El_boiler_eff)/BESS_chrg_eff)-($O6+($P6-$O6)/(A_equiv_harmonious_max_perc-A_equiv_harmonious_min_perc)*($Y6-A_equiv_harmonious_min_perc)))*El_boiler_eff-($Q6+($R6-$Q6)/(A_equiv_harmonious_max_perc-A_equiv_harmonious_min_perc)*($Y6-A_equiv_harmonious_min_perc)),5))", "FN" : "=IF(FG6=0,0,ROUND($DI6+$DT6*El_boiler_eff-$G6,5))", "FO" : "=IF(FG6=0,0,ROUND($DI6+$DT6*El_boiler_eff-($G6+($H6-$G6)/(A_equiv_harmonious_max_perc-A_equiv_harmonious_min_perc)*($Y6-A_equiv_harmonious_min_perc)),5))", "FP" : "=IF(FG6=0,0,ROUND(($DR6+($DS6-$DR6)/(Overall_harmonious_max_perc-Overall_harmonious_min_perc)*(FG6-Overall_harmonious_min_perc))-MAX(0,$Q6-($DG6+($DH6-$DG6)/(Overall_harmonious_max_perc-Overall_harmonious_min_perc)*(FG6-Overall_harmonious_min_perc)))/El_boiler_eff,5))", "FQ" : "=IF(FG6=0,0,ROUND(($DR6+($DS6-$DR6)/(Overall_harmonious_max_perc-Overall_harmonious_min_perc)*(FG6-Overall_harmonious_min_perc))-MAX(0,($Q6+($R6-$Q6)/(A_equiv_harmonious_max_perc-A_equiv_harmonious_min_perc)*($Y6-A_equiv_harmonious_min_perc))-($DG6+($DH6-$DG6)/(Overall_harmonious_max_perc-Overall_harmonious_min_perc)*(FG6-Overall_harmonious_min_perc)))/El_boiler_eff,5))", "FR" : "=IF(FG6=0,0,ROUND($DT6-MAX(0,$G6-$DI6)/El_boiler_eff,5))", "FS" : "=IF(FG6=0,0,ROUND($DT6-MAX(0,($G6+($H6-$G6)/(A_equiv_harmonious_max_perc-A_equiv_harmonious_min_perc)*($Y6-A_equiv_harmonious_min_perc))-$DI6)/El_boiler_eff,5))", "FT" : "=IF(FG6=0,0,ROUND(($DU6+($DV6-$DU6)/(Overall_harmonious_max_perc-Overall_harmonious_min_perc)*(FG6-Overall_harmonious_min_perc))-$I6,5))", "FU" : "=IF(FG6=0,0,ROUND(($DU6+($DV6-$DU6)/(Overall_harmonious_max_perc-Overall_harmonious_min_perc)*(FG6-Overall_harmonious_min_perc))-($I6+($J6-$I6)/(A_equiv_harmonious_max_perc-A_equiv_harmonious_min_perc)*($Y6-A_equiv_harmonious_min_perc)),5))", "FV" : "=IF(FG6=0,0,ROUND(($DX6+($DY6-$DX6)/(Overall_harmonious_max_perc-Overall_harmonious_min_perc)*(FG6-Overall_harmonious_min_perc))-$K6,5))", "FW" : "=IF(FG6=0,0,ROUND(($DX6+($DY6-$DX6)/(Overall_harmonious_max_perc-Overall_harmonious_min_perc)*(FG6-Overall_harmonious_min_perc))-($K6+($L6-$K6)/(A_equiv_harmonious_max_perc-A_equiv_harmonious_min_perc)*($Y6-A_equiv_harmonious_min_perc)),5))", "FX" : "=IF(FG6=0,0,ROUND(($EA6+($EB6-$EA6)/(Overall_harmonious_max_perc-Overall_harmonious_min_perc)*(FG6-Overall_harmonious_min_perc))-$M6,5))", "FY" : "=IF(FG6=0,0,ROUND(($EA6+($EB6-$EA6)/(Overall_harmonious_max_perc-Overall_harmonious_min_perc)*(FG6-Overall_harmonious_min_perc))-($M6+($N6-$M6)/(A_equiv_harmonious_max_perc-A_equiv_harmonious_min_perc)*($Y6-A_equiv_harmonious_min_perc)),5))", "FZ" : "=IF(OR(FG6=0,FH6<0,FJ6<0,FL6<0,FN6<0,FP6<0,FR6<0,FT6<0,FV6<0,FX6<0),0,MIN(1,A_equiv_harmonious_min_perc+MIN(IF(FI6>=0,1,FH6/(FH6-FI6)),IF(FK6>=0,1,FJ6/(FJ6-FK6)),IF(FM6>=0,1,FL6/(FL6-FM6)),IF(FO6>=0,1,FN6/(FN6-FO6)),IF(FQ6>=0,1,FP6/(FP6-FQ6)),IF(FS6>=0,1,FR6/(FR6-FS6)),IF(FU6>=0,1,FT6/(FT6-FU6)),IF(FW6>=0,1,FV6/(FV6-FW6)),IF(FY6>=0,1,FX6/(FX6-FY6)))*(A_equiv_harmonious_max_perc*$Y6-A_equiv_harmonious_min_perc)))",  "GB" : "=IF(OR(EE6<0,EH6<0,EK6<0,EN6<0,EQ6<0,ET6<0,EW6<0,EZ6<0,FC6<0),0,MIN(1,A_equiv_harmonious_min_perc+MIN(IF(EF6>=0,1,EE6/(EE6-EF6)),IF(EI6>=0,1,EH6/(EH6-EI6)),IF(EL6>=0,1,EK6/(EK6-EL6)),IF(EO6>=0,1,EN6/(EN6-EO6)),IF(ER6>=0,1,EQ6/(EQ6-ER6)),IF(EU6>=0,1,ET6/(ET6-EU6)),IF(EX6>=0,1,EW6/(EW6-EX6)),IF(FA6>=0,1,EZ6/(EZ6-FA6)),IF(FD6>=0,1,FC6/(FC6-FD6)))*(A_equiv_harmonious_max_perc*$Y6-A_equiv_harmonious_min_perc)))", "GC" : "=IF(GB6=0,0,ROUND($DD6+$DJ6-($O6+($P6-$O6)/(A_equiv_harmonious_max_perc-A_equiv_harmonious_min_perc)*(GB6-A_equiv_harmonious_min_perc))-MIN($DM6,($DC6+($E6+($F6-$E6)/(A_equiv_harmonious_max_perc-A_equiv_harmonious_min_perc)*(GB6-A_equiv_harmonious_min_perc))+($G6+($H6-$G6)/(A_equiv_harmonious_max_perc-A_equiv_harmonious_min_perc)*(GB6-A_equiv_harmonious_min_perc))/El_boiler_eff)/BESS_chrg_eff)-MAX(0,($Q6+($R6-$Q6)/(A_equiv_harmonious_max_perc-A_equiv_harmonious_min_perc)*(GB6-A_equiv_harmonious_min_perc))-$DG6)/El_boiler_eff,5))", "GD" : "=IF(GB6=0,0,ROUND($DE6+$DK6-($O6+($P6-$O6)/(A_equiv_harmonious_max_perc-A_equiv_harmonious_min_perc)*(GB6-A_equiv_harmonious_min_perc))-MIN($DN6,($DC6+($E6+($F6-$E6)/(A_equiv_harmonious_max_perc-A_equiv_harmonious_min_perc)*(GB6-A_equiv_harmonious_min_perc))+($G6+($H6-$G6)/(A_equiv_harmonious_max_perc-A_equiv_harmonious_min_perc)*(GB6-A_equiv_harmonious_min_perc))/El_boiler_eff)/BESS_chrg_eff)-MAX(0,($Q6+($R6-$Q6)/(A_equiv_harmonious_max_perc-A_equiv_harmonious_min_perc)*(GB6-A_equiv_harmonious_min_perc))-$DH6)/El_boiler_eff,5))", "GE" : "=IF(GB6=0,0,ROUND(($DM6+$DO6)*BESS_chrg_eff+$DL6-($E6+($F6-$E6)/(A_equiv_harmonious_max_perc-A_equiv_harmonious_min_perc)*(GB6-A_equiv_harmonious_min_perc))-($G6+($H6-$G6)/(A_equiv_harmonious_max_perc-A_equiv_harmonious_min_perc)*(GB6-A_equiv_harmonious_min_perc))/El_boiler_eff,5))", "GF" : "=IF(GB6=0,0,ROUND(($DN6+$DO6)*BESS_chrg_eff+$DL6-($E6+($F6-$E6)/(A_equiv_harmonious_max_perc-A_equiv_harmonious_min_perc)*(GB6-A_equiv_harmonious_min_perc))-($G6+($H6-$G6)/(A_equiv_harmonious_max_perc-A_equiv_harmonious_min_perc)*(GB6-A_equiv_harmonious_min_perc))/El_boiler_eff,5))", "GG" : "=IF(GB6=0,0,ROUND($DG6+($DD6+$DJ6-MIN(DM6,($DC6+($E6+($F6-$E6)/(A_equiv_harmonious_max_perc-A_equiv_harmonious_min_perc)*(GB6-A_equiv_harmonious_min_perc))+($G6+($H6-$G6)/(A_equiv_harmonious_max_perc-A_equiv_harmonious_min_perc)*(GB6-A_equiv_harmonious_min_perc))/El_boiler_eff)/BESS_chrg_eff)-($O6+($P6-$O6)/(A_equiv_harmonious_max_perc-A_equiv_harmonious_min_perc)*(GB6-A_equiv_harmonious_min_perc)))*El_boiler_eff-($Q6+($R6-$Q6)/(A_equiv_harmonious_max_perc-A_equiv_harmonious_min_perc)*(GB6-A_equiv_harmonious_min_perc)),5))", "GH" : "=IF(GB6=0,0,ROUND($DH6+($DE6+$DK6-MIN(DN6,($DC6+($E6+($F6-$E6)/(A_equiv_harmonious_max_perc-A_equiv_harmonious_min_perc)*(GB6-A_equiv_harmonious_min_perc))+($G6+($H6-$G6)/(A_equiv_harmonious_max_perc-A_equiv_harmonious_min_perc)*(GB6-A_equiv_harmonious_min_perc))/El_boiler_eff)/BESS_chrg_eff)-($O6+($P6-$O6)/(A_equiv_harmonious_max_perc-A_equiv_harmonious_min_perc)*(GB6-A_equiv_harmonious_min_perc)))*El_boiler_eff-($Q6+($R6-$Q6)/(A_equiv_harmonious_max_perc-A_equiv_harmonious_min_perc)*(GB6-A_equiv_harmonious_min_perc)),5))", "GI" : "=IF(GB6=0,0,ROUND($DI6+$DT6*El_boiler_eff-($G6+($H6-$G6)/(A_equiv_harmonious_max_perc-A_equiv_harmonious_min_perc)*(GB6-A_equiv_harmonious_min_perc)),5))", "GJ" : "=IF(GB6=0,0,ROUND($DI6+$DT6*El_boiler_eff-($G6+($H6-$G6)/(A_equiv_harmonious_max_perc-A_equiv_harmonious_min_perc)*(GB6-A_equiv_harmonious_min_perc)),5))", "GK" : "=IF(GB6=0,0,ROUND($DR6-MAX(0,($Q6+($R6-$Q6)/(A_equiv_harmonious_max_perc-A_equiv_harmonious_min_perc)*(GB6-A_equiv_harmonious_min_perc))-$DG6)/El_boiler_eff,5))", "GL" : "=IF(GB6=0,0,ROUND($DS6-MAX(0,($Q6+($R6-$Q6)/(A_equiv_harmonious_max_perc-A_equiv_harmonious_min_perc)*(GB6-A_equiv_harmonious_min_perc))-$DH6)/El_boiler_eff,5))", "GM" : "=IF(GB6=0,0,ROUND($DT6-MAX(0,($G6+($H6-$G6)/(A_equiv_harmonious_max_perc-A_equiv_harmonious_min_perc)*(GB6-A_equiv_harmonious_min_perc))-$DI6)/El_boiler_eff,5))", "GN" : "=IF(GB6=0,0,ROUND($DT6-MAX(0,($G6+($H6-$G6)/(A_equiv_harmonious_max_perc-A_equiv_harmonious_min_perc)*(GB6-A_equiv_harmonious_min_perc))-$DI6)/El_boiler_eff,5))", "GO" : "=IF(GB6=0,0,ROUND($DU6-($I6+($J6-$I6)/(A_equiv_harmonious_max_perc-A_equiv_harmonious_min_perc)*(GB6-A_equiv_harmonious_min_perc)),5))", "GP" : "=IF(GB6=0,0,ROUND($DV6-($I6+($J6-$I6)/(A_equiv_harmonious_max_perc-A_equiv_harmonious_min_perc)*(GB6-A_equiv_harmonious_min_perc)),5))", "GQ" : "=IF(GB6=0,0,ROUND($DX6-($K6+($L6-$K6)/(A_equiv_harmonious_max_perc-A_equiv_harmonious_min_perc)*(GB6-A_equiv_harmonious_min_perc)),5))", "GR" : "=IF(GB6=0,0,ROUND($DY6-($K6+($L6-$K6)/(A_equiv_harmonious_max_perc-A_equiv_harmonious_min_perc)*(GB6-A_equiv_harmonious_min_perc)),5))", "GS" : "=IF(GB6=0,0,ROUND($EA6-($M6+($N6-$M6)/(A_equiv_harmonious_max_perc-A_equiv_harmonious_min_perc)*(GB6-A_equiv_harmonious_min_perc)),5))", "GT" : "=IF(GB6=0,0,ROUND($EB6-($M6+($N6-$M6)/(A_equiv_harmonious_max_perc-A_equiv_harmonious_min_perc)*(GB6-A_equiv_harmonious_min_perc)),5))", "GU" : "=IF(GB6<=0,0,MIN(1,Overall_harmonious_min_perc+MIN(IF(GD6>=0,1,GC6/(GC6-GD6)),IF(GF6>=0,1,GE6/(GE6-GF6)),IF(GH6>=0,1,GG6/(GG6-GH6)),IF(GJ6>=0,1,GI6/(GI6-GJ6)),IF(GL6>=0,1,GK6/(GK6-GL6)),IF(GN6>=0,1,GM6/(GM6-GN6)),IF(GP6>=0,1,GO6/(GO6-GP6)),IF(GR6>=0,1,GQ6/(GQ6-GR6)),IF(GT6>=0,1,GS6/(GS6-GT6)))*(Overall_harmonious_max_perc-Overall_harmonious_min_perc)))",  "GW" : "=IF(FG6=0,0,$CT6+($CU6-$CT6)/(Overall_harmonious_max_perc-Overall_harmonious_min_perc)*(FG6-Overall_harmonious_min_perc))", "GX" : "=IF(FZ6=0,0,($O6+($P6-$O6)/(A_equiv_harmonious_max_perc-A_equiv_harmonious_min_perc)*(FZ6-A_equiv_harmonious_min_perc)))", "GY" : "=IF(OR(FG6=0,FZ6=0),0,MIN(($DC6+($E6+($F6-$E6)/(A_equiv_harmonious_max_perc-A_equiv_harmonious_min_perc)*(FZ6-A_equiv_harmonious_min_perc))+MAX(0,($G6+($H6-$G6)/(A_equiv_harmonious_max_perc-A_equiv_harmonious_min_perc)*(FZ6-A_equiv_harmonious_min_perc))-$DI6)/El_boiler_eff-$DF6)/BESS_chrg_eff,($DM6+($DN6-$DM6)/(Overall_harmonious_max_perc-Overall_harmonious_min_perc)*(FG6-Overall_harmonious_min_perc))-$DO6))", "GZ" : "=IF(FG6=0,0,$DP6+($DQ6-$DP6)/(Overall_harmonious_max_perc-Overall_harmonious_min_perc)*(FG6-Overall_harmonious_min_perc))", "HA" : "=HJ6/El_boiler_eff", "HB" : "=IF(FG6=0,0,$DD6+($DE6-$DD6)/(Overall_harmonious_max_perc-Overall_harmonious_min_perc)*(FG6-Overall_harmonious_min_perc))", "HC" : "=IF(FG6=0,0,$DA6+($DB6-$DA6)/(Overall_harmonious_max_perc-Overall_harmonious_min_perc)*(FG6-Overall_harmonious_min_perc))", "HD" : "=IF(FG6=0,0,MIN($DJ6+($DK6-$DJ6)/(Overall_harmonious_max_perc-Overall_harmonious_min_perc)*(FG6-Overall_harmonious_min_perc),MAX(0,-(HB6-GX6-GY6-HA6))))", "HE" : "=HB6+HD6-SUM(GX6:GY6,HA6)", "HF" : "=IF(FG6=0,0,$CV6+($CW6-$CV6)/(Overall_harmonious_max_perc-Overall_harmonious_min_perc)*(FG6-Overall_harmonious_min_perc))", "HG" : "=IF(FZ6=0,0,($Q6+($R6-$Q6)/(A_equiv_harmonious_max_perc-A_equiv_harmonious_min_perc)*(FZ6-A_equiv_harmonious_min_perc)))", "HH" : "=IF(FG6=0,0,$DG6+($DH6-$DG6)/(Overall_harmonious_max_perc-Overall_harmonious_min_perc)*(FG6-Overall_harmonious_min_perc))", "HI" : "=IF(FG6=0,0,($DP6+($DQ6-$DP6)/(Overall_harmonious_max_perc-Overall_harmonious_min_perc)*(FG6-Overall_harmonious_min_perc))*El_boiler_eff)", "HJ" : "=IF(FG6=0,0,MIN(($DR6+($DS6-$DR6)/(Overall_harmonious_max_perc-Overall_harmonious_min_perc)*(FG6-Overall_harmonious_min_perc))*El_boiler_eff,MAX(0,HG6-HH6)))", "HK" : "=HH6+HJ6-HG6", "HL" : "=IF(OR(FG6=0,FZ6=0),0,$E6+($F6-$E6)/(A_equiv_harmonious_max_perc-A_equiv_harmonious_min_perc)*(FZ6-A_equiv_harmonious_min_perc))", "HM" : "=HU6/El_boiler_eff", "HN" : "=IF(OR(FG6=0,FZ6=0),0,$DC6)", "HO" : "=IF(OR(FG6=0,FZ6=0),0,$DF6)", "HP" : "=GY6*BESS_chrg_eff", "HQ" : "=IF(OR(FG6=0,FZ6=0),0,MIN($DL6+$DC6,MAX(0,-(SUM(HO6:HP6)-SUM(HL6:HN6)))))", "HR" : "=SUM(HO6:HQ6)-SUM(HL6:HN6)", "HS" : "=IF(OR(FG6=0,FZ6=0),0,$G6+($H6-$G6)/(A_equiv_harmonious_max_perc-A_equiv_harmonious_min_perc)*(FZ6-A_equiv_harmonious_min_perc))", "HT" : "=IF(OR(FG6=0,FZ6=0),0,$DI6)", "HU" : "=IF(OR(FG6=0,FZ6=0),0,MIN($DT6*El_boiler_eff,MAX(0,HS6-HT6)))", "HV" : "=SUM(HT6:HU6)-HS6", "HW" : "=IF(GW6<=0,0,GW6/(Overall_harmonious_var_max_cons+Overall_fix_cons)*MethDist_harmonious_max_perc*MethDist_Meth_nom_prod_ud)+IF(HL6<=0,0,HL6/(A_overall_var_max_cons+A_overall_fix_stby_cons)*A_MethDist_max_perc*MethDist_Meth_nom_prod_ud)", "HX" : "=MIN(HE6,IF(OR(FG6=0,FZ6=0),0,($CX6+($CY6-$CX6)/(Overall_harmonious_max_perc-Overall_harmonious_min_perc)*(FG6-Overall_harmonious_min_perc))))+MIN(HR6,IF(OR(FG6=0,FZ6=0),0,$CZ6))", "HY" : "=HC6+HD6+HQ6", "HZ" : "=MAX(0,-HE6)+MAX(0,-HK6)+MAX(0,-HR6)+MAX(0,-HV6)",  "IB" : "=IF(GU6=0,0,$CT6+($CU6-$CT6)/(Overall_harmonious_max_perc-Overall_harmonious_min_perc)*(GU6-Overall_harmonious_min_perc))", "IC" : "=IF(GB6=0,0,($O6+($P6-$O6)/(A_equiv_harmonious_max_perc-A_equiv_harmonious_min_perc)*(GB6-A_equiv_harmonious_min_perc)))", "ID" : "=IF(OR(GU6=0,GB6=0),0,MIN(($DC6+($E6+($F6-$E6)/(A_equiv_harmonious_max_perc-A_equiv_harmonious_min_perc)*(GB6-A_equiv_harmonious_min_perc))+MAX(0,($G6+($H6-$G6)/(A_equiv_harmonious_max_perc-A_equiv_harmonious_min_perc)*(GB6-A_equiv_harmonious_min_perc))-$DI6)/El_boiler_eff-$DF6)/BESS_chrg_eff,($DM6+($DN6-$DM6)/(Overall_harmonious_max_perc-Overall_harmonious_min_perc)*(GU6-Overall_harmonious_min_perc))-$DO6))", "IE" : "=IF(GU6=0,0,$DP6+($DQ6-$DP6)/(Overall_harmonious_max_perc-Overall_harmonious_min_perc)*(GU6-Overall_harmonious_min_perc))", "IF" : "=IO6/El_boiler_eff", "IG" : "=IF(GU6=0,0,$DD6+($DE6-$DD6)/(Overall_harmonious_max_perc-Overall_harmonious_min_perc)*(GU6-Overall_harmonious_min_perc))", "IH" : "=IF(GU6=0,0,$DA6+($DB6-$DA6)/(Overall_harmonious_max_perc-Overall_harmonious_min_perc)*(GU6-Overall_harmonious_min_perc))", "II" : "=IF(GU6=0,0,MIN($DJ6+($DK6-$DJ6)/(Overall_harmonious_max_perc-Overall_harmonious_min_perc)*(GU6-Overall_harmonious_min_perc),MAX(0,-(IG6-IC6-ID6-IF6))))", "IJ" : "=IG6+II6-SUM(IC6:ID6,IF6)", "IK" : "=IF(GU6=0,0,$CV6+($CW6-$CV6)/(Overall_harmonious_max_perc-Overall_harmonious_min_perc)*(GU6-Overall_harmonious_min_perc))", "IL" : "=IF(GB6=0,0,($Q6+($R6-$Q6)/(A_equiv_harmonious_max_perc-A_equiv_harmonious_min_perc)*(GB6-A_equiv_harmonious_min_perc)))", "IM" : "=IF(GU6=0,0,$DG6+($DH6-$DG6)/(Overall_harmonious_max_perc-Overall_harmonious_min_perc)*(GU6-Overall_harmonious_min_perc))", "IN" : "=IF(GU6=0,0,($DP6+($DQ6-$DP6)/(Overall_harmonious_max_perc-Overall_harmonious_min_perc)*(GU6-Overall_harmonious_min_perc))*El_boiler_eff)", "IO" : "=IF(GU6=0,0,MIN(($DR6+($DS6-$DR6)/(Overall_harmonious_max_perc-Overall_harmonious_min_perc)*(GU6-Overall_harmonious_min_perc))*El_boiler_eff,MAX(0,IL6-IM6)))", "IP" : "=IM6+IO6-IL6", "IQ" : "=IF(OR(GU6=0,GB6=0),0,$E6+($F6-$E6)/(A_equiv_harmonious_max_perc-A_equiv_harmonious_min_perc)*(GB6-A_equiv_harmonious_min_perc))", "IR" : "=IZ6/El_boiler_eff", "IS" : "=IF(OR(GU6=0,GB6=0),0,$DC6)", "IT" : "=IF(OR(GU6=0,GB6=0),0,$DF6)", "IU" : "=ID6*BESS_chrg_eff", "IV" : "=IF(OR(GU6=0,GB6=0),0,MIN($DL6+$DC6,MAX(0,-(SUM(IT6:IU6)-SUM(IQ6:IS6)))))", "IW" : "=SUM(IT6:IV6)-SUM(IQ6:IS6)", "IX" : "=IF(OR(GU6=0,GB6=0),0,$G6+($H6-$G6)/(A_equiv_harmonious_max_perc-A_equiv_harmonious_min_perc)*(GB6-A_equiv_harmonious_min_perc))", "IY" : "=IF(OR(GU6=0,GB6=0),0,$DI6)", "IZ" : "=IF(OR(GU6=0,GB6=0),0,MIN($DT6*El_boiler_eff,MAX(0,IX6-IY6)))", "JA" : "=SUM(IY6:IZ6)-IX6", "JB" : "=IF(IB6<=0,0,IB6/(Overall_harmonious_var_max_cons+Overall_fix_cons)*MethDist_harmonious_max_perc*MethDist_Meth_nom_prod_ud)+IF(IQ6<=0,0,IQ6/(A_overall_var_max_cons+A_overall_fix_stby_cons)*A_MethDist_max_perc*MethDist_Meth_nom_prod_ud)", "JC" : "=MIN(IJ6,IF(OR(GU6=0,GB6=0),0,($CX6+($CY6-$CX6)/(Overall_harmonious_max_perc-Overall_harmonious_min_perc)*(GU6-Overall_harmonious_min_perc))))+MIN(IW6,IF(OR(GU6=0,GB6=0),0,$CZ6))", "JD" : "=IH6+II6+IV6", "JE" : "=MAX(0,-IJ6)+MAX(0,-IP6)+MAX(0,-IW6)+MAX(0,-JA6)",  "JG" : "=$DD6+$DJ6-$AK6-MIN($DM6,($DC6+$AA6+$AC6/El_boiler_eff)/BESS_chrg_eff)-MAX(0,$AM6-$DG6)/El_boiler_eff", "JH" : "=$DD6+$DJ6-($AK6+($AL6-$AK6)/(B_equiv_harmonious_max_perc-B_equiv_harmonious_min_perc)*($AU6-B_equiv_harmonious_min_perc))-MIN($DM6,($DC6+($AA6+($AB6-$AA6)/(B_equiv_harmonious_max_perc-B_equiv_harmonious_min_perc)*($AU6-B_equiv_harmonious_min_perc))+($AC6+($AD6-$AC6)/(B_equiv_harmonious_max_perc-B_equiv_harmonious_min_perc)*($AU6-B_equiv_harmonious_min_perc))/El_boiler_eff)/BESS_chrg_eff)-MAX(0,($AM6+($AN6-$AM6)/(B_equiv_harmonious_max_perc-B_equiv_harmonious_min_perc)*($AU6-B_equiv_harmonious_min_perc))-$DG6)/El_boiler_eff", "JI" : "=$DE6+$DK6-$AK6-MIN($DN6,($DC6+$AA6+$AC6/El_boiler_eff)/BESS_chrg_eff)-MAX(0,$AM6-$DH6)/El_boiler_eff", "JJ" : "=($DM6+$DO6)*BESS_chrg_eff+$DL6-$AA6-$AC6/El_boiler_eff", "JK" : "=($DM6+$DO6)*BESS_chrg_eff+$DL6-($AA6+($AB6-$AA6)/(B_equiv_harmonious_max_perc-B_equiv_harmonious_min_perc)*($AU6-B_equiv_harmonious_min_perc))-($AC6+($AD6-$AC6)/(B_equiv_harmonious_max_perc-B_equiv_harmonious_min_perc)*($AU6-B_equiv_harmonious_min_perc))/El_boiler_eff", "JL" : "=($DN6+$DO6)*BESS_chrg_eff+$DL6-$AA6-$AC6/El_boiler_eff", "JM" : "=$DG6+($DD6+$DJ6-MIN($DM6,($DC6+$AA6+$AC6/El_boiler_eff)/BESS_chrg_eff)-$AK6)*El_boiler_eff-$AM6", "JN" : "=$DG6+($DD6+$DJ6-MIN($DM6,($DC6+($AA6+($AB6-$AA6)/(B_equiv_harmonious_max_perc-B_equiv_harmonious_min_perc)*($AU6-B_equiv_harmonious_min_perc))+($AC6+($AD6-$AC6)/(B_equiv_harmonious_max_perc-B_equiv_harmonious_min_perc)*($AU6-B_equiv_harmonious_min_perc))/El_boiler_eff)/BESS_chrg_eff)-($AK6+($AL6-$AK6)/(B_equiv_harmonious_max_perc-B_equiv_harmonious_min_perc)*($AU6-B_equiv_harmonious_min_perc)))*El_boiler_eff-($AM6+($AN6-$AM6)/(B_equiv_harmonious_max_perc-B_equiv_harmonious_min_perc)*($AU6-B_equiv_harmonious_min_perc))", "JO" : "=$DH6+($DE6+$DK6-MIN($DN6,($DC6+$AA6+$AC6/El_boiler_eff)/BESS_chrg_eff)-$AK6)*El_boiler_eff-$AM6", "JP" : "=$DI6+$DT6*El_boiler_eff-$AC6", "JQ" : "=$DI6+$DT6*El_boiler_eff-($AC6+($AD6-$AC6)/(B_equiv_harmonious_max_perc-B_equiv_harmonious_min_perc)*($AU6-B_equiv_harmonious_min_perc))", "JR" : "=$DI6+$DT6*El_boiler_eff-$AC6", "JS" : "=$DR6-MAX(0,$AM6-$DG6)/El_boiler_eff", "JT" : "=$DR6-MAX(0,($AM6+($AN6-$AM6)/(B_equiv_harmonious_max_perc-B_equiv_harmonious_min_perc)*($AU6-B_equiv_harmonious_min_perc))-$DG6)/El_boiler_eff", "JU" : "=$DS6-MAX(0,$AM6-$DH6)/El_boiler_eff", "JV" : "=$DT6-MAX(0,$AC6-$DI6)/El_boiler_eff", "JW" : "=$DT6-MAX(0,($AC6+($AD6-$AC6)/(B_equiv_harmonious_max_perc-B_equiv_harmonious_min_perc)*($AU6-B_equiv_harmonious_min_perc))-$DI6)/El_boiler_eff", "JX" : "=$DT6-MAX(0,$AC6-$DI6)/El_boiler_eff", "JY" : "=$DU6-$AE6", "JZ" : "=$DU6-($AE6+($AF6-$AE6)/(B_equiv_harmonious_max_perc-B_equiv_harmonious_min_perc)*($AU6-B_equiv_harmonious_min_perc))", "KA" : "=$DV6-$AE6", "KB" : "=$DX6-$AG6", "KC" : "=$DX6-($AG6+($AH6-$AG6)/(B_equiv_harmonious_max_perc-B_equiv_harmonious_min_perc)*($AU6-B_equiv_harmonious_min_perc))", "KD" : "=$DY6-$AG6", "KE" : "=$EA6-$AI6", "KF" : "=$EA6-($AI6+($AJ6-$AI6)/(B_equiv_harmonious_max_perc-B_equiv_harmonious_min_perc)*($AU6-B_equiv_harmonious_min_perc))", "KG" : "=$EB6-$AI6",  "KI" : "=IF(OR(JG6<0,JJ6<0,JM6<0,JP6<0,JS6<0,JV6<0,JY6<0,KB6<0,KE6<0),0,MIN(1,Overall_harmonious_min_perc+MIN(IFERROR(JG6/MAX(0,JG6-JI6),1),IFERROR(JJ6/MAX(0,JJ6-JL6),1),IFERROR(JM6/MAX(0,JM6-JO6),1),IFERROR(JP6/MAX(0,JP6-JR6),1),IFERROR(JS6/MAX(0,JS6-JU6),1),IFERROR(JV6/MAX(0,JV6-JX6),1),IFERROR(JY6/MAX(0,JY6-KA6),1),IFERROR(KB6/MAX(0,KB6-KD6),1),IFERROR(KE6/MAX(0,KE6-KG6),1))*(Overall_harmonious_max_perc-Overall_harmonious_min_perc)))", "KJ" : "=IF(KI6=0,0,ROUND(($DD6+($DE6-$DD6)/(Overall_harmonious_max_perc-Overall_harmonious_min_perc)*(KI6-Overall_harmonious_min_perc))+($DJ6+($DK6-$DJ6)/(Overall_harmonious_max_perc-Overall_harmonious_min_perc)*(KI6-Overall_harmonious_min_perc))-$AK6-MIN($DM6+($DN6-$DM6)/(Overall_harmonious_max_perc-Overall_harmonious_min_perc)*(UM6-Overall_harmonious_min_perc),($DC6+$AA6+$AC6/El_boiler_eff)/BESS_chrg_eff)-MAX(0,$AM6-($DG6+($DH6-$DG6)/(Overall_harmonious_max_perc-Overall_harmonious_min_perc)*(KI6-Overall_harmonious_min_perc)))/El_boiler_eff,5))", "KK" : "=IF(KI6=0,0,ROUND(($DD6+($DE6-$DD6)/(Overall_harmonious_max_perc-Overall_harmonious_min_perc)*(KI6-Overall_harmonious_min_perc))+($DJ6+($DK6-$DJ6)/(Overall_harmonious_max_perc-Overall_harmonious_min_perc)*(KI6-Overall_harmonious_min_perc))-($AK6+($AL6-$AK6)/(B_equiv_harmonious_max_perc-B_equiv_harmonious_min_perc)*($AU6-B_equiv_harmonious_min_perc))-MIN($DM6+($DN6-$DM6)/(Overall_harmonious_max_perc-Overall_harmonious_min_perc)*(UM6-Overall_harmonious_min_perc),($DC6+($AA6+($AB6-$AA6)/(B_equiv_harmonious_max_perc-B_equiv_harmonious_min_perc)*($AU6-B_equiv_harmonious_min_perc))+($AC6+($AD6-$AC6)/(B_equiv_harmonious_max_perc-B_equiv_harmonious_min_perc)*($AU6-B_equiv_harmonious_min_perc))/El_boiler_eff)/BESS_chrg_eff)-MAX(0,($AM6+($AN6-$AM6)/(B_equiv_harmonious_max_perc-B_equiv_harmonious_min_perc)*($AU6-B_equiv_harmonious_min_perc))-($DG6+($DH6-$DG6)/(Overall_harmonious_max_perc-Overall_harmonious_min_perc)*(KI6-Overall_harmonious_min_perc)))/El_boiler_eff,5))", "KL" : "=IF(KI6=0,0,ROUND((($DM6+($DN6-$DM6)/(Overall_harmonious_max_perc-Overall_harmonious_min_perc)*(KI6-Overall_harmonious_min_perc))+$DO6)*BESS_chrg_eff+$DL6-$AA6-$AC6/El_boiler_eff,5))", "KM" : "=IF(KI6=0,0,ROUND((($DM6+($DN6-$DM6)/(Overall_harmonious_max_perc-Overall_harmonious_min_perc)*(KI6-Overall_harmonious_min_perc))+$DO6)*BESS_chrg_eff+$DL6-($AA6+($AB6-$AA6)/(B_equiv_harmonious_max_perc-B_equiv_harmonious_min_perc)*($AU6-B_equiv_harmonious_min_perc))-($AC6+($AD6-$AC6)/(B_equiv_harmonious_max_perc-B_equiv_harmonious_min_perc)*($AU6-B_equiv_harmonious_min_perc))/El_boiler_eff,5))", "KN" : "=IF(KI6=0,0,ROUND(($DG6+($DH6-$DG6)/(Overall_harmonious_max_perc-Overall_harmonious_min_perc)*(KI6-Overall_harmonious_min_perc))+(($DD6+($DE6-$DD6)/(Overall_harmonious_max_perc-Overall_harmonious_min_perc)*(KI6-Overall_harmonious_min_perc))+($DJ6+($DK6-$DJ6)/(Overall_harmonious_max_perc-Overall_harmonious_min_perc)*(KI6-Overall_harmonious_min_perc))-MIN($DM6+($DN6-$DM6)/(Overall_harmonious_max_perc-Overall_harmonious_min_perc)*(UM6-Overall_harmonious_min_perc),($DC6+$AA6+$AC6/El_boiler_eff)/BESS_chrg_eff)-$AK6)*El_boiler_eff-$AM6,5))", "KO" : "=IF(KI6=0,0,ROUND(($DG6+($DH6-$DG6)/(Overall_harmonious_max_perc-Overall_harmonious_min_perc)*(KI6-Overall_harmonious_min_perc))+(($DD6+($DE6-$DD6)/(Overall_harmonious_max_perc-Overall_harmonious_min_perc)*(KI6-Overall_harmonious_min_perc))+($DJ6+($DK6-$DJ6)/(Overall_harmonious_max_perc-Overall_harmonious_min_perc)*(KI6-Overall_harmonious_min_perc))-MIN($DM6+($DN6-$DM6)/(Overall_harmonious_max_perc-Overall_harmonious_min_perc)*(UM6-Overall_harmonious_min_perc),($DC6+($AA6+($AB6-$AA6)/(B_equiv_harmonious_max_perc-B_equiv_harmonious_min_perc)*($AU6-B_equiv_harmonious_min_perc))+($AC6+($AD6-$AC6)/(B_equiv_harmonious_max_perc-B_equiv_harmonious_min_perc)*($AU6-B_equiv_harmonious_min_perc))/El_boiler_eff)/BESS_chrg_eff)-($AK6+($AL6-$AK6)/(B_equiv_harmonious_max_perc-B_equiv_harmonious_min_perc)*($AU6-B_equiv_harmonious_min_perc)))*El_boiler_eff-($AM6+($AN6-$AM6)/(B_equiv_harmonious_max_perc-B_equiv_harmonious_min_perc)*($AU6-B_equiv_harmonious_min_perc)),5))", "KP" : "=IF(KI6=0,0,ROUND($DI6+$DT6*El_boiler_eff-$AC6,5))", "KQ" : "=IF(KI6=0,0,ROUND($DI6+$DT6*El_boiler_eff-($AC6+($AD6-$AC6)/(B_equiv_harmonious_max_perc-B_equiv_harmonious_min_perc)*($AU6-B_equiv_harmonious_min_perc)),5))", "KR" : "=IF(KI6=0,0,ROUND(($DR6+($DS6-$DR6)/(Overall_harmonious_max_perc-Overall_harmonious_min_perc)*(KI6-Overall_harmonious_min_perc))-MAX(0,$AM6-($DG6+($DH6-$DG6)/(Overall_harmonious_max_perc-Overall_harmonious_min_perc)*(KI6-Overall_harmonious_min_perc)))/El_boiler_eff,5))", "KS" : "=IF(KI6=0,0,ROUND(($DR6+($DS6-$DR6)/(Overall_harmonious_max_perc-Overall_harmonious_min_perc)*(KI6-Overall_harmonious_min_perc))-MAX(0,($AM6+($AN6-$AM6)/(B_equiv_harmonious_max_perc-B_equiv_harmonious_min_perc)*($AU6-B_equiv_harmonious_min_perc))-($DG6+($DH6-$DG6)/(Overall_harmonious_max_perc-Overall_harmonious_min_perc)*(KI6-Overall_harmonious_min_perc)))/El_boiler_eff,5))", "KT" : "=IF(KI6=0,0,ROUND($DT6-MAX(0,$AC6-$DI6)/El_boiler_eff,5))", "KU" : "=IF(KI6=0,0,ROUND($DT6-MAX(0,($AC6+($AD6-$AC6)/(B_equiv_harmonious_max_perc-B_equiv_harmonious_min_perc)*($AU6-B_equiv_harmonious_min_perc))-$DI6)/El_boiler_eff,5))", "KV" : "=IF(KI6=0,0,ROUND(($DU6+($DV6-$DU6)/(Overall_harmonious_max_perc-Overall_harmonious_min_perc)*(KI6-Overall_harmonious_min_perc))-$AE6,5))", "KW" : "=IF(KI6=0,0,ROUND(($DU6+($DV6-$DU6)/(Overall_harmonious_max_perc-Overall_harmonious_min_perc)*(KI6-Overall_harmonious_min_perc))-($AE6+($AF6-$AE6)/(B_equiv_harmonious_max_perc-B_equiv_harmonious_min_perc)*($AU6-B_equiv_harmonious_min_perc)),5))", "KX" : "=IF(KI6=0,0,ROUND(($DX6+($DY6-$DX6)/(Overall_harmonious_max_perc-Overall_harmonious_min_perc)*(KI6-Overall_harmonious_min_perc))-$AG6,5))", "KY" : "=IF(KI6=0,0,ROUND(($DX6+($DY6-$DX6)/(Overall_harmonious_max_perc-Overall_harmonious_min_perc)*(KI6-Overall_harmonious_min_perc))-($AG6+($AH6-$AG6)/(B_equiv_harmonious_max_perc-B_equiv_harmonious_min_perc)*($AU6-B_equiv_harmonious_min_perc)),5))", "KZ" : "=IF(KI6=0,0,ROUND(($EA6+($EB6-$EA6)/(Overall_harmonious_max_perc-Overall_harmonious_min_perc)*(KI6-Overall_harmonious_min_perc))-$AI6,5))", "LA" : "=IF(KI6=0,0,ROUND(($EA6+($EB6-$EA6)/(Overall_harmonious_max_perc-Overall_harmonious_min_perc)*(KI6-Overall_harmonious_min_perc))-($AI6+($AJ6-$AI6)/(B_equiv_harmonious_max_perc-B_equiv_harmonious_min_perc)*($AU6-B_equiv_harmonious_min_perc)),5))", "LB" : "=IF(OR(KI6=0,KJ6<0,KL6<0,KN6<0,KP6<0,KR6<0,KT6<0,KV6<0,KX6<0,KZ6<0),0,MIN(1,B_equiv_harmonious_min_perc+MIN(IF(KK6>=0,1,KJ6/(KJ6-KK6)),IF(KM6>=0,1,KL6/(KL6-KM6)),IF(KO6>=0,1,KN6/(KN6-KO6)),IF(KQ6>=0,1,KP6/(KP6-KQ6)),IF(KS6>=0,1,KR6/(KR6-KS6)),IF(KU6>=0,1,KT6/(KT6-KU6)),IF(KW6>=0,1,KV6/(KV6-KW6)),IF(KY6>=0,1,KX6/(KX6-KY6)),IF(LA6>=0,1,KZ6/(KZ6-LA6)))*(B_equiv_harmonious_max_perc*$AU6-B_equiv_harmonious_min_perc)))",  "LD" : "=IF(OR(JG6<0,JJ6<0,JM6<0,JP6<0,JS6<0,JV6<0,JY6<0,KB6<0,KE6<0),0,MIN(1,B_equiv_harmonious_min_perc+MIN(IF(JH6>=0,1,JG6/(JG6-JH6)),IF(JK6>=0,1,JJ6/(JJ6-JK6)),IF(JN6>=0,1,JM6/(JM6-JN6)),IF(JQ6>=0,1,JP6/(JP6-JQ6)),IF(JT6>=0,1,JS6/(JS6-JT6)),IF(JW6>=0,1,JV6/(JV6-JW6)),IF(JZ6>=0,1,JY6/(JY6-JZ6)),IF(KC6>=0,1,KB6/(KB6-KC6)),IF(KF6>=0,1,KE6/(KE6-KF6)))*(B_equiv_harmonious_max_perc*$AU6-B_equiv_harmonious_min_perc)))", "LE" : "=IF(LD6=0,0,ROUND($DD6+$DJ6-($AK6+($AL6-$AK6)/(B_equiv_harmonious_max_perc-B_equiv_harmonious_min_perc)*(LD6-B_equiv_harmonious_min_perc))-MIN($DM6,($DC6+($AA6+($AB6-$AA6)/(B_equiv_harmonious_max_perc-B_equiv_harmonious_min_perc)*(LD6-B_equiv_harmonious_min_perc))+($AC6+($AD6-$AC6)/(B_equiv_harmonious_max_perc-B_equiv_harmonious_min_perc)*(LD6-B_equiv_harmonious_min_perc))/El_boiler_eff)/BESS_chrg_eff)-MAX(0,($AM6+($AN6-$AM6)/(B_equiv_harmonious_max_perc-B_equiv_harmonious_min_perc)*(LD6-B_equiv_harmonious_min_perc))-$DG6)/El_boiler_eff,5))", "LF" : "=IF(LD6=0,0,ROUND($DE6+$DK6-($AK6+($AL6-$AK6)/(B_equiv_harmonious_max_perc-B_equiv_harmonious_min_perc)*(LD6-B_equiv_harmonious_min_perc))-MIN($DN6,($DC6+($AA6+($AB6-$AA6)/(B_equiv_harmonious_max_perc-B_equiv_harmonious_min_perc)*(LD6-B_equiv_harmonious_min_perc))+($AC6+($AD6-$AC6)/(B_equiv_harmonious_max_perc-B_equiv_harmonious_min_perc)*(LD6-B_equiv_harmonious_min_perc))/El_boiler_eff)/BESS_chrg_eff)-MAX(0,($AM6+($AN6-$AM6)/(B_equiv_harmonious_max_perc-B_equiv_harmonious_min_perc)*(LD6-B_equiv_harmonious_min_perc))-$DH6)/El_boiler_eff,5))", "LG" : "=IF(LD6=0,0,ROUND(($DM6+$DO6)*BESS_chrg_eff+$DL6-($AA6+($AB6-$AA6)/(B_equiv_harmonious_max_perc-B_equiv_harmonious_min_perc)*(LD6-B_equiv_harmonious_min_perc))-($AC6+($AD6-$AC6)/(B_equiv_harmonious_max_perc-B_equiv_harmonious_min_perc)*(LD6-B_equiv_harmonious_min_perc))/El_boiler_eff,5))", "LH" : "=IF(LD6=0,0,ROUND(($DN6+$DO6)*BESS_chrg_eff+$DL6-($AA6+($AB6-$AA6)/(B_equiv_harmonious_max_perc-B_equiv_harmonious_min_perc)*(LD6-B_equiv_harmonious_min_perc))-($AC6+($AD6-$AC6)/(B_equiv_harmonious_max_perc-B_equiv_harmonious_min_perc)*(LD6-B_equiv_harmonious_min_perc))/El_boiler_eff,5))", "LI" : "=IF(LD6=0,0,ROUND($DG6+($DD6+$DJ6-MIN(DM6,($DC6+($AA6+($AB6-$AA6)/(B_equiv_harmonious_max_perc-B_equiv_harmonious_min_perc)*(LD6-B_equiv_harmonious_min_perc))+($AC6+($AD6-$AC6)/(B_equiv_harmonious_max_perc-B_equiv_harmonious_min_perc)*(LD6-B_equiv_harmonious_min_perc))/El_boiler_eff)/BESS_chrg_eff)-($AK6+($AL6-$AK6)/(B_equiv_harmonious_max_perc-B_equiv_harmonious_min_perc)*(LD6-B_equiv_harmonious_min_perc)))*El_boiler_eff-($AM6+($AN6-$AM6)/(B_equiv_harmonious_max_perc-B_equiv_harmonious_min_perc)*(LD6-B_equiv_harmonious_min_perc)),5))", "LJ" : "=IF(LD6=0,0,ROUND($DH6+($DE6+$DK6-MIN(DN6,($DC6+($AA6+($AB6-$AA6)/(B_equiv_harmonious_max_perc-B_equiv_harmonious_min_perc)*(LD6-B_equiv_harmonious_min_perc))+($AC6+($AD6-$AC6)/(B_equiv_harmonious_max_perc-B_equiv_harmonious_min_perc)*(LD6-B_equiv_harmonious_min_perc))/El_boiler_eff)/BESS_chrg_eff)-($AK6+($AL6-$AK6)/(B_equiv_harmonious_max_perc-B_equiv_harmonious_min_perc)*(LD6-B_equiv_harmonious_min_perc)))*El_boiler_eff-($AM6+($AN6-$AM6)/(B_equiv_harmonious_max_perc-B_equiv_harmonious_min_perc)*(LD6-B_equiv_harmonious_min_perc)),5))", "LK" : "=IF(LD6=0,0,ROUND($DI6+$DT6*El_boiler_eff-($AC6+($AD6-$AC6)/(B_equiv_harmonious_max_perc-B_equiv_harmonious_min_perc)*(LD6-B_equiv_harmonious_min_perc)),5))", "LL" : "=IF(LD6=0,0,ROUND($DI6+$DT6*El_boiler_eff-($AC6+($AD6-$AC6)/(B_equiv_harmonious_max_perc-B_equiv_harmonious_min_perc)*(LD6-B_equiv_harmonious_min_perc)),5))", "LM" : "=IF(LD6=0,0,ROUND($DR6-MAX(0,($AM6+($AN6-$AM6)/(B_equiv_harmonious_max_perc-B_equiv_harmonious_min_perc)*(LD6-B_equiv_harmonious_min_perc))-$DG6)/El_boiler_eff,5))", "LN" : "=IF(LD6=0,0,ROUND($DS6-MAX(0,($AM6+($AN6-$AM6)/(B_equiv_harmonious_max_perc-B_equiv_harmonious_min_perc)*(LD6-B_equiv_harmonious_min_perc))-$DH6)/El_boiler_eff,5))", "LO" : "=IF(LD6=0,0,ROUND($DT6-MAX(0,($AC6+($AD6-$AC6)/(B_equiv_harmonious_max_perc-B_equiv_harmonious_min_perc)*(LD6-B_equiv_harmonious_min_perc))-$DI6)/El_boiler_eff,5))", "LP" : "=IF(LD6=0,0,ROUND($DT6-MAX(0,($AC6+($AD6-$AC6)/(B_equiv_harmonious_max_perc-B_equiv_harmonious_min_perc)*(LD6-B_equiv_harmonious_min_perc))-$DI6)/El_boiler_eff,5))", "LQ" : "=IF(LD6=0,0,ROUND($DU6-($AE6+($AF6-$AE6)/(B_equiv_harmonious_max_perc-B_equiv_harmonious_min_perc)*(LD6-B_equiv_harmonious_min_perc)),5))", "LR" : "=IF(LD6=0,0,ROUND($DV6-($AE6+($AF6-$AE6)/(B_equiv_harmonious_max_perc-B_equiv_harmonious_min_perc)*(LD6-B_equiv_harmonious_min_perc)),5))", "LS" : "=IF(LD6=0,0,ROUND($DX6-($AG6+($AH6-$AG6)/(B_equiv_harmonious_max_perc-B_equiv_harmonious_min_perc)*(LD6-B_equiv_harmonious_min_perc)),5))", "LT" : "=IF(LD6=0,0,ROUND($DY6-($AG6+($AH6-$AG6)/(B_equiv_harmonious_max_perc-B_equiv_harmonious_min_perc)*(LD6-B_equiv_harmonious_min_perc)),5))", "LU" : "=IF(LD6=0,0,ROUND($EA6-($AI6+($AJ6-$AI6)/(B_equiv_harmonious_max_perc-B_equiv_harmonious_min_perc)*(LD6-B_equiv_harmonious_min_perc)),5))", "LV" : "=IF(LD6=0,0,ROUND($EB6-($AI6+($AJ6-$AI6)/(B_equiv_harmonious_max_perc-B_equiv_harmonious_min_perc)*(LD6-B_equiv_harmonious_min_perc)),5))", "LW" : "=IF(LD6<=0,0,MIN(1,Overall_harmonious_min_perc+MIN(IF(LF6>=0,1,LE6/(LE6-LF6)),IF(LH6>=0,1,LG6/(LG6-LH6)),IF(LJ6>=0,1,LI6/(LI6-LJ6)),IF(LL6>=0,1,LK6/(LK6-LL6)),IF(LN6>=0,1,LM6/(LM6-LN6)),IF(LP6>=0,1,LO6/(LO6-LP6)),IF(LR6>=0,1,LQ6/(LQ6-LR6)),IF(LT6>=0,1,LS6/(LS6-LT6)),IF(LV6>=0,1,LU6/(LU6-LV6)))*(Overall_harmonious_max_perc-Overall_harmonious_min_perc)))",  "LY" : "=IF(KI6=0,0,$CT6+($CU6-$CT6)/(Overall_harmonious_max_perc-Overall_harmonious_min_perc)*(KI6-Overall_harmonious_min_perc))", "LZ" : "=IF(LB6=0,0,($AK6+($AL6-$AK6)/(B_equiv_harmonious_max_perc-B_equiv_harmonious_min_perc)*(LB6-B_equiv_harmonious_min_perc)))", "MA" : "=IF(OR(KI6=0,LB6=0),0,MIN(($DC6+($AA6+($AB6-$AA6)/(B_equiv_harmonious_max_perc-B_equiv_harmonious_min_perc)*(LB6-B_equiv_harmonious_min_perc))+MAX(0,($AC6+($AD6-$AC6)/(B_equiv_harmonious_max_perc-B_equiv_harmonious_min_perc)*(LB6-B_equiv_harmonious_min_perc))-$DI6)/El_boiler_eff-$DF6)/BESS_chrg_eff,($DM6+($DN6-$DM6)/(Overall_harmonious_max_perc-Overall_harmonious_min_perc)*(KI6-Overall_harmonious_min_perc))-$DO6))", "MB" : "=IF(KI6=0,0,$DP6+($DQ6-$DP6)/(Overall_harmonious_max_perc-Overall_harmonious_min_perc)*(KI6-Overall_harmonious_min_perc))", "MC" : "=ML6/El_boiler_eff", "MD" : "=IF(KI6=0,0,$DD6+($DE6-$DD6)/(Overall_harmonious_max_perc-Overall_harmonious_min_perc)*(KI6-Overall_harmonious_min_perc))", "ME" : "=IF(KI6=0,0,$DA6+($DB6-$DA6)/(Overall_harmonious_max_perc-Overall_harmonious_min_perc)*(KI6-Overall_harmonious_min_perc))", "MF" : "=IF(KI6=0,0,MIN($DJ6+($DK6-$DJ6)/(Overall_harmonious_max_perc-Overall_harmonious_min_perc)*(KI6-Overall_harmonious_min_perc),MAX(0,-(MD6-LZ6-MA6-MC6))))", "MG" : "=MD6+MF6-SUM(LZ6:MA6,MC6)", "MH" : "=IF(KI6=0,0,$CV6+($CW6-$CV6)/(Overall_harmonious_max_perc-Overall_harmonious_min_perc)*(KI6-Overall_harmonious_min_perc))", "MI" : "=IF(LB6=0,0,($AM6+($AN6-$AM6)/(B_equiv_harmonious_max_perc-B_equiv_harmonious_min_perc)*(LB6-B_equiv_harmonious_min_perc)))", "MJ" : "=IF(KI6=0,0,$DG6+($DH6-$DG6)/(Overall_harmonious_max_perc-Overall_harmonious_min_perc)*(KI6-Overall_harmonious_min_perc))", "MK" : "=IF(KI6=0,0,($DP6+($DQ6-$DP6)/(Overall_harmonious_max_perc-Overall_harmonious_min_perc)*(KI6-Overall_harmonious_min_perc))*El_boiler_eff)", "ML" : "=IF(KI6=0,0,MIN(($DR6+($DS6-$DR6)/(Overall_harmonious_max_perc-Overall_harmonious_min_perc)*(KI6-Overall_harmonious_min_perc))*El_boiler_eff,MAX(0,MI6-MJ6)))", "MM" : "=MJ6+ML6-MI6", "MN" : "=IF(OR(KI6=0,LB6=0),0,$AA6+($AB6-$AA6)/(B_equiv_harmonious_max_perc-B_equiv_harmonious_min_perc)*(LB6-B_equiv_harmonious_min_perc))", "MO" : "=MW6/El_boiler_eff", "MP" : "=IF(OR(KI6=0,LB6=0),0,$DC6)", "MQ" : "=IF(OR(KI6=0,LB6=0),0,$DF6)", "MR" : "=MA6*BESS_chrg_eff", "MS" : "=IF(OR(KI6=0,LB6=0),0,MIN($DL6+$DC6,MAX(0,-(SUM(MQ6:MR6)-SUM(MN6:MP6)))))", "MT" : "=SUM(MQ6:MS6)-SUM(MN6:MP6)", "MU" : "=IF(OR(KI6=0,LB6=0),0,$AC6+($AD6-$AC6)/(B_equiv_harmonious_max_perc-B_equiv_harmonious_min_perc)*(LB6-B_equiv_harmonious_min_perc))", "MV" : "=IF(OR(KI6=0,LB6=0),0,$DI6)", "MW" : "=IF(OR(KI6=0,LB6=0),0,MIN($DT6*El_boiler_eff,MAX(0,MU6-MV6)))", "MX" : "=SUM(MV6:MW6)-MU6", "MY" : "=IF(LY6<=0,0,LY6/(Overall_harmonious_var_max_cons+Overall_fix_cons)*MethDist_harmonious_max_perc*MethDist_Meth_nom_prod_ud)+IF(MN6<=0,0,MN6/(B_overall_var_max_cons+B_overall_fix_stby_cons)*B_MethDist_max_perc*MethDist_Meth_nom_prod_ud)", "MZ" : "=MIN(MG6,IF(OR(KI6=0,LB6=0),0,($CX6+($CY6-$CX6)/(Overall_harmonious_max_perc-Overall_harmonious_min_perc)*(KI6-Overall_harmonious_min_perc))))+MIN(MT6,IF(OR(KI6=0,LB6=0),0,$CZ6))", "NA" : "=ME6+MF6+MS6", "NB" : "=MAX(0,-MG6)+MAX(0,-MM6)+MAX(0,-MT6)+MAX(0,-MX6)",  "ND" : "=IF(LW6=0,0,$CT6+($CU6-$CT6)/(Overall_harmonious_max_perc-Overall_harmonious_min_perc)*(LW6-Overall_harmonious_min_perc))", "NE" : "=IF(LD6=0,0,($AK6+($AL6-$AK6)/(B_equiv_harmonious_max_perc-B_equiv_harmonious_min_perc)*(LD6-B_equiv_harmonious_min_perc)))", "NF" : "=IF(OR(LW6=0,LD6=0),0,MIN(($DC6+($AA6+($AB6-$AA6)/(B_equiv_harmonious_max_perc-B_equiv_harmonious_min_perc)*(LD6-B_equiv_harmonious_min_perc))+MAX(0,($AC6+($AD6-$AC6)/(B_equiv_harmonious_max_perc-B_equiv_harmonious_min_perc)*(LD6-B_equiv_harmonious_min_perc))-$DI6)/El_boiler_eff-$DF6)/BESS_chrg_eff,($DM6+($DN6-$DM6)/(Overall_harmonious_max_perc-Overall_harmonious_min_perc)*(LW6-Overall_harmonious_min_perc))-$DO6))", "NG" : "=IF(LW6=0,0,$DP6+($DQ6-$DP6)/(Overall_harmonious_max_perc-Overall_harmonious_min_perc)*(LW6-Overall_harmonious_min_perc))", "NH" : "=NQ6/El_boiler_eff", "NI" : "=IF(LW6=0,0,$DD6+($DE6-$DD6)/(Overall_harmonious_max_perc-Overall_harmonious_min_perc)*(LW6-Overall_harmonious_min_perc))", "NJ" : "=IF(LW6=0,0,$DA6+($DB6-$DA6)/(Overall_harmonious_max_perc-Overall_harmonious_min_perc)*(LW6-Overall_harmonious_min_perc))", "NK" : "=IF(LW6=0,0,MIN($DJ6+($DK6-$DJ6)/(Overall_harmonious_max_perc-Overall_harmonious_min_perc)*(LW6-Overall_harmonious_min_perc),MAX(0,-(NI6-NE6-NF6-NH6))))", "NL" : "=NI6+NK6-SUM(NE6:NF6,NH6)", "NM" : "=IF(LW6=0,0,$CV6+($CW6-$CV6)/(Overall_harmonious_max_perc-Overall_harmonious_min_perc)*(LW6-Overall_harmonious_min_perc))", "NN" : "=IF(LD6=0,0,($AM6+($AN6-$AM6)/(B_equiv_harmonious_max_perc-B_equiv_harmonious_min_perc)*(LD6-B_equiv_harmonious_min_perc)))", "NO" : "=IF(LW6=0,0,$DG6+($DH6-$DG6)/(Overall_harmonious_max_perc-Overall_harmonious_min_perc)*(LW6-Overall_harmonious_min_perc))", "NP" : "=IF(LW6=0,0,($DP6+($DQ6-$DP6)/(Overall_harmonious_max_perc-Overall_harmonious_min_perc)*(LW6-Overall_harmonious_min_perc))*El_boiler_eff)", "NQ" : "=IF(LW6=0,0,MIN(($DR6+($DS6-$DR6)/(Overall_harmonious_max_perc-Overall_harmonious_min_perc)*(LW6-Overall_harmonious_min_perc))*El_boiler_eff,MAX(0,NN6-NO6)))", "NR" : "=NO6+NQ6-NN6", "NS" : "=IF(OR(LW6=0,LD6=0),0,$AA6+($AB6-$AA6)/(B_equiv_harmonious_max_perc-B_equiv_harmonious_min_perc)*(LD6-B_equiv_harmonious_min_perc))", "NT" : "=OB6/El_boiler_eff", "NU" : "=IF(OR(LW6=0,LD6=0),0,$DC6)", "NV" : "=IF(OR(LW6=0,LD6=0),0,$DF6)", "NW" : "=NF6*BESS_chrg_eff", "NX" : "=IF(OR(LW6=0,LD6=0),0,MIN($DL6+$DC6,MAX(0,-(SUM(NV6:NW6)-SUM(NS6:NU6)))))", "NY" : "=SUM(NV6:NX6)-SUM(NS6:NU6)", "NZ" : "=IF(OR(LW6=0,LD6=0),0,$AC6+($AD6-$AC6)/(B_equiv_harmonious_max_perc-B_equiv_harmonious_min_perc)*(LD6-B_equiv_harmonious_min_perc))", "OA" : "=IF(OR(LW6=0,LD6=0),0,$DI6)", "OB" : "=IF(OR(LW6=0,LD6=0),0,MIN($DT6*El_boiler_eff,MAX(0,NZ6-OA6)))", "OC" : "=SUM(OA6:OB6)-NZ6", "OD" : "=IF(ND6<=0,0,ND6/(Overall_harmonious_var_max_cons+Overall_fix_cons)*MethDist_harmonious_max_perc*MethDist_Meth_nom_prod_ud)+IF(NS6<=0,0,NS6/(B_overall_var_max_cons+B_overall_fix_stby_cons)*B_MethDist_max_perc*MethDist_Meth_nom_prod_ud)", "OE" : "=MIN(NL6,IF(OR(LW6=0,LD6=0),0,($CX6+($CY6-$CX6)/(Overall_harmonious_max_perc-Overall_harmonious_min_perc)*(LW6-Overall_harmonious_min_perc))))+MIN(NY6,IF(OR(LW6=0,LD6=0),0,$CZ6))", "OF" : "=NJ6+NK6+NX6", "OG" : "=MAX(0,-NL6)+MAX(0,-NR6)+MAX(0,-NY6)+MAX(0,-OC6)",  "OI" : "=$DD6+$DJ6-$BG6-MIN($DM6,($DC6+$AW6+$AY6/El_boiler_eff)/BESS_chrg_eff)-MAX(0,$BI6-$DG6)/El_boiler_eff", "OJ" : "=$DD6+$DJ6-($BG6+($BH6-$BG6)/(C_equiv_harmonious_max_perc-C_equiv_harmonious_min_perc)*($BQ6-C_equiv_harmonious_min_perc))-MIN($DM6,($DC6+($AW6+($AX6-$AW6)/(C_equiv_harmonious_max_perc-C_equiv_harmonious_min_perc)*($BQ6-C_equiv_harmonious_min_perc))+($AY6+($AZ6-$AY6)/(C_equiv_harmonious_max_perc-C_equiv_harmonious_min_perc)*($BQ6-C_equiv_harmonious_min_perc))/El_boiler_eff)/BESS_chrg_eff)-MAX(0,($BI6+($BJ6-$BI6)/(C_equiv_harmonious_max_perc-C_equiv_harmonious_min_perc)*($BQ6-C_equiv_harmonious_min_perc))-$DG6)/El_boiler_eff", "OK" : "=$DE6+$DK6-$BG6-MIN($DN6,($DC6+$AW6+$AY6/El_boiler_eff)/BESS_chrg_eff)-MAX(0,$BI6-$DH6)/El_boiler_eff", "OL" : "=($DM6+$DO6)*BESS_chrg_eff+$DL6-$AW6-$AY6/El_boiler_eff", "OM" : "=($DM6+$DO6)*BESS_chrg_eff+$DL6-($AW6+($AX6-$AW6)/(C_equiv_harmonious_max_perc-C_equiv_harmonious_min_perc)*($BQ6-C_equiv_harmonious_min_perc))-($AY6+($AZ6-$AY6)/(C_equiv_harmonious_max_perc-C_equiv_harmonious_min_perc)*($BQ6-C_equiv_harmonious_min_perc))/El_boiler_eff", "ON" : "=($DN6+$DO6)*BESS_chrg_eff+$DL6-$AW6-$AY6/El_boiler_eff", "OO" : "=$DG6+($DD6+$DJ6-MIN($DM6,($DC6+$AW6+$AY6/El_boiler_eff)/BESS_chrg_eff)-$BG6)*El_boiler_eff-$BI6", "OP" : "=$DG6+($DD6+$DJ6-MIN($DM6,($DC6+($AW6+($AX6-$AW6)/(C_equiv_harmonious_max_perc-C_equiv_harmonious_min_perc)*($BQ6-C_equiv_harmonious_min_perc))+($AY6+($AZ6-$AY6)/(C_equiv_harmonious_max_perc-C_equiv_harmonious_min_perc)*($BQ6-C_equiv_harmonious_min_perc))/El_boiler_eff)/BESS_chrg_eff)-($BG6+($BH6-$BG6)/(C_equiv_harmonious_max_perc-C_equiv_harmonious_min_perc)*($BQ6-C_equiv_harmonious_min_perc)))*El_boiler_eff-($BI6+($BJ6-$BI6)/(C_equiv_harmonious_max_perc-C_equiv_harmonious_min_perc)*($BQ6-C_equiv_harmonious_min_perc))", "OQ" : "=$DH6+($DE6+$DK6-MIN($DN6,($DC6+$AW6+$AY6/El_boiler_eff)/BESS_chrg_eff)-$BG6)*El_boiler_eff-$BI6", "OR" : "=$DI6+$DT6*El_boiler_eff-$AY6", "OS" : "=$DI6+$DT6*El_boiler_eff-($AY6+($AZ6-$AY6)/(C_equiv_harmonious_max_perc-C_equiv_harmonious_min_perc)*($BQ6-C_equiv_harmonious_min_perc))", "OT" : "=$DI6+$DT6*El_boiler_eff-$AY6", "OU" : "=$DR6-MAX(0,$BI6-$DG6)/El_boiler_eff", "OV" : "=$DR6-MAX(0,($BI6+($BJ6-$BI6)/(C_equiv_harmonious_max_perc-C_equiv_harmonious_min_perc)*($BQ6-C_equiv_harmonious_min_perc))-$DG6)/El_boiler_eff", "OW" : "=$DR6-MAX(0,$BI6-$DG6)/El_boiler_eff", "OX" : "=$DT6-MAX(0,$AY6-$DI6)/El_boiler_eff", "OY" : "=$DT6-MAX(0,($AY6+($AZ6-$AY6)/(C_equiv_harmonious_max_perc-C_equiv_harmonious_min_perc)*($BQ6-C_equiv_harmonious_min_perc))-$DI6)/El_boiler_eff", "OZ" : "=$DT6-MAX(0,$AY6-$DI6)/El_boiler_eff", "PA" : "=$DU6-$BA6", "PB" : "=$DU6-($BA6+($BB6-$BA6)/(C_equiv_harmonious_max_perc-C_equiv_harmonious_min_perc)*($BQ6-C_equiv_harmonious_min_perc))", "PC" : "=$DV6-$BA6", "PD" : "=$DX6-$BC6", "PE" : "=$DX6-($BC6+($BD6-$BC6)/(C_equiv_harmonious_max_perc-C_equiv_harmonious_min_perc)*($BQ6-C_equiv_harmonious_min_perc))", "PF" : "=$DY6-$BC6", "PG" : "=$EA6-$BE6", "PH" : "=$EA6-($BE6+($BF6-$BE6)/(C_equiv_harmonious_max_perc-C_equiv_harmonious_min_perc)*($BQ6-C_equiv_harmonious_min_perc))", "PI" : "=$EB6-$BE6",  "PK" : "=IF(OR(OI6<0,OL6<0,OO6<0,OR6<0,OU6<0,OX6<0,PA6<0,PD6<0,PG6<0),0,MIN(1,Overall_harmonious_min_perc+MIN(IFERROR(OI6/MAX(0,OI6-OK6),1),IFERROR(OL6/MAX(0,OL6-ON6),1),IFERROR(OO6/MAX(0,OO6-OQ6),1),IFERROR(OR6/MAX(0,OR6-OT6),1),IFERROR(OU6/MAX(0,OU6-OW6),1),IFERROR(OX6/MAX(0,OX6-OZ6),1),IFERROR(PA6/MAX(0,PA6-PC6),1),IFERROR(PD6/MAX(0,PD6-PF6),1),IFERROR(PG6/MAX(0,PG6-PI6),1))*(Overall_harmonious_max_perc-Overall_harmonious_min_perc)))", "PL" : "=IF(PK6=0,0,ROUND(($DD6+($DE6-$DD6)/(Overall_harmonious_max_perc-Overall_harmonious_min_perc)*(PK6-Overall_harmonious_min_perc))+($DJ6+($DK6-$DJ6)/(Overall_harmonious_max_perc-Overall_harmonious_min_perc)*(PK6-Overall_harmonious_min_perc))-$BG6-MIN($DM6+($DN6-$DM6)/(Overall_harmonious_max_perc-Overall_harmonious_min_perc)*(UM6-Overall_harmonious_min_perc),($DC6+$AW6+$AY6/El_boiler_eff)/BESS_chrg_eff)-MAX(0,$BI6-($DG6+($DH6-$DG6)/(Overall_harmonious_max_perc-Overall_harmonious_min_perc)*(PK6-Overall_harmonious_min_perc)))/El_boiler_eff,5))", "PM" : "=IF(PK6=0,0,ROUND(($DD6+($DE6-$DD6)/(Overall_harmonious_max_perc-Overall_harmonious_min_perc)*(PK6-Overall_harmonious_min_perc))+($DJ6+($DK6-$DJ6)/(Overall_harmonious_max_perc-Overall_harmonious_min_perc)*(PK6-Overall_harmonious_min_perc))-($BG6+($BH6-$BG6)/(C_equiv_harmonious_max_perc-C_equiv_harmonious_min_perc)*($BQ6-C_equiv_harmonious_min_perc))-MIN($DM6+($DN6-$DM6)/(Overall_harmonious_max_perc-Overall_harmonious_min_perc)*(UM6-Overall_harmonious_min_perc),($DC6+($AW6+($AX6-$AW6)/(C_equiv_harmonious_max_perc-C_equiv_harmonious_min_perc)*($BQ6-C_equiv_harmonious_min_perc))+($AY6+($AZ6-$AY6)/(C_equiv_harmonious_max_perc-C_equiv_harmonious_min_perc)*($BQ6-C_equiv_harmonious_min_perc))/El_boiler_eff)/BESS_chrg_eff)-MAX(0,($BI6+($BJ6-$BI6)/(C_equiv_harmonious_max_perc-C_equiv_harmonious_min_perc)*($BQ6-C_equiv_harmonious_min_perc))-($DG6+($DH6-$DG6)/(Overall_harmonious_max_perc-Overall_harmonious_min_perc)*(PK6-Overall_harmonious_min_perc)))/El_boiler_eff,5))", "PN" : "=IF(PK6=0,0,ROUND((($DM6+($DN6-$DM6)/(Overall_harmonious_max_perc-Overall_harmonious_min_perc)*(PK6-Overall_harmonious_min_perc))+$DO6)*BESS_chrg_eff+$DL6-$AW6-$AY6/El_boiler_eff,5))", "PO" : "=IF(PK6=0,0,ROUND((($DM6+($DN6-$DM6)/(Overall_harmonious_max_perc-Overall_harmonious_min_perc)*(PK6-Overall_harmonious_min_perc))+$DO6)*BESS_chrg_eff+$DL6-($AW6+($AX6-$AW6)/(C_equiv_harmonious_max_perc-C_equiv_harmonious_min_perc)*($BQ6-C_equiv_harmonious_min_perc))-($AY6+($AZ6-$AY6)/(C_equiv_harmonious_max_perc-C_equiv_harmonious_min_perc)*($BQ6-C_equiv_harmonious_min_perc))/El_boiler_eff,5))", "PP" : "=IF(PK6=0,0,ROUND(($DG6+($DH6-$DG6)/(Overall_harmonious_max_perc-Overall_harmonious_min_perc)*(PK6-Overall_harmonious_min_perc))+(($DD6+($DE6-$DD6)/(Overall_harmonious_max_perc-Overall_harmonious_min_perc)*(PK6-Overall_harmonious_min_perc))+($DJ6+($DK6-$DJ6)/(Overall_harmonious_max_perc-Overall_harmonious_min_perc)*(PK6-Overall_harmonious_min_perc))-MIN($DM6+($DN6-$DM6)/(Overall_harmonious_max_perc-Overall_harmonious_min_perc)*(UM6-Overall_harmonious_min_perc),($DC6+$AW6+$AY6/El_boiler_eff)/BESS_chrg_eff)-$BG6)*El_boiler_eff-$BI6,5))", "PQ" : "=IF(PK6=0,0,ROUND(($DG6+($DH6-$DG6)/(Overall_harmonious_max_perc-Overall_harmonious_min_perc)*(PK6-Overall_harmonious_min_perc))+(($DD6+($DE6-$DD6)/(Overall_harmonious_max_perc-Overall_harmonious_min_perc)*(PK6-Overall_harmonious_min_perc))+($DJ6+($DK6-$DJ6)/(Overall_harmonious_max_perc-Overall_harmonious_min_perc)*(PK6-Overall_harmonious_min_perc))-MIN($DM6+($DN6-$DM6)/(Overall_harmonious_max_perc-Overall_harmonious_min_perc)*(UM6-Overall_harmonious_min_perc),($DC6+($AW6+($AX6-$AW6)/(C_equiv_harmonious_max_perc-C_equiv_harmonious_min_perc)*($BQ6-C_equiv_harmonious_min_perc))+($AY6+($AZ6-$AY6)/(C_equiv_harmonious_max_perc-C_equiv_harmonious_min_perc)*($BQ6-C_equiv_harmonious_min_perc))/El_boiler_eff)/BESS_chrg_eff)-($BG6+($BH6-$BG6)/(C_equiv_harmonious_max_perc-C_equiv_harmonious_min_perc)*($BQ6-C_equiv_harmonious_min_perc)))*El_boiler_eff-($BI6+($BJ6-$BI6)/(C_equiv_harmonious_max_perc-C_equiv_harmonious_min_perc)*($BQ6-C_equiv_harmonious_min_perc)),5))", "PR" : "=IF(PK6=0,0,ROUND($DI6+$DT6*El_boiler_eff-$AY6,5))", "PS" : "=IF(PK6=0,0,ROUND($DI6+$DT6*El_boiler_eff-($AY6+($AZ6-$AY6)/(C_equiv_harmonious_max_perc-C_equiv_harmonious_min_perc)*($BQ6-C_equiv_harmonious_min_perc)),5))", "PT" : "=IF(PK6=0,0,ROUND(($DR6+($DS6-$DR6)/(Overall_harmonious_max_perc-Overall_harmonious_min_perc)*(PK6-Overall_harmonious_min_perc))-MAX(0,$BI6-($DG6+($DH6-$DG6)/(Overall_harmonious_max_perc-Overall_harmonious_min_perc)*(PK6-Overall_harmonious_min_perc)))/El_boiler_eff,5))", "PU" : "=IF(PK6=0,0,ROUND(($DR6+($DS6-$DR6)/(Overall_harmonious_max_perc-Overall_harmonious_min_perc)*(PK6-Overall_harmonious_min_perc))-MAX(0,($BI6+($BJ6-$BI6)/(C_equiv_harmonious_max_perc-C_equiv_harmonious_min_perc)*($BQ6-C_equiv_harmonious_min_perc))-($DG6+($DH6-$DG6)/(Overall_harmonious_max_perc-Overall_harmonious_min_perc)*(PK6-Overall_harmonious_min_perc)))/El_boiler_eff,5))", "PV" : "=IF(PK6=0,0,ROUND($DT6-MAX(0,$AY6-$DI6)/El_boiler_eff,5))", "PW" : "=IF(PK6=0,0,ROUND($DT6-MAX(0,($AY6+($AZ6-$AY6)/(C_equiv_harmonious_max_perc-C_equiv_harmonious_min_perc)*($BQ6-C_equiv_harmonious_min_perc))-$DI6)/El_boiler_eff,5))", "PX" : "=IF(PK6=0,0,ROUND(($DU6+($DV6-$DU6)/(Overall_harmonious_max_perc-Overall_harmonious_min_perc)*(PK6-Overall_harmonious_min_perc))-$BA6,5))", "PY" : "=IF(PK6=0,0,ROUND(($DU6+($DV6-$DU6)/(Overall_harmonious_max_perc-Overall_harmonious_min_perc)*(PK6-Overall_harmonious_min_perc))-($BA6+($BB6-$BA6)/(C_equiv_harmonious_max_perc-C_equiv_harmonious_min_perc)*($BQ6-C_equiv_harmonious_min_perc)),5))", "PZ" : "=IF(PK6=0,0,ROUND(($DX6+($DY6-$DX6)/(Overall_harmonious_max_perc-Overall_harmonious_min_perc)*(PK6-Overall_harmonious_min_perc))-$BC6,5))", "QA" : "=IF(PK6=0,0,ROUND(($DX6+($DY6-$DX6)/(Overall_harmonious_max_perc-Overall_harmonious_min_perc)*(PK6-Overall_harmonious_min_perc))-($BC6+($BD6-$BC6)/(C_equiv_harmonious_max_perc-C_equiv_harmonious_min_perc)*($BQ6-C_equiv_harmonious_min_perc)),5))", "QB" : "=IF(PK6=0,0,ROUND(($EA6+($EB6-$EA6)/(Overall_harmonious_max_perc-Overall_harmonious_min_perc)*(PK6-Overall_harmonious_min_perc))-$BE6,5))", "QC" : "=IF(PK6=0,0,ROUND(($EA6+($EB6-$EA6)/(Overall_harmonious_max_perc-Overall_harmonious_min_perc)*(PK6-Overall_harmonious_min_perc))-($BE6+($BF6-$BE6)/(C_equiv_harmonious_max_perc-C_equiv_harmonious_min_perc)*($BQ6-C_equiv_harmonious_min_perc)),5))", "QD" : "=IF(OR(PK6=0,PL6<0,PN6<0,PP6<0,PR6<0,PT6<0,PV6<0,PX6<0,PZ6<0,QB6<0),0,MIN(1,C_equiv_harmonious_min_perc+MIN(IF(PM6>=0,1,PL6/(PL6-PM6)),IF(PO6>=0,1,PN6/(PN6-PO6)),IF(PQ6>=0,1,PP6/(PP6-PQ6)),IF(PS6>=0,1,PR6/(PR6-PS6)),IF(PU6>=0,1,PT6/(PT6-PU6)),IF(PW6>=0,1,PV6/(PV6-PW6)),IF(PY6>=0,1,PX6/(PX6-PY6)),IF(QA6>=0,1,PZ6/(PZ6-QA6)),IF(QC6>=0,1,QB6/(QB6-QC6)))*(C_equiv_harmonious_max_perc*$BQ6-C_equiv_harmonious_min_perc)))",  "QF" : "=IF(OR(OI6<0,OL6<0,OO6<0,OR6<0,OU6<0,OX6<0,PA6<0,PD6<0,PG6<0),0,MIN(1,C_equiv_harmonious_min_perc+MIN(IF(OJ6>=0,1,OI6/(OI6-OJ6)),IF(OM6>=0,1,OL6/(OL6-OM6)),IF(OP6>=0,1,OO6/(OO6-OP6)),IF(OS6>=0,1,OR6/(OR6-OS6)),IF(OV6>=0,1,OU6/(OU6-OV6)),IF(OY6>=0,1,OX6/(OX6-OY6)),IF(PB6>=0,1,PA6/(PA6-PB6)),IF(PE6>=0,1,PD6/(PD6-PE6)),IF(PH6>=0,1,PG6/(PG6-PH6)))*(C_equiv_harmonious_max_perc*$BQ6-C_equiv_harmonious_min_perc)))", "QG" : "=IF(QF6=0,0,ROUND($DD6+$DJ6-($BG6+($BH6-$BG6)/(C_equiv_harmonious_max_perc-C_equiv_harmonious_min_perc)*(QF6-C_equiv_harmonious_min_perc))-MIN($DM6,($DC6+($AW6+($AX6-$AW6)/(C_equiv_harmonious_max_perc-C_equiv_harmonious_min_perc)*(QF6-C_equiv_harmonious_min_perc))+($AY6+($AZ6-$AY6)/(C_equiv_harmonious_max_perc-C_equiv_harmonious_min_perc)*(QF6-C_equiv_harmonious_min_perc))/El_boiler_eff)/BESS_chrg_eff)-MAX(0,($BI6+($BJ6-$BI6)/(C_equiv_harmonious_max_perc-C_equiv_harmonious_min_perc)*(QF6-C_equiv_harmonious_min_perc))-$DG6)/El_boiler_eff,5))", "QH" : "=IF(QF6=0,0,ROUND($DE6+$DK6-($BG6+($BH6-$BG6)/(C_equiv_harmonious_max_perc-C_equiv_harmonious_min_perc)*(QF6-C_equiv_harmonious_min_perc))-MIN($DN6,($DC6+($AW6+($AX6-$AW6)/(C_equiv_harmonious_max_perc-C_equiv_harmonious_min_perc)*(QF6-C_equiv_harmonious_min_perc))+($AY6+($AZ6-$AY6)/(C_equiv_harmonious_max_perc-C_equiv_harmonious_min_perc)*(QF6-C_equiv_harmonious_min_perc))/El_boiler_eff)/BESS_chrg_eff)-MAX(0,($BI6+($BJ6-$BI6)/(C_equiv_harmonious_max_perc-C_equiv_harmonious_min_perc)*(QF6-C_equiv_harmonious_min_perc))-$DH6)/El_boiler_eff,5))", "QI" : "=IF(QF6=0,0,ROUND(($DM6+$DO6)*BESS_chrg_eff+$DL6-($AW6+($AX6-$AW6)/(C_equiv_harmonious_max_perc-C_equiv_harmonious_min_perc)*(QF6-C_equiv_harmonious_min_perc))-($AY6+($AZ6-$AY6)/(C_equiv_harmonious_max_perc-C_equiv_harmonious_min_perc)*(QF6-C_equiv_harmonious_min_perc))/El_boiler_eff,5))", "QJ" : "=IF(QF6=0,0,ROUND(($DN6+$DO6)*BESS_chrg_eff+$DL6-($AW6+($AX6-$AW6)/(C_equiv_harmonious_max_perc-C_equiv_harmonious_min_perc)*(QF6-C_equiv_harmonious_min_perc))-($AY6+($AZ6-$AY6)/(C_equiv_harmonious_max_perc-C_equiv_harmonious_min_perc)*(QF6-C_equiv_harmonious_min_perc))/El_boiler_eff,5))", "QK" : "=IF(QF6=0,0,ROUND($DG6+($DD6+$DJ6-MIN(DM6,($DC6+($AW6+($AX6-$AW6)/(C_equiv_harmonious_max_perc-C_equiv_harmonious_min_perc)*(QF6-C_equiv_harmonious_min_perc))+($AY6+($AZ6-$AY6)/(C_equiv_harmonious_max_perc-C_equiv_harmonious_min_perc)*(QF6-C_equiv_harmonious_min_perc))/El_boiler_eff)/BESS_chrg_eff)-($BG6+($BH6-$BG6)/(C_equiv_harmonious_max_perc-C_equiv_harmonious_min_perc)*(QF6-C_equiv_harmonious_min_perc)))*El_boiler_eff-($BI6+($BJ6-$BI6)/(C_equiv_harmonious_max_perc-C_equiv_harmonious_min_perc)*(QF6-C_equiv_harmonious_min_perc)),5))", "QL" : "=IF(QF6=0,0,ROUND($DH6+($DE6+$DK6-MIN(DN6,($DC6+($AW6+($AX6-$AW6)/(C_equiv_harmonious_max_perc-C_equiv_harmonious_min_perc)*(QF6-C_equiv_harmonious_min_perc))+($AY6+($AZ6-$AY6)/(C_equiv_harmonious_max_perc-C_equiv_harmonious_min_perc)*(QF6-C_equiv_harmonious_min_perc))/El_boiler_eff)/BESS_chrg_eff)-($BG6+($BH6-$BG6)/(C_equiv_harmonious_max_perc-C_equiv_harmonious_min_perc)*(QF6-C_equiv_harmonious_min_perc)))*El_boiler_eff-($BI6+($BJ6-$BI6)/(C_equiv_harmonious_max_perc-C_equiv_harmonious_min_perc)*(QF6-C_equiv_harmonious_min_perc)),5))", "QM" : "=IF(QF6=0,0,ROUND($DI6+$DT6*El_boiler_eff-($AY6+($AZ6-$AY6)/(C_equiv_harmonious_max_perc-C_equiv_harmonious_min_perc)*(QF6-C_equiv_harmonious_min_perc)),5))", "QN" : "=IF(QF6=0,0,ROUND($DI6+$DT6*El_boiler_eff-($AY6+($AZ6-$AY6)/(C_equiv_harmonious_max_perc-C_equiv_harmonious_min_perc)*(QF6-C_equiv_harmonious_min_perc)),5))", "QO" : "=IF(QF6=0,0,ROUND($DR6-MAX(0,($BI6+($BJ6-$BI6)/(C_equiv_harmonious_max_perc-C_equiv_harmonious_min_perc)*(QF6-C_equiv_harmonious_min_perc))-$DG6)/El_boiler_eff,5))", "QP" : "=IF(QF6=0,0,ROUND($DS6-MAX(0,($BI6+($BJ6-$BI6)/(C_equiv_harmonious_max_perc-C_equiv_harmonious_min_perc)*(QF6-C_equiv_harmonious_min_perc))-$DH6)/El_boiler_eff,5))", "QQ" : "=IF(QF6=0,0,ROUND($DT6-MAX(0,($AY6+($AZ6-$AY6)/(C_equiv_harmonious_max_perc-C_equiv_harmonious_min_perc)*(QF6-C_equiv_harmonious_min_perc))-$DI6)/El_boiler_eff,5))", "QR" : "=IF(QF6=0,0,ROUND($DT6-MAX(0,($AY6+($AZ6-$AY6)/(C_equiv_harmonious_max_perc-C_equiv_harmonious_min_perc)*(QF6-C_equiv_harmonious_min_perc))-$DI6)/El_boiler_eff,5))", "QS" : "=IF(QF6=0,0,ROUND($DU6-($BA6+($BB6-$BA6)/(C_equiv_harmonious_max_perc-C_equiv_harmonious_min_perc)*(QF6-C_equiv_harmonious_min_perc)),5))", "QT" : "=IF(QF6=0,0,ROUND($DV6-($BA6+($BB6-$BA6)/(C_equiv_harmonious_max_perc-C_equiv_harmonious_min_perc)*(QF6-C_equiv_harmonious_min_perc)),5))", "QU" : "=IF(QF6=0,0,ROUND($DX6-($BC6+($BD6-$BC6)/(C_equiv_harmonious_max_perc-C_equiv_harmonious_min_perc)*(QF6-C_equiv_harmonious_min_perc)),5))", "QV" : "=IF(QF6=0,0,ROUND($DY6-($BC6+($BD6-$BC6)/(C_equiv_harmonious_max_perc-C_equiv_harmonious_min_perc)*(QF6-C_equiv_harmonious_min_perc)),5))", "QW" : "=IF(QF6=0,0,ROUND($EA6-($BE6+($BF6-$BE6)/(C_equiv_harmonious_max_perc-C_equiv_harmonious_min_perc)*(QF6-C_equiv_harmonious_min_perc)),5))", "QX" : "=IF(QF6=0,0,ROUND($EB6-($BE6+($BF6-$BE6)/(C_equiv_harmonious_max_perc-C_equiv_harmonious_min_perc)*(QF6-C_equiv_harmonious_min_perc)),5))", "QY" : "=IF(QF6<=0,0,MIN(1,Overall_harmonious_min_perc+MIN(IF(QH6>=0,1,QG6/(QG6-QH6)),IF(QJ6>=0,1,QI6/(QI6-QJ6)),IF(QL6>=0,1,QK6/(QK6-QL6)),IF(QN6>=0,1,QM6/(QM6-QN6)),IF(QP6>=0,1,QO6/(QO6-QP6)),IF(QR6>=0,1,QQ6/(QQ6-QR6)),IF(QT6>=0,1,QS6/(QS6-QT6)),IF(QV6>=0,1,QU6/(QU6-QV6)),IF(QX6>=0,1,QW6/(QW6-QX6)))*(Overall_harmonious_max_perc-Overall_harmonious_min_perc)))",  "RA" : "=IF(PK6=0,0,$CT6+($CU6-$CT6)/(Overall_harmonious_max_perc-Overall_harmonious_min_perc)*(PK6-Overall_harmonious_min_perc))", "RB" : "=IF(QD6=0,0,($BG6+($BH6-$BG6)/(C_equiv_harmonious_max_perc-C_equiv_harmonious_min_perc)*(QD6-C_equiv_harmonious_min_perc)))", "RC" : "=IF(OR(PK6=0,QD6=0),0,MIN(($DC6+($AW6+($AX6-$AW6)/(C_equiv_harmonious_max_perc-C_equiv_harmonious_min_perc)*(QD6-C_equiv_harmonious_min_perc))+MAX(0,($AY6+($AZ6-$AY6)/(C_equiv_harmonious_max_perc-C_equiv_harmonious_min_perc)*(QD6-C_equiv_harmonious_min_perc))-$DI6)/El_boiler_eff-$DF6)/BESS_chrg_eff,($DM6+($DN6-$DM6)/(Overall_harmonious_max_perc-Overall_harmonious_min_perc)*(PK6-Overall_harmonious_min_perc))-$DO6))", "RD" : "=IF(PK6=0,0,$DP6+($DQ6-$DP6)/(Overall_harmonious_max_perc-Overall_harmonious_min_perc)*(PK6-Overall_harmonious_min_perc))", "RE" : "=RN6/El_boiler_eff", "RF" : "=IF(PK6=0,0,$DD6+($DE6-$DD6)/(Overall_harmonious_max_perc-Overall_harmonious_min_perc)*(PK6-Overall_harmonious_min_perc))", "RG" : "=IF(PK6=0,0,$DA6+($DB6-$DA6)/(Overall_harmonious_max_perc-Overall_harmonious_min_perc)*(PK6-Overall_harmonious_min_perc))", "RH" : "=IF(PK6=0,0,MIN($DJ6+($DK6-$DJ6)/(Overall_harmonious_max_perc-Overall_harmonious_min_perc)*(PK6-Overall_harmonious_min_perc),MAX(0,-(RF6-RB6-RC6-RE6))))", "RI" : "=RF6+RH6-SUM(RB6:RC6,RE6)", "RJ" : "=IF(PK6=0,0,$CV6+($CW6-$CV6)/(Overall_harmonious_max_perc-Overall_harmonious_min_perc)*(PK6-Overall_harmonious_min_perc))", "RK" : "=IF(QD6=0,0,($BI6+($BJ6-$BI6)/(C_equiv_harmonious_max_perc-C_equiv_harmonious_min_perc)*(QD6-C_equiv_harmonious_min_perc)))", "RL" : "=IF(PK6=0,0,$DG6+($DH6-$DG6)/(Overall_harmonious_max_perc-Overall_harmonious_min_perc)*(PK6-Overall_harmonious_min_perc))", "RM" : "=IF(PK6=0,0,($DP6+($DQ6-$DP6)/(Overall_harmonious_max_perc-Overall_harmonious_min_perc)*(PK6-Overall_harmonious_min_perc))*El_boiler_eff)", "RN" : "=IF(PK6=0,0,MIN(($DR6+($DS6-$DR6)/(Overall_harmonious_max_perc-Overall_harmonious_min_perc)*(PK6-Overall_harmonious_min_perc))*El_boiler_eff,MAX(0,RK6-RL6)))", "RO" : "=RL6+RN6-RK6", "RP" : "=IF(OR(PK6=0,QD6=0),0,$AW6+($AX6-$AW6)/(C_equiv_harmonious_max_perc-C_equiv_harmonious_min_perc)*(QD6-C_equiv_harmonious_min_perc))", "RQ" : "=RY6/El_boiler_eff", "RR" : "=IF(OR(PK6=0,QD6=0),0,$DC6)", "RS" : "=IF(OR(PK6=0,QD6=0),0,$DF6)", "RT" : "=RC6*BESS_chrg_eff", "RU" : "=IF(OR(PK6=0,QD6=0),0,MIN($DL6+$DC6,MAX(0,-(SUM(RS6:RT6)-SUM(RP6:RR6)))))", "RV" : "=SUM(RS6:RU6)-SUM(RP6:RR6)", "RW" : "=IF(OR(PK6=0,QD6=0),0,$AY6+($AZ6-$AY6)/(C_equiv_harmonious_max_perc-C_equiv_harmonious_min_perc)*(QD6-C_equiv_harmonious_min_perc))", "RX" : "=IF(OR(PK6=0,QD6=0),0,$DI6)", "RY" : "=IF(OR(PK6=0,QD6=0),0,MIN($DT6*El_boiler_eff,MAX(0,RW6-RX6)))", "RZ" : "=SUM(RX6:RY6)-RW6", "SA" : "=IF(RA6<=0,0,RA6/(Overall_harmonious_var_max_cons+Overall_fix_cons)*MethDist_harmonious_max_perc*MethDist_Meth_nom_prod_ud)+IF(RP6<=0,0,RP6/(C_overall_var_max_cons+C_overall_fix_stby_cons)*C_MethDist_max_perc*MethDist_Meth_nom_prod_ud)", "SB" : "=MIN(RI6,IF(OR(PK6=0,QD6=0),0,($CX6+($CY6-$CX6)/(Overall_harmonious_max_perc-Overall_harmonious_min_perc)*(PK6-Overall_harmonious_min_perc))))+MIN(RV6,IF(OR(PK6=0,QD6=0),0,$CZ6))", "SC" : "=RG6+RH6+RU6", "SD" : "=MAX(0,-RI6)+MAX(0,-RO6)+MAX(0,-RV6)+MAX(0,-RZ6)",  "SF" : "=IF(QY6=0,0,$CT6+($CU6-$CT6)/(Overall_harmonious_max_perc-Overall_harmonious_min_perc)*(QY6-Overall_harmonious_min_perc))", "SG" : "=IF(QF6=0,0,($BG6+($BH6-$BG6)/(C_equiv_harmonious_max_perc-C_equiv_harmonious_min_perc)*(QF6-C_equiv_harmonious_min_perc)))", "SH" : "=IF(OR(QY6=0,QF6=0),0,MIN(($DC6+($AW6+($AX6-$AW6)/(C_equiv_harmonious_max_perc-C_equiv_harmonious_min_perc)*(QF6-C_equiv_harmonious_min_perc))+MAX(0,($AY6+($AZ6-$AY6)/(C_equiv_harmonious_max_perc-C_equiv_harmonious_min_perc)*(QF6-C_equiv_harmonious_min_perc))-$DI6)/El_boiler_eff-$DF6)/BESS_chrg_eff,($DM6+($DN6-$DM6)/(Overall_harmonious_max_perc-Overall_harmonious_min_perc)*(QY6-Overall_harmonious_min_perc))-$DO6))", "SI" : "=IF(QY6=0,0,$DP6+($DQ6-$DP6)/(Overall_harmonious_max_perc-Overall_harmonious_min_perc)*(QY6-Overall_harmonious_min_perc))", "SJ" : "=SS6/El_boiler_eff", "SK" : "=IF(QY6=0,0,$DD6+($DE6-$DD6)/(Overall_harmonious_max_perc-Overall_harmonious_min_perc)*(QY6-Overall_harmonious_min_perc))", "SL" : "=IF(QY6=0,0,$DA6+($DB6-$DA6)/(Overall_harmonious_max_perc-Overall_harmonious_min_perc)*(QY6-Overall_harmonious_min_perc))", "SM" : "=IF(QY6=0,0,MIN($DJ6+($DK6-$DJ6)/(Overall_harmonious_max_perc-Overall_harmonious_min_perc)*(QY6-Overall_harmonious_min_perc),MAX(0,-(SK6-SG6-SH6-SJ6))))", "SN" : "=SK6+SM6-SUM(SG6:SH6,SJ6)", "SO" : "=IF(QY6=0,0,$CV6+($CW6-$CV6)/(Overall_harmonious_max_perc-Overall_harmonious_min_perc)*(QY6-Overall_harmonious_min_perc))", "SP" : "=IF(QF6=0,0,($BI6+($BJ6-$BI6)/(C_equiv_harmonious_max_perc-C_equiv_harmonious_min_perc)*(QF6-C_equiv_harmonious_min_perc)))", "SQ" : "=IF(QY6=0,0,$DG6+($DH6-$DG6)/(Overall_harmonious_max_perc-Overall_harmonious_min_perc)*(QY6-Overall_harmonious_min_perc))", "SR" : "=IF(QY6=0,0,($DP6+($DQ6-$DP6)/(Overall_harmonious_max_perc-Overall_harmonious_min_perc)*(QY6-Overall_harmonious_min_perc))*El_boiler_eff)", "SS" : "=IF(QY6=0,0,MIN(($DR6+($DS6-$DR6)/(Overall_harmonious_max_perc-Overall_harmonious_min_perc)*(QY6-Overall_harmonious_min_perc))*El_boiler_eff,MAX(0,SP6-SQ6)))", "ST" : "=SQ6+SS6-SP6", "SU" : "=IF(OR(QY6=0,QF6=0),0,$AW6+($AX6-$AW6)/(C_equiv_harmonious_max_perc-C_equiv_harmonious_min_perc)*(QF6-C_equiv_harmonious_min_perc))", "SV" : "=TD6/El_boiler_eff", "SW" : "=IF(OR(QY6=0,QF6=0),0,$DC6)", "SX" : "=IF(OR(QY6=0,QF6=0),0,$DF6)", "SY" : "=SH6*BESS_chrg_eff", "SZ" : "=IF(OR(QY6=0,QF6=0),0,MIN($DL6+$DC6,MAX(0,-(SUM(SX6:SY6)-SUM(SU6:SW6)))))", "TA" : "=SUM(SX6:SZ6)-SUM(SU6:SW6)", "TB" : "=IF(OR(QY6=0,QF6=0),0,$AY6+($AZ6-$AY6)/(C_equiv_harmonious_max_perc-C_equiv_harmonious_min_perc)*(QF6-C_equiv_harmonious_min_perc))", "TC" : "=IF(OR(QY6=0,QF6=0),0,$DI6)", "TD" : "=IF(OR(QY6=0,QF6=0),0,MIN($DT6*El_boiler_eff,MAX(0,TB6-TC6)))", "TE" : "=SUM(TC6:TD6)-TB6", "TF" : "=IF(SF6<=0,0,SF6/(Overall_harmonious_var_max_cons+Overall_fix_cons)*MethDist_harmonious_max_perc*MethDist_Meth_nom_prod_ud)+IF(SU6<=0,0,SU6/(C_overall_var_max_cons+C_overall_fix_stby_cons)*C_MethDist_max_perc*MethDist_Meth_nom_prod_ud)", "TG" : "=MIN(SN6,IF(OR(QY6=0,QF6=0),0,($CX6+($CY6-$CX6)/(Overall_harmonious_max_perc-Overall_harmonious_min_perc)*(QY6-Overall_harmonious_min_perc))))+MIN(TA6,IF(OR(QY6=0,QF6=0),0,$CZ6))", "TH" : "=SL6+SM6+SZ6", "TI" : "=MAX(0,-SN6)+MAX(0,-ST6)+MAX(0,-TA6)+MAX(0,-TE6)",  "TK" : "=$DD6+$DJ6-$CC6-MIN($DM6,($DC6+$BS6+$BU6/El_boiler_eff)/BESS_chrg_eff)-MAX(0,$CE6-$DG6)/El_boiler_eff", "TL" : "=$DD6+$DJ6-($CC6+($CD6-$CC6)/(D_equiv_harmonious_max_perc-D_equiv_harmonious_min_perc)*($CM6-D_equiv_harmonious_min_perc))-MIN($DM6,($DC6+($BS6+($BT6-$BS6)/(D_equiv_harmonious_max_perc-D_equiv_harmonious_min_perc)*($CM6-D_equiv_harmonious_min_perc))+($BU6+($BV6-$BU6)/(D_equiv_harmonious_max_perc-D_equiv_harmonious_min_perc)*($CM6-D_equiv_harmonious_min_perc))/El_boiler_eff)/BESS_chrg_eff)-MAX(0,($CE6+($CF6-$CE6)/(D_equiv_harmonious_max_perc-D_equiv_harmonious_min_perc)*($CM6-D_equiv_harmonious_min_perc))-$DG6)/El_boiler_eff", "TM" : "=$DE6+$DK6-$CC6-MIN($DN6,($DC6+$BS6+$BU6/El_boiler_eff)/BESS_chrg_eff)-MAX(0,$CE6-$DH6)/El_boiler_eff", "TN" : "=($DM6+$DO6)*BESS_chrg_eff+$DL6-$BS6-$BU6/El_boiler_eff", "TO" : "=($DM6+$DO6)*BESS_chrg_eff+$DL6-($BS6+($BT6-$BS6)/(D_equiv_harmonious_max_perc-D_equiv_harmonious_min_perc)*($CM6-D_equiv_harmonious_min_perc))-($BU6+($BV6-$BU6)/(D_equiv_harmonious_max_perc-D_equiv_harmonious_min_perc)*($CM6-D_equiv_harmonious_min_perc))/El_boiler_eff", "TP" : "=($DN6+$DO6)*BESS_chrg_eff+$DL6-$BS6-$BU6/El_boiler_eff", "TQ" : "=$DG6+($DD6+$DJ6-MIN($DM6,($DC6+$BS6+$BU6/El_boiler_eff)/BESS_chrg_eff)-$CC6)*El_boiler_eff-$CE6", "TR" : "=$DG6+($DD6+$DJ6-MIN($DM6,($DC6+($BS6+($BT6-$BS6)/(D_equiv_harmonious_max_perc-D_equiv_harmonious_min_perc)*($CM6-D_equiv_harmonious_min_perc))+($BU6+($BV6-$BU6)/(D_equiv_harmonious_max_perc-D_equiv_harmonious_min_perc)*($CM6-D_equiv_harmonious_min_perc))/El_boiler_eff)/BESS_chrg_eff)-($CC6+($CD6-$CC6)/(D_equiv_harmonious_max_perc-D_equiv_harmonious_min_perc)*($CM6-D_equiv_harmonious_min_perc)))*El_boiler_eff-($CE6+($CF6-$CE6)/(D_equiv_harmonious_max_perc-D_equiv_harmonious_min_perc)*($CM6-D_equiv_harmonious_min_perc))", "TS" : "=$DH6+($DE6+$DK6-MIN($DN6,($DC6+$BS6+$BU6/El_boiler_eff)/BESS_chrg_eff)-$CC6)*El_boiler_eff-$CE6", "TT" : "=$DI6+$DT6*El_boiler_eff-$BU6", "TU" : "=$DI6+$DT6*El_boiler_eff-($BU6+($BV6-$BU6)/(D_equiv_harmonious_max_perc-D_equiv_harmonious_min_perc)*($CM6-D_equiv_harmonious_min_perc))", "TV" : "=$DI6+$DT6*El_boiler_eff-$BU6", "TW" : "=$DR6-MAX(0,$CE6-$DG6)/El_boiler_eff", "TX" : "=$DR6-MAX(0,($CE6+($CF6-$CE6)/(D_equiv_harmonious_max_perc-D_equiv_harmonious_min_perc)*($CM6-D_equiv_harmonious_min_perc))-$DG6)/El_boiler_eff", "TY" : "=$DS6-MAX(0,$CE6-$DH6)/El_boiler_eff", "TZ" : "=$DT6-MAX(0,$BU6-$DI6)/El_boiler_eff", "UA" : "=$DT6-MAX(0,($BU6+($BV6-$BU6)/(D_equiv_harmonious_max_perc-D_equiv_harmonious_min_perc)*($CM6-D_equiv_harmonious_min_perc))-$DI6)/El_boiler_eff", "UB" : "=$DT6-MAX(0,$BU6-$DI6)/El_boiler_eff", "UC" : "=$DU6-$BW6", "UD" : "=$DU6-($BW6+($BX6-$BW6)/(D_equiv_harmonious_max_perc-D_equiv_harmonious_min_perc)*($CM6-D_equiv_harmonious_min_perc))", "UE" : "=$DV6-$BW6", "UF" : "=$DX6-$BY6", "UG" : "=$DX6-($BY6+($BZ6-$BY6)/(D_equiv_harmonious_max_perc-D_equiv_harmonious_min_perc)*($CM6-D_equiv_harmonious_min_perc))", "UH" : "=$DY6-$BY6", "UI" : "=$EA6-$CA6", "UJ" : "=$EA6-($CA6+($CB6-$CA6)/(D_equiv_harmonious_max_perc-D_equiv_harmonious_min_perc)*($CM6-D_equiv_harmonious_min_perc))", "UK" : "=$EB6-$CA6",  "UM" : "=IF(OR(TK6<0,TN6<0,TQ6<0,TT6<0,TW6<0,TZ6<0,UC6<0,UF6<0,UI6<0),0,MIN(1,Overall_harmonious_min_perc+MIN(IFERROR(TK6/MAX(0,TK6-TM6),1),IFERROR(TN6/MAX(0,TN6-TP6),1),IFERROR(TQ6/MAX(0,TQ6-TS6),1),IFERROR(TT6/MAX(0,TT6-TV6),1),IFERROR(TW6/MAX(0,TW6-TY6),1),IFERROR(TZ6/MAX(0,TZ6-UB6),1),IFERROR(UC6/MAX(0,UC6-UE6),1),IFERROR(UF6/MAX(0,UF6-UH6),1),IFERROR(UI6/MAX(0,UI6-UK6),1))*(Overall_harmonious_max_perc-Overall_harmonious_min_perc)))", "UN" : "=IF(UM6=0,0,ROUND(($DD6+($DE6-$DD6)/(Overall_harmonious_max_perc-Overall_harmonious_min_perc)*(UM6-Overall_harmonious_min_perc))+($DJ6+($DK6-$DJ6)/(Overall_harmonious_max_perc-Overall_harmonious_min_perc)*(UM6-Overall_harmonious_min_perc))-$CC6-MIN($DM6+($DN6-$DM6)/(Overall_harmonious_max_perc-Overall_harmonious_min_perc)*(UM6-Overall_harmonious_min_perc),($DC6+$BS6+$BU6/El_boiler_eff)/BESS_chrg_eff)-MAX(0,$CE6-($DG6+($DH6-$DG6)/(Overall_harmonious_max_perc-Overall_harmonious_min_perc)*(UM6-Overall_harmonious_min_perc)))/El_boiler_eff,5))", "UO" : "=IF(UM6=0,0,ROUND(($DD6+($DE6-$DD6)/(Overall_harmonious_max_perc-Overall_harmonious_min_perc)*(UM6-Overall_harmonious_min_perc))+($DJ6+($DK6-$DJ6)/(Overall_harmonious_max_perc-Overall_harmonious_min_perc)*(UM6-Overall_harmonious_min_perc))-($CC6+($CD6-$CC6)/(D_equiv_harmonious_max_perc-D_equiv_harmonious_min_perc)*($CM6-D_equiv_harmonious_min_perc))-MIN($DM6+($DN6-$DM6)/(Overall_harmonious_max_perc-Overall_harmonious_min_perc)*(UM6-Overall_harmonious_min_perc),($DC6+($BS6+($BT6-$BS6)/(D_equiv_harmonious_max_perc-D_equiv_harmonious_min_perc)*($CM6-D_equiv_harmonious_min_perc))+($BU6+($BV6-$BU6)/(D_equiv_harmonious_max_perc-D_equiv_harmonious_min_perc)*($CM6-D_equiv_harmonious_min_perc))/El_boiler_eff)/BESS_chrg_eff)-MAX(0,($CE6+($CF6-$CE6)/(D_equiv_harmonious_max_perc-D_equiv_harmonious_min_perc)*($CM6-D_equiv_harmonious_min_perc))-($DG6+($DH6-$DG6)/(Overall_harmonious_max_perc-Overall_harmonious_min_perc)*(UM6-Overall_harmonious_min_perc)))/El_boiler_eff,5))", "UP" : "=IF(UM6=0,0,ROUND((($DM6+($DN6-$DM6)/(Overall_harmonious_max_perc-Overall_harmonious_min_perc)*(UM6-Overall_harmonious_min_perc))+$DO6)*BESS_chrg_eff+$DL6-$BS6-$BU6/El_boiler_eff,5))", "UQ" : "=IF(UM6=0,0,ROUND((($DM6+($DN6-$DM6)/(Overall_harmonious_max_perc-Overall_harmonious_min_perc)*(UM6-Overall_harmonious_min_perc))+$DO6)*BESS_chrg_eff+$DL6-($BS6+($BT6-$BS6)/(D_equiv_harmonious_max_perc-D_equiv_harmonious_min_perc)*($CM6-D_equiv_harmonious_min_perc))-($BU6+($BV6-$BU6)/(D_equiv_harmonious_max_perc-D_equiv_harmonious_min_perc)*($CM6-D_equiv_harmonious_min_perc))/El_boiler_eff,5))", "UR" : "=IF(UM6=0,0,ROUND(($DG6+($DH6-$DG6)/(Overall_harmonious_max_perc-Overall_harmonious_min_perc)*(UM6-Overall_harmonious_min_perc))+(($DD6+($DE6-$DD6)/(Overall_harmonious_max_perc-Overall_harmonious_min_perc)*(UM6-Overall_harmonious_min_perc))+($DJ6+($DK6-$DJ6)/(Overall_harmonious_max_perc-Overall_harmonious_min_perc)*(UM6-Overall_harmonious_min_perc))-MIN($DM6+($DN6-$DM6)/(Overall_harmonious_max_perc-Overall_harmonious_min_perc)*(UM6-Overall_harmonious_min_perc),($DC6+$BS6+$BU6/El_boiler_eff)/BESS_chrg_eff)-$CC6)*El_boiler_eff-$CE6,5))", "US" : "=IF(UM6=0,0,ROUND(($DG6+($DH6-$DG6)/(Overall_harmonious_max_perc-Overall_harmonious_min_perc)*(UM6-Overall_harmonious_min_perc))+(($DD6+($DE6-$DD6)/(Overall_harmonious_max_perc-Overall_harmonious_min_perc)*(UM6-Overall_harmonious_min_perc))+($DJ6+($DK6-$DJ6)/(Overall_harmonious_max_perc-Overall_harmonious_min_perc)*(UM6-Overall_harmonious_min_perc))-MIN($DM6+($DN6-$DM6)/(Overall_harmonious_max_perc-Overall_harmonious_min_perc)*(UM6-Overall_harmonious_min_perc),($DC6+($BS6+($BT6-$BS6)/(D_equiv_harmonious_max_perc-D_equiv_harmonious_min_perc)*($CM6-D_equiv_harmonious_min_perc))+($BU6+($BV6-$BU6)/(D_equiv_harmonious_max_perc-D_equiv_harmonious_min_perc)*($CM6-D_equiv_harmonious_min_perc))/El_boiler_eff)/BESS_chrg_eff)-($CC6+($CD6-$CC6)/(D_equiv_harmonious_max_perc-D_equiv_harmonious_min_perc)*($CM6-D_equiv_harmonious_min_perc)))*El_boiler_eff-($CE6+($CF6-$CE6)/(D_equiv_harmonious_max_perc-D_equiv_harmonious_min_perc)*($CM6-D_equiv_harmonious_min_perc)),5))", "UT" : "=IF(UM6=0,0,ROUND($DI6+$DT6*El_boiler_eff-$BU6,5))", "UU" : "=IF(UM6=0,0,ROUND($DI6+$DT6*El_boiler_eff-($BU6+($BV6-$BU6)/(D_equiv_harmonious_max_perc-D_equiv_harmonious_min_perc)*($CM6-D_equiv_harmonious_min_perc)),5))", "UV" : "=IF(UM6=0,0,ROUND(($DR6+($DS6-$DR6)/(Overall_harmonious_max_perc-Overall_harmonious_min_perc)*(UM6-Overall_harmonious_min_perc))-MAX(0,$CE6-($DG6+($DH6-$DG6)/(Overall_harmonious_max_perc-Overall_harmonious_min_perc)*(UM6-Overall_harmonious_min_perc)))/El_boiler_eff,5))", "UW" : "=IF(UM6=0,0,ROUND(($DR6+($DS6-$DR6)/(Overall_harmonious_max_perc-Overall_harmonious_min_perc)*(UM6-Overall_harmonious_min_perc))-MAX(0,($CE6+($CF6-$CE6)/(D_equiv_harmonious_max_perc-D_equiv_harmonious_min_perc)*($CM6-D_equiv_harmonious_min_perc))-($DG6+($DH6-$DG6)/(Overall_harmonious_max_perc-Overall_harmonious_min_perc)*(UM6-Overall_harmonious_min_perc)))/El_boiler_eff,5))", "UX" : "=IF(UM6=0,0,ROUND($DT6-MAX(0,$BU6-$DI6)/El_boiler_eff,5))", "UY" : "=IF(UM6=0,0,ROUND($DT6-MAX(0,$BU6+($BV6-$BU6)/(D_equiv_harmonious_max_perc-D_equiv_harmonious_min_perc)*($CM6-D_equiv_harmonious_min_perc)-$DI6)/El_boiler_eff,5))", "UZ" : "=IF(UM6=0,0,ROUND(($DU6+($DV6-$DU6)/(Overall_harmonious_max_perc-Overall_harmonious_min_perc)*(UM6-Overall_harmonious_min_perc))-$BW6,5))", "VA" : "=IF(UM6=0,0,ROUND(($DU6+($DV6-$DU6)/(Overall_harmonious_max_perc-Overall_harmonious_min_perc)*(UM6-Overall_harmonious_min_perc))-($BW6+($BX6-$BW6)/(D_equiv_harmonious_max_perc-D_equiv_harmonious_min_perc)*($CM6-D_equiv_harmonious_min_perc)),5))", "VB" : "=IF(UM6=0,0,ROUND(($DX6+($DY6-$DX6)/(Overall_harmonious_max_perc-Overall_harmonious_min_perc)*(UM6-Overall_harmonious_min_perc))-$BY6,5))", "VC" : "=IF(UM6=0,0,ROUND(($DX6+($DY6-$DX6)/(Overall_harmonious_max_perc-Overall_harmonious_min_perc)*(UM6-Overall_harmonious_min_perc))-($BY6+($BZ6-$BY6)/(D_equiv_harmonious_max_perc-D_equiv_harmonious_min_perc)*($CM6-D_equiv_harmonious_min_perc)),5))", "VD" : "=IF(UM6=0,0,ROUND(($EA6+($EB6-$EA6)/(Overall_harmonious_max_perc-Overall_harmonious_min_perc)*(UM6-Overall_harmonious_min_perc))-$CA6,5))", "VE" : "=IF(UM6=0,0,ROUND(($EA6+($EB6-$EA6)/(Overall_harmonious_max_perc-Overall_harmonious_min_perc)*(UM6-Overall_harmonious_min_perc))-($CA6+($CB6-$CA6)/(D_equiv_harmonious_max_perc-D_equiv_harmonious_min_perc)*($CM6-D_equiv_harmonious_min_perc)),5))", "VF" : "=IF(OR(UM6=0,UN6<0,UP6<0,UR6<0,UT6<0,UV6<0,UX6<0,UZ6<0,VB6<0,VD6<0),0,MIN(1,D_equiv_harmonious_min_perc+MIN(IF(UO6>=0,1,UN6/(UN6-UO6)),IF(UQ6>=0,1,UP6/(UP6-UQ6)),IF(US6>=0,1,UR6/(UR6-US6)),IF(UU6>=0,1,UT6/(UT6-UU6)),IF(UW6>=0,1,UV6/(UV6-UW6)),IF(UY6>=0,1,UX6/(UX6-UY6)),IF(VA6>=0,1,UZ6/(UZ6-VA6)),IF(VC6>=0,1,VB6/(VB6-VC6)),IF(VE6>=0,1,VD6/(VD6-VE6)))*(D_equiv_harmonious_max_perc*$CM6-D_equiv_harmonious_min_perc)))",  "VH" : "=IF(OR(TK6<0,TN6<0,TQ6<0,TT6<0,TW6<0,TZ6<0,UC6<0,UF6<0,UI6<0),0,MIN(1,D_equiv_harmonious_min_perc+MIN(IF(TL6>=0,1,TK6/(TK6-TL6)),IF(TO6>=0,1,TN6/(TN6-TO6)),IF(TR6>=0,1,TQ6/(TQ6-TR6)),IF(TU6>=0,1,TT6/(TT6-TU6)),IF(TX6>=0,1,TW6/(TW6-TX6)),IF(UA6>=0,1,TZ6/(TZ6-UA6)),IF(UD6>=0,1,UC6/(UC6-UD6)),IF(UG6>=0,1,UF6/(UF6-UG6)),IF(UJ6>=0,1,UI6/(UI6-UJ6)))*(D_equiv_harmonious_max_perc*$CM6-D_equiv_harmonious_min_perc)))", "VI" : "=IF(VH6=0,0,ROUND($DD6+$DJ6-($CC6+($CD6-$CC6)/(D_equiv_harmonious_max_perc-D_equiv_harmonious_min_perc)*(VH6-D_equiv_harmonious_min_perc))-MIN($DM6,($DC6+($BS6+($BT6-$BS6)/(D_equiv_harmonious_max_perc-D_equiv_harmonious_min_perc)*(VH6-D_equiv_harmonious_min_perc))+($BU6+($BV6-$BU6)/(D_equiv_harmonious_max_perc-D_equiv_harmonious_min_perc)*(VH6-D_equiv_harmonious_min_perc))/El_boiler_eff)/BESS_chrg_eff)-MAX(0,($CE6+($CF6-$CE6)/(D_equiv_harmonious_max_perc-D_equiv_harmonious_min_perc)*(VH6-D_equiv_harmonious_min_perc))-$DG6)/El_boiler_eff,5))", "VJ" : "=IF(VH6=0,0,ROUND($DE6+$DK6-($CC6+($CD6-$CC6)/(D_equiv_harmonious_max_perc-D_equiv_harmonious_min_perc)*(VH6-D_equiv_harmonious_min_perc))-MIN($DN6,($DC6+($BS6+($BT6-$BS6)/(D_equiv_harmonious_max_perc-D_equiv_harmonious_min_perc)*(VH6-D_equiv_harmonious_min_perc))+($BU6+($BV6-$BU6)/(D_equiv_harmonious_max_perc-D_equiv_harmonious_min_perc)*(VH6-D_equiv_harmonious_min_perc))/El_boiler_eff)/BESS_chrg_eff)-MAX(0,($CE6+($CF6-$CE6)/(D_equiv_harmonious_max_perc-D_equiv_harmonious_min_perc)*(VH6-D_equiv_harmonious_min_perc))-$DH6)/El_boiler_eff,5))", "VK" : "=IF(VH6=0,0,ROUND(($DM6+$DO6)*BESS_chrg_eff+$DL6-($BS6+($BT6-$BS6)/(D_equiv_harmonious_max_perc-D_equiv_harmonious_min_perc)*(VH6-D_equiv_harmonious_min_perc))-($BU6+($BV6-$BU6)/(D_equiv_harmonious_max_perc-D_equiv_harmonious_min_perc)*(VH6-D_equiv_harmonious_min_perc))/El_boiler_eff,5))", "VL" : "=IF(VH6=0,0,ROUND(($DN6+$DO6)*BESS_chrg_eff+$DL6-($BS6+($BT6-$BS6)/(D_equiv_harmonious_max_perc-D_equiv_harmonious_min_perc)*(VH6-D_equiv_harmonious_min_perc))-($BU6+($BV6-$BU6)/(D_equiv_harmonious_max_perc-D_equiv_harmonious_min_perc)*(VH6-D_equiv_harmonious_min_perc))/El_boiler_eff,5))", "VM" : "=IF(VH6=0,0,ROUND($DG6+($DD6+$DJ6-MIN(DM6,($DC6+($BS6+($BT6-$BS6)/(D_equiv_harmonious_max_perc-D_equiv_harmonious_min_perc)*(VH6-D_equiv_harmonious_min_perc))+($BU6+($BV6-$BU6)/(D_equiv_harmonious_max_perc-D_equiv_harmonious_min_perc)*(VH6-D_equiv_harmonious_min_perc))/El_boiler_eff)/BESS_chrg_eff)-($CC6+($CD6-$CC6)/(D_equiv_harmonious_max_perc-D_equiv_harmonious_min_perc)*(VH6-D_equiv_harmonious_min_perc)))*El_boiler_eff-($CE6+($CF6-$CE6)/(D_equiv_harmonious_max_perc-D_equiv_harmonious_min_perc)*(VH6-D_equiv_harmonious_min_perc)),5))", "VN" : "=IF(VH6=0,0,ROUND($DH6+($DE6+$DK6-MIN(DN6,($DC6+($BS6+($BT6-$BS6)/(D_equiv_harmonious_max_perc-D_equiv_harmonious_min_perc)*(VH6-D_equiv_harmonious_min_perc))+($BU6+($BV6-$BU6)/(D_equiv_harmonious_max_perc-D_equiv_harmonious_min_perc)*(VH6-D_equiv_harmonious_min_perc))/El_boiler_eff)/BESS_chrg_eff)-($CC6+($CD6-$CC6)/(D_equiv_harmonious_max_perc-D_equiv_harmonious_min_perc)*(VH6-D_equiv_harmonious_min_perc)))*El_boiler_eff-($CE6+($CF6-$CE6)/(D_equiv_harmonious_max_perc-D_equiv_harmonious_min_perc)*(VH6-D_equiv_harmonious_min_perc)),5))", "VO" : "=IF(VH6=0,0,ROUND($DI6+$DT6*El_boiler_eff-($BU6+($BV6-$BU6)/(D_equiv_harmonious_max_perc-D_equiv_harmonious_min_perc)*(VH6-D_equiv_harmonious_min_perc)),5))", "VP" : "=IF(VH6=0,0,ROUND($DI6+$DT6*El_boiler_eff-($BU6+($BV6-$BU6)/(D_equiv_harmonious_max_perc-D_equiv_harmonious_min_perc)*(VH6-D_equiv_harmonious_min_perc)),5))", "VQ" : "=IF(VH6=0,0,ROUND($DR6-MAX(0,($CE6+($CF6-$CE6)/(D_equiv_harmonious_max_perc-D_equiv_harmonious_min_perc)*(VH6-D_equiv_harmonious_min_perc))-$DG6)/El_boiler_eff,5))", "VR" : "=IF(VH6=0,0,ROUND($DS6-MAX(0,($CE6+($CF6-$CE6)/(D_equiv_harmonious_max_perc-D_equiv_harmonious_min_perc)*(VH6-D_equiv_harmonious_min_perc))-$DH6)/El_boiler_eff,5))", "VS" : "=IF(VH6=0,0,ROUND($DT6-MAX(0,($BU6+($BV6-$BU6)/(D_equiv_harmonious_max_perc-D_equiv_harmonious_min_perc)*(VH6-D_equiv_harmonious_min_perc))-$DI6)/El_boiler_eff,5))", "VT" : "=IF(VH6=0,0,ROUND($DT6-MAX(0,($BU6+($BV6-$BU6)/(D_equiv_harmonious_max_perc-D_equiv_harmonious_min_perc)*(VH6-D_equiv_harmonious_min_perc))-$DI6)/El_boiler_eff,5))", "VU" : "=IF(VH6=0,0,ROUND($DU6-($BW6+($BX6-$BW6)/(D_equiv_harmonious_max_perc-D_equiv_harmonious_min_perc)*(VH6-D_equiv_harmonious_min_perc)),5))", "VV" : "=IF(VH6=0,0,ROUND($DV6-($BW6+($BX6-$BW6)/(D_equiv_harmonious_max_perc-D_equiv_harmonious_min_perc)*(VH6-D_equiv_harmonious_min_perc)),5))", "VW" : "=IF(VH6=0,0,ROUND($DX6-($BY6+($BZ6-$BY6)/(D_equiv_harmonious_max_perc-D_equiv_harmonious_min_perc)*(VH6-D_equiv_harmonious_min_perc)),5))", "VX" : "=IF(VH6=0,0,ROUND($DY6-($BY6+($BZ6-$BY6)/(D_equiv_harmonious_max_perc-D_equiv_harmonious_min_perc)*(VH6-D_equiv_harmonious_min_perc)),5))", "VY" : "=IF(VH6=0,0,ROUND($EA6-($CA6+($CB6-$CA6)/(D_equiv_harmonious_max_perc-D_equiv_harmonious_min_perc)*(VH6-D_equiv_harmonious_min_perc)),5))", "VZ" : "=IF(VH6=0,0,ROUND($EB6-($CA6+($CB6-$CA6)/(D_equiv_harmonious_max_perc-D_equiv_harmonious_min_perc)*(VH6-D_equiv_harmonious_min_perc)),5))", "WA" : "=IF(VH6<=0,0,MIN(1,Overall_harmonious_min_perc+MIN(IF(VJ6>=0,1,VI6/(VI6-VJ6)),IF(VL6>=0,1,VK6/(VK6-VL6)),IF(VN6>=0,1,VM6/(VM6-VN6)),IF(VP6>=0,1,VO6/(VO6-VP6)),IF(VR6>=0,1,VQ6/(VQ6-VR6)),IF(VT6>=0,1,VS6/(VS6-VT6)),IF(VV6>=0,1,VU6/(VU6-VV6)),IF(VX6>=0,1,VW6/(VW6-VX6)),IF(VZ6>=0,1,VY6/(VY6-VZ6)))*(Overall_harmonious_max_perc-Overall_harmonious_min_perc)))",  "WC" : "=IF(UM6=0,0,$CT6+($CU6-$CT6)/(Overall_harmonious_max_perc-Overall_harmonious_min_perc)*(UM6-Overall_harmonious_min_perc))", "WD" : "=IF(VF6=0,0,($CC6+($CD6-$CC6)/(D_equiv_harmonious_max_perc-D_equiv_harmonious_min_perc)*(VF6-D_equiv_harmonious_min_perc)))", "WE" : "=IF(OR(UM6=0,VF6=0),0,MIN(($DC6+($BS6+($BT6-$BS6)/(D_equiv_harmonious_max_perc-D_equiv_harmonious_min_perc)*(VF6-D_equiv_harmonious_min_perc))+MAX(0,($BU6+($BV6-$BU6)/(D_equiv_harmonious_max_perc-D_equiv_harmonious_min_perc)*(VF6-D_equiv_harmonious_min_perc))-$DI6)/El_boiler_eff-$DF6)/BESS_chrg_eff,($DM6+($DN6-$DM6)/(Overall_harmonious_max_perc-Overall_harmonious_min_perc)*(UM6-Overall_harmonious_min_perc))-$DO6))", "WF" : "=IF(UM6=0,0,$DP6+($DQ6-$DP6)/(Overall_harmonious_max_perc-Overall_harmonious_min_perc)*(UM6-Overall_harmonious_min_perc))", "WG" : "=WP6/El_boiler_eff", "WH" : "=IF(UM6=0,0,$DD6+($DE6-$DD6)/(Overall_harmonious_max_perc-Overall_harmonious_min_perc)*(UM6-Overall_harmonious_min_perc))", "WI" : "=IF(UM6=0,0,$DA6+($DB6-$DA6)/(Overall_harmonious_max_perc-Overall_harmonious_min_perc)*(UM6-Overall_harmonious_min_perc))", "WJ" : "=IF(UM6=0,0,MIN($DJ6+($DK6-$DJ6)/(Overall_harmonious_max_perc-Overall_harmonious_min_perc)*(UM6-Overall_harmonious_min_perc),MAX(0,-(WH6-WD6-WE6-WG6))))", "WK" : "=WH6+WJ6-SUM(WD6:WE6,WG6)", "WL" : "=IF(UM6=0,0,$CV6+($CW6-$CV6)/(Overall_harmonious_max_perc-Overall_harmonious_min_perc)*(UM6-Overall_harmonious_min_perc))", "WM" : "=IF(VF6=0,0,($CE6+($CF6-$CE6)/(D_equiv_harmonious_max_perc-D_equiv_harmonious_min_perc)*(VF6-D_equiv_harmonious_min_perc)))", "WN" : "=IF(UM6=0,0,$DG6+($DH6-$DG6)/(Overall_harmonious_max_perc-Overall_harmonious_min_perc)*(UM6-Overall_harmonious_min_perc))", "WO" : "=IF(UM6=0,0,($DP6+($DQ6-$DP6)/(Overall_harmonious_max_perc-Overall_harmonious_min_perc)*(UM6-Overall_harmonious_min_perc))*El_boiler_eff)", "WP" : "=IF(UM6=0,0,MIN(($DR6+($DS6-$DR6)/(Overall_harmonious_max_perc-Overall_harmonious_min_perc)*(UM6-Overall_harmonious_min_perc))*El_boiler_eff,MAX(0,WM6-WN6)))", "WQ" : "=WN6+WP6-WM6", "WR" : "=IF(OR(UM6=0,VF6=0),0,$BS6+($BT6-$BS6)/(D_equiv_harmonious_max_perc-D_equiv_harmonious_min_perc)*(VF6-D_equiv_harmonious_min_perc))", "WS" : "=XA6/El_boiler_eff", "WT" : "=IF(OR(UM6=0,VF6=0),0,$DC6)", "WU" : "=IF(OR(UM6=0,VF6=0),0,$DF6)", "WV" : "=WE6*BESS_chrg_eff", "WW" : "=IF(OR(UM6=0,VF6=0),0,MIN($DL6+$DC6,MAX(0,-(SUM(WU6:WV6)-SUM(WR6:WT6)))))", "WX" : "=SUM(WU6:WW6)-SUM(WR6:WT6)", "WY" : "=IF(OR(UM6=0,VF6=0),0,$BU6+($BV6-$BU6)/(D_equiv_harmonious_max_perc-D_equiv_harmonious_min_perc)*(VF6-D_equiv_harmonious_min_perc))", "WZ" : "=IF(OR(UM6=0,VF6=0),0,$DI6)", "XA" : "=IF(OR(UM6=0,VF6=0),0,MIN($DT6*El_boiler_eff,MAX(0,WY6-WZ6)))", "XB" : "=SUM(WZ6:XA6)-WY6", "XC" : "=IF(WC6<=0,0,WC6/(Overall_harmonious_var_max_cons+Overall_fix_cons)*MethDist_harmonious_max_perc*MethDist_Meth_nom_prod_ud)+IF(WR6<=0,0,WR6/(D_overall_var_max_cons+D_overall_fix_stby_cons)*D_MethDist_max_perc*MethDist_Meth_nom_prod_ud)", "XD" : "=MIN(WK6,IF(OR(UM6=0,VF6=0),0,($CX6+($CY6-$CX6)/(Overall_harmonious_max_perc-Overall_harmonious_min_perc)*(UM6-Overall_harmonious_min_perc))))+MIN(WX6,IF(OR(UM6=0,VF6=0),0,$CZ6))", "XE" : "=WI6+WJ6+WW6", "XF" : "=MAX(0,-WK6)+MAX(0,-WQ6)+MAX(0,-WX6)+MAX(0,-XB6)",  "XH" : "=IF(WA6=0,0,$CT6+($CU6-$CT6)/(Overall_harmonious_max_perc-Overall_harmonious_min_perc)*(WA6-Overall_harmonious_min_perc))", "XI" : "=IF(VH6=0,0,($CC6+($CD6-$CC6)/(D_equiv_harmonious_max_perc-D_equiv_harmonious_min_perc)*(VH6-D_equiv_harmonious_min_perc)))", "XJ" : "=IF(OR(WA6=0,VH6=0),0,MIN(($DC6+($BS6+($BT6-$BS6)/(D_equiv_harmonious_max_perc-D_equiv_harmonious_min_perc)*(VH6-D_equiv_harmonious_min_perc))+MAX(0,($BU6+($BV6-$BU6)/(D_equiv_harmonious_max_perc-D_equiv_harmonious_min_perc)*(VH6-D_equiv_harmonious_min_perc))-$DI6)/El_boiler_eff-$DF6)/BESS_chrg_eff,($DM6+($DN6-$DM6)/(Overall_harmonious_max_perc-Overall_harmonious_min_perc)*(WA6-Overall_harmonious_min_perc))-$DO6))", "XK" : "=IF(WA6=0,0,$DP6+($DQ6-$DP6)/(Overall_harmonious_max_perc-Overall_harmonious_min_perc)*(WA6-Overall_harmonious_min_perc))", "XL" : "=XU6/El_boiler_eff", "XM" : "=IF(WA6=0,0,$DD6+($DE6-$DD6)/(Overall_harmonious_max_perc-Overall_harmonious_min_perc)*(WA6-Overall_harmonious_min_perc))", "XN" : "=IF(WA6=0,0,$DA6+($DB6-$DA6)/(Overall_harmonious_max_perc-Overall_harmonious_min_perc)*(WA6-Overall_harmonious_min_perc))", "XO" : "=IF(WA6=0,0,MIN($DJ6+($DK6-$DJ6)/(Overall_harmonious_max_perc-Overall_harmonious_min_perc)*(WA6-Overall_harmonious_min_perc),MAX(0,-(XM6-XI6-XJ6-XL6))))", "XP" : "=XM6+XO6-SUM(XI6:XJ6,XL6)", "XQ" : "=IF(WA6=0,0,$CV6+($CW6-$CV6)/(Overall_harmonious_max_perc-Overall_harmonious_min_perc)*(WA6-Overall_harmonious_min_perc))", "XR" : "=IF(VH6=0,0,($CE6+($CF6-$CE6)/(D_equiv_harmonious_max_perc-D_equiv_harmonious_min_perc)*(VH6-D_equiv_harmonious_min_perc)))", "XS" : "=IF(WA6=0,0,$DG6+($DH6-$DG6)/(Overall_harmonious_max_perc-Overall_harmonious_min_perc)*(WA6-Overall_harmonious_min_perc))", "XT" : "=IF(WA6=0,0,($DP6+($DQ6-$DP6)/(Overall_harmonious_max_perc-Overall_harmonious_min_perc)*(WA6-Overall_harmonious_min_perc))*El_boiler_eff)", "XU" : "=IF(WA6=0,0,MIN(($DR6+($DS6-$DR6)/(Overall_harmonious_max_perc-Overall_harmonious_min_perc)*(WA6-Overall_harmonious_min_perc))*El_boiler_eff,MAX(0,XR6-XS6)))", "XV" : "=XS6+XU6-XR6", "XW" : "=IF(OR(WA6=0,VH6=0),0,$BS6+($BT6-$BS6)/(D_equiv_harmonious_max_perc-D_equiv_harmonious_min_perc)*(VH6-D_equiv_harmonious_min_perc))", "XX" : "=YF6/El_boiler_eff", "XY" : "=IF(OR(WA6=0,VH6=0),0,$DC6)", "XZ" : "=IF(OR(WA6=0,VH6=0),0,$DF6)", "YA" : "=XJ6*BESS_chrg_eff", "YB" : "=IF(OR(WA6=0,VH6=0),0,MIN($DL6+$DC6,MAX(0,-(SUM(XZ6:YA6)-SUM(XW6:XY6)))))", "YC" : "=SUM(XZ6:YB6)-SUM(XW6:XY6)", "YD" : "=IF(OR(WA6=0,VH6=0),0,$BU6+($BV6-$BU6)/(D_equiv_harmonious_max_perc-D_equiv_harmonious_min_perc)*(VH6-D_equiv_harmonious_min_perc))", "YE" : "=IF(OR(WA6=0,VH6=0),0,$DI6)", "YF" : "=IF(OR(WA6=0,VH6=0),0,MIN(($DT6+(#REF-$DT6)/(Overall_harmonious_max_perc-Overall_harmonious_min_perc)*(WA6-Overall_harmonious_min_perc))*El_boiler_eff,MAX(0,YD6-YE6)))", "YG" : "=SUM(YE6:YF6)-YD6", "YH" : "=IF(XH6<=0,0,XH6/(Overall_harmonious_var_max_cons+Overall_fix_cons)*MethDist_harmonious_max_perc*MethDist_Meth_nom_prod_ud)+IF(XW6<=0,0,XW6/(D_overall_var_max_cons+D_overall_fix_stby_cons)*D_MethDist_max_perc*MethDist_Meth_nom_prod_ud)", "YI" : "=MIN(XP6,IF(OR(WA6=0,VH6=0),0,($CX6+($CY6-$CX6)/(Overall_harmonious_max_perc-Overall_harmonious_min_perc)*(WA6-Overall_harmonious_min_perc))))+MIN(YC6,IF(OR(WA6=0,VH6=0),0,$CZ6))", "YJ" : "=XN6+XO6+YB6", "YK" : "=MAX(0,-XP6)+MAX(0,-XV6)+MAX(0,-YC6)+MAX(0,-YG6)",  "YM" : "=HW6", "YN" : "=MIN($C6*Grid_export_max_ud,$HX6)*Specific_Cost$P$8-($HY6)*Specific_Cost$P$7", "YO" : "=IFERROR(((Specific_Cost$P$5*LEC_Calc$AZ$3+LEC_Calc$BA$3)/365-YN6*1000)/YM6,\"NA\")", "YP" : "=HZ6", "YQ" : "=JB6", "YR" : "=MIN($C6*Grid_export_max_ud,$JC6)*Specific_Cost$P$8-($JD6)*Specific_Cost$P$7", "YS" : "=IFERROR(((Specific_Cost$P$5*LEC_Calc$AZ$3+LEC_Calc$BA$3)/365-YR6*1000)/YQ6,\"NA\")", "YT" : "=JE6", "YU" : "=MY6", "YV" : "=MIN($C6*Grid_export_max_ud,$MZ6)*Specific_Cost$P$8-($NA6)*Specific_Cost$P$7", "YW" : "=IFERROR(((Specific_Cost$P$5*LEC_Calc$AZ$3+LEC_Calc$BA$3)/365-YV6*1000)/YU6,\"NA\")", "YX" : "=NB6", "YY" : "=OD6", "YZ" : "=MIN($C6*Grid_export_max_ud,$OE6)*Specific_Cost$P$8-($OF6)*Specific_Cost$P$7", "ZA" : "=IFERROR(((Specific_Cost$P$5*LEC_Calc$AZ$3+LEC_Calc$BA$3)/365-YZ6*1000)/YY6,\"NA\")", "ZB" : "=OG6", "ZC" : "=SA6", "ZD" : "=MIN($C6*Grid_export_max_ud,$SB6)*Specific_Cost$P$8-($SC6)*Specific_Cost$P$7", "ZE" : "=IFERROR(((Specific_Cost$P$5*LEC_Calc$AZ$3+LEC_Calc$BA$3)/365-ZD6*1000)/ZC6,\"NA\")", "ZF" : "=SD6", "ZG" : "=TF6", "ZH" : "=MIN($C6*Grid_export_max_ud,$TG6)*Specific_Cost$P$8-($TH6)*Specific_Cost$P$7", "ZI" : "=IFERROR(((Specific_Cost$P$5*LEC_Calc$AZ$3+LEC_Calc$BA$3)/365-ZH6*1000)/ZG6,\"NA\")", "ZJ" : "=TI6", "ZK" : "=XC6", "ZL" : "=MIN($C6*Grid_export_max_ud,$XD6)*Specific_Cost$P$8-($XE6)*Specific_Cost$P$7", "ZM" : "=IFERROR(((Specific_Cost$P$5*LEC_Calc$AZ$3+LEC_Calc$BA$3)/365-ZL6*1000)/ZK6,\"NA\")", "ZN" : "=XF6", "ZO" : "=YH6", "ZP" : "=MIN($C6*Grid_export_max_ud,$YI6)*Specific_Cost$P$8-($YJ6)*Specific_Cost$P$7", "ZQ" : "=IFERROR(((Specific_Cost$P$5*LEC_Calc$AZ$3+LEC_Calc$BA$3)/365-ZP6*1000)/ZO6,\"NA\")", "ZR" : "=YK6", "ZS" : "=IF(YO6=MIN($YO6,$YS6,$YW6,$ZA6,$ZE6,$ZI6,$ZM6,$ZQ6),\"2a day prio\",IF(YS6=MIN($YO6,$YS6,$YW6,$ZA6,$ZE6,$ZI6,$ZM6,$ZQ6),\"2a night prio\",IF(YW6=MIN($YO6,$YS6,$YW6,$ZA6,$ZE6,$ZI6,$ZM6,$ZQ6),\"2b day prio\",IF(ZA6=MIN($YO6,$YS6,$YW6,$ZA6,$ZE6,$ZI6,$ZM6,$ZQ6),\"2b night prio\",IF(ZE6=MIN($YO6,$YS6,$YW6,$ZA6,$ZE6,$ZI6,$ZM6,$ZQ6),\"2c day prio\",IF(ZI6=MIN($YO6,$YS6,$YW6,$ZA6,$ZE6,$ZI6,$ZM6,$ZQ6),\"2c night prio\",IF(ZM6=MIN($YO6,$YS6,$YW6,$ZA6,$ZE6,$ZI6,$ZM6,$ZQ6),\"2d day prio\",IF(ZQ6=MIN($YO6,$YS6,$YW6,$ZA6,$ZE6,$ZI6,$ZM6,$ZQ6),\"2d night prio\",\"NA\"))))))))", "ZT" : "=IF($YO6=MIN($YO6,$YS6,$YW6,$ZA6,$ZE6,$ZI6,$ZM6,$ZQ6),YM6,IF($YS6=MIN($YO6,$YS6,$YW6,$ZA6,$ZE6,$ZI6,$ZM6,$ZQ6),YQ6,IF($YW6=MIN($YO6,$YS6,$YW6,$ZA6,$ZE6,$ZI6,$ZM6,$ZQ6),YU6,IF($ZA6=MIN($YO6,$YS6,$YW6,$ZA6,$ZE6,$ZI6,$ZM6,$ZQ6),YY6,IF($ZE6=MIN($YO6,$YS6,$YW6,$ZA6,$ZE6,$ZI6,$ZM6,$ZQ6),ZC6,IF($ZI6=MIN($YO6,$YS6,$YW6,$ZA6,$ZE6,$ZI6,$ZM6,$ZQ6),ZG6,IF($ZM6=MIN($YO6,$YS6,$YW6,$ZA6,$ZE6,$ZI6,$ZM6,$ZQ6),ZK6,IF($ZQ6=MIN($YO6,$YS6,$YW6,$ZA6,$ZE6,$ZI6,$ZM6,$ZQ6),ZO6,0))))))))", "ZU" : "=IF($YO6=MIN($YO6,$YS6,$YW6,$ZA6,$ZE6,$ZI6,$ZM6,$ZQ6),YN6,IF($YS6=MIN($YO6,$YS6,$YW6,$ZA6,$ZE6,$ZI6,$ZM6,$ZQ6),YR6,IF($YW6=MIN($YO6,$YS6,$YW6,$ZA6,$ZE6,$ZI6,$ZM6,$ZQ6),YV6,IF($ZA6=MIN($YO6,$YS6,$YW6,$ZA6,$ZE6,$ZI6,$ZM6,$ZQ6),YZ6,IF($ZE6=MIN($YO6,$YS6,$YW6,$ZA6,$ZE6,$ZI6,$ZM6,$ZQ6),ZD6,IF($ZI6=MIN($YO6,$YS6,$YW6,$ZA6,$ZE6,$ZI6,$ZM6,$ZQ6),ZH6,IF($ZM6=MIN($YO6,$YS6,$YW6,$ZA6,$ZE6,$ZI6,$ZM6,$ZQ6),ZL6,IF($ZQ6=MIN($YO6,$YS6,$YW6,$ZA6,$ZE6,$ZI6,$ZM6,$ZQ6),ZP6,0))))))))", "ZV" : "=IF($YO6=MIN($YO6,$YS6,$YW6,$ZA6,$ZE6,$ZI6,$ZM6,$ZQ6),YO6,IF($YS6=MIN($YO6,$YS6,$YW6,$ZA6,$ZE6,$ZI6,$ZM6,$ZQ6),YS6,IF($YW6=MIN($YO6,$YS6,$YW6,$ZA6,$ZE6,$ZI6,$ZM6,$ZQ6),YW6,IF($ZA6=MIN($YO6,$YS6,$YW6,$ZA6,$ZE6,$ZI6,$ZM6,$ZQ6),ZA6,IF($ZE6=MIN($YO6,$YS6,$YW6,$ZA6,$ZE6,$ZI6,$ZM6,$ZQ6),ZE6,IF($ZI6=MIN($YO6,$YS6,$YW6,$ZA6,$ZE6,$ZI6,$ZM6,$ZQ6),ZI6,IF($ZM6=MIN($YO6,$YS6,$YW6,$ZA6,$ZE6,$ZI6,$ZM6,$ZQ6),ZM6,IF($ZQ6=MIN($YO6,$YS6,$YW6,$ZA6,$ZE6,$ZI6,$ZM6,$ZQ6),ZQ6,0))))))))", "ZW" : "=IF($YO6=MIN($YO6,$YS6,$YW6,$ZA6,$ZE6,$ZI6,$ZM6,$ZQ6),YP6,IF($YS6=MIN($YO6,$YS6,$YW6,$ZA6,$ZE6,$ZI6,$ZM6,$ZQ6),YT6,IF($YW6=MIN($YO6,$YS6,$YW6,$ZA6,$ZE6,$ZI6,$ZM6,$ZQ6),YX6,IF($ZA6=MIN($YO6,$YS6,$YW6,$ZA6,$ZE6,$ZI6,$ZM6,$ZQ6),ZB6,IF($ZE6=MIN($YO6,$YS6,$YW6,$ZA6,$ZE6,$ZI6,$ZM6,$ZQ6),ZF6,IF($ZI6=MIN($YO6,$YS6,$YW6,$ZA6,$ZE6,$ZI6,$ZM6,$ZQ6),ZJ6,IF($ZM6=MIN($YO6,$YS6,$YW6,$ZA6,$ZE6,$ZI6,$ZM6,$ZQ6),ZN6,IF($ZQ6=MIN($YO6,$YS6,$YW6,$ZA6,$ZE6,$ZI6,$ZM6,$ZQ6),ZR6,0))))))))"
]

let titlesCalculation: [String: String] = [
"A" : "Month", "B" : "Day", "C" : "Hour", "D" : "Day of year", "E" : "Q_Sol (MW_th/Loop)", "F" : "Reference PV plant power at inverter inlet MWel_DC", "G" : "Reference PV MV power at transformer outlet MWel", "H" : "Inverter power fraction -", "I" : "Inverter efficiency -", "J" : "Q_solar (before dumping) MWth", "K" : "E_PV_Total _Scaled MWel_DC", "L" : "PV MV net power at transformer outlet MWel", "M" : "PV aux consumption at transformer level MWel", "N" : "", "O" : "Aux elec for PB stby, CSP SF and PV Plant MWel", "P" : "Available PV power MWel", "Q" : "Not covered aux elec for PB stby, CSP SF and PV Plant MWel", "R" : "Min harmonious net elec cons", "S" : "Optimized min harmonious net elec cons", "T" : "Min harmonious net heat cons", "U" : "Harmonious operation day", "V" : "Remaining PV after min harmonious", "W" : "Remaining CSP heat after min harmonious", "X" : "Grid import necessary for min harmonious", "Y" : "Remaining grid import capacity after min harmonious", "Z" : "El to el boiler after min harm heat cons", "AA" : "Remaining el boiler cap after min harm heat cons", "AB" : "Remaining MethSynt cap after min harm cons", "AC" : "Remaining CCU cap after min harm cons", "AD" : "Remaining EY cap after min harm cons", "AE" : "Max BESS charging after min harm cons", "AF" : "Max grid export after min harm cons", "AG" : "Max harm net elec cons", "AH" : "Optimized max harm net elec cons", "AI" : "max harm net heat cons", "AJ" : "Remaining PV after max harm", "AK" : "Remaining CSP heat after max harm", "AL" : "Grid import necessary for max harm", "AM" : "Remaining grid import capacity after max harm", "AN" : "El to el boiler after max harm heat cons", "AO" : "Remaining el boiler cap after max harm heat cons", "AP" : "Remaining MethSynt cap after max harm cons", "AQ" : "Remaining CCU cap after max harm cons", "AR" : "Remaining EY cap after max harm cons", "AS" : "Max BESS charging after max harm cons", "AT" : "Max grid export after max harm cons", "AU" : "", "AV" : "Aux elec for CSP SF and PV Plant MWel", "AW" : "Available PV power MWel", "AX" : "Not covered aux elec for CSP SF and PV Plant MWel", "AY" : "Max possible PV elec to TES (considering TES chrg aux)", "AZ" : "Maximum TES energy per PV day", "BA" : "Surplus energy due to TES size limit", "BB" : "Peripherial PV hour PV to heater", "BC" : "Surplus energy due to op limit after removal of peripherial hours", "BD" : "intermediate resulting PV elec to TES", "BE" : "Partitions of PV hour PV to be dedicated to TES chrg", "BF" : "corrected max possible PV elec to TES", "BG" : "Max possible CSP heat to TES", "BH" : "Not covered aux elec for TES chrg, CSP SF and PV Plant MWel", "BI" : "Remaining PV after TES chrg", "BJ" : "Remaining CSP heat after TES", "BK" : "Not covered aux elec for TES chrg, CSP SF and PV Plant MWel", "BL" : "Min harmonious net elec cons not considering grid import", "BM" : "Optimized min harmonious net elec cons", "BN" : "Min harmonious net heat cons", "BO" : "Harmonious operation day", "BP" : "Remaining PV after min harmonious", "BQ" : "Remaining CSP heat after min harmonious", "BR" : "Grid import necessary for min harm", "BS" : "Remaining grid import capacity after min harm", "BT" : "", "BU" : "Min net elec demand to power block", "BV" : "Optimized min net elec demand to power block", "BW" : "Outside harm op aux elec for TES dischrg, CSP SF and PV Plant MWel", "BX" : "Corresponding min PB net elec output", "BY" : "Corresponding min PB gross elec output", "BZ" : "ST startup heat cons", "CA" : "Min gross heat cons for ST", "CB" : "Min gross heat cons for extraction", "CC" : "TES energy needed to fulfil op case", "CD" : "Surplus TES energy due to op case", "CE" : "Peripherial PV hour PV to heater", "CF" : "Surplus energy due to op limit after removal of peripherial hours", "CG" : "intermediate resulting PV elec to TES", "CH" : "Partitions of PV hour PV to be dedicated to TES chrg", "CI" : "corrected max possible PV elec to TES", "CJ" : "Max possible CSP heat to TES", "CK" : "Available elec from PV after TES chrg", "CL" : "Available heat from CSP after TES", "CM" : "Total aux el TES chrg&disch CSP SF, PV, PB stby  MWel", "CN" : "Not covered aux elec MWel", "CO" : "", "CP" : "Min harmonious net elec cons not considering grid import", "CQ" : "Optimized min harmonious net elec cons", "CR" : "Min harmonious net heat cons", "CS" : "Harmonious op day", "CT" : "El cons due to op outside of harm op period", "CU" : "heat cons due to op outside of harm op period", "CV" : "Remaining el after min harmonious", "CW" : "Remaining heat after min harmonious", "CX" : "Grid import necessary for min harm", "CY" : "Remaining grid import capacity after min harm", "CZ" : "El boiler op after min harmonious heat cons", "DA" : "Remaining el boiler cap after min harmonious heat cons", "DB" : "Remaining MethSynt cap after min harmonious cons", "DC" : "Remaining CCU cap after min harmonious cons", "DD" : "Remaining EY cap after min harmonious cons", "DE" : "Max BESS charging after min harmonious cons", "DF" : "Max grid export after TES chrg, min harm, night and aux el  cons", "DG" : "Max harmonious net elec cons without considering grid", "DH" : "Optimized max harmonious net elec cons", "DI" : "max harmonious net heat cons", "DJ" : "Remaining el after max harmonious", "DK" : "Remaining heat after max harmonious", "DL" : "Grid import necessary for max harm", "DM" : "Remaining grid import capacity after max harm", "DN" : "El boiler op after max harmonious heat cons", "DO" : "Remaining el boiler cap after max harmonious heat cons", "DP" : "Remaining MethSynt cap after max harmonious cons", "DQ" : "Remaining CCU cap after max harmonious cons", "DR" : "Remaining EY cap after max harmonious cons", "DS" : "Max BESS charging after max harmonious cons", "DT" : "Max grid export after TES chrg, min harm, night and aux el  cons", "DU" : "", "DV" : "Maximum night op perc considering tank sizes", "DW" : "Max net elec demand outside harm op period", "DX" : "Optimized max net elec demand outside harm op period", "DY" : "Outside harm op aux elec for TES dischrg, CSP SF and PV Plant MWel", "DZ" : "Corresponding max PB net elec output", "EA" : "Corresponding max PB gross elec output", "EB" : "ST startup heat cons", "EC" : "Max gross heat cons for ST", "ED" : "Max gross heat cons for extraction", "EE" : "TES energy needed to fulfil op case", "EF" : "Surplus TES energy due to op case", "EG" : "Peripherial PV hour PV to heater", "EH" : "Surplus energy due to op limit after removal of peripherial hours", "EI" : "intermediate resulting PV elec to TES", "EJ" : "Partitions of PV hour PV to be dedicated to TES chrg", "EK" : "corrected max possible PV elec to TES", "EL" : "Max possible CSP heat to TES", "EM" : "Available elec from PV after TES chrg", "EN" : "Available heat from CSP after TES", "EO" : "Total aux el TES chrg&disch CSP SF, PV, PB stby  MWel", "EP" : "Not covered aux elec MWel", "EQ" : "", "ER" : "Min harmonious net elec cons not considering grid import", "ES" : "Optimized min harmonious net elec cons", "ET" : "Min harmonious net heat cons", "EU" : "Harmonious op day", "EV" : "El cons due to op outside of harm op period", "EW" : "heat cons due to op outside of harm op period", "EX" : "Remaining el after min harmonious", "EY" : "Remaining heat after min harmonious", "EZ" : "Grid import necessary for min harm", "FA" : "Remaining grid import capacity after min harm", "FB" : "El boiler op after min harmonious heat cons", "FC" : "Remaining el boiler cap after min harmonious heat cons", "FD" : "Remaining MethSynt cap after min harmonious cons", "FE" : "Remaining CCU cap after min harmonious cons", "FF" : "Remaining EY cap after min harmonious cons", "FG" : "Max BESS charging after min harmonious cons", "FH" : "Max grid export after TES chrg, min harm, night and aux el  cons", "FI" : "Max harmonious net elec cons without considering grid", "FJ" : "Optimized max harmonious net elec cons", "FK" : "max harmonious net heat cons", "FL" : "Remaining el after max harmonious", "FM" : "Remaining heat after max harmonious", "FN" : "Grid import necessary for max harm", "FO" : "Remaining grid import capacity after max harm", "FP" : "El boiler op after max harmonious heat cons", "FQ" : "Remaining el boiler cap after max harmonious heat cons", "FR" : "Remaining MethSynt cap after max harmonious cons", "FS" : "Remaining CCU cap after max harmonious cons", "FT" : "Remaining EY cap after max harmonious cons", "FU" : "Max BESS charging after max harmonious cons", "FV" : "Max grid export after TES chrg, min harm, night and aux el  cons", "FW" : "", "FX" : "Min net elec demand to power block", "FY" : "Optimized min net elec demand to power block", "FZ" : "Outside harm op aux elec for TES dischrg, CSP SF and PV Plant MWel", "GA" : "Corresponding min PB net elec output", "GB" : "Corresponding min PB gross elec output", "GC" : "ST startup heat cons", "GD" : "Min gross heat cons for ST", "GE" : "Min gross heat cons for extraction", "GF" : "TES energy needed to fulfil op case", "GG" : "Surplus TES energy due to op case", "GH" : "Peripherial PV hour PV to heater", "GI" : "Surplus energy due to op limit after removal of peripherial hours", "GJ" : "intermediate resulting PV elec to TES", "GK" : "Partitions of PV hour PV to be dedicated to TES chrg", "GL" : "corrected max possible PV elec to TES", "GM" : "Max possible CSP heat to TES", "GN" : "Available elec from PV after TES chrg", "GO" : "Available heat from CSP after TES", "GP" : "Total aux el TES chrg&disch CSP SF, PV, PB stby  MWel", "GQ" : "Not covered aux elec MWel"
]

let titlesDaily1: [String: String] = [
"A" : "Day", "B" : "", "C" : "Nr of hours outside of min harm op period", "D" : "Nr of night prep hours during harm op period", "E" : "Min RawMeth cons during night", "F" : "Max RawMeth cons during night", "G" : "Min CO2 cons during night", "H" : "Max CO2 cons during night", "I" : "Min H2 cons during night", "J" : "Max H2 cons during night", "K" : "Min el cons during day for night op prep", "L" : "Max el cons during day for night op prep", "M" : "Min heat cons during day for night op prep", "N" : "Max heat cons during day for prep of night", "O" : "Surplus RawMeth storage cap after night min op  prep", "P" : "Surplus RawMeth storage cap after max night op prep", "Q" : "Surplus CO2 storage cap after min night op prep", "R" : "Surplus CO2 storage cap after max night op prep", "S" : "Surplus H2 storage cap after min night op prep", "T" : "Surplus H2 storage cap after max night op prep", "U" : "Max Equiv harmonious night prod due to physical limits", "V" : "", "W" : "Nr of hours outside of min harm op period", "X" : "Nr of min harm op period hours", "Y" : "Min RawMeth cons during night", "Z" : "Max RawMeth cons during night", "AA" : "Min CO2 cons during night", "AB" : "Max CO2 cons during night", "AC" : "Min H2 cons during night", "AD" : "Max H2 cons during night", "AE" : "Min el cons during day for night op prep", "AF" : "Max el cons during day for night op prep", "AG" : "Min heat cons during day for night op prep", "AH" : "Max heat cons during day for prep of night", "AI" : "Surplus RawMeth storage cap after night min op  prep", "AJ" : "Surplus RawMeth storage cap after max night op prep", "AK" : "Surplus CO2 storage cap after min night op prep", "AL" : "Surplus CO2 storage cap after max night op prep", "AM" : "Surplus H2 storage cap after min night op prep", "AN" : "Surplus H2 storage cap after max night op prep", "AO" : "Max Equiv harmonious night prod due to physical limits", "AP" : "", "AQ" : "Nr of hours outside of min harm op period", "AR" : "Nr of min harm op period hours", "AS" : "Min RawMeth cons during night", "AT" : "Max RawMeth cons during night", "AU" : "Min CO2 cons during night", "AV" : "Max CO2 cons during night", "AW" : "Min H2 cons during night", "AX" : "Max H2 cons during night", "AY" : "Min el cons during day for night op prep", "AZ" : "Max el cons during day for night op prep", "BA" : "Min heat cons during day for night op prep", "BB" : "Max heat cons during day for prep of night", "BC" : "Surplus RawMeth storage cap after night min op  prep", "BD" : "Surplus RawMeth storage cap after max night op prep", "BE" : "Surplus CO2 storage cap after min night op prep", "BF" : "Surplus CO2 storage cap after max night op prep", "BG" : "Surplus H2 storage cap after min night op prep", "BH" : "Surplus H2 storage cap after max night op prep", "BI" : "Max Equiv harmonious night prod due to physical limits", "BJ" : "", "BK" : "Nr of hours outside of min harm op period", "BL" : "Nr of min harm op period hours", "BM" : "Min RawMeth cons during night", "BN" : "Max RawMeth cons during night", "BO" : "Min CO2 cons during night", "BP" : "Max CO2 cons during night", "BQ" : "Min H2 cons during night", "BR" : "Max H2 cons during night", "BS" : "Min el cons during day for night op prep", "BT" : "Max el cons during day for night op prep", "BU" : "Min heat cons during day for night op prep", "BV" : "Max heat cons during day for prep of night", "BW" : "Surplus RawMeth storage cap after night min op  prep", "BX" : "Surplus RawMeth storage cap after max night op prep", "BY" : "Surplus CO2 storage cap after min night op prep", "BZ" : "Surplus CO2 storage cap after max night op prep", "CA" : "Surplus H2 storage cap after min night op prep", "CB" : "Surplus H2 storage cap after max night op prep", "CC" : "Max Equiv harmonious night prod due to physical limits", "CD" : "", "CE" : "Available elec after TES chrg during harm op period", "CF" : "Available elec after TES chrg outside harm op period", "CG" : "Available heat after TES chrg during harm op period", "CH" : "Available heat after TES chrg outside of harm op period", "CI" : "Harm el cons considering min harm op during harm op period", "CJ" : "Harm el cons considering max harm op during harm op period", "CK" : "Harm el cons outside of harm op period", "CL" : "Harm heat cons considering min harm op during harm op period", "CM" : "Harm heat cons considering max harm op during harm op period", "CN" : "Harm heat cons outside of harm op period", "CO" : "El boiler op considering min harm op during harm op period", "CP" : "El boiler op considering max harm op during harm op period", "CQ" : "El boiler op outside harm op period", "CR" : "Total aux cons during harm op period", "CS" : "Total aux cons outside of harm op period", "CT" : "El cons not covered during harm op period", "CU" : "El cons not covered outside of harm op period", "CV" : "Remaining PV el after TES chrg&min harm&aux during harm op period", "CW" : "Remaining PV el after TES chrg&max harm&aux op during harm op period", "CX" : "Remaining PV el outside of harm op period", "CY" : "Remaining CSP heat after min harm during harm op period", "CZ" : "Remaining CSP heat after max harm op during harm op period", "DA" : "Remaining CSP heat outside of harm op period", "DB" : "Max BESS night prep after min harm cons during harm op period", "DC" : "Max BESS night prep after max harm cons during harm op period", "DD" : "Max BESS night prep outside of harm op period", "DE" : "Max grid export after min harm cons during harm op period", "DF" : "Max grid export after max harm cons during harm op period", "DG" : "Max grid export outside of harm op period", "DH" : "Remaining El boiler cap during harm op period after min harm", "DI" : "Remaining El boiler cap during harm op period after max harm", "DJ" : "Remaining El boiler cap outside of harm op period", "DK" : "Remaining MethSynt cap during harm op after min harm op", "DL" : "Remaining MethSynt cap during harm op period after max harm op", "DM" : "Remaining MethSynt cap outside of harm op period", "DN" : "Remaining CCU cap during harm op after min harm", "DO" : "Remaining CCU cap during harm op after max harm", "DP" : "Remaining CCU cap outside of harm op after min harm", "DQ" : "Remaining EY cap during harm op after min harm", "DR" : "Remaining EY cap during harm op period after max harm", "DS" : "Remaining EY cap outside of harm op period", "DT" : "", "DU" : "Available elec after TES chrg during harm op period", "DV" : "Available elec after TES chrg outside harm op period", "DW" : "Available heat after TES chrg during harm op period", "DX" : "Available heat after TES chrg outside of harm op period", "DY" : "Harm el cons considering min harm op during harm op period", "DZ" : "Harm el cons considering max harm op during harm op period", "EA" : "Harm el cons outside of harm op period", "EB" : "Harm heat cons considering min harm op during harm op period", "EC" : "Harm heat cons considering max harm op during harm op period", "ED" : "Harm heat cons outside of harm op period", "EE" : "El boiler op considering min harm op during harm op period", "EF" : "El boiler op considering max harm op during harm op period", "EG" : "El boiler op outside harm op period", "EH" : "Total aux cons during harm op period", "EI" : "Total aux cons outside of harm op period", "EJ" : "El cons not covered during harm op period", "EK" : "El cons not covered outside of harm op period", "EL" : "Remaining PV el after TES chrg& min harm&aux during harm op period", "EM" : "Remaining PV el after TES chrg& max harm&aux during harm op period", "EN" : "Remaining PV el outside of harm op period", "EO" : "Remaining CSP heat after min harm during harm op period", "EP" : "Remaining CSP heat after max harm op during harm op period", "EQ" : "Remaining CSP heat outside of harm op period", "ER" : "Max elec to BESS for night prep after min harm op during harm op period", "ES" : "Max elec to BESS for night prep after max harm op during harm op period", "ET" : "Max elec to BESS for night prep outside of harm op period", "EU" : "Max grid export after min harm cons during harm op period", "EV" : "Max grid export after max harm cons during harm op period", "EW" : "Max grid export outside of harm op period", "EX" : "Remaining El boiler cap during harm op period after min harm", "EY" : "Remaining El boiler cap during harm op period after max harm", "EZ" : "Remaining El boiler cap outside of harm op period", "FA" : "Remaining MethSynt cap during harm op after min harm op", "FB" : "Remaining MethSynt cap during harm op period after max harm op", "FC" : "Remaining MethSynt cap outside of harm op period", "FD" : "Remaining CCU cap during harm op after min harm", "FE" : "Remaining CCU cap during harm op after max harm", "FF" : "Remaining CCU cap outside of harm op after min harm", "FG" : "Remaining EY cap during harm op after min harm", "FH" : "Remaining EY cap during harm op period after max harm", "FI" : "Remaining EY cap outside of harm op period", "FJ" : "", "FK" : "Surplus harm op period electricity after min harm op and min night op prep", "FL" : "Surplus harm op period electricity after min harm op and max night op prep", "FM" : "Surplus harm op period electricity after max harm op and min night op prep", "FN" : "Surplus harm op heat+boiler prod after min harm op and min night op prep", "FO" : "Surplus harm op heat+boiler prod after min harm op and max night op prep", "FP" : "Surplus harm op heat+boiler prod after max harm op and min night op prep", "FQ" : "Surplus el boiler cap after min harm op and min night op prep", "FR" : "Surplus el boiler cap after min harm op and max night op prep", "FS" : "Surplus el boiler cap after max harm op and min night op prep", "FT" : "Surplus BESS chrg cap after min harm op and min night op prep", "FU" : "Surplus BESS chrg cap after min harm op and max night op prep", "FV" : "Surplus BESS chrg cap after max harm op and min night op prep", "FW" : "Surplus RawMeth prod cap after min harm op and min night op prep", "FX" : "Surplus RawMeth prod cap after min harm op and max night op prep", "FY" : "Surplus RawMeth prod cap after max harm op and min night op prep", "FZ" : "Surplus CO2 prod cap after min harm op and min night op prep", "GA" : "Surplus CO2 prod cap after min harm op and max night op prep", "GB" : "Surplus CO2 prod cap after max harm op and min night op prep", "GC" : "Surplus H2 prod cap after min harm op and min night op prep", "GD" : "Surplus H2 prod cap after min harm op and max night op prep", "GE" : "Surplus H2 prod cap after max harm op and min night op prep", "GF" : "", "GG" : "Optimal harmonious day prod after min night prep due to prod cap limits", "GH" : "Surplus harm op period electricity after opt harmonious and min night op prep", "GI" : "Surplus harm op period electricity after opt harmonious and max night op prep", "GJ" : "Surplus harm op csp steam+boiler prod cap after opt day harm and min night op prep", "GK" : "Surplus harm op csp steam+boiler prod cap after opt day harm and max night op prep", "GL" : "Surplus el boiler cap after opt day harm and min night op prep", "GM" : "Surplus el boiler cap after opt day harm and max night op prep", "GN" : "Surplus BESS chrg cap after opt day harm and min night op prep", "GO" : "Surplus BESS chrg cap after opt day harm and max night op prep", "GP" : "Surplus RawMeth prod cap after opt day harm and min night op prep", "GQ" : "Surplus RawMeth prod cap after opt day harm and max night op prep", "GR" : "Surplus CO2 prod cap after opt day harm and min night op prep", "GS" : "Surplus CO2 prod cap after opt day harm and max night op prep", "GT" : "Surplus H2 prod cap after opt day harm and min night op prep", "GU" : "Surplus H2 prod cap after opt day harm and max night op prep", "GV" : "Opt night prep during day prio operation", "GW" : "", "GX" : "min harmonious day prod after opt equiv harmonious night prod due to prod cap limits", "GY" : "Surplus harm op period electricity after min day harmonious and opti night op prep", "GZ" : "Surplus harm op period electricity after max day harmonious and opti night op prep", "HA" : "Surplus harmonious op csp steam+boiler prod cap after min day harmonious and opti night op prep", "HB" : "Surplus harmonious op csp steam+boiler prod cap after max day harmonious and opti night op prep", "HC" : "Surplus el boiler cap after min day harmonious and opti night op prep", "HD" : "Surplus el boiler cap after max day harmonious and opti night op prep", "HE" : "Surplus BESS cap after min day harmonious and opti night op prep", "HF" : "Surplus BESS cap after max day harmonious and opti night op prep", "HG" : "Surplus RawMeth prod cap after min day harmonious and opti night op prep", "HH" : "Surplus RawMeth prod cap after max day harmonious and opti night op prep", "HI" : "Surplus CO2 prod cap after min day harmonious and opti night op prep", "HJ" : "Surplus CO2 prod cap after max day harmonious and opti night op prep", "HK" : "Surplus H2 prod cap after min day harmonious and opti night op prep", "HL" : "Surplus H2 prod cap after max day harmonious and opti night op prep", "HM" : "Opt harm op period op during night prio operation", "HN" : "", "HO" : "el cons for harm op during harm op period", "HP" : "el cons for night prep during harm op period", "HQ" : "el to cover aux cons during harm op period", "HR" : "el cons for BESS charging during harm op period", "HS" : "el cons for el boiler op for harm op during harm op period", "HT" : "el cons for el boiler op for night prep during harm op period", "HU" : "El available during harm op period after TES chrg", "HV" : "Grid import needed during harm op period", "HW" : "Balance of electricity during harm op period", "HX" : "heat cons for harm op during harm op period", "HY" : "heat cons for night prep during harm op period", "HZ" : "heat prod by el boiler for harm op during harm op period", "IA" : "heat prod by el boiler for night prep during harm op period", "IB" : "Heat available during harm op period after TES chrg", "IC" : "Balance of heat during harm op period", "ID" : "el cons for harm op outside of harm op period", "IE" : "el to cover aux cons outside of harm op period", "IF" : "el cons for el boiler for harm op outside of harm op period", "IG" : "el from BESS discharging outside of harm op period", "IH" : "El available outside of harm op period after TES chrg", "II" : "Grid import needed outside of harm op period", "IJ" : "Balance of electricity outside of harm op period", "IK" : "heat cons for harm op outside of harm op period", "IL" : "Heat prod by el boiler for harm op outside of harm op period", "IM" : "Heat available outside of harm op period after TES chrg", "IN" : "Balance of heat outside of harm op period", "IO" : "Pure Methanol prod with day priority and resp night op", "IP" : "grid export", "IQ" : "Grid import", "IR" : "Checksum", "IS" : "", "IT" : "el cons for harm op during harm op period", "IU" : "el cons for night prep during harm op period", "IV" : "el to cover aux cons during harm op period", "IW" : "el cons for BESS charging during harm op period", "IX" : "el cons for el boiler op for harm op during harm op period", "IY" : "el cons for el boiler op for night prep during harm op period", "IZ" : "El available during harm op period after TES chrg", "JA" : "Grid import needed during harm op period", "JB" : "Balance of electricity during harm op period", "JC" : "heat cons for harm op during harm op period", "JD" : "heat cons for night prep during harm op period", "JE" : "heat prod by el boiler for harm op during harm op period", "JF" : "heat prod by el boiler for night prep during harm op period", "JG" : "Heat available during harm op period after TES chrg", "JH" : "Balance of heat during harm op period", "JI" : "el cons for harm op outside of harm op period", "JJ" : "el to cover aux cons outside of harm op period", "JK" : "el cons for el boiler for harm op outside of harm op period", "JL" : "el from BESS discharging outside of harm op period", "JM" : "El available outside of harm op period after TES chrg", "JN" : "Grid import needed outside of harm op period", "JO" : "Balance of electricity outside of harm op period", "JP" : "heat cons for harm op outside of harm op period", "JQ" : "Heat prod by el boiler for harm op outside of harm op period", "JR" : "Heat available outside of harm op period after TES chrg", "JS" : "Balance of heat outside of harm op period", "JT" : "Pure Methanol prod with night priority and resp day op", "JU" : "Grid export", "JV" : "Grid import", "JW" : "Checksum", "JX" : "", "JY" : "Available elec after TES chrg during harm op period", "JZ" : "Available elec after TES chrg outside harm op period", "KA" : "Available heat after TES chrg during harm op period", "KB" : "Available heat after TES chrg outside of harm op period", "KC" : "Harm el cons considering min harm op during harm op period", "KD" : "Harm el cons considering max harm op during harm op period", "KE" : "Harm el cons outside of harm op period", "KF" : "Harm heat cons considering min harm op during harm op period", "KG" : "Harm heat cons considering max harm op during harm op period", "KH" : "Harm heat cons outside of harm op period", "KI" : "El boiler op considering min harm op during harm op period", "KJ" : "El boiler op considering max harm op during harm op period", "KK" : "El boiler op outside harm op period", "KL" : "Total aux cons during harm op period", "KM" : "Total aux cons outside of harm op period", "KN" : "El cons not covered during harm op period", "KO" : "El cons not covered outside of harm op period", "KP" : "Remaining PV el after TES chrg&min harm&aux during harm op period", "KQ" : "Remaining PV el after TES chrg&max harm&aux op during harm op period", "KR" : "Remaining PV el outside of harm op period", "KS" : "Remaining CSP heat after min harm during harm op period", "KT" : "Remaining CSP heat after max harm op during harm op period", "KU" : "Remaining CSP heat outside of harm op period", "KV" : "Max BESS night prep after min harm cons during harm op period", "KW" : "Max BESS night prep after max harm cons during harm op period", "KX" : "Max BESS night prep outside of harm op period", "KY" : "Max grid export after min harm cons during harm op period", "KZ" : "Max grid export after max harm cons during harm op period", "LA" : "Max grid export outside of harm op period", "LB" : "Remaining El boiler cap during harm op period after min harm", "LC" : "Remaining El boiler cap during harm op period after max harm", "LD" : "Remaining El boiler cap outside of harm op period", "LE" : "Remaining MethSynt cap during harm op after min harm op", "LF" : "Remaining MethSynt cap during harm op period after max harm op", "LG" : "Remaining MethSynt cap outside of harm op period", "LH" : "Remaining CCU cap during harm op after min harm", "LI" : "Remaining CCU cap during harm op after max harm", "LJ" : "Remaining CCU cap outside of harm op after min harm", "LK" : "Remaining EY cap during harm op after min harm", "LL" : "Remaining EY cap during harm op period after max harm", "LM" : "Remaining EY cap outside of harm op period", "LN" : "", "LO" : "Available elec after TES chrg during harm op period", "LP" : "Available elec after TES chrg outside harm op period", "LQ" : "Available heat after TES chrg during harm op period", "LR" : "Available heat after TES chrg outside of harm op period", "LS" : "Harm el cons considering min harm op during harm op period", "LT" : "Harm el cons considering max harm op during harm op period", "LU" : "Harm el cons outside of harm op period", "LV" : "Harm heat cons considering min harm op during harm op period", "LW" : "Harm heat cons considering max harm op during harm op period", "LX" : "Harm heat cons outside of harm op period", "LY" : "El boiler op considering min harm op during harm op period", "LZ" : "El boiler op considering max harm op during harm op period", "MA" : "El boiler op outside harm op period", "MB" : "Total aux cons during harm op period", "MC" : "Total aux cons outside of harm op period", "MD" : "El cons not covered during harm op period", "ME" : "El cons not covered outside of harm op period", "MF" : "Remaining PV el after TES chrg& min harm&aux during harm op period", "MG" : "Remaining PV el after TES chrg& max harm&aux during harm op period", "MH" : "Remaining PV el outside of harm op period", "MI" : "Remaining CSP heat after min harm during harm op period", "MJ" : "Remaining CSP heat after max harm op during harm op period", "MK" : "Remaining CSP heat outside of harm op period", "ML" : "Max elec to BESS for night prep after min harm op during harm op period", "MM" : "Max elec to BESS for night prep after max harm op during harm op period", "MN" : "Max elec to BESS for night prep outside of harm op period", "MO" : "Max grid export after min harm cons during harm op period", "MP" : "Max grid export after max harm cons during harm op period", "MQ" : "Max grid export outside of harm op period", "MR" : "Remaining El boiler cap during harm op period after min harm", "MS" : "Remaining El boiler cap during harm op period after max harm", "MT" : "Remaining El boiler cap outside of harm op period", "MU" : "Remaining MethSynt cap during harm op after min harm op", "MV" : "Remaining MethSynt cap during harm op period after max harm op", "MW" : "Remaining MethSynt cap outside of harm op period", "MX" : "Remaining CCU cap during harm op after min harm", "MY" : "Remaining CCU cap during harm op after max harm", "MZ" : "Remaining CCU cap outside of harm op after min harm", "NA" : "Remaining EY cap during harm op after min harm", "NB" : "Remaining EY cap during harm op period after max harm", "NC" : "Remaining EY cap outside of harm op period", "ND" : "", "NE" : "Surplus harm op period electricity after min harm op and min night op prep", "NF" : "Surplus harm op period electricity after min harm op and max night op prep", "NG" : "Surplus harm op period electricity after max harm op and min night op prep", "NH" : "Surplus harm op heat+boiler prod after min harm op and min night op prep", "NI" : "Surplus harm op heat+boiler prod after min harm op and max night op prep", "NJ" : "Surplus harm op heat+boiler prod after max harm op and min night op prep", "NK" : "Surplus el boiler cap after min harm op and min night op prep", "NL" : "Surplus el boiler cap after min harm op and max night op prep", "NM" : "Surplus el boiler cap after max harm op and min night op prep", "NN" : "Surplus BESS chrg cap after min harm op and min night op prep", "NO" : "Surplus BESS chrg cap after min harm op and max night op prep", "NP" : "Surplus BESS chrg cap after max harm op and min night op prep", "NQ" : "Surplus RawMeth prod cap after min harm op and min night op prep", "NR" : "Surplus RawMeth prod cap after min harm op and max night op prep", "NS" : "Surplus RawMeth prod cap after max harm op and min night op prep", "NT" : "Surplus CO2 prod cap after min harm op and min night op prep", "NU" : "Surplus CO2 prod cap after min harm op and max night op prep", "NV" : "Surplus CO2 prod cap after max harm op and min night op prep", "NW" : "Surplus H2 prod cap after min harm op and min night op prep", "NX" : "Surplus H2 prod cap after min harm op and max night op prep", "NY" : "Surplus H2 prod cap after max harm op and min night op prep", "NZ" : "", "OA" : "Optimal harmonious day prod after min night prep due to prod cap limits", "OB" : "Surplus harm op period electricity after opt harmonious and min night op prep", "OC" : "Surplus harm op period electricity after opt harmonious and max night op prep", "OD" : "Surplus harm op csp steam+boiler prod cap after opt day harm and min night op prep", "OE" : "Surplus harm op csp steam+boiler prod cap after opt day harm and max night op prep", "OF" : "Surplus el boiler cap after opt day harm and min night op prep", "OG" : "Surplus el boiler cap after opt day harm and max night op prep", "OH" : "Surplus BESS chrg cap after opt day harm and min night op prep", "OI" : "Surplus BESS chrg cap after opt day harm and max night op prep", "OJ" : "Surplus RawMeth prod cap after opt day harm and min night op prep", "OK" : "Surplus RawMeth prod cap after opt day harm and max night op prep", "OL" : "Surplus CO2 prod cap after opt day harm and min night op prep", "OM" : "Surplus CO2 prod cap after opt day harm and max night op prep", "ON" : "Surplus H2 prod cap after opt day harm and min night op prep", "OO" : "Surplus H2 prod cap after opt day harm and max night op prep", "OP" : "Opt night prep during day prio operation", "OQ" : "", "OR" : "min harmonious day prod after opt equiv harmonious night prod due to prod cap limits", "OS" : "Surplus harm op period electricity after min day harmonious and opti night op prep", "OT" : "Surplus harm op period electricity after max day harmonious and opti night op prep", "OU" : "Surplus harmonious op csp steam+boiler prod cap after min day harmonious and opti night op prep", "OV" : "Surplus harmonious op csp steam+boiler prod cap after max day harmonious and opti night op prep", "OW" : "Surplus el boiler cap after min day harmonious and opti night op prep", "OX" : "Surplus el boiler cap after max day harmonious and opti night op prep", "OY" : "Surplus BESS cap after min day harmonious and opti night op prep", "OZ" : "Surplus BESS cap after max day harmonious and opti night op prep", "PA" : "Surplus RawMeth prod cap after min day harmonious and opti night op prep", "PB" : "Surplus RawMeth prod cap after max day harmonious and opti night op prep", "PC" : "Surplus CO2 prod cap after min day harmonious and opti night op prep", "PD" : "Surplus CO2 prod cap after max day harmonious and opti night op prep", "PE" : "Surplus H2 prod cap after min day harmonious and opti night op prep", "PF" : "Surplus H2 prod cap after max day harmonious and opti night op prep", "PG" : "Opt harm op period op during night prio operation", "PH" : "", "PI" : "el cons for harm op during harm op period", "PJ" : "el cons for night prep during harm op period", "PK" : "el to cover aux cons during harm op period", "PL" : "el cons for BESS charging during harm op period", "PM" : "el cons for el boiler op for harm op during harm op period", "PN" : "el cons for el boiler op for night prep during harm op period", "PO" : "El available during harm op period after TES chrg", "PP" : "Grid import needed during harm op period", "PQ" : "Balance of electricity during harm op period", "PR" : "heat cons for harm op during harm op period", "PS" : "heat cons for night prep during harm op period", "PT" : "heat prod by el boiler for harm op during harm op period", "PU" : "heat prod by el boiler for night prep during harm op period", "PV" : "Heat available during harm op period after TES chrg", "PW" : "Balance of heat during harm op period", "PX" : "el cons for harm op outside of harm op period", "PY" : "el to cover aux cons outside of harm op period", "PZ" : "el cons for el boiler for harm op outside of harm op period", "QA" : "el from BESS discharging outside of harm op period", "QB" : "El available outside of harm op period after TES chrg", "QC" : "Grid import needed outside of harm op period", "QD" : "Balance of electricity outside of harm op period", "QE" : "heat cons for harm op outside of harm op period", "QF" : "Heat prod by el boiler for harm op outside of harm op period", "QG" : "Heat available outside of harm op period after TES chrg", "QH" : "Balance of heat outside of harm op period", "QI" : "Pure Methanol prod with day priority and resp night op", "QJ" : "Grid export", "QK" : "Grid import", "QL" : "Checksum", "QM" : "", "QN" : "el cons for harm op during harm op period", "QO" : "el cons for night prep during harm op period", "QP" : "el to cover aux cons during harm op period", "QQ" : "el cons for BESS charging during harm op period", "QR" : "el cons for el boiler op for harm op during harm op period", "QS" : "el cons for el boiler op for night prep during harm op period", "QT" : "El available during harm op period after TES chrg", "QU" : "Grid import needed during harm op period", "QV" : "Balance of electricity during harm op period", "QW" : "heat cons for harm op during harm op period", "QX" : "heat cons for night prep during harm op period", "QY" : "heat prod by el boiler for harm op during harm op period", "QZ" : "heat prod by el boiler for night prep during harm op period", "RA" : "Heat available during harm op period after TES chrg", "RB" : "Balance of heat during harm op period", "RC" : "el cons for harm op outside of harm op period", "RD" : "el to cover aux cons outside of harm op period", "RE" : "el cons for el boiler for harm op outside of harm op period", "RF" : "el from BESS discharging outside of harm op period", "RG" : "El available outside of harm op period after TES chrg", "RH" : "Grid import needed outside of harm op period", "RI" : "Balance of electricity outside of harm op period", "RJ" : "heat cons for harm op outside of harm op period", "RK" : "Heat prod by el boiler for harm op outside of harm op period", "RL" : "Heat available outside of harm op period after TES chrg", "RM" : "Balance of heat outside of harm op period", "RN" : "Pure Methanol prod with night priority and resp day op", "RO" : "Grid export", "RP" : "Grid import", "RQ" : "Checksum", "RR" : "", "RS" : "Available elec after TES chrg during harm op period", "RT" : "Available elec after TES chrg outside harm op period", "RU" : "Available heat after TES chrg during harm op period", "RV" : "Available heat after TES chrg outside of harm op period", "RW" : "Harm el cons considering min harm op during harm op period", "RX" : "Harm el cons considering max harm op during harm op period", "RY" : "Harm el cons outside of harm op period", "RZ" : "Harm heat cons considering min harm op during harm op period", "SA" : "Harm heat cons considering max harm op during harm op period", "SB" : "Harm heat cons outside of harm op period", "SC" : "El boiler op considering min harm op during harm op period", "SD" : "El boiler op considering max harm op during harm op period", "SE" : "El boiler op outside harm op period", "SF" : "Total aux cons during harm op period", "SG" : "Total aux cons outside of harm op period", "SH" : "El cons not covered during harm op period", "SI" : "El cons not covered outside of harm op period", "SJ" : "Remaining PV el after TES chrg&min harm&aux during harm op period", "SK" : "Remaining PV el after TES chrg&max harm&aux op during harm op period", "SL" : "Remaining PV el outside of harm op period", "SM" : "Remaining CSP heat after min harm during harm op period", "SN" : "Remaining CSP heat after max harm op during harm op period", "SO" : "Remaining CSP heat outside of harm op period", "SP" : "Max BESS night prep after min harm cons during harm op period", "SQ" : "Max BESS night prep after max harm cons during harm op period", "SR" : "Max BESS night prep outside of harm op period", "SS" : "Max grid export after min harm cons during harm op period", "ST" : "Max grid export after max harm cons during harm op period", "SU" : "Max grid export outside of harm op period", "SV" : "Remaining El boiler cap during harm op period after min harm", "SW" : "Remaining El boiler cap during harm op period after max harm", "SX" : "Remaining El boiler cap outside of harm op period", "SY" : "Remaining MethSynt cap during harm op after min harm op", "SZ" : "Remaining MethSynt cap during harm op period after max harm op", "TA" : "Remaining MethSynt cap outside of harm op period", "TB" : "Remaining CCU cap during harm op after min harm", "TC" : "Remaining CCU cap during harm op after max harm", "TD" : "Remaining CCU cap outside of harm op after min harm", "TE" : "Remaining EY cap during harm op after min harm", "TF" : "Remaining EY cap during harm op period after max harm", "TG" : "Remaining EY cap outside of harm op period", "TH" : "", "TI" : "Available elec after TES chrg during harm op period", "TJ" : "Available elec after TES chrg outside harm op period", "TK" : "Available heat after TES chrg during harm op period", "TL" : "Available heat after TES chrg outside of harm op period", "TM" : "Harm el cons considering min harm op during harm op period", "TN" : "Harm el cons considering max harm op during harm op period", "TO" : "Harm el cons outside of harm op period", "TP" : "Harm heat cons considering min harm op during harm op period", "TQ" : "Harm heat cons considering max harm op during harm op period", "TR" : "Harm heat cons outside of harm op period", "TS" : "El boiler op considering min harm op during harm op period", "TT" : "El boiler op considering max harm op during harm op period", "TU" : "El boiler op outside harm op period", "TV" : "Total aux cons during harm op period", "TW" : "Total aux cons outside of harm op period", "TX" : "El cons not covered during harm op period", "TY" : "El cons not covered outside of harm op period", "TZ" : "Remaining PV el after TES chrg& min harm&aux during harm op period", "UA" : "Remaining PV el after TES chrg& max harm&aux during harm op period", "UB" : "Remaining PV el outside of harm op period", "UC" : "Remaining CSP heat after min harm during harm op period", "UD" : "Remaining CSP heat after max harm op during harm op period", "UE" : "Remaining CSP heat outside of harm op period", "UF" : "Max elec to BESS for night prep after min harm op during harm op period", "UG" : "Max elec to BESS for night prep after max harm op during harm op period", "UH" : "Max elec to BESS for night prep outside of harm op period", "UI" : "Max grid export after min harm cons during harm op period", "UJ" : "Max grid export after max harm cons during harm op period", "UK" : "Max grid export outside of harm op period", "UL" : "Remaining El boiler cap during harm op period after min harm", "UM" : "Remaining El boiler cap during harm op period after max harm", "UN" : "Remaining El boiler cap outside of harm op period", "UO" : "Remaining MethSynt cap during harm op after min harm op", "UP" : "Remaining MethSynt cap during harm op period after max harm op", "UQ" : "Remaining MethSynt cap outside of harm op period", "UR" : "Remaining CCU cap during harm op after min harm", "US" : "Remaining CCU cap during harm op after max harm", "UT" : "Remaining CCU cap outside of harm op after min harm", "UU" : "Remaining EY cap during harm op after min harm", "UV" : "Remaining EY cap during harm op period after max harm", "UW" : "Remaining EY cap outside of harm op period", "UX" : "", "UY" : "Surplus harm op period electricity after min harm op and min night op prep", "UZ" : "Surplus harm op period electricity after min harm op and max night op prep", "VA" : "Surplus harm op period electricity after max harm op and min night op prep", "VB" : "Surplus harm op heat+boiler prod after min harm op and min night op prep", "VC" : "Surplus harm op heat+boiler prod after min harm op and max night op prep", "VD" : "Surplus harm op heat+boiler prod after max harm op and min night op prep", "VE" : "Surplus el boiler cap after min harm op and min night op prep", "VF" : "Surplus el boiler cap after min harm op and max night op prep", "VG" : "Surplus el boiler cap after max harm op and min night op prep", "VH" : "Surplus BESS chrg cap after min harm op and min night op prep", "VI" : "Surplus BESS chrg cap after min harm op and max night op prep", "VJ" : "Surplus BESS chrg cap after max harm op and min night op prep", "VK" : "Surplus RawMeth prod cap after min harm op and min night op prep", "VL" : "Surplus RawMeth prod cap after min harm op and max night op prep", "VM" : "Surplus RawMeth prod cap after max harm op and min night op prep", "VN" : "Surplus CO2 prod cap after min harm op and min night op prep", "VO" : "Surplus CO2 prod cap after min harm op and max night op prep", "VP" : "Surplus CO2 prod cap after max harm op and min night op prep", "VQ" : "Surplus H2 prod cap after min harm op and min night op prep", "VR" : "Surplus H2 prod cap after min harm op and max night op prep", "VS" : "Surplus H2 prod cap after max harm op and min night op prep", "VT" : "", "VU" : "Optimal harmonious day prod after min night prep due to prod cap limits", "VV" : "Surplus harm op period electricity after opt harmonious and min night op prep", "VW" : "Surplus harm op period electricity after opt harmonious and max night op prep", "VX" : "Surplus harm op csp steam+boiler prod cap after opt day harm and min night op prep", "VY" : "Surplus harm op csp steam+boiler prod cap after opt day harm and max night op prep", "VZ" : "Surplus el boiler cap after opt day harm and min night op prep", "WA" : "Surplus el boiler cap after opt day harm and max night op prep", "WB" : "Surplus BESS chrg cap after opt day harm and min night op prep", "WC" : "Surplus BESS chrg cap after opt day harm and max night op prep", "WD" : "Surplus RawMeth prod cap after opt day harm and min night op prep", "WE" : "Surplus RawMeth prod cap after opt day harm and max night op prep", "WF" : "Surplus CO2 prod cap after opt day harm and min night op prep", "WG" : "Surplus CO2 prod cap after opt day harm and max night op prep", "WH" : "Surplus H2 prod cap after opt day harm and min night op prep", "WI" : "Surplus H2 prod cap after opt day harm and max night op prep", "WJ" : "Opt night prep during day prio operation", "WK" : "", "WL" : "min harmonious day prod after opt equiv harmonious night prod due to prod cap limits", "WM" : "Surplus harm op period electricity after min day harmonious and opti night op prep", "WN" : "Surplus harm op period electricity after max day harmonious and opti night op prep", "WO" : "Surplus harmonious op csp steam+boiler prod cap after min day harmonious and opti night op prep", "WP" : "Surplus harmonious op csp steam+boiler prod cap after max day harmonious and opti night op prep", "WQ" : "Surplus el boiler cap after min day harmonious and opti night op prep", "WR" : "Surplus el boiler cap after max day harmonious and opti night op prep", "WS" : "Surplus BESS cap after min day harmonious and opti night op prep", "WT" : "Surplus BESS cap after max day harmonious and opti night op prep", "WU" : "Surplus RawMeth prod cap after min day harmonious and opti night op prep", "WV" : "Surplus RawMeth prod cap after max day harmonious and opti night op prep", "WW" : "Surplus CO2 prod cap after min day harmonious and opti night op prep", "WX" : "Surplus CO2 prod cap after max day harmonious and opti night op prep", "WY" : "Surplus H2 prod cap after min day harmonious and opti night op prep", "WZ" : "Surplus H2 prod cap after max day harmonious and opti night op prep", "XA" : "Opt harm op period op during night prio operation", "XB" : "", "XC" : "el cons for harm op during harm op period", "XD" : "el cons for night prep during harm op period", "XE" : "el to cover aux cons during harm op period", "XF" : "el cons for BESS charging during harm op period", "XG" : "el cons for el boiler op for harm op during harm op period", "XH" : "el cons for el boiler op for night prep during harm op period", "XI" : "El available during harm op period after TES chrg", "XJ" : "Grid import needed during harm op period", "XK" : "Balance of electricity during harm op period", "XL" : "heat cons for harm op during harm op period", "XM" : "heat cons for night prep during harm op period", "XN" : "heat prod by el boiler for harm op during harm op period", "XO" : "heat prod by el boiler for night prep during harm op period", "XP" : "Heat available during harm op period after TES chrg", "XQ" : "Balance of heat during harm op period", "XR" : "el cons for harm op outside of harm op period", "XS" : "el to cover aux cons outside of harm op period", "XT" : "el cons for el boiler for harm op outside of harm op period", "XU" : "el from BESS discharging outside of harm op period", "XV" : "El available outside of harm op period after TES chrg", "XW" : "Grid import needed outside of harm op period", "XX" : "Balance of electricity outside of harm op period", "XY" : "heat cons for harm op outside of harm op period", "XZ" : "Heat prod by el boiler for harm op outside of harm op period", "YA" : "Heat available outside of harm op period after TES chrg", "YB" : "Balance of heat outside of harm op period", "YC" : "Pure Methanol prod with day priority and resp night op", "YD" : "Grid export", "YE" : "Grid import", "YF" : "Checksum", "YG" : "", "YH" : "el cons for harm op during harm op period", "YI" : "el cons for night prep during harm op period", "YJ" : "el to cover aux cons during harm op period", "YK" : "el cons for BESS charging during harm op period", "YL" : "el cons for el boiler op for harm op during harm op period", "YM" : "el cons for el boiler op for night prep during harm op period", "YN" : "El available during harm op period after TES chrg", "YO" : "Grid import needed during harm op period", "YP" : "Balance of electricity during harm op period", "YQ" : "heat cons for harm op during harm op period", "YR" : "heat cons for night prep during harm op period", "YS" : "heat prod by el boiler for harm op during harm op period", "YT" : "heat prod by el boiler for night prep during harm op period", "YU" : "Heat available during harm op period after TES chrg", "YV" : "Balance of heat during harm op period", "YW" : "el cons for harm op outside of harm op period", "YX" : "el to cover aux cons outside of harm op period", "YY" : "el cons for el boiler for harm op outside of harm op period", "YZ" : "el from BESS discharging outside of harm op period", "ZA" : "El available outside of harm op period after TES chrg", "ZB" : "Grid import needed outside of harm op period", "ZC" : "Balance of electricity outside of harm op period", "ZD" : "heat cons for harm op outside of harm op period", "ZE" : "Heat prod by el boiler for harm op outside of harm op period", "ZF" : "Heat available outside of harm op period after TES chrg", "ZG" : "Balance of heat outside of harm op period", "ZH" : "Pure Methanol prod with night priority and resp day op", "ZI" : "Grid export", "ZJ" : "Grid import", "ZK" : "Checksum", "ZL" : "", "ZM" : "Available elec after TES chrg during harm op period", "ZN" : "Available elec after TES chrg outside harm op period", "ZO" : "Available heat after TES chrg during harm op period", "ZP" : "Available heat after TES chrg outside of harm op period", "ZQ" : "Harm el cons considering min harm op during harm op period", "ZR" : "Harm el cons considering max harm op during harm op period", "ZS" : "Harm el cons outside of harm op period", "ZT" : "Harm heat cons considering min harm op during harm op period", "ZU" : "Harm heat cons considering max harm op during harm op period", "ZV" : "Harm heat cons outside of harm op period", "ZW" : "El boiler op considering min harm op during harm op period", "ZX" : "El boiler op considering max harm op during harm op period", "ZY" : "El boiler op outside harm op period", "ZZ" : "Total aux cons during harm op period", "AAA" : "Total aux cons outside of harm op period", "AAB" : "El cons not covered during harm op period", "AAC" : "El cons not covered outside of harm op period", "AAD" : "Remaining PV el after TES chrg&min harm&aux during harm op period", "AAE" : "Remaining PV el after TES chrg&max harm&aux op during harm op period", "AAF" : "Remaining PV el outside of harm op period", "AAG" : "Remaining CSP heat after min harm during harm op period", "AAH" : "Remaining CSP heat after max harm op during harm op period", "AAI" : "Remaining CSP heat outside of harm op period", "AAJ" : "Max BESS night prep after min harm cons during harm op period", "AAK" : "Max BESS night prep after max harm cons during harm op period", "AAL" : "Max BESS night prep outside of harm op period", "AAM" : "Max grid export after min harm cons during harm op period", "AAN" : "Max grid export after max harm cons during harm op period", "AAO" : "Max grid export outside of harm op period", "AAP" : "Remaining El boiler cap during harm op period after min harm", "AAQ" : "Remaining El boiler cap during harm op period after max harm", "AAR" : "Remaining El boiler cap outside of harm op period", "AAS" : "Remaining MethSynt cap during harm op after min harm op", "AAT" : "Remaining MethSynt cap during harm op period after max harm op", "AAU" : "Remaining MethSynt cap outside of harm op period", "AAV" : "Remaining CCU cap during harm op after min harm", "AAW" : "Remaining CCU cap during harm op after max harm", "AAX" : "Remaining CCU cap outside of harm op after min harm", "AAY" : "Remaining EY cap during harm op after min harm", "AAZ" : "Remaining EY cap during harm op period after max harm", "ABA" : "Remaining EY cap outside of harm op period", "ABB" : "", "ABC" : "Available elec after TES chrg during harm op period", "ABD" : "Available elec after TES chrg outside harm op period", "ABE" : "Available heat after TES chrg during harm op period", "ABF" : "Available heat after TES chrg outside of harm op period", "ABG" : "Harm el cons considering min harm op during harm op period", "ABH" : "Harm el cons considering max harm op during harm op period", "ABI" : "Harm el cons outside of harm op period", "ABJ" : "Harm heat cons considering min harm op during harm op period", "ABK" : "Harm heat cons considering max harm op during harm op period", "ABL" : "Harm heat cons outside of harm op period", "ABM" : "El boiler op considering min harm op during harm op period", "ABN" : "El boiler op considering max harm op during harm op period", "ABO" : "El boiler op outside harm op period", "ABP" : "Total aux cons during harm op period", "ABQ" : "Total aux cons outside of harm op period", "ABR" : "El cons not covered during harm op period", "ABS" : "El cons not covered outside of harm op period", "ABT" : "Remaining PV el after TES chrg& min harm&aux during harm op period", "ABU" : "Remaining PV el after TES chrg& max harm&aux during harm op period", "ABV" : "Remaining PV el outside of harm op period", "ABW" : "Remaining CSP heat after min harm during harm op period", "ABX" : "Remaining CSP heat after max harm op during harm op period", "ABY" : "Remaining CSP heat outside of harm op period", "ABZ" : "Max elec to BESS for night prep after min harm op during harm op period", "ACA" : "Max elec to BESS for night prep after max harm op during harm op period", "ACB" : "Max elec to BESS for night prep outside of harm op period", "ACC" : "Max grid export after min harm cons during harm op period", "ACD" : "Max grid export after max harm cons during harm op period", "ACE" : "Max grid export outside of harm op period", "ACF" : "Remaining El boiler cap during harm op period after min harm", "ACG" : "Remaining El boiler cap during harm op period after max harm", "ACH" : "Remaining El boiler cap outside of harm op period", "ACI" : "Remaining MethSynt cap during harm op after min harm op", "ACJ" : "Remaining MethSynt cap during harm op period after max harm op", "ACK" : "Remaining MethSynt cap outside of harm op period", "ACL" : "Remaining CCU cap during harm op after min harm", "ACM" : "Remaining CCU cap during harm op after max harm", "ACN" : "Remaining CCU cap outside of harm op after min harm", "ACO" : "Remaining EY cap during harm op after min harm", "ACP" : "Remaining EY cap during harm op period after max harm", "ACQ" : "Remaining EY cap outside of harm op period", "ACR" : "", "ACS" : "Surplus harm op period electricity after min harm op and min night op prep", "ACT" : "Surplus harm op period electricity after min harm op and max night op prep", "ACU" : "Surplus harm op period electricity after max harm op and min night op prep", "ACV" : "Surplus harm op heat+boiler prod after min harm op and min night op prep", "ACW" : "Surplus harm op heat+boiler prod after min harm op and max night op prep", "ACX" : "Surplus harm op heat+boiler prod after max harm op and min night op prep", "ACY" : "Surplus el boiler cap after min harm op and min night op prep", "ACZ" : "Surplus el boiler cap after min harm op and max night op prep", "ADA" : "Surplus el boiler cap after max harm op and min night op prep", "ADB" : "Surplus BESS chrg cap after min harm op and min night op prep", "ADC" : "Surplus BESS chrg cap after min harm op and max night op prep", "ADD" : "Surplus BESS chrg cap after max harm op and min night op prep", "ADE" : "Surplus RawMeth prod cap after min harm op and min night op prep", "ADF" : "Surplus RawMeth prod cap after min harm op and max night op prep", "ADG" : "Surplus RawMeth prod cap after max harm op and min night op prep", "ADH" : "Surplus CO2 prod cap after min harm op and min night op prep", "ADI" : "Surplus CO2 prod cap after min harm op and max night op prep", "ADJ" : "Surplus CO2 prod cap after max harm op and min night op prep", "ADK" : "Surplus H2 prod cap after min harm op and min night op prep", "ADL" : "Surplus H2 prod cap after min harm op and max night op prep", "ADM" : "Surplus H2 prod cap after max harm op and min night op prep", "ADN" : "", "ADO" : "Optimal harmonious day prod after min night prep due to prod cap limits", "ADP" : "Surplus harm op period electricity after opt harmonious and min night op prep", "ADQ" : "Surplus harm op period electricity after opt harmonious and max night op prep", "ADR" : "Surplus harm op csp steam+boiler prod cap after opt day harm and min night op prep", "ADS" : "Surplus harm op csp steam+boiler prod cap after opt day harm and max night op prep", "ADT" : "Surplus el boiler cap after opt day harm and min night op prep", "ADU" : "Surplus el boiler cap after opt day harm and max night op prep", "ADV" : "Surplus BESS chrg cap after opt day harm and min night op prep", "ADW" : "Surplus BESS chrg cap after opt day harm and max night op prep", "ADX" : "Surplus RawMeth prod cap after opt day harm and min night op prep", "ADY" : "Surplus RawMeth prod cap after opt day harm and max night op prep", "ADZ" : "Surplus CO2 prod cap after opt day harm and min night op prep", "AEA" : "Surplus CO2 prod cap after opt day harm and max night op prep", "AEB" : "Surplus H2 prod cap after opt day harm and min night op prep", "AEC" : "Surplus H2 prod cap after opt day harm and max night op prep", "AED" : "Opt night prep during day prio operation", "AEE" : "", "AEF" : "min harmonious day prod after opt equiv harmonious night prod due to prod cap limits", "AEG" : "Surplus harm op period electricity after min day harmonious and opti night op prep", "AEH" : "Surplus harm op period electricity after max day harmonious and opti night op prep", "AEI" : "Surplus harmonious op csp steam+boiler prod cap after min day harmonious and opti night op prep", "AEJ" : "Surplus harmonious op csp steam+boiler prod cap after max day harmonious and opti night op prep", "AEK" : "Surplus el boiler cap after min day harmonious and opti night op prep", "AEL" : "Surplus el boiler cap after max day harmonious and opti night op prep", "AEM" : "Surplus BESS cap after min day harmonious and opti night op prep", "AEN" : "Surplus BESS cap after max day harmonious and opti night op prep", "AEO" : "Surplus RawMeth prod cap after min day harmonious and opti night op prep", "AEP" : "Surplus RawMeth prod cap after max day harmonious and opti night op prep", "AEQ" : "Surplus CO2 prod cap after min day harmonious and opti night op prep", "AER" : "Surplus CO2 prod cap after max day harmonious and opti night op prep", "AES" : "Surplus H2 prod cap after min day harmonious and opti night op prep", "AET" : "Surplus H2 prod cap after max day harmonious and opti night op prep", "AEU" : "Opt harm op period op during night prio operation", "AEV" : "", "AEW" : "el cons for harm op during harm op period", "AEX" : "el cons for night prep during harm op period", "AEY" : "el to cover aux cons during harm op period", "AEZ" : "el cons for BESS charging during harm op period", "AFA" : "el cons for el boiler op for harm op during harm op period", "AFB" : "el cons for el boiler op for night prep during harm op period", "AFC" : "El available during harm op period after TES chrg", "AFD" : "Grid import needed during harm op period", "AFE" : "Balance of electricity during harm op period", "AFF" : "heat cons for harm op during harm op period", "AFG" : "heat cons for night prep during harm op period", "AFH" : "heat prod by el boiler for harm op during harm op period", "AFI" : "heat prod by el boiler for night prep during harm op period", "AFJ" : "Heat available during harm op period after TES chrg", "AFK" : "Balance of heat during harm op period", "AFL" : "el cons for harm op outside of harm op period", "AFM" : "el to cover aux cons outside of harm op period", "AFN" : "el cons for el boiler for harm op outside of harm op period", "AFO" : "el from BESS discharging outside of harm op period", "AFP" : "El available outside of harm op period after TES chrg", "AFQ" : "Grid import needed outside of harm op period", "AFR" : "Balance of electricity outside of harm op period", "AFS" : "heat cons for harm op outside of harm op period", "AFT" : "Heat prod by el boiler for harm op outside of harm op period", "AFU" : "Heat available outside of harm op period after TES chrg", "AFV" : "Balance of heat outside of harm op period", "AFW" : "Pure Methanol prod with day priority and resp night op", "AFX" : "grid balance", "AFY" : "Grid import", "AFZ" : "Checksum", "AGA" : "", "AGB" : "el cons for harm op during harm op period", "AGC" : "el cons for night prep during harm op period", "AGD" : "el to cover aux cons during harm op period", "AGE" : "el cons for BESS charging during harm op period", "AGF" : "el cons for el boiler op for harm op during harm op period", "AGG" : "el cons for el boiler op for night prep during harm op period", "AGH" : "El available during harm op period after TES chrg", "AGI" : "Grid import needed during harm op period", "AGJ" : "Balance of electricity during harm op period", "AGK" : "heat cons for harm op during harm op period", "AGL" : "heat cons for night prep during harm op period", "AGM" : "heat prod by el boiler for harm op during harm op period", "AGN" : "heat prod by el boiler for night prep during harm op period", "AGO" : "Heat available during harm op period after TES chrg", "AGP" : "Balance of heat during harm op period", "AGQ" : "el cons for harm op outside of harm op period", "AGR" : "el to cover aux cons outside of harm op period", "AGS" : "el cons for el boiler for harm op outside of harm op period", "AGT" : "el from BESS discharging outside of harm op period", "AGU" : "El available outside of harm op period after TES chrg", "AGV" : "Grid import needed outside of harm op period", "AGW" : "Balance of electricity outside of harm op period", "AGX" : "heat cons for harm op outside of harm op period", "AGY" : "Heat prod by el boiler for harm op outside of harm op period", "AGZ" : "Heat available outside of harm op period after TES chrg", "AHA" : "Balance of heat outside of harm op period", "AHB" : "Pure Methanol prod with night priority and resp day op", "AHC" : "grid balance", "AHD" : "Grid import", "AHE" : "Checksum", "AHF" : "", "AHG" : "", "AHH" : "Pure Methanol produced", "AHI" : "grid cost balance", "AHJ" : "LCOM of day", "AHK" : "Checksum", "AHL" : "Pure Methanol produced", "AHM" : "grid cost balance", "AHN" : "LCOM of day", "AHO" : "Checksum", "AHP" : "Pure Methanol produced", "AHQ" : "grid cost balance", "AHR" : "LCOM of day", "AHS" : "Checksum", "AHT" : "Pure Methanol produced", "AHU" : "grid cost balance", "AHV" : "LCOM of day", "AHW" : "Checksum", "AHX" : "Pure Methanol produced", "AHY" : "grid cost balance", "AHZ" : "LCOM of day", "AIA" : "Checksum", "AIB" : "Pure Methanol produced", "AIC" : "grid cost balance", "AID" : "LCOM of day", "AIE" : "Checksum", "AIF" : "Pure Methanol produced", "AIG" : "grid cost balance", "AIH" : "LCOM of day", "AII" : "Checksum", "AIJ" : "Pure Methanol produced", "AIK" : "grid cost balance", "AIL" : "LCOM of day", "AIM" : "Checksum", "AIN" : "Best op case", "AIO" : "Meth produced", "AIP" : "grid cost balance", "AIQ" : "LCOM of day", "AIR" : "Checksum"
]

let titlesDaily2: [String: String] = [
  "A" : "Day",	"B" : "Nr of hours where min harmonious is not possible in spite of grid support",	"C" : "Nr of hours where min harmonious is possible considering grid support",	"D" : "",	"E" : "Min el cons during night",	"F" : "Max el cons during night",	"G" : "Min heat cons during night",	"H" : "Max heat cons during night",	"I" : "Min RawMeth cons during night",	"J" : "Max RawMeth cons during night",	"K" : "Min CO2 cons during night",	"L" : "Max CO2 cons during night",	"M" : "Min H2 cons during night",	"N" : "Max H2 cons during night",	"O" : "Min el cons during day for night op prep",	"P" : "Max el cons during day for night op prep",	"Q" : "Min heat cons during day for night op prep",	"R" : "Max heat cons during day for prep of night",	"S" : "Surplus RawMeth storage cap after night min op  prep",	"T" : "Surplus RawMeth storage cap after max night op prep",	"U" : "Surplus CO2 storage cap after min night op prep",	"V" : "Surplus CO2 storage cap after max night op prep",	"W" : "Surplus H2 storage cap after min night op prep",	"X" : "Surplus H2 storage cap after max night op prep",	"Y" : "Max Equiv harmonious night prod due to physical limits",	"Z" : "",	"AA" : "Min el cons during night",	"AB" : "Max el cons during night",	"AC" : "Min heat cons during night",	"AD" : "Max heat cons during night",	"AE" : "Min RawMeth cons during night",	"AF" : "Max RawMeth cons during night",	"AG" : "Min CO2 cons during night",	"AH" : "Max CO2 cons during night",	"AI" : "Min H2 cons during night",	"AJ" : "Max H2 cons during night",	"AK" : "Min el cons during day for night op prep",	"AL" : "Max el cons during day for night op prep",	"AM" : "Min heat cons during day for night op prep",	"AN" : "Max heat cons during day for prep of night",	"AO" : "Surplus RawMeth storage cap after night min op  prep",	"AP" : "Surplus RawMeth storage cap after max night op prep",	"AQ" : "Surplus CO2 storage cap after min night op prep",	"AR" : "Surplus CO2 storage cap after max night op prep",	"AS" : "Surplus H2 storage cap after min night op prep",	"AT" : "Surplus H2 storage cap after max night op prep",	"AU" : "Max Equiv harmonious night prod due to physical limits",	"AV" : "",	"AW" : "Min el cons during night",	"AX" : "Max el cons during night",	"AY" : "Min heat cons during night",	"AZ" : "Max heat cons during night",	"BA" : "Min RawMeth cons during night",	"BB" : "Max RawMeth cons during night",	"BC" : "Min CO2 cons during night",	"BD" : "Max CO2 cons during night",	"BE" : "Min H2 cons during night",	"BF" : "Max H2 cons during night",	"BG" : "Min el cons during day for night op prep",	"BH" : "Max el cons during day for night op prep",	"BI" : "Min heat cons during day for night op prep",	"BJ" : "Max heat cons during day for prep of night",	"BK" : "Surplus RawMeth storage cap after night min op  prep",	"BL" : "Surplus RawMeth storage cap after max night op prep",	"BM" : "Surplus CO2 storage cap after min night op prep",	"BN" : "Surplus CO2 storage cap after max night op prep",	"BO" : "Surplus H2 storage cap after min night op prep",	"BP" : "Surplus H2 storage cap after max night op prep",	"BQ" : "Max Equiv harmonious night prod due to physical limits",	"BR" : "",	"BS" : "Min el cons during night",	"BT" : "Max el cons during night",	"BU" : "Min heat cons during night",	"BV" : "Max heat cons during night",	"BW" : "Min RawMeth cons during night",	"BX" : "Max RawMeth cons during night",	"BY" : "Min CO2 cons during night",	"BZ" : "Max CO2 cons during night",	"CA" : "Min H2 cons during night",	"CB" : "Max H2 cons during night",	"CC" : "Min el cons during day for night op prep",	"CD" : "Max el cons during day for night op prep",	"CE" : "Min heat cons during day for night op prep",	"CF" : "Max heat cons during day for prep of night",	"CG" : "Surplus RawMeth storage cap after night min op  prep",	"CH" : "Surplus RawMeth storage cap after max night op prep",	"CI" : "Surplus CO2 storage cap after min night op prep",	"CJ" : "Surplus CO2 storage cap after max night op prep",	"CK" : "Surplus H2 storage cap after min night op prep",	"CL" : "Surplus H2 storage cap after max night op prep",	"CM" : "Max Equiv harmonious night prod due to physical limits",	"CN" : "",	"CO" : "Available day op PV elec after CSP, PB stby aux",	"CP" : "Available night op PV elec after CSP, PB stby aux",	"CQ" : "Available day op  CSP heat",	"CR" : "Available night op  CSP heat",	"CS" : "",	"CT" : "El cons considering min harm op during harm op period",	"CU" : "El cons considering max harm op during harm op period",	"CV" : "Heat cons considering min harm op during harm op period",	"CW" : "Heat cons considering max harm op during harm op period",	"CX" : "Max grid export after min harm op during harm op period",	"CY" : "Max grid export after max harm op during harm op period",	"CZ" : "Max grid export after min/max harm op outside of harm op period",	"DA" : "Grid cons considering min harm op during harm op period",	"DB" : "Grid cons considering max harm op during harm op period",	"DC" : "Grid cons considering min/max harm op outside harm op period",	"DD" : "Remaining PV el after min harm during harm op period",	"DE" : "Remaining PV el after max harm during harm op period",	"DF" : "Remaining PV el after min harm outside harm op period",	"DG" : "Remaining CSP heat after min harm during harm op period",	"DH" : "Remaining CSP heat after max harm during harm op period",	"DI" : "Remaining CSP heat after min harm outside harm op period",	"DJ" : "Remaining grid import cap after min harm during harm op period",	"DK" : "Remaining grid import cap after max harm during harm op period",	"DL" : "Remaining grid import cap after min harm outside harm op period",	"DM" : "Max elec to BESS for night prep after min harm op during harm op period",	"DN" : "Max BESS night prep after max harm cons during harm op period",	"DO" : "Max elec to BESS for night prep after min harm op outside harm op period",	"DP" : "El boiler op for min harm during harm op period",	"DQ" : "El boiler op for max harm during harm op period",	"DR" : "Remaining El boiler cap after min harm during harm op period",	"DS" : "Remaining El boiler cap after max harm during harm op period",	"DT" : "Remaining El boiler cap after min harm outside harm op period",	"DU" : "Remaining MethSynt cap after min harm during harm op period",	"DV" : "Remaining MethSynt cap after max harm during harm op period",	"DW" : "Remaining MethSynt cap after min harm outside of harm op period",	"DX" : "Remaining CCU cap after min harm during harm op period",	"DY" : "Remaining CCU cap after max harm during harm op period",	"DZ" : "Remaining CCU cap after min harm outside of harm op period",	"EA" : "Remaining EY cap after min harm during harm op period",	"EB" : "Remaining EY cap after max harm during harm op period",	"EC" : "Remaining EY cap after min harm outside of harm op period",	"ED" : "",	"EE" : "Surplus harm op period el after min day harm op and min night op prep",	"EF" : "Surplus harm op period el after min day harm op and max night op prep",	"EG" : "Surplus harm op period el after max day harm op and min night op prep",	"EH" : "Surplus outside harm op period el after min day harm and min night op prep; comment: it is assumed that PV during off-harmonious period is not well distributed and must therefore be channelled during the BESS to be used",	"EI" : "Surplus outside harm op period el after min day harm and max night op prep; comment: it is assumed that PV during off-harmonious period is not well distributed and must therefore be channelled during the BESS to be used",	"EJ" : "Surplus outside harm op period el after max day harm and min night op prep; comment: it is assumed that PV during off-harmonious period is not well distributed and must therefore be channelled during the BESS to be used",	"EK" : "Surplus harm op heat after min day harm and min night op prep; Comment: it is assumed that PV electricity from outside harmonious period is used to charge BESS",	"EL" : "Surplus harm op heat after min day harm and max night op prep; Comment: it is assumed that PV electricity from outside harmonious period is used to charge BESS",	"EM" : "Surplus harm op heat after max day harm and min night op prep; Comment: it is assumed that PV electricity from outside harmonious period is used to charge BESS",	"EN" : "Surplus outside harm op heat after min day harm and min night op prep",	"EO" : "Surplus outside harm op heat after min day harm and max night op prep",	"EP" : "Surplus outside harm op heat after max day harm and min night op prep",	"EQ" : "Surplus el boiler cap after min harm op and min night op prep during harm op period",	"ER" : "Surplus el boiler cap after min harm op and max night op prep during harm op period",	"ES" : "Surplus el boiler cap after max harm op and min night op prep during harm op period",	"ET" : "Surplus el boiler cap after min harm op and min night op prep outside of harm op period",	"EU" : "Surplus el boiler cap after min harm op and max night op prep outside of harm op period",	"EV" : "Surplus el boiler cap after max harm op and min night op prep outside of harm op period",	"EW" : "Surplus RawMeth prod cap after min day harm and min night op prep",	"EX" : "Surplus RawMeth prod cap after min day harm and max night op prep",	"EY" : "Surplus RawMeth prod cap after max day harm and min night op prep",	"EZ" : "Surplus CO2 prod cap after min day harm and min night op prep",	"FA" : "Surplus CO2 prod cap after min day harm and max night op prep",	"FB" : "Surplus CO2 prod cap after max day harm and min night op prep",	"FC" : "Surplus H2 prod cap after min day harm and min night op prep",	"FD" : "Surplus H2 prod cap after min day harm and max night op prep",	"FE" : "Surplus H2 prod cap after max day harm and min night op prep",	"FF" : "",	"FG" : "Optimal harmonious day prod after min night prep due to prod cap limits",	"FH" : "Surplus harm op period el after opt day harm op and min night op prep",	"FI" : "Surplus harm op period el after opt day harm op and max night op prep",	"FJ" : "Surplus outside harm op period el after opt day harm and min night op prep; comment: it is assumed that PV during off-harmonious period is not well distributed and must therefore be channelled during the BESS to be used",	"FK" : "Surplus outside harm op period el after opt day harm and max night op prep; comment: it is assumed that PV during off-harmonious period is not well distributed and must therefore be channelled during the BESS to be used",	"FL" : "Surplus harm op heat after opt day harm and min night op prep; Comment: it is assumed that PV electricity from outside harmonious period is used to charge BESS",	"FM" : "Surplus harm op heat after opt day harm and max night op prep; Comment: it is assumed that PV electricity from outside harmonious period is used to charge BESS",	"FN" : "Surplus outside harm op heat after opt day harm and min night op prep",	"FO" : "Surplus outside harm op heat after opt day harm and max night op prep",	"FP" : "Surplus el boiler cap after opt harm op and min night op prep during harm op period",	"FQ" : "Surplus el boiler cap after opt harm op and max night op prep during harm op period",	"FR" : "Surplus el boiler cap after opt harm op and min night op prep outside of harm op period",	"FS" : "Surplus el boiler cap after opt harm op and max night op prep outside of harm op period",	"FT" : "Surplus RawMeth prod cap after opt day harm and min night op prep",	"FU" : "Surplus RawMeth prod cap after opt day harm and max night op prep",	"FV" : "Surplus CO2 prod cap after opt day harm and min night op prep",	"FW" : "Surplus CO2 prod cap after opt day harm and max night op prep",	"FX" : "Surplus H2 prod cap after opt day harm and min night op prep",	"FY" : "Surplus H2 prod cap after opt day harm and max night op prep",	"FZ" : "Max harmonious day prod after min night prep due to prod cap limits",	"GA" : "",	"GB" : "Max Equiv harmonious night prod due to prod cap limits",	"GC" : "Surplus harm op period el after min day harm op and opt night op prep",	"GD" : "Surplus harm op period el after max day harm op and opt night op prep",	"GE" : "Surplus outside harm op period el after min day harm and opt night op prep; comment: it is assumed that PV during off-harmonious period is not well distributed and must therefore be channelled during the BESS to be used",	"GF" : "Surplus outside harm op period el after max day harm and opt night op prep; comment: it is assumed that PV during off-harmonious period is not well distributed and must therefore be channelled during the BESS to be used",	"GG" : "Surplus harm op heat after min day harm and opt night op prep; Comment: it is assumed that PV electricity from outside harmonious period is used to charge BESS",	"GH" : "Surplus harm op heat after max day harm and opt night op prep; Comment: it is assumed that PV electricity from outside harmonious period is used to charge BESS",	"GI" : "Surplus outside harm op heat after min day harm and opt night op prep",	"GJ" : "Surplus outside harm op heat after max day harm and opt night op prep",	"GK" : "Surplus el boiler cap after min harm op and opt night op prep during harm op period",	"GL" : "Surplus el boiler cap after max harm op and opt night op prep during harm op period",	"GM" : "Surplus el boiler cap after min harm op and opt night op prep outside of harm op period",	"GN" : "Surplus el boiler cap after max harm op and opt night op prep outside of harm op period",	"GO" : "Surplus RawMeth prod cap after min day harm and opt night op prep",	"GP" : "Surplus RawMeth prod cap after max day harm and opt night op prep",	"GQ" : "Surplus CO2 prod cap after min day harm and opt night op prep",	"GR" : "Surplus CO2 prod cap after max day harm and opt night op prep",	"GS" : "Surplus H2 prod cap after min day harm and opt night op prep",	"GT" : "Surplus H2 prod cap after min day harm and opt night op prep",	"GU" : "Opt harm op period op during night prio operation",	"GV" : "",	"GW" : "el cons for harm op during harm op period",	"GX" : "el cons for night prep during harm op period",	"GY" : "el cons for BESS charging during harm op period",	"GZ" : "el cons of el boiler for harm op during harm op period",	"HA" : "el cons of el boiler for night prep during harm op period",	"HB" : "PV available after harm op during harm op period",	"HC" : "grid input for harm op during harm op period",	"HD" : "grid input for night prep during harm op period",	"HE" : "Balance of electricity during harm op period",	"HF" : "Heat cons for harm op during harm op period",	"HG" : "Heat cons for night prep during harm op period",	"HH" : "CSP heat available after harm op during harm op period",	"HI" : "El boiler heat prod for harm op during harm op period",	"HJ" : "El boiler heat prod for night prep during harm op period",	"HK" : "Balance of heat during harm op period",	"HL" : "el cons for harm op outside of harm op period",	"HM" : "el cons by el boiler outside of harm op period",	"HN" : "el cons for aux cons outside of harm op period",	"HO" : "el from PV outside of harm op period",	"HP" : "el from BESS outside of harm op period",	"HQ" : "grid input outside of harm op period",	"HR" : "Balance of electricity outside of harm op period",	"HS" : "heat cons for harm op outside of harm op period",	"HT" : "heat from CSP outside of harm op period",	"HU" : "heat from el boiler outside of harm op period",	"HV" : "Balance of heat outside of harm op period",	"HW" : "Pure Methanol prod with min night prep and resp day op",	"HX" : "grid export",	"HY" : "grid import",	"HZ" : "Checksum",	"IA" : "",	"IB" : "el cons for harm op during harm op period",	"IC" : "el cons for night prep during harm op period",	"ID" : "el cons for BESS charging during harm op period",	"IE" : "el cons of el boiler for harm op during harm op period",	"IF" : "el cons of el boiler for night prep during harm op period",	"IG" : "PV available after harm op during harm op period",	"IH" : "grid input for harm op during harm op period",	"II" : "grid input for night prep during harm op period",	"IJ" : "Balance of electricity during harm op period",	"IK" : "Heat cons for harm op during harm op period",	"IL" : "Heat cons for night prep during harm op period",	"IM" : "CSP heat available after harm op during harm op period",	"IN" : "El boiler heat prod for harm op during harm op period",	"IO" : "El boiler heat prod for night prep during harm op period",	"IP" : "Balance of heat during harm op period",	"IQ" : "el cons for harm op outside of harm op period",	"IR" : "el cons by el boiler outside of harm op period",	"IS" : "el cons for aux cons outside of harm op period",	"IT" : "el from PV outside of harm op period",	"IU" : "el from BESS outside of harm op period",	"IV" : "grid input outside of harm op period",	"IW" : "Balance of electricity outside of harm op period",	"IX" : "heat cons for harm op outside of harm op period",	"IY" : "heat from CSP outside of harm op period",	"IZ" : "heat from el boiler outside of harm op period",	"JA" : "Balance of heat outside of harm op period",	"JB" : "Pure Methanol prod with min night prep and resp day op",	"JC" : "grid export",	"JD" : "grid import",	"JE" : "Checksum",	"JF" : "",	"JG" : "Surplus harm op period el after min day harm op and min night op prep",	"JH" : "Surplus harm op period el after min day harm op and max night op prep",	"JI" : "Surplus harm op period el after max day harm op and min night op prep",	"JJ" : "Surplus outside harm op period el after min day harm and min night op prep; comment: it is assumed that PV during off-harmonious period is not well distributed and must therefore be channelled during the BESS to be used",	"JK" : "Surplus outside harm op period el after min day harm and max night op prep; comment: it is assumed that PV during off-harmonious period is not well distributed and must therefore be channelled during the BESS to be used",	"JL" : "Surplus outside harm op period el after max day harm and min night op prep; comment: it is assumed that PV during off-harmonious period is not well distributed and must therefore be channelled during the BESS to be used",	"JM" : "Surplus harm op heat after min day harm and min night op prep; Comment: it is assumed that PV electricity from outside harmonious period is used to charge BESS",	"JN" : "Surplus harm op heat after min day harm and max night op prep; Comment: it is assumed that PV electricity from outside harmonious period is used to charge BESS",	"JO" : "Surplus harm op heat after max day harm and min night op prep; Comment: it is assumed that PV electricity from outside harmonious period is used to charge BESS",	"JP" : "Surplus outside harm op heat after min day harm and min night op prep",	"JQ" : "Surplus outside harm op heat after min day harm and max night op prep",	"JR" : "Surplus outside harm op heat after max day harm and min night op prep",	"JS" : "Surplus el boiler cap after min harm op and min night op prep during harm op period",	"JT" : "Surplus el boiler cap after min harm op and max night op prep during harm op period",	"JU" : "Surplus el boiler cap after max harm op and min night op prep during harm op period",	"JV" : "Surplus el boiler cap after min harm op and min night op prep outside of harm op period",	"JW" : "Surplus el boiler cap after min harm op and max night op prep outside of harm op period",	"JX" : "Surplus el boiler cap after max harm op and min night op prep outside of harm op period",	"JY" : "Surplus RawMeth prod cap after min day harm and min night op prep",	"JZ" : "Surplus RawMeth prod cap after min day harm and max night op prep",	"KA" : "Surplus RawMeth prod cap after max day harm and min night op prep",	"KB" : "Surplus CO2 prod cap after min day harm and min night op prep",	"KC" : "Surplus CO2 prod cap after min day harm and max night op prep",	"KD" : "Surplus CO2 prod cap after max day harm and min night op prep",	"KE" : "Surplus H2 prod cap after min day harm and min night op prep",	"KF" : "Surplus H2 prod cap after min day harm and max night op prep",	"KG" : "Surplus H2 prod cap after max day harm and min night op prep",	"KH" : "",	"KI" : "Optimal harmonious day prod after min night prep due to prod cap limits",	"KJ" : "Surplus harm op period el after opt day harm op and min night op prep",	"KK" : "Surplus harm op period el after opt day harm op and max night op prep",	"KL" : "Surplus outside harm op period el after opt day harm and min night op prep; comment: it is assumed that PV during off-harmonious period is not well distributed and must therefore be channelled during the BESS to be used",	"KM" : "Surplus outside harm op period el after opt day harm and max night op prep; comment: it is assumed that PV during off-harmonious period is not well distributed and must therefore be channelled during the BESS to be used",	"KN" : "Surplus harm op heat after opt day harm and min night op prep; Comment: it is assumed that PV electricity from outside harmonious period is used to charge BESS",	"KO" : "Surplus harm op heat after opt day harm and max night op prep; Comment: it is assumed that PV electricity from outside harmonious period is used to charge BESS",	"KP" : "Surplus outside harm op heat after opt day harm and min night op prep",	"KQ" : "Surplus outside harm op heat after opt day harm and max night op prep",	"KR" : "Surplus el boiler cap after opt harm op and min night op prep during harm op period",	"KS" : "Surplus el boiler cap after opt harm op and max night op prep during harm op period",	"KT" : "Surplus el boiler cap after opt harm op and min night op prep outside of harm op period",	"KU" : "Surplus el boiler cap after opt harm op and max night op prep outside of harm op period",	"KV" : "Surplus RawMeth prod cap after opt day harm and min night op prep",	"KW" : "Surplus RawMeth prod cap after opt day harm and max night op prep",	"KX" : "Surplus CO2 prod cap after opt day harm and min night op prep",	"KY" : "Surplus CO2 prod cap after opt day harm and max night op prep",	"KZ" : "Surplus H2 prod cap after opt day harm and min night op prep",	"LA" : "Surplus H2 prod cap after opt day harm and max night op prep",	"LB" : "Max harmonious day prod after min night prep due to prod cap limits",	"LC" : "",	"LD" : "Max Equiv harmonious night prod due to prod cap limits",	"LE" : "Surplus harm op period el after min day harm op and opt night op prep",	"LF" : "Surplus harm op period el after max day harm op and opt night op prep",	"LG" : "Surplus outside harm op period el after min day harm and opt night op prep; comment: it is assumed that PV during off-harmonious period is not well distributed and must therefore be channelled during the BESS to be used",	"LH" : "Surplus outside harm op period el after max day harm and opt night op prep; comment: it is assumed that PV during off-harmonious period is not well distributed and must therefore be channelled during the BESS to be used",	"LI" : "Surplus harm op heat after min day harm and opt night op prep; Comment: it is assumed that PV electricity from outside harmonious period is used to charge BESS",	"LJ" : "Surplus harm op heat after max day harm and opt night op prep; Comment: it is assumed that PV electricity from outside harmonious period is used to charge BESS",	"LK" : "Surplus outside harm op heat after min day harm and opt night op prep",	"LL" : "Surplus outside harm op heat after max day harm and opt night op prep",	"LM" : "Surplus el boiler cap after min harm op and opt night op prep during harm op period",	"LN" : "Surplus el boiler cap after max harm op and opt night op prep during harm op period",	"LO" : "Surplus el boiler cap after min harm op and opt night op prep outside of harm op period",	"LP" : "Surplus el boiler cap after max harm op and opt night op prep outside of harm op period",	"LQ" : "Surplus RawMeth prod cap after min day harm and opt night op prep",	"LR" : "Surplus RawMeth prod cap after max day harm and opt night op prep",	"LS" : "Surplus CO2 prod cap after min day harm and opt night op prep",	"LT" : "Surplus CO2 prod cap after max day harm and opt night op prep",	"LU" : "Surplus H2 prod cap after min day harm and opt night op prep",	"LV" : "Surplus H2 prod cap after min day harm and opt night op prep",	"LW" : "Opt harm op period op during night prio operation",	"LX" : "",	"LY" : "el cons for harm op during harm op period",	"LZ" : "el cons for night prep during harm op period",	"MA" : "el cons for BESS charging during harm op period",	"MB" : "el cons of el boiler for harm op during harm op period",	"MC" : "el cons of el boiler for night prep during harm op period",	"MD" : "PV available after harm op during harm op period",	"ME" : "grid input for harm op during harm op period",	"MF" : "grid input for night prep during harm op period",	"MG" : "Balance of electricity during harm op period",	"MH" : "Heat cons for harm op during harm op period",	"MI" : "Heat cons for night prep during harm op period",	"MJ" : "CSP heat available after harm op during harm op period",	"MK" : "El boiler heat prod for harm op during harm op period",	"ML" : "El boiler heat prod for night prep during harm op period",	"MM" : "Balance of heat during harm op period",	"MN" : "el cons for harm op outside of harm op period",	"MO" : "el cons by el boiler outside of harm op period",	"MP" : "el cons for aux cons outside of harm op period",	"MQ" : "el from PV outside of harm op period",	"MR" : "el from BESS outside of harm op period",	"MS" : "grid input outside of harm op period",	"MT" : "Balance of electricity outside of harm op period",	"MU" : "heat cons for harm op outside of harm op period",	"MV" : "heat from CSP outside of harm op period",	"MW" : "heat from el boiler outside of harm op period",	"MX" : "Balance of heat outside of harm op period",	"MY" : "Pure Methanol prod with min night prep and resp day op",	"MZ" : "grid export",	"NA" : "grid import",	"NB" : "Checksum",	"NC" : "",	"ND" : "el cons for harm op during harm op period",	"NE" : "el cons for night prep during harm op period",	"NF" : "el cons for BESS charging during harm op period",	"NG" : "el cons of el boiler for harm op during harm op period",	"NH" : "el cons of el boiler for night prep during harm op period",	"NI" : "PV available after harm op during harm op period",	"NJ" : "grid input for harm op during harm op period",	"NK" : "grid input for night prep during harm op period",	"NL" : "Balance of electricity during harm op period",	"NM" : "Heat cons for harm op during harm op period",	"NN" : "Heat cons for night prep during harm op period",	"NO" : "CSP heat available after harm op during harm op period",	"NP" : "El boiler heat prod for harm op during harm op period",	"NQ" : "El boiler heat prod for night prep during harm op period",	"NR" : "Balance of heat during harm op period",	"NS" : "el cons for harm op outside of harm op period",	"NT" : "el cons by el boiler outside of harm op period",	"NU" : "el cons for aux cons outside of harm op period",	"NV" : "el from PV outside of harm op period",	"NW" : "el from BESS outside of harm op period",	"NX" : "grid input outside of harm op period",	"NY" : "Balance of electricity outside of harm op period",	"NZ" : "heat cons for harm op outside of harm op period",	"OA" : "heat from CSP outside of harm op period",	"OB" : "heat from el boiler outside of harm op period",	"OC" : "Balance of heat outside of harm op period",	"OD" : "Pure Methanol prod with min night prep and resp day op",	"OE" : "grid export",	"OF" : "grid import",	"OG" : "Checksum",	"OH" : "",	"OI" : "Surplus harm op period el after min day harm op and min night op prep",	"OJ" : "Surplus harm op period el after min day harm op and max night op prep",	"OK" : "Surplus harm op period el after max day harm op and min night op prep",	"OL" : "Surplus outside harm op period el after min day harm and min night op prep; comment: it is assumed that PV during off-harmonious period is not well distributed and must therefore be channelled during the BESS to be used",	"OM" : "Surplus outside harm op period el after min day harm and max night op prep; comment: it is assumed that PV during off-harmonious period is not well distributed and must therefore be channelled during the BESS to be used",	"ON" : "Surplus outside harm op period el after max day harm and min night op prep; comment: it is assumed that PV during off-harmonious period is not well distributed and must therefore be channelled during the BESS to be used",	"OO" : "Surplus harm op heat after min day harm and min night op prep; Comment: it is assumed that PV electricity from outside harmonious period is used to charge BESS",	"OP" : "Surplus harm op heat after min day harm and max night op prep; Comment: it is assumed that PV electricity from outside harmonious period is used to charge BESS",	"OQ" : "Surplus harm op heat after max day harm and min night op prep; Comment: it is assumed that PV electricity from outside harmonious period is used to charge BESS",	"OR" : "Surplus outside harm op heat after min day harm and min night op prep",	"OS" : "Surplus outside harm op heat after min day harm and max night op prep",	"OT" : "Surplus outside harm op heat after max day harm and min night op prep",	"OU" : "Surplus el boiler cap after min harm op and min night op prep during harm op period",	"OV" : "Surplus el boiler cap after min harm op and max night op prep during harm op period",	"OW" : "Surplus el boiler cap after max harm op and min night op prep during harm op period",	"OX" : "Surplus el boiler cap after min harm op and min night op prep outside of harm op period",	"OY" : "Surplus el boiler cap after min harm op and max night op prep outside of harm op period",	"OZ" : "Surplus el boiler cap after max harm op and min night op prep outside of harm op period",	"PA" : "Surplus RawMeth prod cap after min day harm and min night op prep",	"PB" : "Surplus RawMeth prod cap after min day harm and max night op prep",	"PC" : "Surplus RawMeth prod cap after max day harm and min night op prep",	"PD" : "Surplus CO2 prod cap after min day harm and min night op prep",	"PE" : "Surplus CO2 prod cap after min day harm and max night op prep",	"PF" : "Surplus CO2 prod cap after max day harm and min night op prep",	"PG" : "Surplus H2 prod cap after min day harm and min night op prep",	"PH" : "Surplus H2 prod cap after min day harm and max night op prep",	"PI" : "Surplus H2 prod cap after max day harm and min night op prep",	"PJ" : "",	"PK" : "Optimal harmonious day prod after min night prep due to prod cap limits",	"PL" : "Surplus harm op period el after opt day harm op and min night op prep",	"PM" : "Surplus harm op period el after opt day harm op and max night op prep",	"PN" : "Surplus outside harm op period el after opt day harm and min night op prep; comment: it is assumed that PV during off-harmonious period is not well distributed and must therefore be channelled during the BESS to be used",	"PO" : "Surplus outside harm op period el after opt day harm and max night op prep; comment: it is assumed that PV during off-harmonious period is not well distributed and must therefore be channelled during the BESS to be used",	"PP" : "Surplus harm op heat after opt day harm and min night op prep; Comment: it is assumed that PV electricity from outside harmonious period is used to charge BESS",	"PQ" : "Surplus harm op heat after opt day harm and max night op prep; Comment: it is assumed that PV electricity from outside harmonious period is used to charge BESS",	"PR" : "Surplus outside harm op heat after opt day harm and min night op prep",	"PS" : "Surplus outside harm op heat after opt day harm and max night op prep",	"PT" : "Surplus el boiler cap after opt harm op and min night op prep during harm op period",	"PU" : "Surplus el boiler cap after opt harm op and max night op prep during harm op period",	"PV" : "Surplus el boiler cap after opt harm op and min night op prep outside of harm op period",	"PW" : "Surplus el boiler cap after opt harm op and max night op prep outside of harm op period",	"PX" : "Surplus RawMeth prod cap after opt day harm and min night op prep",	"PY" : "Surplus RawMeth prod cap after opt day harm and max night op prep",	"PZ" : "Surplus CO2 prod cap after opt day harm and min night op prep",	"QA" : "Surplus CO2 prod cap after opt day harm and max night op prep",	"QB" : "Surplus H2 prod cap after opt day harm and min night op prep",	"QC" : "Surplus H2 prod cap after opt day harm and max night op prep",	"QD" : "Max harmonious day prod after min night prep due to prod cap limits",	"QE" : "",	"QF" : "Max Equiv harmonious night prod due to prod cap limits",	"QG" : "Surplus harm op period el after min day harm op and opt night op prep",	"QH" : "Surplus harm op period el after max day harm op and opt night op prep",	"QI" : "Surplus outside harm op period el after min day harm and opt night op prep; comment: it is assumed that PV during off-harmonious period is not well distributed and must therefore be channelled during the BESS to be used",	"QJ" : "Surplus outside harm op period el after max day harm and opt night op prep; comment: it is assumed that PV during off-harmonious period is not well distributed and must therefore be channelled during the BESS to be used",	"QK" : "Surplus harm op heat after min day harm and opt night op prep; Comment: it is assumed that PV electricity from outside harmonious period is used to charge BESS",	"QL" : "Surplus harm op heat after max day harm and opt night op prep; Comment: it is assumed that PV electricity from outside harmonious period is used to charge BESS",	"QM" : "Surplus outside harm op heat after min day harm and opt night op prep",	"QN" : "Surplus outside harm op heat after max day harm and opt night op prep",	"QO" : "Surplus el boiler cap after min harm op and opt night op prep during harm op period",	"QP" : "Surplus el boiler cap after max harm op and opt night op prep during harm op period",	"QQ" : "Surplus el boiler cap after min harm op and opt night op prep outside of harm op period",	"QR" : "Surplus el boiler cap after max harm op and opt night op prep outside of harm op period",	"QS" : "Surplus RawMeth prod cap after min day harm and opt night op prep",	"QT" : "Surplus RawMeth prod cap after max day harm and opt night op prep",	"QU" : "Surplus CO2 prod cap after min day harm and opt night op prep",	"QV" : "Surplus CO2 prod cap after max day harm and opt night op prep",	"QW" : "Surplus H2 prod cap after min day harm and opt night op prep",	"QX" : "Surplus H2 prod cap after min day harm and opt night op prep",	"QY" : "Opt harm op period op during night prio operation",	"QZ" : "",	"RA" : "el cons for harm op during harm op period",	"RB" : "el cons for night prep during harm op period",	"RC" : "el cons for BESS charging during harm op period",	"RD" : "el cons of el boiler for harm op during harm op period",	"RE" : "el cons of el boiler for night prep during harm op period",	"RF" : "PV available after harm op during harm op period",	"RG" : "grid input for harm op during harm op period",	"RH" : "grid input for night prep during harm op period",	"RI" : "Balance of electricity during harm op period",	"RJ" : "Heat cons for harm op during harm op period",	"RK" : "Heat cons for night prep during harm op period",	"RL" : "CSP heat available after harm op during harm op period",	"RM" : "El boiler heat prod for harm op during harm op period",	"RN" : "El boiler heat prod for night prep during harm op period",	"RO" : "Balance of heat during harm op period",	"RP" : "el cons for harm op outside of harm op period",	"RQ" : "el cons by el boiler outside of harm op period",	"RR" : "el cons for aux cons outside of harm op period",	"RS" : "el from PV outside of harm op period",	"RT" : "el from BESS outside of harm op period",	"RU" : "grid input outside of harm op period",	"RV" : "Balance of electricity outside of harm op period",	"RW" : "heat cons for harm op outside of harm op period",	"RX" : "heat from CSP outside of harm op period",	"RY" : "heat from el boiler outside of harm op period",	"RZ" : "Balance of heat outside of harm op period",	"SA" : "Pure Methanol prod with min night prep and resp day op",	"SB" : "grid export",	"SC" : "grid import",	"SD" : "Checksum",	"SE" : "",	"SF" : "el cons for harm op during harm op period",	"SG" : "el cons for night prep during harm op period",	"SH" : "el cons for BESS charging during harm op period",	"SI" : "el cons of el boiler for harm op during harm op period",	"SJ" : "el cons of el boiler for night prep during harm op period",	"SK" : "PV available after harm op during harm op period",	"SL" : "grid input for harm op during harm op period",	"SM" : "grid input for night prep during harm op period",	"SN" : "Balance of electricity during harm op period",	"SO" : "Heat cons for harm op during harm op period",	"SP" : "Heat cons for night prep during harm op period",	"SQ" : "CSP heat available after harm op during harm op period",	"SR" : "El boiler heat prod for harm op during harm op period",	"SS" : "El boiler heat prod for night prep during harm op period",	"ST" : "Balance of heat during harm op period",	"SU" : "el cons for harm op outside of harm op period",	"SV" : "el cons by el boiler outside of harm op period",	"SW" : "el cons for aux cons outside of harm op period",	"SX" : "el from PV outside of harm op period",	"SY" : "el from BESS outside of harm op period",	"SZ" : "grid input outside of harm op period",	"TA" : "Balance of electricity outside of harm op period",	"TB" : "heat cons for harm op outside of harm op period",	"TC" : "heat from CSP outside of harm op period",	"TD" : "heat from el boiler outside of harm op period",	"TE" : "Balance of heat outside of harm op period",	"TF" : "Pure Methanol prod with min night prep and resp day op",	"TG" : "grid export",	"TH" : "grid import",	"TI" : "Checksum",	"TJ" : "",	"TK" : "Surplus harm op period el after min day harm op and min night op prep",	"TL" : "Surplus harm op period el after min day harm op and max night op prep",	"TM" : "Surplus harm op period el after max day harm op and min night op prep",	"TN" : "Surplus outside harm op period el after min day harm and min night op prep; comment: it is assumed that PV during off-harmonious period is not well distributed and must therefore be channelled during the BESS to be used",	"TO" : "Surplus outside harm op period el after min day harm and max night op prep; comment: it is assumed that PV during off-harmonious period is not well distributed and must therefore be channelled during the BESS to be used",	"TP" : "Surplus outside harm op period el after max day harm and min night op prep; comment: it is assumed that PV during off-harmonious period is not well distributed and must therefore be channelled during the BESS to be used",	"TQ" : "Surplus harm op heat after min day harm and min night op prep; Comment: it is assumed that PV electricity from outside harmonious period is used to charge BESS",	"TR" : "Surplus harm op heat after min day harm and max night op prep; Comment: it is assumed that PV electricity from outside harmonious period is used to charge BESS",	"TS" : "Surplus harm op heat after max day harm and min night op prep; Comment: it is assumed that PV electricity from outside harmonious period is used to charge BESS",	"TT" : "Surplus outside harm op heat after min day harm and min night op prep",	"TU" : "Surplus outside harm op heat after min day harm and max night op prep",	"TV" : "Surplus outside harm op heat after max day harm and min night op prep",	"TW" : "Surplus el boiler cap after min harm op and min night op prep during harm op period",	"TX" : "Surplus el boiler cap after min harm op and max night op prep during harm op period",	"TY" : "Surplus el boiler cap after max harm op and min night op prep during harm op period",	"TZ" : "Surplus el boiler cap after min harm op and min night op prep outside of harm op period",	"UA" : "Surplus el boiler cap after min harm op and max night op prep outside of harm op period",	"UB" : "Surplus el boiler cap after max harm op and min night op prep outside of harm op period",	"UC" : "Surplus RawMeth prod cap after min day harm and min night op prep",	"UD" : "Surplus RawMeth prod cap after min day harm and max night op prep",	"UE" : "Surplus RawMeth prod cap after max day harm and min night op prep",	"UF" : "Surplus CO2 prod cap after min day harm and min night op prep",	"UG" : "Surplus CO2 prod cap after min day harm and max night op prep",	"UH" : "Surplus CO2 prod cap after max day harm and min night op prep",	"UI" : "Surplus H2 prod cap after min day harm and min night op prep",	"UJ" : "Surplus H2 prod cap after min day harm and max night op prep",	"UK" : "Surplus H2 prod cap after max day harm and min night op prep",	"UL" : "",	"UM" : "Optimal harmonious day prod after min night prep due to prod cap limits",	"UN" : "Surplus harm op period el after opt day harm op and min night op prep",	"UO" : "Surplus harm op period el after opt day harm op and max night op prep",	"UP" : "Surplus outside harm op period el after opt day harm and min night op prep; comment: it is assumed that PV during off-harmonious period is not well distributed and must therefore be channelled during the BESS to be used",	"UQ" : "Surplus outside harm op period el after opt day harm and max night op prep; comment: it is assumed that PV during off-harmonious period is not well distributed and must therefore be channelled during the BESS to be used",	"UR" : "Surplus harm op heat after opt day harm and min night op prep; Comment: it is assumed that PV electricity from outside harmonious period is used to charge BESS",	"US" : "Surplus harm op heat after opt day harm and max night op prep; Comment: it is assumed that PV electricity from outside harmonious period is used to charge BESS",	"UT" : "Surplus outside harm op heat after opt day harm and min night op prep",	"UU" : "Surplus outside harm op heat after opt day harm and max night op prep",	"UV" : "Surplus el boiler cap after opt harm op and min night op prep during harm op period",	"UW" : "Surplus el boiler cap after opt harm op and max night op prep during harm op period",	"UX" : "Surplus el boiler cap after opt harm op and min night op prep outside of harm op period",	"UY" : "Surplus el boiler cap after opt harm op and max night op prep outside of harm op period",	"UZ" : "Surplus RawMeth prod cap after opt day harm and min night op prep",	"VA" : "Surplus RawMeth prod cap after opt day harm and max night op prep",	"VB" : "Surplus CO2 prod cap after opt day harm and min night op prep",	"VC" : "Surplus CO2 prod cap after opt day harm and max night op prep",	"VD" : "Surplus H2 prod cap after opt day harm and min night op prep",	"VE" : "Surplus H2 prod cap after opt day harm and max night op prep",	"VF" : "Max harmonious day prod after min night prep due to prod cap limits",	"VG" : "",	"VH" : "Max Equiv harmonious night prod due to prod cap limits",	"VI" : "Surplus harm op period el after min day harm op and opt night op prep",	"VJ" : "Surplus harm op period el after max day harm op and opt night op prep",	"VK" : "Surplus outside harm op period el after min day harm and opt night op prep; comment: it is assumed that PV during off-harmonious period is not well distributed and must therefore be channelled during the BESS to be used",	"VL" : "Surplus outside harm op period el after max day harm and opt night op prep; comment: it is assumed that PV during off-harmonious period is not well distributed and must therefore be channelled during the BESS to be used",	"VM" : "Surplus harm op heat after min day harm and opt night op prep; Comment: it is assumed that PV electricity from outside harmonious period is used to charge BESS",	"VN" : "Surplus harm op heat after max day harm and opt night op prep; Comment: it is assumed that PV electricity from outside harmonious period is used to charge BESS",	"VO" : "Surplus outside harm op heat after min day harm and opt night op prep",	"VP" : "Surplus outside harm op heat after max day harm and opt night op prep",	"VQ" : "Surplus el boiler cap after min harm op and opt night op prep during harm op period",	"VR" : "Surplus el boiler cap after max harm op and opt night op prep during harm op period",	"VS" : "Surplus el boiler cap after min harm op and opt night op prep outside of harm op period",	"VT" : "Surplus el boiler cap after max harm op and opt night op prep outside of harm op period",	"VU" : "Surplus RawMeth prod cap after min day harm and opt night op prep",	"VV" : "Surplus RawMeth prod cap after max day harm and opt night op prep",	"VW" : "Surplus CO2 prod cap after min day harm and opt night op prep",	"VX" : "Surplus CO2 prod cap after max day harm and opt night op prep",	"VY" : "Surplus H2 prod cap after min day harm and opt night op prep",	"VZ" : "Surplus H2 prod cap after min day harm and opt night op prep",	"WA" : "Opt harm op period op during night prio operation",	"WB" : "",	"WC" : "el cons for harm op during harm op period",	"WD" : "el cons for night prep during harm op period",	"WE" : "el cons for BESS charging during harm op period",	"WF" : "el cons of el boiler for harm op during harm op period",	"WG" : "el cons of el boiler for night prep during harm op period",	"WH" : "PV available after harm op during harm op period",	"WI" : "grid input for harm op during harm op period",	"WJ" : "grid input for night prep during harm op period",	"WK" : "Balance of electricity during harm op period",	"WL" : "Heat cons for harm op during harm op period",	"WM" : "Heat cons for night prep during harm op period",	"WN" : "CSP heat available after harm op during harm op period",	"WO" : "El boiler heat prod for harm op during harm op period",	"WP" : "El boiler heat prod for night prep during harm op period",	"WQ" : "Balance of heat during harm op period",	"WR" : "el cons for harm op outside of harm op period",	"WS" : "el cons by el boiler outside of harm op period",	"WT" : "el cons for aux cons outside of harm op period",	"WU" : "el from PV outside of harm op period",	"WV" : "el from BESS outside of harm op period",	"WW" : "grid input outside of harm op period",	"WX" : "Balance of electricity outside of harm op period",	"WY" : "heat cons for harm op outside of harm op period",	"WZ" : "heat from CSP outside of harm op period",	"XA" : "heat from el boiler outside of harm op period",	"XB" : "Balance of heat outside of harm op period",	"XC" : "Pure Methanol prod with min night prep and resp day op",	"XD" : "grid export",	"XE" : "grid import",	"XF" : "Checksum",	"XG" : "",	"XH" : "el cons for harm op during harm op period",	"XI" : "el cons for night prep during harm op period",	"XJ" : "el cons for BESS charging during harm op period",	"XK" : "el cons of el boiler for harm op during harm op period",	"XL" : "el cons of el boiler for night prep during harm op period",	"XM" : "PV available after harm op during harm op period",	"XN" : "grid input for harm op during harm op period",	"XO" : "grid input for night prep during harm op period",	"XP" : "Balance of electricity during harm op period",	"XQ" : "Heat cons for harm op during harm op period",	"XR" : "Heat cons for night prep during harm op period",	"XS" : "CSP heat available after harm op during harm op period",	"XT" : "El boiler heat prod for harm op during harm op period",	"XU" : "El boiler heat prod for night prep during harm op period",	"XV" : "Balance of heat during harm op period",	"XW" : "el cons for harm op outside of harm op period",	"XX" : "el cons by el boiler outside of harm op period",	"XY" : "el cons for aux cons outside of harm op period",	"XZ" : "el from PV outside of harm op period",	"YA" : "el from BESS outside of harm op period",	"YB" : "grid input outside of harm op period",	"YC" : "Balance of electricity outside of harm op period",	"YD" : "heat cons for harm op outside of harm op period",	"YE" : "heat from CSP outside of harm op period",	"YF" : "heat from el boiler outside of harm op period",	"YG" : "Balance of heat outside of harm op period",	"YH" : "Pure Methanol prod with min night prep and resp day op",	"YI" : "grid export",	"YJ" : "grid import",	"YK" : "Checksum",	"YL" : "",	"YM" : "Pure Methanol produced",	"YN" : "grid cost balance",	"YO" : "LCOM of day",	"YP" : "Checksum",	"YQ" : "Pure Methanol produced",	"YR" : "grid cost balance",	"YS" : "LCOM of day",	"YT" : "Checksum",	"YU" : "Pure Methanol produced",	"YV" : "grid cost balance",	"YW" : "LCOM of day",	"YX" : "Checksum",	"YY" : "Pure Methanol produced",	"YZ" : "grid cost balance",	"ZA" : "LCOM of day",	"ZB" : "Checksum",	"ZC" : "Pure Methanol produced",	"ZD" : "grid cost balance",	"ZE" : "LCOM of day",	"ZF" : "Checksum",	"ZG" : "Pure Methanol produced",	"ZH" : "grid cost balance",	"ZI" : "LCOM of day",	"ZJ" : "Checksum",	"ZK" : "Pure Methanol produced",	"ZL" : "grid cost balance",	"ZM" : "LCOM of day",	"ZN" : "Checksum",	"ZO" : "Pure Methanol produced",	"ZP" : "grid cost balance",	"ZQ" : "LCOM of day",	"ZR" : "Checksum",	"ZS" : "Best op case",	"ZT" : "Meth produced",	"ZU" : "grid cost balance",	"ZV" : "LCOM of day",	"ZW" : "Checksum"
]
import Utilities
var minima = 0
func cleanUp(_ formulas: [String: String], _ titles: [String: String], _ count: Int = 8760, skip: [String])
  -> [String]
{
  var out = [String]()
  var i = 0
  for k in columns {
    guard !skip.contains(k), var formula = formulas[k], let title = titles[k] else { continue }
    formula = formula.dropFirst().replacingOccurrences(of: "$", with: "")
    .replacingOccurrences(of: "&", with: "").replacingOccurrences(of: ";", with: ",")
    let og = formula
    var newFormula = ""
    for char in formula {
      switch char {
        case "*": newFormula.append(" * ")
        case "+": newFormula.append(" + ")
        case "/": newFormula.append(" / ")
        case "^": newFormula.append(" ** ")
        default: newFormula.append(char)
      }
    }
    formula = newFormula
    formula = #"SUMIF\(Calculation([A-Z]*)........,"="A6,Calculation([A-Z]*)........\)"#.r!.replaceAll(in: formula, with: "$2sum[i]")
    formula = #"SUMIF\(([A-Z]*)[^,]*,([A-Z]*)[^,]*,([A-Z]*)[^)]*\)"#.r!.replaceAll(in: formula, with: "$2sum[i]")
    formula = #"SUMIFS\(Calculation([A-Z]*)[^,]*,Calculation([A-Z]*)[^,]*,....,Calculation([A-Z]*)[^,]*,.....,Calculation([A-Z]*)[^\)]*\)"#.r!.replaceAll(in: formula, with: "/* $2 $3 */ $1sum[i]")
    formula = #"SUMIFS\(Calculation([A-Z]*)[^,]*,Calculation([A-Z]*)[^,]*,.....,Calculation([A-Z]*)[^\)]*\)"#.r!.replaceAll(in: formula, with: "/* $2 $3 */ $1sum[i]")
    formula = #"COUNTIFS\(Calculation([A-Z]*)\S{1,10}"="([A-Z]*)\S{1,15}Calculation([A-Z]*)\S{5,14}"<=0"\)"#.r!.replaceAll(in: formula, with: "$3_$1countZero[i]")
    formula = #"COUNTIFS\(Calculation([A-Z]*)\S{1,10}"="([A-Z]*)\S{1,15}Calculation([A-Z]*)\S{5,14}">0"\)"#.r!.replaceAll(in: formula, with: "$3_$1countNonZero[i]")
    formula = #"COUNTIFS\(([A-Z]*)\d...............([A-Z]*)\S{1,15}">0"\)"#.r!.replaceAll(in: formula, with: "$2_$1countNonZero[i]")
    // #"SUM\(([A-Z]*)([0-9]):([A-Z]*)([0-9])\)"#
    // if formula.contains("COUNT") { print(k, formula) }
    formula = formula.replacingOccurrences(of: "MAX(", with: "max(")
      .replacingOccurrences(of: "MIN(", with: " min(")
      .replacingOccurrences(of: "IFERROR(", with: " ifFinite(\n ")
      .replacingOccurrences(of: "IF(", with: "iff(\n ")
      .replacingOccurrences(of: "AND(", with: " and(\n ")
      .replacingOccurrences(of: "OR(", with: " or(\n ")
      .replacingOccurrences(of: "COUNT", with: " count")
      .replacingOccurrences(of: "ROUND", with: " round")

    formula = formula.replacingOccurrences(of: "_n2g_", with: "_n_g_")
    formula = formula.replacingOccurrences(of: "CO2_", with: "C_O_2_")
    formula = formula.replacingOccurrences(of: "_H2O_", with: "_H_2_O_")
    formula = formula.replacingOccurrences(of: "_H2_", with: "_H_2_")
    formula = formula.replacingOccurrences(of: "LEC_Calc", with: "Lec_calc").replacingOccurrences(of: "<>", with: " != ")
    formula = formula.replacingOccurrences(of: "<=", with: " <= ")
    formula = formula.replacingOccurrences(of: ">=", with: " >= ").replacingOccurrences(of: "=0", with: ".isZero")
    formula = formula.replacingOccurrences(of: " = ", with: " == ")
    formula = formula.replacingOccurrences(of: "#", with: "_").replacingOccurrences(of: "$", with: "")
    formula = formula.replacingOccurrences(of: "!", with: "_")
    formula = formula.replacingOccurrences(of: "\"", with: "")
    formula = formula.replacingOccurrences(of: " =", with: " == ")
    
    if k == "AIN" {
      var index = 0
      Prio.allCases.map(\.rawValue).forEach {
        formula = formula.replacingOccurrences(of: "1" + $0, with: "\(index)")
        index += 1
      }
    }
    if k == "ZS" {
      var index = 0
      Prio.allCases.map(\.rawValue).forEach {
        formula = formula.replacingOccurrences(of: "2" + $0, with: "\(index)")
        index += 1
      }
    }
    if og.contains("SUM(") {
      // print(k, og)
    } 

    formula = #"([A-Z]+)[0-9]*:[A-Z]+[0-9]*"#.r!.replaceAll(in: formula, with: "$1..<$1+\(count)")
    formula = #"_C[0-9]"#.r!.replaceAll(in: formula, with: "")
    formula = #"([A-Z]{1,3})(5)"#.r!.replaceAll(in: formula, with: "xy[$1 + i - 1]")
    formula = #"([A-Z]{1,3})([0-9])"#.r!.replaceAll(in: formula, with: "xy[$1 + i]")
    formula = #"\$([A-Z]{1,3})\$([0-9])"#.r!.replaceAll(in: formula, with: "_$1_$2")
    formula = #"(A_)(\w*_\w*)"#.r!.replaceAll(in: formula, with: "$2[j]")
    formula = formula.replacingOccurrences(of: "-", with: " - ")
    // formula = #"(B_)(\w*_\w*)"#.r!.replaceAll(in: formula, with: "$2[j]")
    // formula = #"(C_)(\w*_\w*)"#.r!.replaceAll(in: formula, with: "$2[j]")
    // formula = #"(D_)(\w*_\w*)"#.r!.replaceAll(in: formula, with: "$2[j]")
    // let \(k)chunks = Array((0..<8760).chunked(by:) { xy[$0 + \(k)] == 0.0 && xy[$0 + \(k)] > 0.0) })
          // for chunk in \(k)chunks {
      //   xy[chunk].reduce(0, +)        
      // }
    let Case = formula.contains("[j]")
    out.append(
      """
      /// \(title)
      let \(k) = \(i*count)
      // \(og)
      for i in 0..<\(count) {       
        xy[\(k) + i] = \(formula)        
      }
      """)
    i += 1
  }
  
  return out
}

enum Prio: String, CaseIterable {
  case aDay = "a day prio"
  case aNight = "a night prio"
  case bDay = "b day prio"
  case bNight = "b night prio"
  case cDay = "c day prio"
  case cNight = "c night prio"
  case dDay = "d day prio"
  case dNight = "d night prio"
}